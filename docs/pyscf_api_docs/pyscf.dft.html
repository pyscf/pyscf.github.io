
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pyscf.dft package &#8212; PySCF</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf-pst.css?v=ed6b5f64" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=dfec817d"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pyscf_api_docs/pyscf.dft';</script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-64x64.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../_static/logo-64x64.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">PySCF</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../news.html">
    News
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../news.html">
    News
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pyscf.adc.html">pyscf.adc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.agf2.html">pyscf.agf2 package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.ao2mo.html">pyscf.ao2mo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.cc.html">pyscf.cc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.ci.html">pyscf.ci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.data.html">pyscf.data package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.df.html">pyscf.df package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.grad.html">pyscf.df.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.hessian.html">pyscf.df.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">pyscf.dft package</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.dft.xc.html">pyscf.dft.xc package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.eph.html">pyscf.eph package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.fci.html">pyscf.fci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.geomopt.html">pyscf.geomopt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.grad.html">pyscf.grad package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.gto.html">pyscf.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.gto.basis.html">pyscf.gto.basis package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.gw.html">pyscf.gw package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.hessian.html">pyscf.hessian package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.lib.html">pyscf.lib package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.lo.html">pyscf.lo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mcscf.html">pyscf.mcscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mp.html">pyscf.mp package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mrpt.html">pyscf.mrpt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.nac.html">pyscf.nac package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.pbc.html">pyscf.pbc package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.adc.html">pyscf.pbc.adc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ao2mo.html">pyscf.pbc.ao2mo package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.cc.html">pyscf.pbc.cc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ci.html">pyscf.pbc.ci package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.df.html">pyscf.pbc.df package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.pbc.dft.html">pyscf.pbc.dft package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html">pyscf.pbc.dft.multigrid package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.eph.html">pyscf.pbc.eph package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.geomopt.html">pyscf.pbc.geomopt package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.grad.html">pyscf.pbc.grad package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.pbc.gto.html">pyscf.pbc.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html">pyscf.pbc.gto.basis package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html">pyscf.pbc.gto.pseudo package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gw.html">pyscf.pbc.gw package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.lib.html">pyscf.pbc.lib package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mp.html">pyscf.pbc.mp package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpicc.html">pyscf.pbc.mpicc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpitools.html">pyscf.pbc.mpitools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.scf.html">pyscf.pbc.scf package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.symm.html">pyscf.pbc.symm package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tddft.html">pyscf.pbc.tddft package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tdscf.html">pyscf.pbc.tdscf package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tools.html">pyscf.pbc.tools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.x2c.html">pyscf.pbc.x2c package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.qmmm.html">pyscf.qmmm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.scf.html">pyscf.scf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.sgx.html">pyscf.sgx package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.solvent.html">pyscf.solvent package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.grad.html">pyscf.solvent.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.hessian.html">pyscf.solvent.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.soscf.html">pyscf.soscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.symm.html">pyscf.symm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tddft.html">pyscf.tddft package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tdscf.html">pyscf.tdscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tools.html">pyscf.tools package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.x2c.html">pyscf.x2c package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">pyscf.dft package</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pyscf-dft-package">
<h1>pyscf.dft package<a class="headerlink" href="#pyscf-dft-package" title="Link to this heading">#</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyscf.dft.xc.html">pyscf.dft.xc package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.dft.xc.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.dft.xc.html#module-pyscf.dft.xc.utils">pyscf.dft.xc.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.dft.xc.html#pyscf.dft.xc.utils.format_xc_code"><code class="docutils literal notranslate"><span class="pre">format_xc_code()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.dft.xc.html#pyscf.dft.xc.utils.remove_dup"><code class="docutils literal notranslate"><span class="pre">remove_dup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.dft.xc.html#module-pyscf.dft.xc">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-pyscf.dft.LebedevGrid">
<span id="pyscf-dft-lebedevgrid-module"></span><h2>pyscf.dft.LebedevGrid module<a class="headerlink" href="#module-pyscf.dft.LebedevGrid" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid" title="Link to this definition">#</a></dt>
<dd><p>Angular grids for specified Lebedev points</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_110">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_110</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_110"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_110" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_1202">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_1202</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_1202"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_1202" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_14">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_14</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_14"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_14" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_1454">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_1454</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_1454"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_1454" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_146">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_146</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_146"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_146" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_170">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_170</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_170" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_1730">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_1730</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_1730"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_1730" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_194">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_194</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_194"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_194" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_2030">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_2030</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_2030"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_2030" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_230">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_230</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_230"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_230" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_2354">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_2354</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_2354"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_2354" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_26">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_26</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_26"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_26" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_266">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_266</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_266"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_266" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_2702">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_2702</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_2702"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_2702" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_302">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_302</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_302"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_302" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_3074">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_3074</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_3074"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_3074" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_3470">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_3470</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_3470"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_3470" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_350">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_350</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_350"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_350" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_38">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_38</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_38"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_38" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_3890">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_3890</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_3890"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_3890" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_4334">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_4334</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_4334"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_4334" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_434">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_434</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_434"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_434" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_4802">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_4802</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_4802"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_4802" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_50">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_50</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_50"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_50" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_5294">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_5294</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_5294"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_5294" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_5810">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_5810</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_5810"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_5810" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_590">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_590</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_590"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_590" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_6">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_6</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_6"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_6" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_74">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_74</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_74"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_74" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_770">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_770</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_770"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_770" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_86">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_86</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_86"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_86" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.MakeAngularGrid_974">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">MakeAngularGrid_974</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#MakeAngularGrid_974"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_974" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.LebedevGrid.SphGenOh">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.LebedevGrid.</span></span><span class="sig-name descname"><span class="pre">SphGenOh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/LebedevGrid.html#SphGenOh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.LebedevGrid.SphGenOh" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.dft.dft_parser">
<span id="pyscf-dft-dft-parser-module"></span><h2>pyscf.dft.dft_parser module<a class="headerlink" href="#module-pyscf.dft.dft_parser" title="Link to this heading">#</a></h2>
<p>unified dft parser for coordinating dft protocols with
1. xc functionals
2. dispersion corrections / nonlocal correction
3. GTO basis (TODO)
4. geometrical counterpoise (gCP) correction (TODO)</p>
</section>
<section id="module-pyscf.dft.dks">
<span id="pyscf-dft-dks-module"></span><h2>pyscf.dft.dks module<a class="headerlink" href="#module-pyscf.dft.dks" title="Link to this heading">#</a></h2>
<p>4-component Dirac-Kohn-Sham</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.dks.DKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.dks.</span></span><span class="sig-name descname"><span class="pre">DKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#DKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.DKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.dft.dks.KohnShamDFT" title="pyscf.dft.dks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.scf.html#pyscf.scf.dhf.DHF" title="pyscf.scf.dhf.DHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">DHF</span></code></a></p>
<p>Kramers unrestricted Dirac-Kohn-Sham</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.dks.DKS.CasidaTDDFT">
<span class="sig-name descname"><span class="pre">CasidaTDDFT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.dks.DKS.CasidaTDDFT" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.DKS.TDA">
<span class="sig-name descname"><span class="pre">TDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.dks.DKS.TDA" title="Link to this definition">#</a></dt>
<dd><p>Tamm-Dancoff approximation</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Diagonalization convergence tolerance.  Default is 1e-9.</p>
</dd>
<dt>nstates<span class="classifier">int</span></dt><dd><p>Number of TD states to be computed. Default is 3.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Diagonalization converged or not</p>
</dd>
<dt>e<span class="classifier">1D array</span></dt><dd><p>excitation energy for each excited state.</p>
</dd>
<dt>xy<span class="classifier">A list of two 2D arrays</span></dt><dd><p>The two 2D arrays are Excitation coefficients X (shape [nocc,nvir])
and de-excitation coefficients Y (shape [nocc,nvir]) for each
excited state.  (X,Y) are normalized to 1/2 in RHF/RKS methods and
normalized to 1 for UHF/UKS methods. In the TDA calculation, Y = 0.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.DKS.TDDFT">
<span class="sig-name descname"><span class="pre">TDDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.dks.DKS.TDDFT" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.dks.DKS.TDHF">
<span class="sig-name descname"><span class="pre">TDHF</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.dks.DKS.TDHF" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.DKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#DKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.DKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.DKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.dks.DKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.DKS.x2c">
<span class="sig-name descname"><span class="pre">x2c</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.dks.DKS.x2c" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.DKS.x2c1e">
<span class="sig-name descname"><span class="pre">x2c1e</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#DKS.x2c1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.DKS.x2c1e" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.dks.</span></span><span class="sig-name descname"><span class="pre">KohnShamDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#KohnShamDFT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.dft.rks.KohnShamDFT" title="pyscf.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.collinear">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collinear</span></span><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.collinear" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#KohnShamDFT.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of RKS energy.</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl>
<dt>Args:</dt><dd><p>ks : an instance of DFT class</p>
<dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>RKS electronic energy and the 2-electron contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.dft.dks.RKS" title="pyscf.dft.dks.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dm_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The density matrix baseline.  If not 0, this function computes the
increment of HF potential w.r.t. the reference HF potential matrix.</p>
</dd>
<dt>vhf_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The reference Vxc potential matrix.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether J, K matrix is hermitian</p>
<div class="line-block">
<div class="line">0 : no hermitian or symmetric</div>
<div class="line">1 : hermitian</div>
<div class="line">2 : anti-hermitian</div>
</div>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.spin_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spin_samples</span></span><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.spin_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.to_dhf">
<span class="sig-name descname"><span class="pre">to_dhf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#KohnShamDFT.to_dhf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.to_dhf" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a DHF object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.to_dks">
<span class="sig-name descname"><span class="pre">to_dks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#KohnShamDFT.to_dks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.to_dks" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.to_ghf">
<span class="sig-name descname"><span class="pre">to_ghf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#KohnShamDFT.to_ghf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.to_ghf" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a GHF object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.to_gks">
<span class="sig-name descname"><span class="pre">to_gks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#KohnShamDFT.to_gks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.to_gks" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a GKS object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a DHF object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.to_ks">
<span class="sig-name descname"><span class="pre">to_ks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.to_ks" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.to_rhf">
<span class="sig-name descname"><span class="pre">to_rhf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#KohnShamDFT.to_rhf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.to_rhf" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a RHF/ROHF object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.to_rks">
<span class="sig-name descname"><span class="pre">to_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#KohnShamDFT.to_rks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.to_rks" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a RKS/ROKS object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.to_uhf">
<span class="sig-name descname"><span class="pre">to_uhf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#KohnShamDFT.to_uhf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.to_uhf" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a UHF object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.KohnShamDFT.to_uks">
<span class="sig-name descname"><span class="pre">to_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#KohnShamDFT.to_uks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.KohnShamDFT.to_uks" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a UKS object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.dks.RDKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.dks.</span></span><span class="sig-name descname"><span class="pre">RDKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#RDKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.RDKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.dft.dks.DKS" title="pyscf.dft.dks.DKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">DKS</span></code></a>, <a class="reference internal" href="pyscf.scf.html#pyscf.scf.dhf.RDHF" title="pyscf.scf.dhf.RDHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">RDHF</span></code></a></p>
<p>Kramers restricted Dirac-Kohn-Sham</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.dks.RDKS.CasidaTDDFT">
<span class="sig-name descname"><span class="pre">CasidaTDDFT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.dks.RDKS.CasidaTDDFT" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.RDKS.TDA">
<span class="sig-name descname"><span class="pre">TDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.dks.RDKS.TDA" title="Link to this definition">#</a></dt>
<dd><p>Tamm-Dancoff approximation</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Diagonalization convergence tolerance.  Default is 1e-9.</p>
</dd>
<dt>nstates<span class="classifier">int</span></dt><dd><p>Number of TD states to be computed. Default is 3.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Diagonalization converged or not</p>
</dd>
<dt>e<span class="classifier">1D array</span></dt><dd><p>excitation energy for each excited state.</p>
</dd>
<dt>xy<span class="classifier">A list of two 2D arrays</span></dt><dd><p>The two 2D arrays are Excitation coefficients X (shape [nocc,nvir])
and de-excitation coefficients Y (shape [nocc,nvir]) for each
excited state.  (X,Y) are normalized to 1/2 in RHF/RKS methods and
normalized to 1 for UHF/UKS methods. In the TDA calculation, Y = 0.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.RDKS.TDDFT">
<span class="sig-name descname"><span class="pre">TDDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.dks.RDKS.TDDFT" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.dks.RDKS.TDHF">
<span class="sig-name descname"><span class="pre">TDHF</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.dks.RDKS.TDHF" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.RDKS.to_dhf">
<span class="sig-name descname"><span class="pre">to_dhf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#RDKS.to_dhf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.RDKS.to_dhf" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a DHF object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.RDKS.x2c">
<span class="sig-name descname"><span class="pre">x2c</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.dks.RDKS.x2c" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.dks.RDKS.x2c1e">
<span class="sig-name descname"><span class="pre">x2c1e</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#RDKS.x2c1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.RDKS.x2c1e" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.dks.RKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.dks.</span></span><span class="sig-name descname"><span class="pre">RKS</span></span><a class="headerlink" href="#pyscf.dft.dks.RKS" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.dft.dks.RDKS" title="pyscf.dft.dks.RDKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RDKS</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.dks.UDKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.dks.</span></span><span class="sig-name descname"><span class="pre">UDKS</span></span><a class="headerlink" href="#pyscf.dft.dks.UDKS" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.dft.dks.DKS" title="pyscf.dft.dks.DKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">DKS</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.dks.UKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.dks.</span></span><span class="sig-name descname"><span class="pre">UKS</span></span><a class="headerlink" href="#pyscf.dft.dks.UKS" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.dft.dks.DKS" title="pyscf.dft.dks.DKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">DKS</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.dks.energy_elec">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.dks.</span></span><span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of DKS energy.</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl>
<dt>Args:</dt><dd><p>ks : an instance of DFT class</p>
<dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>DKS electronic energy and the 2-electron contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.dks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.dks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/dks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.dks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.dft.dks.RKS" title="pyscf.dft.dks.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dm_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The density matrix baseline.  If not 0, this function computes the
increment of HF potential w.r.t. the reference HF potential matrix.</p>
</dd>
<dt>vhf_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The reference Vxc potential matrix.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether J, K matrix is hermitian</p>
<div class="line-block">
<div class="line">0 : no hermitian or symmetric</div>
<div class="line">1 : hermitian</div>
<div class="line">2 : anti-hermitian</div>
</div>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.dft.gen_grid">
<span id="pyscf-dft-gen-grid-module"></span><h2>pyscf.dft.gen_grid module<a class="headerlink" href="#module-pyscf.dft.gen_grid" title="Link to this heading">#</a></h2>
<p>Generate DFT grids and weights, based on the code provided by Gerald Knizia &lt;&gt;</p>
<dl class="simple">
<dt>Reference for Lebedev-Laikov grid:</dt><dd><p>V. I. Lebedev, and D. N. Laikov A quadrature formula for the sphere of the
131st algebraic order of accuracy, Doklady Mathematics, 59, 477-481 (1999)</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">Grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#Grids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.Grids" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a></p>
<p>DFT mesh grids</p>
<dl>
<dt>Attributes for Grids:</dt><dd><dl>
<dt>level<span class="classifier">int</span></dt><dd><p>To control the number of radial and angular grids. Large number
leads to large mesh grids. The default level 3 corresponds to
(50,302) for H, He;
(75,302) for second row;
(80~105,434) for rest.</p>
<p>Grids settings at other levels can be found in
pyscf.dft.gen_grid.RAD_GRIDS and pyscf.dft.gen_grid.ANG_ORDER</p>
</dd>
<dt>atomic_radii<span class="classifier">1D array</span></dt><dd><div class="line-block">
<div class="line">radi.BRAGG_RADII  (default)</div>
<div class="line">radi.COVALENT_RADII</div>
<div class="line">None : to switch off atomic radii adjustment</div>
</div>
</dd>
<dt>radii_adjust<span class="classifier">function(mol, atomic_radii) =&gt; (function(atom_id, atom_id, g) =&gt; array_like_g)</span></dt><dd><p>Function to adjust atomic radii, can be one of
| radi.treutler_atomic_radii_adjust
| radi.becke_atomic_radii_adjust
| None : to switch off atomic radii adjustment</p>
</dd>
<dt>radi_method<span class="classifier">function(n) =&gt; (rad_grids, rad_weights)</span></dt><dd><p>scheme for radial grids, can be one of
| radi.treutler  (default)
| radi.delley
| radi.mura_knowles
| radi.gauss_chebyshev</p>
</dd>
<dt>becke_scheme<span class="classifier">function(v) =&gt; array_like_v</span></dt><dd><p>weight partition function, can be one of
| gen_grid.original_becke  (default)
| gen_grid.stratmann</p>
</dd>
<dt>prune<span class="classifier">function(nuc, rad_grids, n_ang) =&gt; list_n_ang_for_each_rad_grid</span></dt><dd><p>scheme to reduce number of grids, can be one of
| gen_grid.nwchem_prune  (default)
| gen_grid.sg1_prune
| gen_grid.treutler_prune
| None : to switch off grid pruning</p>
</dd>
<dt>symmetry<span class="classifier">bool</span></dt><dd><p>whether to symmetrize mesh grids (TODO)</p>
</dd>
<dt>atom_grid<span class="classifier">dict</span></dt><dd><p>Set (radial, angular) grids for particular atoms.
Eg, grids.atom_grid = {H: (20,110)} will generate 20 radial
grids and 110 angular grids for H atom.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.alignment">
<span class="sig-name descname"><span class="pre">alignment</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.alignment" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.atomic_radii">
<span class="sig-name descname"><span class="pre">atomic_radii</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">array([3.77945036,</span> <span class="pre">0.66140414,</span> <span class="pre">2.64561657,</span> <span class="pre">2.74010288,</span> <span class="pre">1.98421243,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1.60626721,</span> <span class="pre">1.32280829,</span> <span class="pre">1.22832198,</span> <span class="pre">1.13383567,</span> <span class="pre">0.94486306,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.83458919,</span> <span class="pre">3.40150702,</span> <span class="pre">2.83458919,</span> <span class="pre">2.36215766,</span> <span class="pre">2.07869874,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1.88972612,</span> <span class="pre">1.88972612,</span> <span class="pre">1.88972612,</span> <span class="pre">3.40150702,</span> <span class="pre">4.15739747,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.40150702,</span> <span class="pre">3.0235618</span> <span class="pre">,</span> <span class="pre">2.64561657,</span> <span class="pre">2.55113027,</span> <span class="pre">2.64561657,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.64561657,</span> <span class="pre">2.64561657,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.55113027,</span> <span class="pre">2.45664396,</span> <span class="pre">2.36215766,</span> <span class="pre">2.17318504,</span> <span class="pre">2.17318504,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.17318504,</span> <span class="pre">3.59047964,</span> <span class="pre">4.44085639,</span> <span class="pre">3.77945225,</span> <span class="pre">3.40150702,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.92907549,</span> <span class="pre">2.74010288,</span> <span class="pre">2.74010288,</span> <span class="pre">2.55113027,</span> <span class="pre">2.45664396,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.55113027,</span> <span class="pre">2.64561657,</span> <span class="pre">3.0235618</span> <span class="pre">,</span> <span class="pre">2.92907549,</span> <span class="pre">2.92907549,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.74010288,</span> <span class="pre">2.74010288,</span> <span class="pre">2.64561657,</span> <span class="pre">2.64561657,</span> <span class="pre">3.96842486,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">4.91328792,</span> <span class="pre">4.06291117,</span> <span class="pre">3.68496594,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.40150702,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">2.92907549,</span> <span class="pre">2.74010288,</span> <span class="pre">2.55113027,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.55113027,</span> <span class="pre">2.45664396,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.83458919,</span> <span class="pre">3.59047964,</span> <span class="pre">3.40150702,</span> <span class="pre">3.0235618</span> <span class="pre">,</span> <span class="pre">3.59047964,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.74010288,</span> <span class="pre">3.96842486,</span> <span class="pre">3.40150702,</span> <span class="pre">4.06291117,</span> <span class="pre">3.68496594,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.40150702,</span> <span class="pre">3.40150702,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3.30702072])</span></em><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.atomic_radii" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.becke_scheme">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">becke_scheme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.becke_scheme" title="Link to this definition">#</a></dt>
<dd><p>Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#Grids.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.build" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-15</span></em><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.cutoff" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#Grids.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.gen_atomic_grids">
<span class="sig-name descname"><span class="pre">gen_atomic_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radi_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.gen_atomic_grids" title="Link to this definition">#</a></dt>
<dd><p>Generate number of radial grids and angular grids for the given molecule.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>A dict, with the atom symbol for the dict key.  For each atom type,
the dict value has two items: one is the meshgrid coordinates wrt the
atom center; the second is the volume of that grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.gen_partition">
<span class="sig-name descname"><span class="pre">gen_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_grids_tab=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radii_adjust=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_radii=array([3.77945036</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.66140414</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.98421243</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.60626721</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.32280829</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.22832198</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.13383567</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.94486306</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.36215766</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.07869874</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.15739747</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.36215766</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.44085639</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.77945225</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.96842486</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.91328792</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.06291117</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.68496594</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.96842486</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.06291117</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.68496594</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">becke_scheme=&lt;function</span> <span class="pre">original_becke&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat=True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.gen_partition" title="Link to this definition">#</a></dt>
<dd><p>Generate the mesh grid coordinates and weights for DFT numerical integration.
We can change radii_adjust, becke_scheme functions to generate different meshgrid.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>concat: bool</dt><dd><p>Whether to concatenate grids and weights in return</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>grid_coord and grid_weight arrays.  grid_coord array has shape (N,3);
weight 1D array has N elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.get_partition">
<span class="sig-name descname"><span class="pre">get_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_grids_tab=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radii_adjust=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_radii=array([3.77945036</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.66140414</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.98421243</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.60626721</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.32280829</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.22832198</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.13383567</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.94486306</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.36215766</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.07869874</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.15739747</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.36215766</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.44085639</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.77945225</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.96842486</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.91328792</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.06291117</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.68496594</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.96842486</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.06291117</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.68496594</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">becke_scheme=&lt;function</span> <span class="pre">original_becke&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#Grids.get_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.get_partition" title="Link to this definition">#</a></dt>
<dd><p>Generate the mesh grid coordinates and weights for DFT numerical integration.
We can change radii_adjust, becke_scheme functions to generate different meshgrid.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>concat: bool</dt><dd><p>Whether to concatenate grids and weights in return</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>grid_coord and grid_weight arrays.  grid_coord array has shape (N,3);
weight 1D array has N elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#Grids.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.kernel" title="Link to this definition">#</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.level">
<span class="sig-name descname"><span class="pre">level</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.level" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.make_mask" title="Link to this definition">#</a></dt>
<dd><p>Mask to indicate whether a shell is ignorable on grids. See also the
function gto.eval_gto.make_screen_index</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>relativity<span class="classifier">bool</span></dt><dd><p>No effects.</p>
</dd>
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in mol will be evaluated.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D mask array of shape (N,nbas), where N is the number of grids, nbas
is the number of shells.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.prune">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nuc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.77945036,</span> <span class="pre">0.66140414,</span> <span class="pre">2.64561657,</span> <span class="pre">2.74010288,</span> <span class="pre">1.98421243,</span> <span class="pre">1.60626721,</span> <span class="pre">1.32280829,</span> <span class="pre">1.22832198,</span> <span class="pre">1.13383567,</span> <span class="pre">0.94486306,</span> <span class="pre">2.83458919,</span> <span class="pre">3.40150702,</span> <span class="pre">2.83458919,</span> <span class="pre">2.36215766,</span> <span class="pre">2.07869874,</span> <span class="pre">1.88972612,</span> <span class="pre">1.88972612,</span> <span class="pre">1.88972612,</span> <span class="pre">3.40150702,</span> <span class="pre">4.15739747,</span> <span class="pre">3.40150702,</span> <span class="pre">3.0235618,</span> <span class="pre">2.64561657,</span> <span class="pre">2.55113027,</span> <span class="pre">2.64561657,</span> <span class="pre">2.64561657,</span> <span class="pre">2.64561657,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.45664396,</span> <span class="pre">2.36215766,</span> <span class="pre">2.17318504,</span> <span class="pre">2.17318504,</span> <span class="pre">2.17318504,</span> <span class="pre">3.59047964,</span> <span class="pre">4.44085639,</span> <span class="pre">3.77945225,</span> <span class="pre">3.40150702,</span> <span class="pre">2.92907549,</span> <span class="pre">2.74010288,</span> <span class="pre">2.74010288,</span> <span class="pre">2.55113027,</span> <span class="pre">2.45664396,</span> <span class="pre">2.55113027,</span> <span class="pre">2.64561657,</span> <span class="pre">3.0235618,</span> <span class="pre">2.92907549,</span> <span class="pre">2.92907549,</span> <span class="pre">2.74010288,</span> <span class="pre">2.74010288,</span> <span class="pre">2.64561657,</span> <span class="pre">2.64561657,</span> <span class="pre">3.96842486,</span> <span class="pre">4.91328792,</span> <span class="pre">4.06291117,</span> <span class="pre">3.68496594,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.40150702,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">2.92907549,</span> <span class="pre">2.74010288,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.45664396,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.83458919,</span> <span class="pre">3.59047964,</span> <span class="pre">3.40150702,</span> <span class="pre">3.0235618,</span> <span class="pre">3.59047964,</span> <span class="pre">2.74010288,</span> <span class="pre">3.96842486,</span> <span class="pre">3.40150702,</span> <span class="pre">4.06291117,</span> <span class="pre">3.68496594,</span> <span class="pre">3.40150702,</span> <span class="pre">3.40150702,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.prune" title="Link to this definition">#</a></dt>
<dd><p>NWChem</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>nuc<span class="classifier">int</span></dt><dd><p>Nuclear charge.</p>
</dd>
<dt>rads<span class="classifier">1D array</span></dt><dd><p>Grid coordinates on radical axis.</p>
</dd>
<dt>n_ang<span class="classifier">int</span></dt><dd><p>Max number of grids over angular part.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>radii<span class="classifier">1D array</span></dt><dd><p>radii (in Bohr) for atoms in periodic table</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list has the same length as rads. The list element is the number of
grids over angular part for each radial grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.prune_by_density_">
<span class="sig-name descname"><span class="pre">prune_by_density_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#Grids.prune_by_density_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.prune_by_density_" title="Link to this definition">#</a></dt>
<dd><p>Prune grids if the electron density on the grid is small</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.radi_method">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">radi_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.radi_method" title="Link to this definition">#</a></dt>
<dd><p>Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.radii_adjust">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">radii_adjust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_radii</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.radii_adjust" title="Link to this definition">#</a></dt>
<dd><p>Treutler atomic radii adjust function: [JCP 102, 346 (1995); DOI:10.1063/1.469408]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#Grids.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.reset" title="Link to this definition">#</a></dt>
<dd><p>Reset mol and clean up relevant attributes for scanner mode</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.size" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.Grids.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gen_grid.Grids.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.arg_group_grids">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">arg_group_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#arg_group_grids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.arg_group_grids" title="Link to this definition">#</a></dt>
<dd><p>Partition the entire space into small boxes according to the input box_size.
Group the grids against these boxes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.gen_atomic_grids">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">gen_atomic_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_grid={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radi_method=&lt;function</span> <span class="pre">gauss_chebyshev&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune=&lt;function</span> <span class="pre">nwchem_prune&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#gen_atomic_grids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.gen_atomic_grids" title="Link to this definition">#</a></dt>
<dd><p>Generate number of radial grids and angular grids for the given molecule.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>A dict, with the atom symbol for the dict key.  For each atom type,
the dict value has two items: one is the meshgrid coordinates wrt the
atom center; the second is the volume of that grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.gen_partition">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">gen_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_grids_tab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radii_adjust=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_radii=array([3.77945036</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.66140414</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.98421243</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.60626721</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.32280829</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.22832198</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.13383567</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.94486306</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.36215766</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.07869874</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.15739747</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.36215766</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.44085639</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.77945225</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.96842486</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.91328792</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.06291117</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.68496594</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.96842486</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.06291117</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.68496594</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">becke_scheme=&lt;function</span> <span class="pre">original_becke&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat=True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gen_grid.gen_partition" title="Link to this definition">#</a></dt>
<dd><p>Generate the mesh grid coordinates and weights for DFT numerical integration.
We can change radii_adjust, becke_scheme functions to generate different meshgrid.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>concat: bool</dt><dd><p>Whether to concatenate grids and weights in return</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>grid_coord and grid_weight arrays.  grid_coord array has shape (N,3);
weight 1D array has N elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.get_partition">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">get_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_grids_tab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radii_adjust=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_radii=array([3.77945036</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.66140414</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.98421243</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.60626721</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.32280829</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.22832198</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.13383567</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.94486306</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.36215766</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.07869874</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.88972612</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.15739747</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.36215766</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.17318504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.44085639</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.77945225</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.64561657</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.96842486</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.91328792</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.06291117</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.68496594</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.49599333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.92907549</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.45664396</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.55113027</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.83458919</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.0235618</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.59047964</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2.74010288</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.96842486</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">4.06291117</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.68496594</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.40150702</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3.30702072])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">becke_scheme=&lt;function</span> <span class="pre">original_becke&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#get_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.get_partition" title="Link to this definition">#</a></dt>
<dd><p>Generate the mesh grid coordinates and weights for DFT numerical integration.
We can change radii_adjust, becke_scheme functions to generate different meshgrid.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>concat: bool</dt><dd><p>Whether to concatenate grids and weights in return</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>grid_coord and grid_weight arrays.  grid_coord array has shape (N,3);
weight 1D array has N elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.make_mask">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#make_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.make_mask" title="Link to this definition">#</a></dt>
<dd><p>Mask to indicate whether a shell is ignorable on grids. See also the
function gto.eval_gto.make_screen_index</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>relativity<span class="classifier">bool</span></dt><dd><p>No effects.</p>
</dd>
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in mol will be evaluated.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D mask array of shape (N,nbas), where N is the number of grids, nbas
is the number of shells.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.nwchem_prune">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">nwchem_prune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nuc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.77945036,</span> <span class="pre">0.66140414,</span> <span class="pre">2.64561657,</span> <span class="pre">2.74010288,</span> <span class="pre">1.98421243,</span> <span class="pre">1.60626721,</span> <span class="pre">1.32280829,</span> <span class="pre">1.22832198,</span> <span class="pre">1.13383567,</span> <span class="pre">0.94486306,</span> <span class="pre">2.83458919,</span> <span class="pre">3.40150702,</span> <span class="pre">2.83458919,</span> <span class="pre">2.36215766,</span> <span class="pre">2.07869874,</span> <span class="pre">1.88972612,</span> <span class="pre">1.88972612,</span> <span class="pre">1.88972612,</span> <span class="pre">3.40150702,</span> <span class="pre">4.15739747,</span> <span class="pre">3.40150702,</span> <span class="pre">3.0235618,</span> <span class="pre">2.64561657,</span> <span class="pre">2.55113027,</span> <span class="pre">2.64561657,</span> <span class="pre">2.64561657,</span> <span class="pre">2.64561657,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.45664396,</span> <span class="pre">2.36215766,</span> <span class="pre">2.17318504,</span> <span class="pre">2.17318504,</span> <span class="pre">2.17318504,</span> <span class="pre">3.59047964,</span> <span class="pre">4.44085639,</span> <span class="pre">3.77945225,</span> <span class="pre">3.40150702,</span> <span class="pre">2.92907549,</span> <span class="pre">2.74010288,</span> <span class="pre">2.74010288,</span> <span class="pre">2.55113027,</span> <span class="pre">2.45664396,</span> <span class="pre">2.55113027,</span> <span class="pre">2.64561657,</span> <span class="pre">3.0235618,</span> <span class="pre">2.92907549,</span> <span class="pre">2.92907549,</span> <span class="pre">2.74010288,</span> <span class="pre">2.74010288,</span> <span class="pre">2.64561657,</span> <span class="pre">2.64561657,</span> <span class="pre">3.96842486,</span> <span class="pre">4.91328792,</span> <span class="pre">4.06291117,</span> <span class="pre">3.68496594,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.49599333,</span> <span class="pre">3.40150702,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">2.92907549,</span> <span class="pre">2.74010288,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.45664396,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.55113027,</span> <span class="pre">2.83458919,</span> <span class="pre">3.59047964,</span> <span class="pre">3.40150702,</span> <span class="pre">3.0235618,</span> <span class="pre">3.59047964,</span> <span class="pre">2.74010288,</span> <span class="pre">3.96842486,</span> <span class="pre">3.40150702,</span> <span class="pre">4.06291117,</span> <span class="pre">3.68496594,</span> <span class="pre">3.40150702,</span> <span class="pre">3.40150702,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072,</span> <span class="pre">3.30702072])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#nwchem_prune"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.nwchem_prune" title="Link to this definition">#</a></dt>
<dd><p>NWChem</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>nuc<span class="classifier">int</span></dt><dd><p>Nuclear charge.</p>
</dd>
<dt>rads<span class="classifier">1D array</span></dt><dd><p>Grid coordinates on radical axis.</p>
</dd>
<dt>n_ang<span class="classifier">int</span></dt><dd><p>Max number of grids over angular part.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>radii<span class="classifier">1D array</span></dt><dd><p>radii (in Bohr) for atoms in periodic table</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list has the same length as rads. The list element is the number of
grids over angular part for each radial grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.original_becke">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">original_becke</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#original_becke"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.original_becke" title="Link to this definition">#</a></dt>
<dd><p>Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.sg1_prune">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">sg1_prune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nuc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">1.,</span> <span class="pre">0.5882,</span> <span class="pre">3.0769,</span> <span class="pre">2.0513,</span> <span class="pre">1.5385,</span> <span class="pre">1.2308,</span> <span class="pre">1.0256,</span> <span class="pre">0.8791,</span> <span class="pre">0.7692,</span> <span class="pre">0.6838,</span> <span class="pre">4.0909,</span> <span class="pre">3.1579,</span> <span class="pre">2.5714,</span> <span class="pre">2.1687,</span> <span class="pre">1.875,</span> <span class="pre">1.6514,</span> <span class="pre">1.4754,</span> <span class="pre">1.3333])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#sg1_prune"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.sg1_prune" title="Link to this definition">#</a></dt>
<dd><p>SG1, CPL, 209, 506</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>nuc<span class="classifier">int</span></dt><dd><p>Nuclear charge.</p>
</dd>
<dt>rads<span class="classifier">1D array</span></dt><dd><p>Grid coordinates on radical axis.</p>
</dd>
<dt>n_ang<span class="classifier">int</span></dt><dd><p>Max number of grids over angular part.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>radii<span class="classifier">1D array</span></dt><dd><p>radii (in Bohr) for atoms in periodic table</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list has the same length as rads. The list element is the number of
grids over angular part for each radial grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.stratmann">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">stratmann</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#stratmann"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.stratmann" title="Link to this definition">#</a></dt>
<dd><p>Stratmann, Scuseria, Frisch. CPL, 257, 213 (1996); DOI:10.1016/0009-2614(96)00600-8</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.gen_grid.treutler_prune">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">treutler_prune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nuc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gen_grid.html#treutler_prune"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gen_grid.treutler_prune" title="Link to this definition">#</a></dt>
<dd><p>Treutler-Ahlrichs</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>nuc<span class="classifier">int</span></dt><dd><p>Nuclear charge.</p>
</dd>
<dt>rads<span class="classifier">1D array</span></dt><dd><p>Grid coordinates on radical axis.</p>
</dd>
<dt>n_ang<span class="classifier">int</span></dt><dd><p>Max number of grids over angular part.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list has the same length as rads. The list element is the number of
grids over angular part for each radial grid.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.dft.gks">
<span id="pyscf-dft-gks-module"></span><h2>pyscf.dft.gks module<a class="headerlink" href="#module-pyscf.dft.gks" title="Link to this heading">#</a></h2>
<p>Generalized Kohn-Sham</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.gks.</span></span><span class="sig-name descname"><span class="pre">GKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gks.html#GKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gks.GKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.dft.rks.KohnShamDFT" title="pyscf.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.scf.html#pyscf.scf.ghf.GHF" title="pyscf.scf.ghf.GHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">GHF</span></code></a></p>
<p>Generalized Kohn-Sham</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.CasidaTDDFT">
<span class="sig-name descname"><span class="pre">CasidaTDDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks.GKS.CasidaTDDFT" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.TDA">
<span class="sig-name descname"><span class="pre">TDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks.GKS.TDA" title="Link to this definition">#</a></dt>
<dd><p>Tamm-Dancoff approximation</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Diagonalization convergence tolerance.  Default is 1e-9.</p>
</dd>
<dt>nstates<span class="classifier">int</span></dt><dd><p>Number of TD states to be computed. Default is 3.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Diagonalization converged or not</p>
</dd>
<dt>e<span class="classifier">1D array</span></dt><dd><p>excitation energy for each excited state.</p>
</dd>
<dt>xy<span class="classifier">A list of two 2D arrays</span></dt><dd><p>The two 2D arrays are Excitation coefficients X (shape [nocc,nvir])
and de-excitation coefficients Y (shape [nocc,nvir]) for each
excited state.  (X,Y) are normalized to 1/2 in RHF/RKS methods and
normalized to 1 for UHF/UKS methods. In the TDA calculation, Y = 0.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.TDDFT">
<span class="sig-name descname"><span class="pre">TDDFT</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks.GKS.TDDFT" title="Link to this definition">#</a></dt>
<dd><p>Driver to create TDDFT or CasidaTDDFT object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.TDDFTNoHybrid">
<span class="sig-name descname"><span class="pre">TDDFTNoHybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks.GKS.TDDFTNoHybrid" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.TDHF">
<span class="sig-name descname"><span class="pre">TDHF</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.gks.GKS.TDHF" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.collinear">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collinear</span></span><a class="headerlink" href="#pyscf.dft.gks.GKS.collinear" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gks.html#GKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gks.GKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks.GKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of RKS energy.</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl>
<dt>Args:</dt><dd><p>ks : an instance of DFT class</p>
<dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>RKS electronic energy and the 2-electron contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks.GKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dm_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The density matrix baseline.  If not 0, this function computes the
increment of HF potential w.r.t. the reference HF potential matrix.</p>
</dd>
<dt>vhf_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The reference Vxc potential matrix.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether J, K matrix is hermitian</p>
<div class="line-block">
<div class="line">0 : no hermitian or symmetric</div>
<div class="line">1 : hermitian</div>
<div class="line">2 : anti-hermitian</div>
</div>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gks.html#GKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gks.GKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.spin_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spin_samples</span></span><a class="headerlink" href="#pyscf.dft.gks.GKS.spin_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks.GKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks.GKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gks.html#GKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gks.GKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to GHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.gks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.gks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dm_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The density matrix baseline.  If not 0, this function computes the
increment of HF potential w.r.t. the reference HF potential matrix.</p>
</dd>
<dt>vhf_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The reference Vxc potential matrix.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether J, K matrix is hermitian</p>
<div class="line-block">
<div class="line">0 : no hermitian or symmetric</div>
<div class="line">1 : hermitian</div>
<div class="line">2 : anti-hermitian</div>
</div>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.dft.gks_symm">
<span id="pyscf-dft-gks-symm-module"></span><h2>pyscf.dft.gks_symm module<a class="headerlink" href="#module-pyscf.dft.gks_symm" title="Link to this heading">#</a></h2>
<p>Generalized Kohn-Sham</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.gks_symm.</span></span><span class="sig-name descname"><span class="pre">GKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gks_symm.html#GKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gks_symm.GKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.dft.rks.KohnShamDFT" title="pyscf.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.scf.html#pyscf.scf.ghf_symm.SymAdaptedGHF" title="pyscf.scf.ghf_symm.SymAdaptedGHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymAdaptedGHF</span></code></a></p>
<p>Restricted Kohn-Sham</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS.CasidaTDDFT">
<span class="sig-name descname"><span class="pre">CasidaTDDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks_symm.GKS.CasidaTDDFT" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS.TDA">
<span class="sig-name descname"><span class="pre">TDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks_symm.GKS.TDA" title="Link to this definition">#</a></dt>
<dd><p>Tamm-Dancoff approximation</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Diagonalization convergence tolerance.  Default is 1e-9.</p>
</dd>
<dt>nstates<span class="classifier">int</span></dt><dd><p>Number of TD states to be computed. Default is 3.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Diagonalization converged or not</p>
</dd>
<dt>e<span class="classifier">1D array</span></dt><dd><p>excitation energy for each excited state.</p>
</dd>
<dt>xy<span class="classifier">A list of two 2D arrays</span></dt><dd><p>The two 2D arrays are Excitation coefficients X (shape [nocc,nvir])
and de-excitation coefficients Y (shape [nocc,nvir]) for each
excited state.  (X,Y) are normalized to 1/2 in RHF/RKS methods and
normalized to 1 for UHF/UKS methods. In the TDA calculation, Y = 0.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS.TDDFT">
<span class="sig-name descname"><span class="pre">TDDFT</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks_symm.GKS.TDDFT" title="Link to this definition">#</a></dt>
<dd><p>Driver to create TDDFT or CasidaTDDFT object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS.TDDFTNoHybrid">
<span class="sig-name descname"><span class="pre">TDDFTNoHybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks_symm.GKS.TDDFTNoHybrid" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS.TDHF">
<span class="sig-name descname"><span class="pre">TDHF</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.gks_symm.GKS.TDHF" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS.collinear">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collinear</span></span><a class="headerlink" href="#pyscf.dft.gks_symm.GKS.collinear" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gks_symm.html#GKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gks_symm.GKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks_symm.GKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of RKS energy.</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl>
<dt>Args:</dt><dd><p>ks : an instance of DFT class</p>
<dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>RKS electronic energy and the 2-electron contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks_symm.GKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dm_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The density matrix baseline.  If not 0, this function computes the
increment of HF potential w.r.t. the reference HF potential matrix.</p>
</dd>
<dt>vhf_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The reference Vxc potential matrix.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether J, K matrix is hermitian</p>
<div class="line-block">
<div class="line">0 : no hermitian or symmetric</div>
<div class="line">1 : hermitian</div>
<div class="line">2 : anti-hermitian</div>
</div>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/gks_symm.html#GKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.gks_symm.GKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.gks_symm.GKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.gks_symm.GKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyscf.dft.libxc">
<span id="pyscf-dft-libxc-module"></span><h2>pyscf.dft.libxc module<a class="headerlink" href="#module-pyscf.dft.libxc" title="Link to this heading">#</a></h2>
<p>XC functional, the interface to libxc
(<a class="reference external" href="http://www.tddft.org/programs/octopus/wiki/index.php/Libxc">http://www.tddft.org/programs/octopus/wiki/index.php/Libxc</a>)</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.available_libxc_functionals">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">available_libxc_functionals</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#available_libxc_functionals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.available_libxc_functionals" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.define_xc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">define_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#define_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.define_xc" title="Link to this definition">#</a></dt>
<dd><p>Define XC functional.  See also <a class="reference internal" href="#pyscf.dft.libxc.eval_xc" title="pyscf.dft.libxc.eval_xc"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_xc()</span></code></a> for the rules of input description.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></p>
<dl class="simple">
<dt>description<span class="classifier">str</span></dt><dd><p>A string to describe the linear combination of different XC functionals.
The X and C functional are separated by comma like .8*LDA+.2*B86,VWN.
If HF was appeared in the string, it stands for the exact exchange.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA or GGA or MGGA</p>
</dd>
<dt>hyb<span class="classifier">float</span></dt><dd><p>hybrid functional coefficient</p>
</dd>
<dt>rsh<span class="classifier">a list of three floats</span></dt><dd><p>coefficients (omega, alpha, beta) for range-separated hybrid functional.
omega is the exponent factor in attenuated Coulomb operator e^{-omega r_{12}}/r_{12}
alpha is the coefficient for long-range part, hybrid coefficient
can be obtained by alpha + beta</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s1">&#39;.2*HF + .08*LDA + .72*B88, .81*LYP + .19*VWN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.3783361189611</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s1">&#39;LDA*.08 + .72*B88 + .2*HF, .81*LYP + .19*VWN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.3783361189611</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">eval_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">exc</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">rho</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">... </span>    <span class="n">vrho</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">rho</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">... </span>    <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">vrho</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">fxc</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 2nd order functional derivative</span>
<span class="gp">... </span>    <span class="n">kxc</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 3rd order functional derivative</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span><span class="p">,</span> <span class="n">fxc</span><span class="p">,</span> <span class="n">kxc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="n">eval_xc</span><span class="p">,</span> <span class="n">xctype</span><span class="o">=</span><span class="s1">&#39;LDA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">48.8525211046668</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.define_xc_">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">define_xc_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#define_xc_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.define_xc_" title="Link to this definition">#</a></dt>
<dd><p>Define XC functional.  See also <a class="reference internal" href="#pyscf.dft.libxc.eval_xc" title="pyscf.dft.libxc.eval_xc"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_xc()</span></code></a> for the rules of input description.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></p>
<dl class="simple">
<dt>description<span class="classifier">str</span></dt><dd><p>A string to describe the linear combination of different XC functionals.
The X and C functional are separated by comma like .8*LDA+.2*B86,VWN.
If HF was appeared in the string, it stands for the exact exchange.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA or GGA or MGGA</p>
</dd>
<dt>hyb<span class="classifier">float</span></dt><dd><p>hybrid functional coefficient</p>
</dd>
<dt>rsh<span class="classifier">a list of three floats</span></dt><dd><p>coefficients (omega, alpha, beta) for range-separated hybrid functional.
omega is the exponent factor in attenuated Coulomb operator e^{-omega r_{12}}/r_{12}
alpha is the coefficient for long-range part, hybrid coefficient
can be obtained by alpha + beta</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s1">&#39;.2*HF + .08*LDA + .72*B88, .81*LYP + .19*VWN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.3783361189611</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s1">&#39;LDA*.08 + .72*B88 + .2*HF, .81*LYP + .19*VWN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.3783361189611</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">eval_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">exc</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">rho</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">... </span>    <span class="n">vrho</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">rho</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">... </span>    <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">vrho</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">fxc</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 2nd order functional derivative</span>
<span class="gp">... </span>    <span class="n">kxc</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 3rd order functional derivative</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span><span class="p">,</span> <span class="n">fxc</span><span class="p">,</span> <span class="n">kxc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="n">eval_xc</span><span class="p">,</span> <span class="n">xctype</span><span class="o">=</span><span class="s1">&#39;LDA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">48.8525211046668</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.eval_xc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">eval_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#eval_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.eval_xc" title="Link to this definition">#</a></dt>
<dd><p>Interface to call libxc library to evaluate XC functional, potential
and functional derivatives.</p>
<ul>
<li><p>The given functional xc_code must be a one-line string.</p></li>
<li><p>The functional xc_code is case-insensitive.</p></li>
<li><p>The functional xc_code string has two parts, separated by ,.  The
first part describes the exchange functional, the second part sets the
correlation functional.</p>
<ul>
<li><p>If , not appeared in string, the entire string is treated as the
name of a compound functional (containing both the exchange and
the correlation functional) which was declared in the functional
aliases list. The full list of functional aliases can be obtained by
calling the function pyscf.dft.xcfun.XC_ALIAS.keys() .</p>
<p>If the string was not found in the aliased functional list, it is
treated as X functional.</p>
</li>
<li><p>To input only X functional (without C functional), leave the second
part blank. E.g. description=slater, means a functional with LDA
contribution only.</p></li>
<li><p>To neglect the contribution of X functional (just apply C functional),
leave blank in the first part, e.g. description=,vwn means a
functional with VWN only.</p></li>
<li><p>If compound XC functional is specified, no matter whether it is in the
X part (the string in front of comma) or the C part (the string behind
comma), both X and C functionals of the compound XC functional will be
used.</p></li>
</ul>
</li>
<li><p>The functional name can be placed in arbitrary order.  Two names need to
be separated by operators + or -.  Blank spaces are ignored.
NOTE the parser only reads operators + - *.  / is not supported.</p></li>
<li><p>A functional name can have at most one factor.  If the factor is not
given, it is set to 1.  Compound functional can be scaled as a unit. For
example 0.5*b3lyp is equivalent to
HF*0.1 + .04*LDA + .36*B88, .405*LYP + .095*VWN</p></li>
<li><p>String HF stands for exact exchange (HF K matrix).  HF can be put in
the correlation functional part (after comma). Putting HF in the
correlation part is the same to putting HF in the exchange part.</p></li>
<li><p>String RSH means range-separated operator. Its format is
RSH(omega, alpha, beta).  Another way to input RSH is to use keywords
SR_HF and LR_HF: SR_HF(0.1) * alpha_plus_beta and LR_HF(0.1) *
alpha where the number in parenthesis is the value of omega.</p></li>
<li><p>Be careful with the libxc convention of GGA functional, in which the LDA
contribution is included.</p></li>
</ul>
<dl>
<dt>Args:</dt><dd><dl>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>A string to describe the linear combination of different XC functionals.
The X and C functional are separated by comma like .8*LDA+.2*B86,VWN.
If HF (exact exchange) is appeared in the string, the HF part will
be skipped.  If an empty string  is given, the returns exc, vxc,
will be vectors of zeros.</p>
</dd>
<dt>rho<span class="classifier">ndarray</span></dt><dd><p>Shape of ((<em>,N)) for electron density (and derivatives) if spin = 0;
Shape of ((</em>,N),(<em>,N)) for alpha/beta electron density (and derivatives) if spin &gt; 0;
where N is number of grids.
rho (</em>,N) are ordered as (den,grad_x,grad_y,grad_z,laplacian,tau)
where grad_x = d/dx den, laplacian = nabla^2 den, tau = 1/2(nabla f)^2
In spin unrestricted case,
rho is ((den_u,grad_xu,grad_yu,grad_zu,laplacian_u,tau_u)</p>
<blockquote>
<div><p>(den_d,grad_xd,grad_yd,grad_zd,laplacian_d,tau_d))</p>
</div></blockquote>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin &gt; 0</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ex, vxc, fxc, kxc</p>
<p>where</p>
<ul>
<li><p>vxc = (vrho, vsigma, vlapl, vtau) for restricted case</p></li>
<li><p>vxc for unrestricted case
| vrho[:,2]   = (u, d)
| vsigma[:,3] = (uu, ud, dd)
| vlapl[:,2]  = (u, d)
| vtau[:,2]   = (u, d)</p></li>
<li><p>fxc for restricted case:
(v2rho2, v2rhosigma, v2sigma2, v2lapl2, vtau2, v2rholapl, v2rhotau, v2lapltau, v2sigmalapl, v2sigmatau)</p></li>
<li><p>fxc for unrestricted case:
| v2rho2[:,3]     = (u_u, u_d, d_d)
| v2rhosigma[:,6] = (u_uu, u_ud, u_dd, d_uu, d_ud, d_dd)
| v2sigma2[:,6]   = (uu_uu, uu_ud, uu_dd, ud_ud, ud_dd, dd_dd)
| v2lapl2[:,3]
| v2tau2[:,3]     = (u_u, u_d, d_d)
| v2rholapl[:,4]
| v2rhotau[:,4]   = (u_u, u_d, d_u, d_d)
| v2lapltau[:,4]
| v2sigmalapl[:,6]
| v2sigmatau[:,6] = (uu_u, uu_d, ud_u, ud_d, dd_u, dd_d)</p></li>
<li><p>kxc for restricted case:
(v3rho3, v3rho2sigma, v3rhosigma2, v3sigma3,</p>
<blockquote>
<div><p>v3rho2lapl, v3rho2tau,
v3rhosigmalapl, v3rhosigmatau,
v3rholapl2, v3rholapltau, v3rhotau2,
v3sigma2lapl, v3sigma2tau,
v3sigmalapl2, v3sigmalapltau, v3sigmatau2,
v3lapl3, v3lapl2tau, v3lapltau2, v3tau3)</p>
</div></blockquote>
</li>
<li><p>kxc for unrestricted case:
| v3rho3[:,4]         = (u_u_u, u_u_d, u_d_d, d_d_d)
| v3rho2sigma[:,9]    = (u_u_uu, u_u_ud, u_u_dd, u_d_uu, u_d_ud, u_d_dd, d_d_uu, d_d_ud, d_d_dd)
| v3rhosigma2[:,12]   = (u_uu_uu, u_uu_ud, u_uu_dd, u_ud_ud, u_ud_dd, u_dd_dd, d_uu_uu, d_uu_ud, d_uu_dd, d_ud_ud, d_ud_dd, d_dd_dd)
| v3sigma3[:,10]      = (uu_uu_uu, uu_uu_ud, uu_uu_dd, uu_ud_ud, uu_ud_dd, uu_dd_dd, ud_ud_ud, ud_ud_dd, ud_dd_dd, dd_dd_dd)
| v3rho2lapl[:,6]
| v3rho2tau[:,6]      = (u_u_u, u_u_d, u_d_u, u_d_d, d_d_u, d_d_d)
| v3rhosigmalapl[:,12]
| v3rhosigmatau[:,12] = (u_uu_u, u_uu_d, u_ud_u, u_ud_d, u_dd_u, u_dd_d,</p>
<blockquote>
<div><p>d_uu_u, d_uu_d, d_ud_u, d_ud_d, d_dd_u, d_dd_d)</p>
</div></blockquote>
<div class="line-block">
<div class="line">v3rholapl2[:,6]</div>
<div class="line">v3rholapltau[:,8]</div>
<div class="line">v3rhotau2[:,6]      = (u_u_u, u_u_d, u_d_d, d_u_u, d_u_d, d_d_d)</div>
<div class="line">v3sigma2lapl[:,12]</div>
<div class="line">v3sigma2tau[:,12]   = (uu_uu_u, uu_uu_d, uu_ud_u, uu_ud_d, uu_dd_u, uu_dd_d,
ud_ud_u, ud_ud_d, ud_dd_u, ud_dd_d, dd_dd_u, dd_dd_d)</div>
<div class="line">v3sigmalapl2[:,9]</div>
<div class="line">v3sigmalapltau[:,12]</div>
<div class="line">v3sigmatau2[:,9]    = (uu_u_u, uu_u_d, uu_d_d, ud_u_u, ud_u_d, ud_d_d, dd_u_u, dd_u_d, dd_d_d)</div>
<div class="line">v3lapl3[:,4]</div>
<div class="line">v3lapl2tau[:,6]</div>
<div class="line">v3lapltau2[:,6]</div>
<div class="line">v3tau3[:,4]         = (u_u_u, u_u_d, u_d_d, d_d_d)</div>
</div>
</li>
</ul>
<p>see also libxc_itrf.c</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.eval_xc1">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">eval_xc1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#eval_xc1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.eval_xc1" title="Link to this definition">#</a></dt>
<dd><p>Similar to eval_xc.
Returns an array with the order of derivatives following xcfun convention.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.eval_xc_eff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">eval_xc_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#eval_xc_eff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.eval_xc_eff" title="Link to this definition">#</a></dt>
<dd><p>Returns the derivative tensor against the density parameters</p>
<p>[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a]</p>
<p>or spin-polarized density parameters</p>
<dl class="simple">
<dt>[[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a],</dt><dd><p>[density_b, (nabla_x)_b, (nabla_y)_b, (nabla_z)_b, tau_b]].</p>
</dd>
</dl>
<p>It differs from the eval_xc method in the derivatives of non-local part.
The eval_xc method returns the XC functional derivatives to sigma
(<a href="#id1"><span class="problematic" id="id2">|</span></a>nabla rho|^2)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>rho: 2-dimensional or 3-dimensional array</dt><dd><p>Total density or (spin-up, spin-down) densities (and their
derivatives if GGA or MGGA functionals) on grids</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>deriv: int</dt><dd><p>derivative orders</p>
</dd>
<dt>omega: float</dt><dd><p>define the exponent in the attenuated Coulomb for RSH functional</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.hybrid_coeff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">hybrid_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#hybrid_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.hybrid_coeff" title="Link to this definition">#</a></dt>
<dd><p>Support recursively defining hybrid functional</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.is_gga">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">is_gga</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#is_gga"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.is_gga" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.is_hybrid_xc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">is_hybrid_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#is_hybrid_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.is_hybrid_xc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.is_lda">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">is_lda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#is_lda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.is_lda" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.is_meta_gga">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">is_meta_gga</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#is_meta_gga"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.is_meta_gga" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.is_nlc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">is_nlc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#is_nlc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.is_nlc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.libxc_reference">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">libxc_reference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#libxc_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.libxc_reference" title="Link to this definition">#</a></dt>
<dd><p>Returns the reference to libxc</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.libxc_reference_doi">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">libxc_reference_doi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#libxc_reference_doi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.libxc_reference_doi" title="Link to this definition">#</a></dt>
<dd><p>Returns the reference to libxc</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.libxc_version">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">libxc_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#libxc_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.libxc_version" title="Link to this definition">#</a></dt>
<dd><p>Returns the version of libxc</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.max_deriv_order">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">max_deriv_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#max_deriv_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.max_deriv_order" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.needs_laplacian">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">needs_laplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#needs_laplacian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.needs_laplacian" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.nlc_coeff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">nlc_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#nlc_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.nlc_coeff" title="Link to this definition">#</a></dt>
<dd><p>Get NLC coefficients</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.parse_xc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">parse_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#parse_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.parse_xc" title="Link to this definition">#</a></dt>
<dd><p>Rules to input functional description:</p>
<ul class="simple">
<li><p>The given functional description must be a one-line string.</p></li>
<li><p>The functional description is case-insensitive.</p></li>
<li><p>The functional description string has two parts, separated by ,.  The
first part describes the exchange functional, the second is the correlation
functional.</p>
<ul>
<li><p>If , was not in string, the entire string is considered as a
compound XC functional (including both X and C functionals, such as b3lyp).</p></li>
<li><p>To input only X functional (without C functional), leave the second
part blank. E.g. description=slater, means pure LDA functional.</p></li>
<li><p>To neglect X functional (just apply C functional), leave the first
part blank. E.g. description=,vwn means pure VWN functional.</p></li>
<li><p>If compound XC functional is specified, no matter whether it is in the
X part (the string in front of comma) or the C part (the string behind
comma), both X and C functionals of the compound XC functional will be
used.</p></li>
</ul>
</li>
<li><p>The functional name can be placed in arbitrary order.  Two name needs to
be separated by operators + or -.  Blank spaces are ignored.
NOTE the parser only reads operators + - *.  / is not in support.</p></li>
<li><p>A functional name can have at most one factor.  If the factor is not
given, it is set to 1.  Compound functional can be scaled as a unit. For
example 0.5*b3lyp is equivalent to
HF*0.1 + .04*LDA + .36*B88, .405*LYP + .095*VWN</p></li>
<li><p>String HF stands for exact exchange (HF K matrix).  Putting HF in
correlation functional part is the same to putting HF in exchange
part.</p></li>
<li><p>String RSH means range-separated operator. Its format is
RSH(omega, alpha, beta).  Another way to input RSH is to use keywords
SR_HF and LR_HF: SR_HF(0.1) * alpha_plus_beta and LR_HF(0.1) *
alpha where the number in parenthesis is the value of omega.</p></li>
<li><p>Be careful with the libxc convention on GGA functional, in which the LDA
contribution has been included.</p></li>
</ul>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>description<span class="classifier">str</span></dt><dd><p>A string to describe the linear combination of different XC functionals.
The X and C functional are separated by comma like .8*LDA+.2*B86,VWN.
If HF was appeared in the string, it stands for the exact exchange.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>decoded XC description, with the data structure
(hybrid, alpha, omega), ((libxc-Id, fac), (libxc-Id, fac), )</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.parse_xc_name">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">parse_xc_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#parse_xc_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.parse_xc_name" title="Link to this definition">#</a></dt>
<dd><p>Convert the XC functional name to libxc library internal ID.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.print_XC_CODES">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">print_XC_CODES</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#print_XC_CODES"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.print_XC_CODES" title="Link to this definition">#</a></dt>
<dd><p>Dump the built-in libxc XC_CODES along with their references in a readable format.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.rsh_coeff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">rsh_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#rsh_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.rsh_coeff" title="Link to this definition">#</a></dt>
<dd><p>Range-separated parameter and HF exchange components: omega, alpha, beta</p>
<dl class="simple">
<dt>Exc_RSH = c_LR * LR_HFX + c_SR * SR_HFX + (1-c_SR) * Ex_SR + (1-c_LR) * Ex_LR + Ec</dt><dd><p>= alpha * HFX   + beta * SR_HFX + (1-c_SR) * Ex_SR + (1-c_LR) * Ex_LR + Ec
= alpha * LR_HFX + hyb * SR_HFX + (1-c_SR) * Ex_SR + (1-c_LR) * Ex_LR + Ec</p>
</dd>
</dl>
<p>SR_HFX = &lt; pi | (1-erf(-omega r_{12}))/r_{12} | iq &gt;
LR_HFX = &lt; pi | erf(-omega r_{12})/r_{12} | iq &gt;
alpha = c_LR
beta = c_SR - c_LR = hyb - alpha</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.test_deriv_order">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">test_deriv_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#test_deriv_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.test_deriv_order" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.xc_reference">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">xc_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#xc_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.xc_reference" title="Link to this definition">#</a></dt>
<dd><p>Returns the reference to the individual XC functional</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.libxc.xc_type">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.libxc.</span></span><span class="sig-name descname"><span class="pre">xc_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/libxc.html#xc_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.libxc.xc_type" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.dft.numint">
<span id="pyscf-dft-numint-module"></span><h2>pyscf.dft.numint module<a class="headerlink" href="#module-pyscf.dft.numint" title="Link to this heading">#</a></h2>
<p>Numerical integration functions for RKS and UKS with real AO basis</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.numint.LibXCMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">LibXCMixin</span></span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#LibXCMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.LibXCMixin" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.LibXCMixin.eval_xc">
<span class="sig-name descname"><span class="pre">eval_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#LibXCMixin.eval_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.LibXCMixin.eval_xc" title="Link to this definition">#</a></dt>
<dd><p>Interface to call libxc library to evaluate XC functional, potential
and functional derivatives.</p>
<ul>
<li><p>The given functional xc_code must be a one-line string.</p></li>
<li><p>The functional xc_code is case-insensitive.</p></li>
<li><p>The functional xc_code string has two parts, separated by ,.  The
first part describes the exchange functional, the second part sets the
correlation functional.</p>
<ul>
<li><p>If , not appeared in string, the entire string is treated as the
name of a compound functional (containing both the exchange and
the correlation functional) which was declared in the functional
aliases list. The full list of functional aliases can be obtained by
calling the function pyscf.dft.xcfun.XC_ALIAS.keys() .</p>
<p>If the string was not found in the aliased functional list, it is
treated as X functional.</p>
</li>
<li><p>To input only X functional (without C functional), leave the second
part blank. E.g. description=slater, means a functional with LDA
contribution only.</p></li>
<li><p>To neglect the contribution of X functional (just apply C functional),
leave blank in the first part, e.g. description=,vwn means a
functional with VWN only.</p></li>
<li><p>If compound XC functional is specified, no matter whether it is in the
X part (the string in front of comma) or the C part (the string behind
comma), both X and C functionals of the compound XC functional will be
used.</p></li>
</ul>
</li>
<li><p>The functional name can be placed in arbitrary order.  Two names need to
be separated by operators + or -.  Blank spaces are ignored.
NOTE the parser only reads operators + - *.  / is not supported.</p></li>
<li><p>A functional name can have at most one factor.  If the factor is not
given, it is set to 1.  Compound functional can be scaled as a unit. For
example 0.5*b3lyp is equivalent to
HF*0.1 + .04*LDA + .36*B88, .405*LYP + .095*VWN</p></li>
<li><p>String HF stands for exact exchange (HF K matrix).  HF can be put in
the correlation functional part (after comma). Putting HF in the
correlation part is the same to putting HF in the exchange part.</p></li>
<li><p>String RSH means range-separated operator. Its format is
RSH(omega, alpha, beta).  Another way to input RSH is to use keywords
SR_HF and LR_HF: SR_HF(0.1) * alpha_plus_beta and LR_HF(0.1) *
alpha where the number in parenthesis is the value of omega.</p></li>
<li><p>Be careful with the libxc convention of GGA functional, in which the LDA
contribution is included.</p></li>
</ul>
<dl>
<dt>Args:</dt><dd><dl>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>A string to describe the linear combination of different XC functionals.
The X and C functional are separated by comma like .8*LDA+.2*B86,VWN.
If HF (exact exchange) is appeared in the string, the HF part will
be skipped.  If an empty string  is given, the returns exc, vxc,
will be vectors of zeros.</p>
</dd>
<dt>rho<span class="classifier">ndarray</span></dt><dd><p>Shape of ((<em>,N)) for electron density (and derivatives) if spin = 0;
Shape of ((</em>,N),(<em>,N)) for alpha/beta electron density (and derivatives) if spin &gt; 0;
where N is number of grids.
rho (</em>,N) are ordered as (den,grad_x,grad_y,grad_z,laplacian,tau)
where grad_x = d/dx den, laplacian = nabla^2 den, tau = 1/2(nabla f)^2
In spin unrestricted case,
rho is ((den_u,grad_xu,grad_yu,grad_zu,laplacian_u,tau_u)</p>
<blockquote>
<div><p>(den_d,grad_xd,grad_yd,grad_zd,laplacian_d,tau_d))</p>
</div></blockquote>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin &gt; 0</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ex, vxc, fxc, kxc</p>
<p>where</p>
<ul>
<li><p>vxc = (vrho, vsigma, vlapl, vtau) for restricted case</p></li>
<li><p>vxc for unrestricted case
| vrho[:,2]   = (u, d)
| vsigma[:,3] = (uu, ud, dd)
| vlapl[:,2]  = (u, d)
| vtau[:,2]   = (u, d)</p></li>
<li><p>fxc for restricted case:
(v2rho2, v2rhosigma, v2sigma2, v2lapl2, vtau2, v2rholapl, v2rhotau, v2lapltau, v2sigmalapl, v2sigmatau)</p></li>
<li><p>fxc for unrestricted case:
| v2rho2[:,3]     = (u_u, u_d, d_d)
| v2rhosigma[:,6] = (u_uu, u_ud, u_dd, d_uu, d_ud, d_dd)
| v2sigma2[:,6]   = (uu_uu, uu_ud, uu_dd, ud_ud, ud_dd, dd_dd)
| v2lapl2[:,3]
| v2tau2[:,3]     = (u_u, u_d, d_d)
| v2rholapl[:,4]
| v2rhotau[:,4]   = (u_u, u_d, d_u, d_d)
| v2lapltau[:,4]
| v2sigmalapl[:,6]
| v2sigmatau[:,6] = (uu_u, uu_d, ud_u, ud_d, dd_u, dd_d)</p></li>
<li><p>kxc for restricted case:
(v3rho3, v3rho2sigma, v3rhosigma2, v3sigma3,</p>
<blockquote>
<div><p>v3rho2lapl, v3rho2tau,
v3rhosigmalapl, v3rhosigmatau,
v3rholapl2, v3rholapltau, v3rhotau2,
v3sigma2lapl, v3sigma2tau,
v3sigmalapl2, v3sigmalapltau, v3sigmatau2,
v3lapl3, v3lapl2tau, v3lapltau2, v3tau3)</p>
</div></blockquote>
</li>
<li><p>kxc for unrestricted case:
| v3rho3[:,4]         = (u_u_u, u_u_d, u_d_d, d_d_d)
| v3rho2sigma[:,9]    = (u_u_uu, u_u_ud, u_u_dd, u_d_uu, u_d_ud, u_d_dd, d_d_uu, d_d_ud, d_d_dd)
| v3rhosigma2[:,12]   = (u_uu_uu, u_uu_ud, u_uu_dd, u_ud_ud, u_ud_dd, u_dd_dd, d_uu_uu, d_uu_ud, d_uu_dd, d_ud_ud, d_ud_dd, d_dd_dd)
| v3sigma3[:,10]      = (uu_uu_uu, uu_uu_ud, uu_uu_dd, uu_ud_ud, uu_ud_dd, uu_dd_dd, ud_ud_ud, ud_ud_dd, ud_dd_dd, dd_dd_dd)
| v3rho2lapl[:,6]
| v3rho2tau[:,6]      = (u_u_u, u_u_d, u_d_u, u_d_d, d_d_u, d_d_d)
| v3rhosigmalapl[:,12]
| v3rhosigmatau[:,12] = (u_uu_u, u_uu_d, u_ud_u, u_ud_d, u_dd_u, u_dd_d,</p>
<blockquote>
<div><p>d_uu_u, d_uu_d, d_ud_u, d_ud_d, d_dd_u, d_dd_d)</p>
</div></blockquote>
<div class="line-block">
<div class="line">v3rholapl2[:,6]</div>
<div class="line">v3rholapltau[:,8]</div>
<div class="line">v3rhotau2[:,6]      = (u_u_u, u_u_d, u_d_d, d_u_u, d_u_d, d_d_d)</div>
<div class="line">v3sigma2lapl[:,12]</div>
<div class="line">v3sigma2tau[:,12]   = (uu_uu_u, uu_uu_d, uu_ud_u, uu_ud_d, uu_dd_u, uu_dd_d,
ud_ud_u, ud_ud_d, ud_dd_u, ud_dd_d, dd_dd_u, dd_dd_d)</div>
<div class="line">v3sigmalapl2[:,9]</div>
<div class="line">v3sigmalapltau[:,12]</div>
<div class="line">v3sigmatau2[:,9]    = (uu_u_u, uu_u_d, uu_d_d, ud_u_u, ud_u_d, ud_d_d, dd_u_u, dd_u_d, dd_d_d)</div>
<div class="line">v3lapl3[:,4]</div>
<div class="line">v3lapl2tau[:,6]</div>
<div class="line">v3lapltau2[:,6]</div>
<div class="line">v3tau3[:,4]         = (u_u_u, u_u_d, u_d_d, d_d_d)</div>
</div>
</li>
</ul>
<p>see also libxc_itrf.c</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.LibXCMixin.eval_xc1">
<span class="sig-name descname"><span class="pre">eval_xc1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#LibXCMixin.eval_xc1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.LibXCMixin.eval_xc1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.LibXCMixin.eval_xc_eff">
<span class="sig-name descname"><span class="pre">eval_xc_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#LibXCMixin.eval_xc_eff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.LibXCMixin.eval_xc_eff" title="Link to this definition">#</a></dt>
<dd><p>Returns the derivative tensor against the density parameters</p>
<p>[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a]</p>
<p>or spin-polarized density parameters</p>
<dl class="simple">
<dt>[[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a],</dt><dd><p>[density_b, (nabla_x)_b, (nabla_y)_b, (nabla_z)_b, tau_b]].</p>
</dd>
</dl>
<p>It differs from the eval_xc method in the derivatives of non-local part.
The eval_xc method returns the XC functional derivatives to sigma
(<a href="#id3"><span class="problematic" id="id4">|</span></a>nabla rho|^2)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>rho: 2-dimensional or 3-dimensional array</dt><dd><p>Total density or (spin-up, spin-down) densities (and their
derivatives if GGA or MGGA functionals) on grids</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>deriv: int</dt><dd><p>derivative orders</p>
</dd>
<dt>omega: float</dt><dd><p>define the exponent in the attenuated Coulomb for RSH functional</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.LibXCMixin.hybrid_coeff">
<span class="sig-name descname"><span class="pre">hybrid_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#LibXCMixin.hybrid_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.LibXCMixin.hybrid_coeff" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.numint.LibXCMixin.libxc">
<span class="sig-name descname"><span class="pre">libxc</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;module</span> <span class="pre">'pyscf.dft.libxc'</span> <span class="pre">from</span> <span class="pre">'/home/runner/.local/lib/python3.10/site-packages/pyscf/dft/libxc.py'&gt;</span></em><a class="headerlink" href="#pyscf.dft.numint.LibXCMixin.libxc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.LibXCMixin.nlc_coeff">
<span class="sig-name descname"><span class="pre">nlc_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#LibXCMixin.nlc_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.LibXCMixin.nlc_coeff" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.numint.LibXCMixin.omega">
<span class="sig-name descname"><span class="pre">omega</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.numint.LibXCMixin.omega" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.LibXCMixin.rsh_and_hybrid_coeff">
<span class="sig-name descname"><span class="pre">rsh_and_hybrid_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#LibXCMixin.rsh_and_hybrid_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.LibXCMixin.rsh_and_hybrid_coeff" title="Link to this definition">#</a></dt>
<dd><p>Range-separated parameter and HF exchange components: omega, alpha, beta</p>
<dl class="simple">
<dt>Exc_RSH = c_SR * SR_HFX + c_LR * LR_HFX + (1-c_SR) * Ex_SR + (1-c_LR) * Ex_LR + Ec</dt><dd><p>= alpha * HFX + beta * SR_HFX + (1-c_SR) * Ex_SR + (1-c_LR) * Ex_LR + Ec
= alpha * LR_HFX + hyb * SR_HFX + (1-c_SR) * Ex_SR + (1-c_LR) * Ex_LR + Ec</p>
</dd>
</dl>
<p>SR_HFX = &lt; pi | (1-erf(-omega r_{12}))/r_{12} | iq &gt;
LR_HFX = &lt; pi | erf(-omega r_{12})/r_{12} | iq &gt;
alpha = c_LR
beta = c_SR - c_LR</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.LibXCMixin.rsh_coeff">
<span class="sig-name descname"><span class="pre">rsh_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#LibXCMixin.rsh_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.LibXCMixin.rsh_coeff" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">NumInt</span></span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#NumInt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.NumInt" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a>, <a class="reference internal" href="#pyscf.dft.numint.LibXCMixin" title="pyscf.dft.numint.LibXCMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LibXCMixin</span></code></a></p>
<p>Numerical integration methods for non-relativistic RKS and UKS</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.block_loop">
<span class="sig-name descname"><span class="pre">block_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#NumInt.block_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.NumInt.block_loop" title="Link to this definition">#</a></dt>
<dd><p>Define this macro to loop over grids by blocks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.cache_xc_kernel">
<span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.cache_xc_kernel" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.cache_xc_kernel1">
<span class="sig-name descname"><span class="pre">cache_xc_kernel1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.cache_xc_kernel1" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc. Note dm the zeroth order density matrix must be a
hermitian matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-13</span></em><a class="headerlink" href="#pyscf.dft.numint.NumInt.cutoff" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.eval_ao">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.eval_ao" title="Link to this definition">#</a></dt>
<dd><p>Evaluate AO function value on the given grids.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of the grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>deriv<span class="classifier">int</span></dt><dd><p>AO derivative order.  It affects the shape of the return array.
If deriv=0, the returned AO values are stored in a (N,nao) array.
Otherwise the AO values are stored in an array of shape (M,N,nao).
Here N is the number of grids, nao is the number of AO functions,
M is the size associated to the derivative deriv.</p>
</dd>
<dt>relativity<span class="classifier">bool</span></dt><dd><p>No effects.</p>
</dd>
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in mol will be evaluated.</p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <a class="reference internal" href="#pyscf.dft.numint.NumInt.make_mask" title="pyscf.dft.numint.NumInt.make_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></a></p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>AO values smaller than cutoff will be set to zero. The default
cutoff threshold is ~1e-22 (defined in gto/grid_ao_drv.h)</p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>If provided, results are written into this array.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array of shape (N,nao) for AO values if deriv = 0.
Or 3D array of shape (:,N,nao) for AO values and AO derivatives if deriv &gt; 0.
In the 3D array, the first (N,nao) elements are the AO values,
followed by (3,N,nao) for x,y,z components;
Then 2nd derivatives (6,N,nao) for xx, xy, xz, yy, yz, zz;
Then 3rd derivatives (10,N,nao) for xxx, xxy, xxz, xyy, xyz, xzz, yyy, yyz, yzz, zzz;
</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 24)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shls_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(4, 100, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shls_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(10, 100, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.eval_rho">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.eval_rho" title="Link to this definition">#</a></dt>
<dd><p>Calculate the electron density for LDA functional, and the density
derivatives for GGA and MGGA functionals.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">2D array of shape (N,nao) for LDA, 3D array of shape (4,N,nao) for GGA</span></dt><dd><p>or meta-GGA.  N is the number of grids, nao is the
number of AO functions.  If xctype is GGA (MGGA), ao[0] is AO value
and ao[1:3] are the AO gradients. ao[4:10] are second derivatives of
ao values if applicable.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <a class="reference internal" href="#pyscf.dft.numint.NumInt.make_mask" title="pyscf.dft.numint.NumInt.make_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></a></p>
</dd>
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of the return density.</p>
</dd>
<dt>hermi<span class="classifier">bool</span></dt><dd><p>dm is hermitian or not</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>1D array of size N to store electron density if xctype = LDA;  2D array
of (4,N) to store density and density derivatives for x,y,z components
if xctype = GGA; For meta-GGA, returns can be a (6,N) (with_lapl=True)
array where last two rows are nabla^2 rho and tau = 1/2(nabla f)^2
or (5,N) (with_lapl=False) where the last row is tau = 1/2(nabla f)^2</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">dm</span> <span class="o">+</span> <span class="n">dm</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span><span class="p">,</span> <span class="n">dx_rho</span><span class="p">,</span> <span class="n">dy_rho</span><span class="p">,</span> <span class="n">dz_rho</span> <span class="o">=</span> <span class="n">eval_rho</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">ao</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">xctype</span><span class="o">=</span><span class="s1">&#39;LDA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.eval_rho1">
<span class="sig-name descname"><span class="pre">eval_rho1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pair_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.eval_rho1" title="Link to this definition">#</a></dt>
<dd><p>Calculate the electron density for LDA and the density derivatives for
GGA and MGGA with sparsity information.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">2D array of shape (N,nao) for LDA, 3D array of shape (4,N,nao) for GGA</span></dt><dd><p>or meta-GGA.  N is the number of grids, nao is the
number of AO functions.  If xctype is GGA (MGGA), ao[0] is AO value
and ao[1:3] are the AO gradients. ao[4:10] are second derivatives of
ao values if applicable.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>screen_index<span class="classifier">2D uint8 array</span></dt><dd><p>How likely the AO values on grids are negligible. This array can be
obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">gen_grid.make_screen_index()</span></code></p>
</dd>
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of the return density.</p>
</dd>
<dt>hermi<span class="classifier">bool</span></dt><dd><p>dm is hermitian or not</p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>cutoff for density value</p>
</dd>
<dt>ao_cutoff<span class="classifier">float</span></dt><dd><p>cutoff for AO value. Needs to be the same to the cutoff when
generating screen_index</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>1D array of size N to store electron density if xctype = LDA;  2D array
of (4,N) to store density and density derivatives for x,y,z components
if xctype = GGA; For meta-GGA, returns can be a (6,N) (with_lapl=True)
array where last two rows are nabla^2 rho and tau = 1/2(nabla f)^2
or (5,N) (with_lapl=False) where the last row is tau = 1/2(nabla f)^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.eval_rho2">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.eval_rho2" title="Link to this definition">#</a></dt>
<dd><p>Calculate the electron density for LDA functional, and the density
derivatives for GGA functional.  This function has the same functionality
as <a class="reference internal" href="#pyscf.dft.numint.eval_rho" title="pyscf.dft.numint.eval_rho"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_rho()</span></code></a> except that the density are evaluated based on orbital
coefficients and orbital occupancy.  It is more efficient than
<a class="reference internal" href="#pyscf.dft.numint.eval_rho" title="pyscf.dft.numint.eval_rho"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_rho()</span></code></a> in most scenario.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">2D array of shape (N,nao) for LDA, 3D array of shape (4,N,nao) for GGA</span></dt><dd><p>or meta-GGA.  N is the number of grids, nao is the
number of AO functions.  If xctype is GGA (MGGA), ao[0] is AO value
and ao[1:3] are the AO gradients. ao[4:10] are second derivatives of
ao values if applicable.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <a class="reference internal" href="#pyscf.dft.numint.NumInt.make_mask" title="pyscf.dft.numint.NumInt.make_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></a></p>
</dd>
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of the return density.</p>
</dd>
<dt>with_lapl: bool</dt><dd><p>Whether to compute laplacian. It affects the shape of returns.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>1D array of size N to store electron density if xctype = LDA;  2D array
of (4,N) to store density and density derivatives for x,y,z components
if xctype = GGA; For meta-GGA, returns can be a (6,N) (with_lapl=True)
array where last two rows are nabla^2 rho and tau = 1/2(nabla f)^2
or (5,N) (with_lapl=False) where the last row is tau = 1/2(nabla f)^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.get_fxc">
<span class="sig-name descname"><span class="pre">get_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.get_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract XC kernel matrix with given density matrices</p>
<p> math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_</span><span class="p">{</span><span class="n">pq</span><span class="p">}</span> <span class="o">=</span> <span class="n">f_</span><span class="p">{</span><span class="n">pq</span><span class="p">,</span><span class="n">rs</span><span class="p">}</span> <span class="o">*</span> <span class="n">x_</span><span class="p">{</span><span class="n">rs</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.get_vxc">
<span class="sig-name descname"><span class="pre">get_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.get_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix on given meshgrids
for a set of density matrices.  See <a class="reference internal" href="#pyscf.dft.numint.nr_rks" title="pyscf.dft.numint.nr_rks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code></a> and <a class="reference internal" href="#pyscf.dft.numint.nr_uks" title="pyscf.dft.numint.nr_uks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code></a>
for more details.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array or a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">nr_vxc</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.make_mask">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.make_mask" title="Link to this definition">#</a></dt>
<dd><p>Mask to indicate whether a shell is ignorable on grids. See also the
function gto.eval_gto.make_screen_index</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>relativity<span class="classifier">bool</span></dt><dd><p>No effects.</p>
</dd>
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in mol will be evaluated.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D mask array of shape (N,nbas), where N is the number of grids, nbas
is the number of shells.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.nr_fxc">
<span class="sig-name descname"><span class="pre">nr_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#NumInt.nr_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.NumInt.nr_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract XC kernel matrix with given density matrices</p>
<p> math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_</span><span class="p">{</span><span class="n">pq</span><span class="p">}</span> <span class="o">=</span> <span class="n">f_</span><span class="p">{</span><span class="n">pq</span><span class="p">,</span><span class="n">rs</span><span class="p">}</span> <span class="o">*</span> <span class="n">x_</span><span class="p">{</span><span class="n">rs</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.nr_nlc_vxc">
<span class="sig-name descname"><span class="pre">nr_nlc_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.nr_nlc_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate NLC functional and potential matrix on given grids</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.nr_rks">
<span class="sig-name descname"><span class="pre">nr_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.nr_rks" title="Link to this definition">#</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix on given meshgrids
for a set of density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array or a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ni</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">NumInt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">nr_rks</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.nr_rks_fxc">
<span class="sig-name descname"><span class="pre">nr_rks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.nr_rks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC (singlet hessian) kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm0<span class="classifier">2D array</span></dt><dd><p>Zeroth order density matrix</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>First order density matrix or density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>First order density matrix symmetric or not. It also indicates
whether the matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.nr_rks_fxc_st">
<span class="sig-name descname"><span class="pre">nr_rks_fxc_st</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.nr_rks_fxc_st" title="Link to this definition">#</a></dt>
<dd><p>Associated to singlet or triplet Hessian
Note the difference to nr_rks_fxc, dms_alpha is the response density
matrices of alpha spin, alpha+/-beta DM is applied due to singlet/triplet
coupling</p>
<p>Ref. CPL, 256, 454</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.nr_sap">
<span class="sig-name descname"><span class="pre">nr_sap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.nr_sap" title="Link to this definition">#</a></dt>
<dd><p>Calculate superposition of atomic potentials matrix on given meshgrids.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>vmat is the XC potential matrix in 2D array of shape (nao,nao)
where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:
&gt;&gt;&gt; import numpy
&gt;&gt;&gt; from pyscf import gto, dft
&gt;&gt;&gt; mol = gto.M(atom=H 0 0 0; H 0 0 1.1)
&gt;&gt;&gt; grids = dft.gen_grid.Grids(mol)
&gt;&gt;&gt; ni = dft.numint.NumInt()
&gt;&gt;&gt; vsap = ni.nr_sap(mol, grids)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.nr_sap_vxc">
<span class="sig-name descname"><span class="pre">nr_sap_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.nr_sap_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate superposition of atomic potentials matrix on given meshgrids.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>vmat is the XC potential matrix in 2D array of shape (nao,nao)
where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:
&gt;&gt;&gt; import numpy
&gt;&gt;&gt; from pyscf import gto, dft
&gt;&gt;&gt; mol = gto.M(atom=H 0 0 0; H 0 0 1.1)
&gt;&gt;&gt; grids = dft.gen_grid.Grids(mol)
&gt;&gt;&gt; ni = dft.numint.NumInt()
&gt;&gt;&gt; vsap = ni.nr_sap(mol, grids)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.nr_uks">
<span class="sig-name descname"><span class="pre">nr_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.nr_uks" title="Link to this definition">#</a></dt>
<dd><p>Calculate UKS XC functional and potential matrix on given meshgrids
for a set of density matrices</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">a list of 2D arrays</span></dt><dd><p>A list of density matrices, stored as (alpha,alpha,,beta,beta,)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of (alpha,beta) electrons generated by numerical integration.
excsum is the XC functional value.
vmat is the XC potential matrix for (alpha,beta) spin.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ni</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">NumInt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">nr_uks</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.nr_uks_fxc">
<span class="sig-name descname"><span class="pre">nr_uks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.NumInt.nr_uks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract UKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm0<span class="classifier">(2, N, N) array</span></dt><dd><p>Zeroth order density matrices</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>First order density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>First order density matrix symmetric or not. It also indicates
whether the matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.nr_vxc">
<span class="sig-name descname"><span class="pre">nr_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#NumInt.nr_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.NumInt.nr_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix on given meshgrids
for a set of density matrices.  See <a class="reference internal" href="#pyscf.dft.numint.nr_rks" title="pyscf.dft.numint.nr_rks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code></a> and <a class="reference internal" href="#pyscf.dft.numint.nr_uks" title="pyscf.dft.numint.nr_uks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code></a>
for more details.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array or a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">nr_vxc</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint.NumInt.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#NumInt.to_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.NumInt.to_gpu" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.cache_xc_kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#cache_xc_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.cache_xc_kernel" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.cache_xc_kernel1">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">cache_xc_kernel1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#cache_xc_kernel1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.cache_xc_kernel1" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc. Note dm the zeroth order density matrix must be a
hermitian matrix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.eval_ao">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#eval_ao"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.eval_ao" title="Link to this definition">#</a></dt>
<dd><p>Evaluate AO function value on the given grids.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of the grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>deriv<span class="classifier">int</span></dt><dd><p>AO derivative order.  It affects the shape of the return array.
If deriv=0, the returned AO values are stored in a (N,nao) array.
Otherwise the AO values are stored in an array of shape (M,N,nao).
Here N is the number of grids, nao is the number of AO functions,
M is the size associated to the derivative deriv.</p>
</dd>
<dt>relativity<span class="classifier">bool</span></dt><dd><p>No effects.</p>
</dd>
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in mol will be evaluated.</p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>AO values smaller than cutoff will be set to zero. The default
cutoff threshold is ~1e-22 (defined in gto/grid_ao_drv.h)</p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>If provided, results are written into this array.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array of shape (N,nao) for AO values if deriv = 0.
Or 3D array of shape (:,N,nao) for AO values and AO derivatives if deriv &gt; 0.
In the 3D array, the first (N,nao) elements are the AO values,
followed by (3,N,nao) for x,y,z components;
Then 2nd derivatives (6,N,nao) for xx, xy, xz, yy, yz, zz;
Then 3rd derivatives (10,N,nao) for xxx, xxy, xxz, xyy, xyz, xzz, yyy, yyz, yzz, zzz;
</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 24)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shls_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(4, 100, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shls_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(10, 100, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.eval_mat">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#eval_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.eval_mat" title="Link to this definition">#</a></dt>
<dd><p>Calculate XC potential matrix.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>ao<span class="classifier">([4/10,] ngrids, nao) ndarray</span></dt><dd><p>2D array of shape (N,nao) for LDA,
3D array of shape (4,N,nao) for GGA
or (10,N,nao) for meta-GGA.
N is the number of grids, nao is the number of AO functions.
If xctype is GGA (MGGA), ao[0] is AO value and ao[1:3] are the real space
gradients. ao[4:10] are second derivatives of ao values if applicable.</p>
</dd>
<dt>weight<span class="classifier">1D array</span></dt><dd><p>Integral weights on grids.</p>
</dd>
<dt>rho<span class="classifier">([4/6,] ngrids) ndarray</span></dt><dd><p>Shape of ((<em>,N)) for electron density (and derivatives) if spin = 0;
Shape of ((</em>,N),(<em>,N)) for alpha/beta electron density (and derivatives) if spin &gt; 0;
where N is number of grids.
rho (</em>,N) are ordered as (den,grad_x,grad_y,grad_z,laplacian,tau)
where grad_x = d/dx den, laplacian = nabla^2 den, tau = 1/2(nabla f)^2
In spin unrestricted case,
rho is ((den_u,grad_xu,grad_yu,grad_zu,laplacian_u,tau_u)</p>
<blockquote>
<div><p>(den_d,grad_xd,grad_yd,grad_zd,laplacian_d,tau_d))</p>
</div></blockquote>
</dd>
<dt>vxc<span class="classifier">([4,] ngrids) ndarray</span></dt><dd><p>XC potential value on each grid = (vrho, vsigma, vlapl, vtau)
vsigma is GGA potential value on each grid.
If the kwarg spin != 0, a list [vsigma_uu,vsigma_ud] is required.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of <cite>ao</cite> and <cite>rho</cite></p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></p>
</dd>
<dt>spin<span class="classifier">int</span></dt><dd><p>If not 0, the returned matrix is the Vxc matrix of alpha-spin.  It
is computed with the spin non-degenerated UKS formula.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>XC potential matrix in 2D array of shape (nao,nao) where nao is the
number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.eval_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#eval_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.eval_rho" title="Link to this definition">#</a></dt>
<dd><p>Calculate the electron density for LDA functional, and the density
derivatives for GGA and MGGA functionals.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">2D array of shape (N,nao) for LDA, 3D array of shape (4,N,nao) for GGA</span></dt><dd><p>or meta-GGA.  N is the number of grids, nao is the
number of AO functions.  If xctype is GGA (MGGA), ao[0] is AO value
and ao[1:3] are the AO gradients. ao[4:10] are second derivatives of
ao values if applicable.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></p>
</dd>
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of the return density.</p>
</dd>
<dt>hermi<span class="classifier">bool</span></dt><dd><p>dm is hermitian or not</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>1D array of size N to store electron density if xctype = LDA;  2D array
of (4,N) to store density and density derivatives for x,y,z components
if xctype = GGA; For meta-GGA, returns can be a (6,N) (with_lapl=True)
array where last two rows are nabla^2 rho and tau = 1/2(nabla f)^2
or (5,N) (with_lapl=False) where the last row is tau = 1/2(nabla f)^2</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">dm</span> <span class="o">+</span> <span class="n">dm</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span><span class="p">,</span> <span class="n">dx_rho</span><span class="p">,</span> <span class="n">dy_rho</span><span class="p">,</span> <span class="n">dz_rho</span> <span class="o">=</span> <span class="n">eval_rho</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">ao</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">xctype</span><span class="o">=</span><span class="s1">&#39;LDA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.eval_rho1">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_rho1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pair_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#eval_rho1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.eval_rho1" title="Link to this definition">#</a></dt>
<dd><p>Calculate the electron density for LDA and the density derivatives for
GGA and MGGA with sparsity information.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">2D array of shape (N,nao) for LDA, 3D array of shape (4,N,nao) for GGA</span></dt><dd><p>or meta-GGA.  N is the number of grids, nao is the
number of AO functions.  If xctype is GGA (MGGA), ao[0] is AO value
and ao[1:3] are the AO gradients. ao[4:10] are second derivatives of
ao values if applicable.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>screen_index<span class="classifier">2D uint8 array</span></dt><dd><p>How likely the AO values on grids are negligible. This array can be
obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">gen_grid.make_screen_index()</span></code></p>
</dd>
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of the return density.</p>
</dd>
<dt>hermi<span class="classifier">bool</span></dt><dd><p>dm is hermitian or not</p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>cutoff for density value</p>
</dd>
<dt>ao_cutoff<span class="classifier">float</span></dt><dd><p>cutoff for AO value. Needs to be the same to the cutoff when
generating screen_index</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>1D array of size N to store electron density if xctype = LDA;  2D array
of (4,N) to store density and density derivatives for x,y,z components
if xctype = GGA; For meta-GGA, returns can be a (6,N) (with_lapl=True)
array where last two rows are nabla^2 rho and tau = 1/2(nabla f)^2
or (5,N) (with_lapl=False) where the last row is tau = 1/2(nabla f)^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.eval_rho2">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#eval_rho2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.eval_rho2" title="Link to this definition">#</a></dt>
<dd><p>Calculate the electron density for LDA functional, and the density
derivatives for GGA functional.  This function has the same functionality
as <a class="reference internal" href="#pyscf.dft.numint.eval_rho" title="pyscf.dft.numint.eval_rho"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_rho()</span></code></a> except that the density are evaluated based on orbital
coefficients and orbital occupancy.  It is more efficient than
<a class="reference internal" href="#pyscf.dft.numint.eval_rho" title="pyscf.dft.numint.eval_rho"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_rho()</span></code></a> in most scenario.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">2D array of shape (N,nao) for LDA, 3D array of shape (4,N,nao) for GGA</span></dt><dd><p>or meta-GGA.  N is the number of grids, nao is the
number of AO functions.  If xctype is GGA (MGGA), ao[0] is AO value
and ao[1:3] are the AO gradients. ao[4:10] are second derivatives of
ao values if applicable.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></p>
</dd>
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of the return density.</p>
</dd>
<dt>with_lapl: bool</dt><dd><p>Whether to compute laplacian. It affects the shape of returns.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>1D array of size N to store electron density if xctype = LDA;  2D array
of (4,N) to store density and density derivatives for x,y,z components
if xctype = GGA; For meta-GGA, returns can be a (6,N) (with_lapl=True)
array where last two rows are nabla^2 rho and tau = 1/2(nabla f)^2
or (5,N) (with_lapl=False) where the last row is tau = 1/2(nabla f)^2</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Density in real space</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.nr_fxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#nr_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.nr_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract XC kernel matrix with given density matrices</p>
<p> math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a_</span><span class="p">{</span><span class="n">pq</span><span class="p">}</span> <span class="o">=</span> <span class="n">f_</span><span class="p">{</span><span class="n">pq</span><span class="p">,</span><span class="n">rs</span><span class="p">}</span> <span class="o">*</span> <span class="n">x_</span><span class="p">{</span><span class="n">rs</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.nr_nlc_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_nlc_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#nr_nlc_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.nr_nlc_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate NLC functional and potential matrix on given grids</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.nr_rks">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#nr_rks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.nr_rks" title="Link to this definition">#</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix on given meshgrids
for a set of density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array or a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ni</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">NumInt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">nr_rks</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.nr_rks_fxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#nr_rks_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.nr_rks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC (singlet hessian) kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm0<span class="classifier">2D array</span></dt><dd><p>Zeroth order density matrix</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>First order density matrix or density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>First order density matrix symmetric or not. It also indicates
whether the matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.nr_rks_fxc_st">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks_fxc_st</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#nr_rks_fxc_st"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.nr_rks_fxc_st" title="Link to this definition">#</a></dt>
<dd><p>Associated to singlet or triplet Hessian
Note the difference to nr_rks_fxc, dms_alpha is the response density
matrices of alpha spin, alpha+/-beta DM is applied due to singlet/triplet
coupling</p>
<p>Ref. CPL, 256, 454</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.nr_rks_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.nr_rks_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix on given meshgrids
for a set of density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array or a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ni</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">NumInt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">nr_rks</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.nr_sap_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_sap_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#nr_sap_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.nr_sap_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate superposition of atomic potentials matrix on given meshgrids.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>vmat is the XC potential matrix in 2D array of shape (nao,nao)
where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:
&gt;&gt;&gt; import numpy
&gt;&gt;&gt; from pyscf import gto, dft
&gt;&gt;&gt; mol = gto.M(atom=H 0 0 0; H 0 0 1.1)
&gt;&gt;&gt; grids = dft.gen_grid.Grids(mol)
&gt;&gt;&gt; ni = dft.numint.NumInt()
&gt;&gt;&gt; vsap = ni.nr_sap(mol, grids)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.nr_uks">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#nr_uks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.nr_uks" title="Link to this definition">#</a></dt>
<dd><p>Calculate UKS XC functional and potential matrix on given meshgrids
for a set of density matrices</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">a list of 2D arrays</span></dt><dd><p>A list of density matrices, stored as (alpha,alpha,,beta,beta,)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of (alpha,beta) electrons generated by numerical integration.
excsum is the XC functional value.
vmat is the XC potential matrix for (alpha,beta) spin.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ni</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">NumInt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">nr_uks</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.nr_uks_fxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_uks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#nr_uks_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.nr_uks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract UKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm0<span class="classifier">(2, N, N) array</span></dt><dd><p>Zeroth order density matrices</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>First order density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>First order density matrix symmetric or not. It also indicates
whether the matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.nr_uks_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_uks_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint.nr_uks_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate UKS XC functional and potential matrix on given meshgrids
for a set of density matrices</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">a list of 2D arrays</span></dt><dd><p>A list of density matrices, stored as (alpha,alpha,,beta,beta,)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of (alpha,beta) electrons generated by numerical integration.
excsum is the XC functional value.
vmat is the XC potential matrix for (alpha,beta) spin.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ni</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">NumInt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">nr_uks</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint.nr_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint.html#nr_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint.nr_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix on given meshgrids
for a set of density matrices.  See <a class="reference internal" href="#pyscf.dft.numint.nr_rks" title="pyscf.dft.numint.nr_rks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code></a> and <a class="reference internal" href="#pyscf.dft.numint.nr_uks" title="pyscf.dft.numint.nr_uks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code></a>
for more details.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array or a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">nr_vxc</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyscf.dft.numint2c">
<span id="pyscf-dft-numint2c-module"></span><h2>pyscf.dft.numint2c module<a class="headerlink" href="#module-pyscf.dft.numint2c" title="Link to this heading">#</a></h2>
<p>Numerical integration functions for (2-component) GKS with real AO basis</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint2c.</span></span><span class="sig-name descname"><span class="pre">NumInt2C</span></span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#NumInt2C"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a>, <a class="reference internal" href="#pyscf.dft.numint.LibXCMixin" title="pyscf.dft.numint.LibXCMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LibXCMixin</span></code></a></p>
<p>Numerical integration methods for 2-component basis (used by GKS)</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.block_loop">
<span class="sig-name descname"><span class="pre">block_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.block_loop" title="Link to this definition">#</a></dt>
<dd><p>Define this macro to loop over grids by blocks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.cache_xc_kernel">
<span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#NumInt2C.cache_xc_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.cache_xc_kernel" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.cache_xc_kernel1">
<span class="sig-name descname"><span class="pre">cache_xc_kernel1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#NumInt2C.cache_xc_kernel1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.cache_xc_kernel1" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.collinear">
<span class="sig-name descname"><span class="pre">collinear</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'col'</span></em><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.collinear" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.collinear_samples">
<span class="sig-name descname"><span class="pre">collinear_samples</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">200</span></em><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.collinear_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.collinear_thrd">
<span class="sig-name descname"><span class="pre">collinear_thrd</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.99</span></em><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.collinear_thrd" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.eval_ao">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.eval_ao" title="Link to this definition">#</a></dt>
<dd><p>Evaluate AO function value on the given grids.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of the grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>deriv<span class="classifier">int</span></dt><dd><p>AO derivative order.  It affects the shape of the return array.
If deriv=0, the returned AO values are stored in a (N,nao) array.
Otherwise the AO values are stored in an array of shape (M,N,nao).
Here N is the number of grids, nao is the number of AO functions,
M is the size associated to the derivative deriv.</p>
</dd>
<dt>relativity<span class="classifier">bool</span></dt><dd><p>No effects.</p>
</dd>
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in mol will be evaluated.</p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <a class="reference internal" href="#pyscf.dft.numint2c.NumInt2C.make_mask" title="pyscf.dft.numint2c.NumInt2C.make_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></a></p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>AO values smaller than cutoff will be set to zero. The default
cutoff threshold is ~1e-22 (defined in gto/grid_ao_drv.h)</p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>If provided, results are written into this array.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array of shape (N,nao) for AO values if deriv = 0.
Or 3D array of shape (:,N,nao) for AO values and AO derivatives if deriv &gt; 0.
In the 3D array, the first (N,nao) elements are the AO values,
followed by (3,N,nao) for x,y,z components;
Then 2nd derivatives (6,N,nao) for xx, xy, xz, yy, yz, zz;
Then 3rd derivatives (10,N,nao) for xxx, xxy, xxz, xyy, xyz, xzz, yyy, yyz, yzz, zzz;
</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 24)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shls_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(4, 100, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shls_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(10, 100, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.eval_rho">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.eval_rho" title="Link to this definition">#</a></dt>
<dd><p>Calculate the electron density and magnetization spin density in the
framework of 2-component real basis.
Calculate the electron density for LDA functional, and the density
derivatives for GGA and MGGA functionals.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">2D array of shape (N,nao) for LDA, 3D array of shape (4,N,nao) for GGA</span></dt><dd><p>or meta-GGA.  N is the number of grids, nao is the
number of AO functions.  If xctype is GGA (MGGA), ao[0] is AO value
and ao[1:3] are the AO gradients. ao[4:10] are second derivatives of
ao values if applicable.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <a class="reference internal" href="#pyscf.dft.numint2c.NumInt2C.make_mask" title="pyscf.dft.numint2c.NumInt2C.make_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></a></p>
</dd>
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of the return density.</p>
</dd>
<dt>hermi<span class="classifier">bool</span></dt><dd><p>dm is hermitian or not</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>1D array of size N to store electron density if xctype = LDA;  2D array
of (4,N) to store density and density derivatives for x,y,z components
if xctype = GGA; For meta-GGA, returns can be a (6,N) (with_lapl=True)
array where last two rows are nabla^2 rho and tau = 1/2(nabla f)^2
or (5,N) (with_lapl=False) where the last row is tau = 1/2(nabla f)^2</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">dm</span> <span class="o">+</span> <span class="n">dm</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span><span class="p">,</span> <span class="n">dx_rho</span><span class="p">,</span> <span class="n">dy_rho</span><span class="p">,</span> <span class="n">dz_rho</span> <span class="o">=</span> <span class="n">eval_rho</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">ao</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">xctype</span><span class="o">=</span><span class="s1">&#39;LDA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.eval_rho1">
<span class="sig-name descname"><span class="pre">eval_rho1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pair_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#NumInt2C.eval_rho1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.eval_rho1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.eval_rho2">
<span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#NumInt2C.eval_rho2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.eval_rho2" title="Link to this definition">#</a></dt>
<dd><p>Calculate the electron density for LDA functional and the density
derivatives for GGA functional in the framework of 2-component basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.eval_xc_eff">
<span class="sig-name descname"><span class="pre">eval_xc_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.eval_xc_eff" title="Link to this definition">#</a></dt>
<dd><p>Returns the derivative tensor against the density parameters</p>
<dl class="simple">
<dt>[[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a],</dt><dd><p>[density_b, (nabla_x)_b, (nabla_y)_b, (nabla_z)_b, tau_b]].</p>
</dd>
</dl>
<p>It differs from the eval_xc method in the derivatives of non-local part.
The eval_xc method returns the XC functional derivatives to sigma
(<a href="#id5"><span class="problematic" id="id6">|</span></a>nabla rho|^2)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>rho: 2-dimensional or 3-dimensional array</dt><dd><p>Total density and spin density (and their derivatives if GGA or MGGA
functionals) on grids</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>deriv: int</dt><dd><p>derivative orders</p>
</dd>
<dt>omega: float</dt><dd><p>define the exponent in the attenuated Coulomb for RSH functional</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.get_fxc">
<span class="sig-name descname"><span class="pre">get_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.get_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC (singlet hessian) kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm0<span class="classifier">2D array</span></dt><dd><p>Zeroth order density matrix</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>First order density matrix or density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>First order density matrix symmetric or not. It also indicates
whether the matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#NumInt2C.get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.get_vxc">
<span class="sig-name descname"><span class="pre">get_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.get_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix on given meshgrids
for a set of density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array or a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ni</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">NumInt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">nr_rks</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.make_mask">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.make_mask" title="Link to this definition">#</a></dt>
<dd><p>Mask to indicate whether a shell is ignorable on grids. See also the
function gto.eval_gto.make_screen_index</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>relativity<span class="classifier">bool</span></dt><dd><p>No effects.</p>
</dd>
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in mol will be evaluated.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D mask array of shape (N,nbas), where N is the number of grids, nbas
is the number of shells.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.mcfun_eval_xc_adapter">
<span class="sig-name descname"><span class="pre">mcfun_eval_xc_adapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.mcfun_eval_xc_adapter" title="Link to this definition">#</a></dt>
<dd><p>Wrapper to generate the eval_xc function required by mcfun</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.nr_fxc">
<span class="sig-name descname"><span class="pre">nr_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#NumInt2C.nr_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.nr_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC (singlet hessian) kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm0<span class="classifier">2D array</span></dt><dd><p>Zeroth order density matrix</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>First order density matrix or density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>First order density matrix symmetric or not. It also indicates
whether the matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.nr_gks_fxc">
<span class="sig-name descname"><span class="pre">nr_gks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.nr_gks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC (singlet hessian) kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm0<span class="classifier">2D array</span></dt><dd><p>Zeroth order density matrix</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>First order density matrix or density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>First order density matrix symmetric or not. It also indicates
whether the matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.nr_gks_vxc">
<span class="sig-name descname"><span class="pre">nr_gks_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.nr_gks_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix on given meshgrids
for a set of density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array or a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ni</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">NumInt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">nr_rks</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.nr_nlc_vxc">
<span class="sig-name descname"><span class="pre">nr_nlc_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#NumInt2C.nr_nlc_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.nr_nlc_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate NLC functional and potential matrix on given grids</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.nr_vxc">
<span class="sig-name descname"><span class="pre">nr_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#NumInt2C.nr_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.nr_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix on given meshgrids
for a set of density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></p>
<p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array or a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">Grids</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grids</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nao</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">nao</span><span class="p">,</span><span class="n">nao</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ni</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">numint</span><span class="o">.</span><span class="n">NumInt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nelec</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">nr_rks</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="s1">&#39;lda,vwn&#39;</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.NumInt2C.spin_samples">
<span class="sig-name descname"><span class="pre">spin_samples</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">770</span></em><a class="headerlink" href="#pyscf.dft.numint2c.NumInt2C.spin_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.eval_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint2c.</span></span><span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#eval_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint2c.eval_rho" title="Link to this definition">#</a></dt>
<dd><p>Calculate the electron density and magnetization spin density in the
framework of 2-component real basis.
Calculate the electron density for LDA functional, and the density
derivatives for GGA and MGGA functionals.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">2D array of shape (N,nao) for LDA, 3D array of shape (4,N,nao) for GGA</span></dt><dd><p>or meta-GGA.  N is the number of grids, nao is the
number of AO functions.  If xctype is GGA (MGGA), ao[0] is AO value
and ao[1:3] are the AO gradients. ao[4:10] are second derivatives of
ao values if applicable.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></p>
</dd>
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of the return density.</p>
</dd>
<dt>hermi<span class="classifier">bool</span></dt><dd><p>dm is hermitian or not</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>1D array of size N to store electron density if xctype = LDA;  2D array
of (4,N) to store density and density derivatives for x,y,z components
if xctype = GGA; For meta-GGA, returns can be a (6,N) (with_lapl=True)
array where last two rows are nabla^2 rho and tau = 1/2(nabla f)^2
or (5,N) (with_lapl=False) where the last row is tau = 1/2(nabla f)^2</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">dm</span> <span class="o">+</span> <span class="n">dm</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span><span class="p">,</span> <span class="n">dx_rho</span><span class="p">,</span> <span class="n">dy_rho</span><span class="p">,</span> <span class="n">dz_rho</span> <span class="o">=</span> <span class="n">eval_rho</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">ao</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">xctype</span><span class="o">=</span><span class="s1">&#39;LDA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.numint2c.mcfun_eval_xc_adapter">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.numint2c.</span></span><span class="sig-name descname"><span class="pre">mcfun_eval_xc_adapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#mcfun_eval_xc_adapter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.numint2c.mcfun_eval_xc_adapter" title="Link to this definition">#</a></dt>
<dd><p>Wrapper to generate the eval_xc function required by mcfun</p>
</dd></dl>

</section>
<section id="module-pyscf.dft.r_numint">
<span id="pyscf-dft-r-numint-module"></span><h2>pyscf.dft.r_numint module<a class="headerlink" href="#module-pyscf.dft.r_numint" title="Link to this heading">#</a></h2>
<p>Numerical integration functions for 4-component or 2-component relativistic
methods with j-adapted AO basis</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.r_numint.</span></span><span class="sig-name descname"><span class="pre">RNumInt</span></span><a class="reference internal" href="../_modules/pyscf/dft/r_numint.html#RNumInt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a>, <a class="reference internal" href="#pyscf.dft.numint.LibXCMixin" title="pyscf.dft.numint.LibXCMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LibXCMixin</span></code></a></p>
<p>NumInt for j-adapted (spinor) basis</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.block_loop">
<span class="sig-name descname"><span class="pre">block_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/r_numint.html#RNumInt.block_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.block_loop" title="Link to this definition">#</a></dt>
<dd><p>Define this macro to loop over grids by blocks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.cache_xc_kernel">
<span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.cache_xc_kernel" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.cache_xc_kernel1">
<span class="sig-name descname"><span class="pre">cache_xc_kernel1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.cache_xc_kernel1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.collinear">
<span class="sig-name descname"><span class="pre">collinear</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'col'</span></em><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.collinear" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.collinear_samples">
<span class="sig-name descname"><span class="pre">collinear_samples</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">200</span></em><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.collinear_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.collinear_thrd">
<span class="sig-name descname"><span class="pre">collinear_thrd</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.99</span></em><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.collinear_thrd" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.eval_ao">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.eval_ao" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the value of 2-component or 4-component j-adapted basis on grids.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.eval_rho">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.eval_rho" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.eval_rho1">
<span class="sig-name descname"><span class="pre">eval_rho1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pair_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/r_numint.html#RNumInt.eval_rho1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.eval_rho1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.eval_rho2">
<span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/r_numint.html#RNumInt.eval_rho2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.eval_rho2" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.eval_xc_eff">
<span class="sig-name descname"><span class="pre">eval_xc_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.eval_xc_eff" title="Link to this definition">#</a></dt>
<dd><p>Returns the derivative tensor against the density parameters</p>
<dl class="simple">
<dt>[[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a],</dt><dd><p>[density_b, (nabla_x)_b, (nabla_y)_b, (nabla_z)_b, tau_b]].</p>
</dd>
</dl>
<p>It differs from the eval_xc method in the derivatives of non-local part.
The eval_xc method returns the XC functional derivatives to sigma
(<a href="#id7"><span class="problematic" id="id8">|</span></a>nabla rho|^2)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>rho: 2-dimensional or 3-dimensional array</dt><dd><p>Total density and spin density (and their derivatives if GGA or MGGA
functionals) on grids</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>deriv: int</dt><dd><p>derivative orders</p>
</dd>
<dt>omega: float</dt><dd><p>define the exponent in the attenuated Coulomb for RSH functional</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.get_fxc">
<span class="sig-name descname"><span class="pre">get_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.get_fxc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.get_rho" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.get_vxc">
<span class="sig-name descname"><span class="pre">get_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.get_vxc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.mcfun_eval_xc_adapter">
<span class="sig-name descname"><span class="pre">mcfun_eval_xc_adapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.mcfun_eval_xc_adapter" title="Link to this definition">#</a></dt>
<dd><p>Wrapper to generate the eval_xc function required by mcfun</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.r_fxc">
<span class="sig-name descname"><span class="pre">r_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.r_fxc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.r_vxc">
<span class="sig-name descname"><span class="pre">r_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.r_vxc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.RNumInt.spin_samples">
<span class="sig-name descname"><span class="pre">spin_samples</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">770</span></em><a class="headerlink" href="#pyscf.dft.r_numint.RNumInt.spin_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.cache_xc_kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.r_numint.</span></span><span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/r_numint.html#cache_xc_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.r_numint.cache_xc_kernel" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.cache_xc_kernel1">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.r_numint.</span></span><span class="sig-name descname"><span class="pre">cache_xc_kernel1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/r_numint.html#cache_xc_kernel1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.r_numint.cache_xc_kernel1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.eval_ao">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.r_numint.</span></span><span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/r_numint.html#eval_ao"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.r_numint.eval_ao" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the value of 2-component or 4-component j-adapted basis on grids.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.eval_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.r_numint.</span></span><span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/r_numint.html#eval_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.r_numint.eval_rho" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.r_numint.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/r_numint.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.r_numint.get_rho" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.r_fxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.r_numint.</span></span><span class="sig-name descname"><span class="pre">r_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/r_numint.html#r_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.r_numint.r_fxc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.r_numint.r_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.r_numint.</span></span><span class="sig-name descname"><span class="pre">r_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/r_numint.html#r_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.r_numint.r_vxc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.dft.radi">
<span id="pyscf-dft-radi-module"></span><h2>pyscf.dft.radi module<a class="headerlink" href="#module-pyscf.dft.radi" title="Link to this heading">#</a></h2>
<p>radii grids</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.radi.becke">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.radi.</span></span><span class="sig-name descname"><span class="pre">becke</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/radi.html#becke"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.radi.becke" title="Link to this definition">#</a></dt>
<dd><p>Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.radi.becke_atomic_radii_adjust">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.radi.</span></span><span class="sig-name descname"><span class="pre">becke_atomic_radii_adjust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_radii</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/radi.html#becke_atomic_radii_adjust"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.radi.becke_atomic_radii_adjust" title="Link to this definition">#</a></dt>
<dd><p>Becke atomic radii adjust function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.radi.delley">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.radi.</span></span><span class="sig-name descname"><span class="pre">delley</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/radi.html#delley"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.radi.delley" title="Link to this definition">#</a></dt>
<dd><ol class="upperalpha simple" start="2">
<li><p>Delley radial grids. Ref. JCP 104, 9848 (1996); DOI:10.1063/1.471749. log2 algorithm</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.radi.gauss_chebyshev">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.radi.</span></span><span class="sig-name descname"><span class="pre">gauss_chebyshev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/radi.html#gauss_chebyshev"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.radi.gauss_chebyshev" title="Link to this definition">#</a></dt>
<dd><p>Gauss-Chebyshev [JCP 108, 3226 (1998); DOI:10.1063/1.475719) radial grids</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.radi.gauss_legendre">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.radi.</span></span><span class="sig-name descname"><span class="pre">gauss_legendre</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.radi.gauss_legendre" title="Link to this definition">#</a></dt>
<dd><ol class="upperalpha simple" start="2">
<li><p>Delley radial grids. Ref. JCP 104, 9848 (1996); DOI:10.1063/1.471749. log2 algorithm</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.radi.mura_knowles">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.radi.</span></span><span class="sig-name descname"><span class="pre">mura_knowles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/radi.html#mura_knowles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.radi.mura_knowles" title="Link to this definition">#</a></dt>
<dd><p>Mura-Knowles [JCP 104, 9848 (1996); DOI:10.1063/1.471749] log3 quadrature radial grids</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.radi.murray">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.radi.</span></span><span class="sig-name descname"><span class="pre">murray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/radi.html#murray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.radi.murray" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.radi.treutler">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.radi.</span></span><span class="sig-name descname"><span class="pre">treutler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.radi.treutler" title="Link to this definition">#</a></dt>
<dd><p>Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.radi.treutler_ahlrichs">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.radi.</span></span><span class="sig-name descname"><span class="pre">treutler_ahlrichs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/radi.html#treutler_ahlrichs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.radi.treutler_ahlrichs" title="Link to this definition">#</a></dt>
<dd><p>Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.radi.treutler_atomic_radii_adjust">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.radi.</span></span><span class="sig-name descname"><span class="pre">treutler_atomic_radii_adjust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_radii</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/radi.html#treutler_atomic_radii_adjust"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.radi.treutler_atomic_radii_adjust" title="Link to this definition">#</a></dt>
<dd><p>Treutler atomic radii adjust function: [JCP 102, 346 (1995); DOI:10.1063/1.469408]</p>
</dd></dl>

</section>
<section id="module-pyscf.dft.rks">
<span id="pyscf-dft-rks-module"></span><h2>pyscf.dft.rks module<a class="headerlink" href="#module-pyscf.dft.rks" title="Link to this heading">#</a></h2>
<p>Non-relativistic restricted Kohn-Sham</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks.</span></span><span class="sig-name descname"><span class="pre">KohnShamDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl>
<dt>Attributes for Kohn-Sham DFT:</dt><dd><dl>
<dt>xc<span class="classifier">str</span></dt><dd><p>X_name,C_name for the XC functional.  Default is lda,vwn</p>
</dd>
<dt>nlc<span class="classifier">str</span></dt><dd><p>NLC_name for the NLC functional.  Default is  (i.e., None)</p>
</dd>
<dt>omega<span class="classifier">float</span></dt><dd><p>Omega of the range-separated Coulomb operator e^{-omega r_{12}^2} / r_{12}</p>
</dd>
<dt>grids<span class="classifier">Grids object</span></dt><dd><p>grids.level (0 - 9)  big number for large mesh grids. Default is 3</p>
<dl>
<dt>radii_adjust</dt><dd><div class="line-block">
<div class="line">radi.treutler_atomic_radii_adjust (default)</div>
<div class="line">radi.becke_atomic_radii_adjust</div>
<div class="line">None : to switch off atomic radii adjustment</div>
</div>
</dd>
<dt>grids.atomic_radii</dt><dd><div class="line-block">
<div class="line">radi.BRAGG_RADII  (default)</div>
<div class="line">radi.COVALENT_RADII</div>
<div class="line">None : to switch off atomic radii adjustment</div>
</div>
</dd>
<dt>grids.radi_method  scheme for radial grids</dt><dd><div class="line-block">
<div class="line">radi.treutler  (default)</div>
<div class="line">radi.delley</div>
<div class="line">radi.mura_knowles</div>
<div class="line">radi.gauss_chebyshev</div>
</div>
</dd>
<dt>grids.becke_scheme  weight partition function</dt><dd><div class="line-block">
<div class="line">gen_grid.original_becke  (default)</div>
<div class="line">gen_grid.stratmann</div>
</div>
</dd>
<dt>grids.prune  scheme to reduce number of grids</dt><dd><div class="line-block">
<div class="line">gen_grid.nwchem_prune  (default)</div>
<div class="line">gen_grid.sg1_prune</div>
<div class="line">gen_grid.treutler_prune</div>
<div class="line">None : to switch off grids pruning</div>
</div>
</dd>
</dl>
<p>grids.symmetry  True/False  to symmetrize mesh grids (TODO)</p>
<p>grids.atom_grid  Set (radial, angular) grids for particular atoms.
Eg, grids.atom_grid = {H: (20,110)} will generate 20 radial
grids and 110 angular grids for H atom.</p>
</dd>
<dt>small_rho_cutoff<span class="classifier">float</span></dt><dd><p>Drop grids if their contribution to total electrons smaller than
this cutoff value.  Default is 1e-7.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;b3lyp&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.415443079840458</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.check_sanity">
<span class="sig-name descname"><span class="pre">check_sanity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.check_sanity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.check_sanity" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.define_xc_">
<span class="sig-name descname"><span class="pre">define_xc_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.define_xc_" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.do_nlc">
<span class="sig-name descname"><span class="pre">do_nlc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.do_nlc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.do_nlc" title="Link to this definition">#</a></dt>
<dd><p>Check if the object needs to do nlc calculations</p>
<p>if self.nlc == False (or 0), nlc is disabled regardless the value of self.xc
if self.nlc == vv10, do nlc (vv10) regardless the value of self.xc
if self.nlc == , determined by self.xc, certain xc allows the nlc part</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.initialize_grids">
<span class="sig-name descname"><span class="pre">initialize_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.initialize_grids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.initialize_grids" title="Link to this definition">#</a></dt>
<dd><p>Initialize self.grids the first time call get_veff</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.omega">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">omega</span></span><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.omega" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.reset" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.to_ghf">
<span class="sig-name descname"><span class="pre">to_ghf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.to_ghf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.to_ghf" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a GHF object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.to_gks">
<span class="sig-name descname"><span class="pre">to_gks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.to_gks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.to_gks" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a GKS object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.to_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.to_gpu" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert the input KS object to the associated HF object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.to_rhf">
<span class="sig-name descname"><span class="pre">to_rhf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.to_rhf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.to_rhf" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a RHF/ROHF object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.to_rks">
<span class="sig-name descname"><span class="pre">to_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.to_rks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.to_rks" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a RKS/ROKS object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.to_uhf">
<span class="sig-name descname"><span class="pre">to_uhf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.to_uhf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.to_uhf" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a UHF object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.KohnShamDFT.to_uks">
<span class="sig-name descname"><span class="pre">to_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#KohnShamDFT.to_uks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.KohnShamDFT.to_uks" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a UKS object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks.</span></span><span class="sig-name descname"><span class="pre">RKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#RKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.RKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.dft.rks.KohnShamDFT" title="pyscf.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.scf.html#pyscf.scf.hf.RHF" title="pyscf.scf.hf.RHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">RHF</span></code></a></p>
<p>Restricted Kohn-Sham
SCF base class.   non-relativistic RHF.</p>
<blockquote>
<div><dl>
<dt>Attributes:</dt><dd><dl>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB.  Default equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>chkfile<span class="classifier">str</span></dt><dd><p>checkpoint file to save MOs, orbital energies etc.  Writing to
chkfile can be disabled if this attribute is set to None or False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>converge threshold.  Default is 1e-9</p>
</dd>
<dt>conv_tol_grad<span class="classifier">float</span></dt><dd><p>gradients converge threshold.  Default is sqrt(conv_tol)</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>max number of iterations.  If max_cycle &lt;= 0, SCF iteration will
be skipped and the kernel function will compute only the total
energy based on the initial guess. Default value is 50.</p>
</dd>
<dt>init_guess<span class="classifier">str</span></dt><dd><p>initial guess method.  It can be one of minao, atom, huckel, hcore, 1e, sap, chkfile.
Default is minao</p>
</dd>
<dt>sap_basis<span class="classifier">str or dict</span></dt><dd><p>basis for SAP initial guess, either filename or path as str or
internal format dictionary.</p>
</dd>
<dt>DIIS<span class="classifier">DIIS class</span></dt><dd><p>The class to generate diis object.  It can be one of
diis.SCF_DIIS, diis.ADIIS, diis.EDIIS.</p>
</dd>
<dt>diis<span class="classifier">boolean or object of DIIS class defined in <code class="xref py py-mod docutils literal notranslate"><span class="pre">scf.diis</span></code>.</span></dt><dd><p>Default is the object associated to the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.DIIS</span></code>.
Set it to None/False to turn off DIIS.
Note if this attribute is initialized as a DIIS object, the SCF driver
will use this object in the iteration. The DIIS information (vector
basis and error vector) will be held inside this object. When kernel
function is called again, the old states (vector basis and error
vector) will be reused.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size.  By default, 8 Fock matrices and errors vector are stored.</p>
</dd>
<dt>diis_damp<span class="classifier">float</span></dt><dd><p>DIIS damping factor.  Default is 0.</p>
</dd>
<dt>diis_start_cycle<span class="classifier">int</span></dt><dd><p>The step to start DIIS.  Default is 1.</p>
</dd>
<dt>diis_file: str</dt><dd><p>File to store DIIS vectors and error vectors.</p>
</dd>
<dt>level_shift<span class="classifier">float or int</span></dt><dd><p>Level shift (in AU) for virtual space.  Default is 0.</p>
</dd>
<dt>direct_scf<span class="classifier">bool</span></dt><dd><p>Direct SCF is used by default.</p>
</dd>
<dt>direct_scf_tol<span class="classifier">float</span></dt><dd><p>Direct SCF cutoff threshold.  Default is 1e-13.</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
environment.</p>
</dd>
<dt>conv_check<span class="classifier">bool</span></dt><dd><p>An extra cycle to check convergence after SCF iterations.</p>
</dd>
<dt>check_convergence<span class="classifier">function(envs) =&gt; bool</span></dt><dd><p>A hook for overloading convergence criteria in SCF iterations.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether the SCF iteration converged</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total HF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>mo_energy :</dt><dd><p>Orbital energies</p>
</dd>
<dt>mo_occ</dt><dd><p>Orbital occupancy</p>
</dd>
<dt>mo_coeff</dt><dd><p>Orbital coefficients</p>
</dd>
<dt>cycles<span class="classifier">int</span></dt><dd><p>The number of iteration cycles performed</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;cc-pvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">SCF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">level_shift</span> <span class="o">=</span> <span class="mf">.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="go">-1.0811707843775884</span>
</pre></div>
</div>
<dl>
<dt>Attributes for Kohn-Sham DFT:</dt><dd><dl>
<dt>xc<span class="classifier">str</span></dt><dd><p>X_name,C_name for the XC functional.  Default is lda,vwn</p>
</dd>
<dt>nlc<span class="classifier">str</span></dt><dd><p>NLC_name for the NLC functional.  Default is  (i.e., None)</p>
</dd>
<dt>omega<span class="classifier">float</span></dt><dd><p>Omega of the range-separated Coulomb operator e^{-omega r_{12}^2} / r_{12}</p>
</dd>
<dt>grids<span class="classifier">Grids object</span></dt><dd><p>grids.level (0 - 9)  big number for large mesh grids. Default is 3</p>
<dl>
<dt>radii_adjust</dt><dd><div class="line-block">
<div class="line">radi.treutler_atomic_radii_adjust (default)</div>
<div class="line">radi.becke_atomic_radii_adjust</div>
<div class="line">None : to switch off atomic radii adjustment</div>
</div>
</dd>
<dt>grids.atomic_radii</dt><dd><div class="line-block">
<div class="line">radi.BRAGG_RADII  (default)</div>
<div class="line">radi.COVALENT_RADII</div>
<div class="line">None : to switch off atomic radii adjustment</div>
</div>
</dd>
<dt>grids.radi_method  scheme for radial grids</dt><dd><div class="line-block">
<div class="line">radi.treutler  (default)</div>
<div class="line">radi.delley</div>
<div class="line">radi.mura_knowles</div>
<div class="line">radi.gauss_chebyshev</div>
</div>
</dd>
<dt>grids.becke_scheme  weight partition function</dt><dd><div class="line-block">
<div class="line">gen_grid.original_becke  (default)</div>
<div class="line">gen_grid.stratmann</div>
</div>
</dd>
<dt>grids.prune  scheme to reduce number of grids</dt><dd><div class="line-block">
<div class="line">gen_grid.nwchem_prune  (default)</div>
<div class="line">gen_grid.sg1_prune</div>
<div class="line">gen_grid.treutler_prune</div>
<div class="line">None : to switch off grids pruning</div>
</div>
</dd>
</dl>
<p>grids.symmetry  True/False  to symmetrize mesh grids (TODO)</p>
<p>grids.atom_grid  Set (radial, angular) grids for particular atoms.
Eg, grids.atom_grid = {H: (20,110)} will generate 20 radial
grids and 110 angular grids for H atom.</p>
</dd>
<dt>small_rho_cutoff<span class="classifier">float</span></dt><dd><p>Drop grids if their contribution to total electrons smaller than
this cutoff value.  Default is 1e-7.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;b3lyp&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.415443079840458</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.CasidaTDDFT">
<span class="sig-name descname"><span class="pre">CasidaTDDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.CasidaTDDFT" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.Gradients">
<span class="sig-name descname"><span class="pre">Gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.Gradients" title="Link to this definition">#</a></dt>
<dd><p>Non-relativistic restricted Hartree-Fock gradients</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.Hessian">
<span class="sig-name descname"><span class="pre">Hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.Hessian" title="Link to this definition">#</a></dt>
<dd><p>Non-relativistic RKS hessian</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.TDA">
<span class="sig-name descname"><span class="pre">TDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.TDA" title="Link to this definition">#</a></dt>
<dd><p>Tamm-Dancoff approximation</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Diagonalization convergence tolerance.  Default is 1e-9.</p>
</dd>
<dt>nstates<span class="classifier">int</span></dt><dd><p>Number of TD states to be computed. Default is 3.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Diagonalization converged or not</p>
</dd>
<dt>e<span class="classifier">1D array</span></dt><dd><p>excitation energy for each excited state.</p>
</dd>
<dt>xy<span class="classifier">A list of two 2D arrays</span></dt><dd><p>The two 2D arrays are Excitation coefficients X (shape [nocc,nvir])
and de-excitation coefficients Y (shape [nocc,nvir]) for each
excited state.  (X,Y) are normalized to 1/2 in RHF/RKS methods and
normalized to 1 for UHF/UKS methods. In the TDA calculation, Y = 0.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.TDDFT">
<span class="sig-name descname"><span class="pre">TDDFT</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.TDDFT" title="Link to this definition">#</a></dt>
<dd><p>Driver to create TDDFT or CasidaTDDFT object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.TDDFTNoHybrid">
<span class="sig-name descname"><span class="pre">TDDFTNoHybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.TDDFTNoHybrid" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.TDHF">
<span class="sig-name descname"><span class="pre">TDHF</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.rks.RKS.TDHF" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.dRPA">
<span class="sig-name descname"><span class="pre">dRPA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.dRPA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.dTDA">
<span class="sig-name descname"><span class="pre">dTDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.dTDA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#RKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.RKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of RKS energy.</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl>
<dt>Args:</dt><dd><p>ks : an instance of DFT class</p>
<dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>RKS electronic energy and the 2-electron contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.dft.rks.RKS" title="pyscf.dft.rks.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dm_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The density matrix baseline.  If not 0, this function computes the
increment of HF potential w.r.t. the reference HF potential matrix.</p>
</dd>
<dt>vhf_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The reference Vxc potential matrix.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether J, K matrix is hermitian</p>
<div class="line-block">
<div class="line">0 : no hermitian or symmetric</div>
<div class="line">1 : hermitian</div>
<div class="line">2 : anti-hermitian</div>
</div>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.get_vsap">
<span class="sig-name descname"><span class="pre">get_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.get_vsap" title="Link to this definition">#</a></dt>
<dd><p>Superposition of atomic potentials</p>
<p>S. Lehtola, Assessment of initial guesses for self-consistent
field calculations. Superposition of Atomic Potentials: simple yet
efficient, J. Chem. Theory Comput. 15, 1593 (2019). DOI:
10.1021/acs.jctc.8b01089. arXiv:1810.11659.</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, Fully numerical Hartree-Fock and density functional
calculations. I. Atoms, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.dft.rks.RKS" title="pyscf.dft.rks.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vsap = Vnuc + J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.init_guess_by_vsap">
<span class="sig-name descname"><span class="pre">init_guess_by_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.init_guess_by_vsap" title="Link to this definition">#</a></dt>
<dd><p>Form SAP guess</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#RKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.RKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks.RKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks.RKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#RKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.RKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to RHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.rks.define_xc_">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks.</span></span><span class="sig-name descname"><span class="pre">define_xc_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#define_xc_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.define_xc_" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.rks.energy_elec">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks.</span></span><span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of RKS energy.</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl>
<dt>Args:</dt><dd><p>ks : an instance of DFT class</p>
<dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>RKS electronic energy and the 2-electron contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.rks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.dft.rks.RKS" title="pyscf.dft.rks.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dm_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The density matrix baseline.  If not 0, this function computes the
increment of HF potential w.r.t. the reference HF potential matrix.</p>
</dd>
<dt>vhf_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The reference Vxc potential matrix.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether J, K matrix is hermitian</p>
<div class="line-block">
<div class="line">0 : no hermitian or symmetric</div>
<div class="line">1 : hermitian</div>
<div class="line">2 : anti-hermitian</div>
</div>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.rks.get_vsap">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks.</span></span><span class="sig-name descname"><span class="pre">get_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#get_vsap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.get_vsap" title="Link to this definition">#</a></dt>
<dd><p>Superposition of atomic potentials</p>
<p>S. Lehtola, Assessment of initial guesses for self-consistent
field calculations. Superposition of Atomic Potentials: simple yet
efficient, J. Chem. Theory Comput. 15, 1593 (2019). DOI:
10.1021/acs.jctc.8b01089. arXiv:1810.11659.</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, Fully numerical Hartree-Fock and density functional
calculations. I. Atoms, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.dft.rks.RKS" title="pyscf.dft.rks.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vsap = Vnuc + J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.rks.init_guess_by_vsap">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks.</span></span><span class="sig-name descname"><span class="pre">init_guess_by_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#init_guess_by_vsap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.init_guess_by_vsap" title="Link to this definition">#</a></dt>
<dd><p>Form SAP guess</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.rks.prune_small_rho_grids_">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks.</span></span><span class="sig-name descname"><span class="pre">prune_small_rho_grids_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks.html#prune_small_rho_grids_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks.prune_small_rho_grids_" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.dft.rks_symm">
<span id="pyscf-dft-rks-symm-module"></span><h2>pyscf.dft.rks_symm module<a class="headerlink" href="#module-pyscf.dft.rks_symm" title="Link to this heading">#</a></h2>
<p>Non-relativistic Restricted Kohn-Sham</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.RKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks_symm.</span></span><span class="sig-name descname"><span class="pre">RKS</span></span><a class="headerlink" href="#pyscf.dft.rks_symm.RKS" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.dft.rks_symm.SymAdaptedRKS" title="pyscf.dft.rks_symm.SymAdaptedRKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymAdaptedRKS</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.ROKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks_symm.</span></span><span class="sig-name descname"><span class="pre">ROKS</span></span><a class="headerlink" href="#pyscf.dft.rks_symm.ROKS" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.dft.rks_symm.SymAdaptedROKS" title="pyscf.dft.rks_symm.SymAdaptedROKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymAdaptedROKS</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks_symm.</span></span><span class="sig-name descname"><span class="pre">SymAdaptedRKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks_symm.html#SymAdaptedRKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.dft.rks.KohnShamDFT" title="pyscf.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.scf.html#pyscf.scf.hf_symm.SymAdaptedRHF" title="pyscf.scf.hf_symm.SymAdaptedRHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymAdaptedRHF</span></code></a></p>
<p>Restricted Kohn-Sham</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.CasidaTDDFT">
<span class="sig-name descname"><span class="pre">CasidaTDDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.CasidaTDDFT" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.Gradients">
<span class="sig-name descname"><span class="pre">Gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.Gradients" title="Link to this definition">#</a></dt>
<dd><p>Non-relativistic restricted Hartree-Fock gradients</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.Hessian">
<span class="sig-name descname"><span class="pre">Hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.Hessian" title="Link to this definition">#</a></dt>
<dd><p>Non-relativistic RKS hessian</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.TDA">
<span class="sig-name descname"><span class="pre">TDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.TDA" title="Link to this definition">#</a></dt>
<dd><p>Tamm-Dancoff approximation</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Diagonalization convergence tolerance.  Default is 1e-9.</p>
</dd>
<dt>nstates<span class="classifier">int</span></dt><dd><p>Number of TD states to be computed. Default is 3.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Diagonalization converged or not</p>
</dd>
<dt>e<span class="classifier">1D array</span></dt><dd><p>excitation energy for each excited state.</p>
</dd>
<dt>xy<span class="classifier">A list of two 2D arrays</span></dt><dd><p>The two 2D arrays are Excitation coefficients X (shape [nocc,nvir])
and de-excitation coefficients Y (shape [nocc,nvir]) for each
excited state.  (X,Y) are normalized to 1/2 in RHF/RKS methods and
normalized to 1 for UHF/UKS methods. In the TDA calculation, Y = 0.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.TDDFT">
<span class="sig-name descname"><span class="pre">TDDFT</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.TDDFT" title="Link to this definition">#</a></dt>
<dd><p>Driver to create TDDFT or CasidaTDDFT object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.TDDFTNoHybrid">
<span class="sig-name descname"><span class="pre">TDDFTNoHybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.TDDFTNoHybrid" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.TDHF">
<span class="sig-name descname"><span class="pre">TDHF</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.TDHF" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.dRPA">
<span class="sig-name descname"><span class="pre">dRPA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.dRPA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.dTDA">
<span class="sig-name descname"><span class="pre">dTDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.dTDA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks_symm.html#SymAdaptedRKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of RKS energy.</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl>
<dt>Args:</dt><dd><p>ks : an instance of DFT class</p>
<dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>RKS electronic energy and the 2-electron contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.dft.rks_symm.RKS" title="pyscf.dft.rks_symm.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dm_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The density matrix baseline.  If not 0, this function computes the
increment of HF potential w.r.t. the reference HF potential matrix.</p>
</dd>
<dt>vhf_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The reference Vxc potential matrix.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether J, K matrix is hermitian</p>
<div class="line-block">
<div class="line">0 : no hermitian or symmetric</div>
<div class="line">1 : hermitian</div>
<div class="line">2 : anti-hermitian</div>
</div>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.get_vsap">
<span class="sig-name descname"><span class="pre">get_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.get_vsap" title="Link to this definition">#</a></dt>
<dd><p>Superposition of atomic potentials</p>
<p>S. Lehtola, Assessment of initial guesses for self-consistent
field calculations. Superposition of Atomic Potentials: simple yet
efficient, J. Chem. Theory Comput. 15, 1593 (2019). DOI:
10.1021/acs.jctc.8b01089. arXiv:1810.11659.</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, Fully numerical Hartree-Fock and density functional
calculations. I. Atoms, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.dft.rks_symm.RKS" title="pyscf.dft.rks_symm.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vsap = Vnuc + J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.init_guess_by_vsap">
<span class="sig-name descname"><span class="pre">init_guess_by_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.init_guess_by_vsap" title="Link to this definition">#</a></dt>
<dd><p>Form SAP guess</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks_symm.html#SymAdaptedRKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedRKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedRKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.rks_symm.</span></span><span class="sig-name descname"><span class="pre">SymAdaptedROKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks_symm.html#SymAdaptedROKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.dft.rks.KohnShamDFT" title="pyscf.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.scf.html#pyscf.scf.hf_symm.SymAdaptedROHF" title="pyscf.scf.hf_symm.SymAdaptedROHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymAdaptedROHF</span></code></a></p>
<p>Restricted Kohn-Sham</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.Gradients">
<span class="sig-name descname"><span class="pre">Gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.Gradients" title="Link to this definition">#</a></dt>
<dd><p>Non-relativistic ROHF gradients</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.Hessian">
<span class="sig-name descname"><span class="pre">Hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.Hessian" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.TDA">
<span class="sig-name descname"><span class="pre">TDA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.TDA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.TDDFT">
<span class="sig-name descname"><span class="pre">TDDFT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.TDDFT" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.TDDFTNoHybrid">
<span class="sig-name descname"><span class="pre">TDDFTNoHybrid</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.TDDFTNoHybrid" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.TDHF">
<span class="sig-name descname"><span class="pre">TDHF</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.TDHF" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.dRPA">
<span class="sig-name descname"><span class="pre">dRPA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.dRPA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.dTDA">
<span class="sig-name descname"><span class="pre">dTDA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.dTDA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks_symm.html#SymAdaptedROKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of Hartree-Fock energy, for given core hamiltonian and
HF potential</p>
<p> math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> \<span class="n">sum_</span><span class="p">{</span><span class="n">ij</span><span class="p">}</span><span class="n">h_</span><span class="p">{</span><span class="n">ij</span><span class="p">}</span> \<span class="n">gamma_</span><span class="p">{</span><span class="n">ji</span><span class="p">}</span>
  <span class="o">+</span> \<span class="n">frac</span><span class="p">{</span><span class="mi">1</span><span class="p">}{</span><span class="mi">2</span><span class="p">}</span>\<span class="n">sum_</span><span class="p">{</span><span class="n">ijkl</span><span class="p">}</span> \<span class="n">gamma_</span><span class="p">{</span><span class="n">ji</span><span class="p">}</span>\<span class="n">gamma_</span><span class="p">{</span><span class="n">lk</span><span class="p">}</span> \<span class="n">langle</span> <span class="n">ik</span><span class="o">||</span><span class="n">jl</span>\<span class="n">rangle</span>
</pre></div>
</div>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mf : an instance of SCF class</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
<dt>vhf<span class="classifier">2D ndarray</span></dt><dd><p>HF potential</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Hartree-Fock electronic energy and the Coulomb energy</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">energy_elec</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
<span class="go">(-1.5176090667746334, 0.60917167853723675)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">energy_elec</span><span class="p">(</span><span class="n">dm</span><span class="p">)</span>
<span class="go">(-1.5176090667746334, 0.60917167853723675)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/dft/rks.py
<a class="reference internal" href="#pyscf.dft.rks_symm.SymAdaptedROKS.get_veff" title="pyscf.dft.rks_symm.SymAdaptedROKS.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.get_vsap">
<span class="sig-name descname"><span class="pre">get_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.get_vsap" title="Link to this definition">#</a></dt>
<dd><p>Superposition of atomic potentials</p>
<p>S. Lehtola, Assessment of initial guesses for self-consistent
field calculations. Superposition of Atomic Potentials: simple yet
efficient, J. Chem. Theory Comput. 15, 1593 (2019). DOI:
10.1021/acs.jctc.8b01089. arXiv:1810.11659.</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, Fully numerical Hartree-Fock and density functional
calculations. I. Atoms, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.dft.rks_symm.RKS" title="pyscf.dft.rks_symm.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vsap = Vnuc + J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.init_guess_by_vsap">
<span class="sig-name descname"><span class="pre">init_guess_by_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.init_guess_by_vsap" title="Link to this definition">#</a></dt>
<dd><p>Form SAP guess</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/rks_symm.html#SymAdaptedROKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.rks_symm.SymAdaptedROKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.rks_symm.SymAdaptedROKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyscf.dft.roks">
<span id="pyscf-dft-roks-module"></span><h2>pyscf.dft.roks module<a class="headerlink" href="#module-pyscf.dft.roks" title="Link to this heading">#</a></h2>
<p>Non-relativistic restricted open-shell Kohn-Sham</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.roks.</span></span><span class="sig-name descname"><span class="pre">ROKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/roks.html#ROKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.roks.ROKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.dft.rks.KohnShamDFT" title="pyscf.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.scf.html#pyscf.scf.rohf.ROHF" title="pyscf.scf.rohf.ROHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">ROHF</span></code></a></p>
<p>Restricted open-shell Kohn-Sham
See pyscf/dft/rks.py RKS class for the usage of the attributes</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.Gradients">
<span class="sig-name descname"><span class="pre">Gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.roks.ROKS.Gradients" title="Link to this definition">#</a></dt>
<dd><p>Non-relativistic ROHF gradients</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.Hessian">
<span class="sig-name descname"><span class="pre">Hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.roks.ROKS.Hessian" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.TDA">
<span class="sig-name descname"><span class="pre">TDA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.roks.ROKS.TDA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.TDDFT">
<span class="sig-name descname"><span class="pre">TDDFT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.roks.ROKS.TDDFT" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.TDDFTNoHybrid">
<span class="sig-name descname"><span class="pre">TDDFTNoHybrid</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.roks.ROKS.TDDFTNoHybrid" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.TDHF">
<span class="sig-name descname"><span class="pre">TDHF</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.roks.ROKS.TDHF" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.dRPA">
<span class="sig-name descname"><span class="pre">dRPA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.roks.ROKS.dRPA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.dTDA">
<span class="sig-name descname"><span class="pre">dTDA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.roks.ROKS.dTDA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/roks.html#ROKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.roks.ROKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.roks.ROKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of Hartree-Fock energy, for given core hamiltonian and
HF potential</p>
<p> math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> \<span class="n">sum_</span><span class="p">{</span><span class="n">ij</span><span class="p">}</span><span class="n">h_</span><span class="p">{</span><span class="n">ij</span><span class="p">}</span> \<span class="n">gamma_</span><span class="p">{</span><span class="n">ji</span><span class="p">}</span>
  <span class="o">+</span> \<span class="n">frac</span><span class="p">{</span><span class="mi">1</span><span class="p">}{</span><span class="mi">2</span><span class="p">}</span>\<span class="n">sum_</span><span class="p">{</span><span class="n">ijkl</span><span class="p">}</span> \<span class="n">gamma_</span><span class="p">{</span><span class="n">ji</span><span class="p">}</span>\<span class="n">gamma_</span><span class="p">{</span><span class="n">lk</span><span class="p">}</span> \<span class="n">langle</span> <span class="n">ik</span><span class="o">||</span><span class="n">jl</span>\<span class="n">rangle</span>
</pre></div>
</div>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mf : an instance of SCF class</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
<dt>vhf<span class="classifier">2D ndarray</span></dt><dd><p>HF potential</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Hartree-Fock electronic energy and the Coulomb energy</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">energy_elec</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
<span class="go">(-1.5176090667746334, 0.60917167853723675)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">energy_elec</span><span class="p">(</span><span class="n">dm</span><span class="p">)</span>
<span class="go">(-1.5176090667746334, 0.60917167853723675)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.roks.ROKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/dft/rks.py
<a class="reference internal" href="#pyscf.dft.roks.get_veff" title="pyscf.dft.roks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.get_vsap">
<span class="sig-name descname"><span class="pre">get_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.roks.ROKS.get_vsap" title="Link to this definition">#</a></dt>
<dd><p>Superposition of atomic potentials</p>
<p>S. Lehtola, Assessment of initial guesses for self-consistent
field calculations. Superposition of Atomic Potentials: simple yet
efficient, J. Chem. Theory Comput. 15, 1593 (2019). DOI:
10.1021/acs.jctc.8b01089. arXiv:1810.11659.</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, Fully numerical Hartree-Fock and density functional
calculations. I. Atoms, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vsap = Vnuc + J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.init_guess_by_vsap">
<span class="sig-name descname"><span class="pre">init_guess_by_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.roks.ROKS.init_guess_by_vsap" title="Link to this definition">#</a></dt>
<dd><p>Form SAP guess</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/roks.html#ROKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.roks.ROKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.roks.ROKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.roks.ROKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/roks.html#ROKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.roks.ROKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to ROHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.roks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.roks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/roks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.roks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/dft/rks.py
<a class="reference internal" href="#pyscf.dft.roks.get_veff" title="pyscf.dft.roks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

</section>
<section id="module-pyscf.dft.sap">
<span id="pyscf-dft-sap-module"></span><h2>pyscf.dft.sap module<a class="headerlink" href="#module-pyscf.dft.sap" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.sap.sap_effective_charge">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.sap.</span></span><span class="sig-name descname"><span class="pre">sap_effective_charge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/sap.html#sap_effective_charge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.sap.sap_effective_charge" title="Link to this definition">#</a></dt>
<dd><p>Calculates the effective charge for the superposition of atomic potentials.</p>
<p>S. Lehtola, Assessment of Initial Guesses for Self-Consistent Field
Calculations. Superposition of Atomic Potentials: Simple yet
Efficient, J. Chem. Theory Comput. 15, 1593 (2019).
DOI: 10.1021/acs.jctc.8b01089</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, Fully numerical Hartree-Fock and density functional
calculations. I. Atoms, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<dl class="simple">
<dt>Input:</dt><dd><p>Z: atomic charge
r: distance from nucleus</p>
</dd>
<dt>Output:</dt><dd><p>Z(r): screened charge</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.dft.sap_data">
<span id="pyscf-dft-sap-data-module"></span><h2>pyscf.dft.sap_data module<a class="headerlink" href="#module-pyscf.dft.sap_data" title="Link to this heading">#</a></h2>
</section>
<section id="module-pyscf.dft.uks">
<span id="pyscf-dft-uks-module"></span><h2>pyscf.dft.uks module<a class="headerlink" href="#module-pyscf.dft.uks" title="Link to this heading">#</a></h2>
<p>Non-relativistic Unrestricted Kohn-Sham</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.uks.</span></span><span class="sig-name descname"><span class="pre">UKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/uks.html#UKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.uks.UKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.dft.rks.KohnShamDFT" title="pyscf.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.scf.html#pyscf.scf.uhf.UHF" title="pyscf.scf.uhf.UHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">UHF</span></code></a></p>
<p>Unrestricted Kohn-Sham
See pyscf/dft/rks.py RKS class for document of the attributes</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.CasidaTDDFT">
<span class="sig-name descname"><span class="pre">CasidaTDDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.CasidaTDDFT" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.Gradients">
<span class="sig-name descname"><span class="pre">Gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.Gradients" title="Link to this definition">#</a></dt>
<dd><p>Non-relativistic unrestricted Hartree-Fock gradients</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.Hessian">
<span class="sig-name descname"><span class="pre">Hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.Hessian" title="Link to this definition">#</a></dt>
<dd><p>Non-relativistic UKS hessian</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.TDA">
<span class="sig-name descname"><span class="pre">TDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.TDA" title="Link to this definition">#</a></dt>
<dd><p>Tamm-Dancoff approximation</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Diagonalization convergence tolerance.  Default is 1e-9.</p>
</dd>
<dt>nstates<span class="classifier">int</span></dt><dd><p>Number of TD states to be computed. Default is 3.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Diagonalization converged or not</p>
</dd>
<dt>e<span class="classifier">1D array</span></dt><dd><p>excitation energy for each excited state.</p>
</dd>
<dt>xy<span class="classifier">A list of two 2D arrays</span></dt><dd><p>The two 2D arrays are Excitation coefficients X (shape [nocc,nvir])
and de-excitation coefficients Y (shape [nocc,nvir]) for each
excited state.  (X,Y) are normalized to 1/2 in RHF/RKS methods and
normalized to 1 for UHF/UKS methods. In the TDA calculation, Y = 0.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.TDDFT">
<span class="sig-name descname"><span class="pre">TDDFT</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.TDDFT" title="Link to this definition">#</a></dt>
<dd><p>Driver to create TDDFT or CasidaTDDFT object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.TDDFTNoHybrid">
<span class="sig-name descname"><span class="pre">TDDFTNoHybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.TDDFTNoHybrid" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.TDHF">
<span class="sig-name descname"><span class="pre">TDHF</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.uks.UKS.TDHF" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.dRPA">
<span class="sig-name descname"><span class="pre">dRPA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.dRPA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.dTDA">
<span class="sig-name descname"><span class="pre">dTDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.dTDA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/uks.html#UKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.uks.UKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic energy of Unrestricted Hartree-Fock</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>Hartree-Fock electronic energy and the 2-electron part contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/dft/rks.py
<a class="reference internal" href="#pyscf.dft.uks.get_veff" title="pyscf.dft.uks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.get_vsap">
<span class="sig-name descname"><span class="pre">get_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.get_vsap" title="Link to this definition">#</a></dt>
<dd><p>Superposition of atomic potentials</p>
<p>S. Lehtola, Assessment of initial guesses for self-consistent
field calculations. Superposition of Atomic Potentials: simple yet
efficient, J. Chem. Theory Comput. 15, 1593 (2019). DOI:
10.1021/acs.jctc.8b01089. arXiv:1810.11659.</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, Fully numerical Hartree-Fock and density functional
calculations. I. Atoms, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vsap = Vnuc + J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.init_guess_by_vsap">
<span class="sig-name descname"><span class="pre">init_guess_by_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.init_guess_by_vsap" title="Link to this definition">#</a></dt>
<dd><p>Form SAP guess</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.initialize_grids">
<span class="sig-name descname"><span class="pre">initialize_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/uks.html#UKS.initialize_grids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.uks.UKS.initialize_grids" title="Link to this definition">#</a></dt>
<dd><p>Initialize self.grids the first time call get_veff</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/uks.html#UKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.uks.UKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks.UKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks.UKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/uks.html#UKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.uks.UKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to UHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.uks.energy_elec">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.uks.</span></span><span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/uks.html#energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.uks.energy_elec" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.uks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.uks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/uks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.uks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/dft/rks.py
<a class="reference internal" href="#pyscf.dft.uks.get_veff" title="pyscf.dft.uks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.uks.get_vsap">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.uks.</span></span><span class="sig-name descname"><span class="pre">get_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/uks.html#get_vsap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.uks.get_vsap" title="Link to this definition">#</a></dt>
<dd><p>Superposition of atomic potentials</p>
<p>S. Lehtola, Assessment of initial guesses for self-consistent
field calculations. Superposition of Atomic Potentials: simple yet
efficient, J. Chem. Theory Comput. 15, 1593 (2019). DOI:
10.1021/acs.jctc.8b01089. arXiv:1810.11659.</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, Fully numerical Hartree-Fock and density functional
calculations. I. Atoms, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vsap = Vnuc + J + Vxc.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.dft.uks_symm">
<span id="pyscf-dft-uks-symm-module"></span><h2>pyscf.dft.uks_symm module<a class="headerlink" href="#module-pyscf.dft.uks_symm" title="Link to this heading">#</a></h2>
<p>Non-relativistic Unrestricted Kohn-Sham</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.dft.uks_symm.</span></span><span class="sig-name descname"><span class="pre">SymAdaptedUKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/uks_symm.html#SymAdaptedUKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.dft.rks.KohnShamDFT" title="pyscf.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.scf.html#pyscf.scf.uhf_symm.SymAdaptedUHF" title="pyscf.scf.uhf_symm.SymAdaptedUHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymAdaptedUHF</span></code></a></p>
<p>Restricted Kohn-Sham</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.CasidaTDDFT">
<span class="sig-name descname"><span class="pre">CasidaTDDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.CasidaTDDFT" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.Gradients">
<span class="sig-name descname"><span class="pre">Gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.Gradients" title="Link to this definition">#</a></dt>
<dd><p>Non-relativistic unrestricted Hartree-Fock gradients</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.Hessian">
<span class="sig-name descname"><span class="pre">Hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.Hessian" title="Link to this definition">#</a></dt>
<dd><p>Non-relativistic UKS hessian</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.TDA">
<span class="sig-name descname"><span class="pre">TDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.TDA" title="Link to this definition">#</a></dt>
<dd><p>Tamm-Dancoff approximation</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Diagonalization convergence tolerance.  Default is 1e-9.</p>
</dd>
<dt>nstates<span class="classifier">int</span></dt><dd><p>Number of TD states to be computed. Default is 3.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Diagonalization converged or not</p>
</dd>
<dt>e<span class="classifier">1D array</span></dt><dd><p>excitation energy for each excited state.</p>
</dd>
<dt>xy<span class="classifier">A list of two 2D arrays</span></dt><dd><p>The two 2D arrays are Excitation coefficients X (shape [nocc,nvir])
and de-excitation coefficients Y (shape [nocc,nvir]) for each
excited state.  (X,Y) are normalized to 1/2 in RHF/RKS methods and
normalized to 1 for UHF/UKS methods. In the TDA calculation, Y = 0.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.TDDFT">
<span class="sig-name descname"><span class="pre">TDDFT</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.TDDFT" title="Link to this definition">#</a></dt>
<dd><p>Driver to create TDDFT or CasidaTDDFT object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.TDDFTNoHybrid">
<span class="sig-name descname"><span class="pre">TDDFTNoHybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.TDDFTNoHybrid" title="Link to this definition">#</a></dt>
<dd><p>Solve the Casida TDDFT formula (A-B)(A+B)(X+Y) = (X+Y)w^2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.TDHF">
<span class="sig-name descname"><span class="pre">TDHF</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.TDHF" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.dRPA">
<span class="sig-name descname"><span class="pre">dRPA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.dRPA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.dTDA">
<span class="sig-name descname"><span class="pre">dTDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.dTDA" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/uks_symm.html#SymAdaptedUKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic energy of Unrestricted Hartree-Fock</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>Hartree-Fock electronic energy and the 2-electron part contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/dft/rks.py
<a class="reference internal" href="#pyscf.dft.uks_symm.SymAdaptedUKS.get_veff" title="pyscf.dft.uks_symm.SymAdaptedUKS.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.get_vsap">
<span class="sig-name descname"><span class="pre">get_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.get_vsap" title="Link to this definition">#</a></dt>
<dd><p>Superposition of atomic potentials</p>
<p>S. Lehtola, Assessment of initial guesses for self-consistent
field calculations. Superposition of Atomic Potentials: simple yet
efficient, J. Chem. Theory Comput. 15, 1593 (2019). DOI:
10.1021/acs.jctc.8b01089. arXiv:1810.11659.</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, Fully numerical Hartree-Fock and density functional
calculations. I. Atoms, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vsap = Vnuc + J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.init_guess_by_vsap">
<span class="sig-name descname"><span class="pre">init_guess_by_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.init_guess_by_vsap" title="Link to this definition">#</a></dt>
<dd><p>Form SAP guess</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/uks_symm.html#SymAdaptedUKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.SymAdaptedUKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.uks_symm.SymAdaptedUKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.dft.uks_symm.UKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.uks_symm.</span></span><span class="sig-name descname"><span class="pre">UKS</span></span><a class="headerlink" href="#pyscf.dft.uks_symm.UKS" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.dft.uks_symm.SymAdaptedUKS" title="pyscf.dft.uks_symm.SymAdaptedUKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymAdaptedUKS</span></code></a></p>
</dd></dl>

</section>
<section id="module-pyscf.dft.xc_deriv">
<span id="pyscf-dft-xc-deriv-module"></span><h2>pyscf.dft.xc_deriv module<a class="headerlink" href="#module-pyscf.dft.xc_deriv" title="Link to this heading">#</a></h2>
<p>Transform XC functional derivatives between different representations</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xc_deriv.count_combinations">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xc_deriv.</span></span><span class="sig-name descname"><span class="pre">count_combinations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xc_deriv.html#count_combinations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xc_deriv.count_combinations" title="Link to this definition">#</a></dt>
<dd><p>sum(len(combinations_with_replacement(range(nvar), o) for o in range(order))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xc_deriv.transform_fxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xc_deriv.</span></span><span class="sig-name descname"><span class="pre">transform_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xc_deriv.html#transform_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xc_deriv.transform_fxc" title="Link to this definition">#</a></dt>
<dd><p>Transform libxc functional derivatives to the derivative tensor of
parameters in rho:</p>
<blockquote>
<div><dl class="simple">
<dt>[[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a],</dt><dd><p>[density_b, (nabla_x)_b, (nabla_y)_b, (nabla_z)_b, tau_b]].</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>The output tensor has the shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>spin polarized</dt><dd><p>LDA : [2,1,2,1,N]
GGA : [2,4,2,4,N]
MGGA: [2,5,2,5,N]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>spin unpolarized</dt><dd><p>LDA : [1,1,N]
GGA : [4,4,N]
MGGA: [5,5,N]</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xc_deriv.transform_kxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xc_deriv.</span></span><span class="sig-name descname"><span class="pre">transform_kxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kxc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xc_deriv.html#transform_kxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xc_deriv.transform_kxc" title="Link to this definition">#</a></dt>
<dd><p>Transform libxc functional derivatives to the derivative tensor of
parameters in rho:</p>
<blockquote>
<div><dl class="simple">
<dt>[[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a],</dt><dd><p>[density_b, (nabla_x)_b, (nabla_y)_b, (nabla_z)_b, tau_b]].</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>The output tensor has the shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>spin polarized</dt><dd><p>LDA : [2,1,2,1,2,1,N]
GGA : [2,4,2,4,2,4,N]
MGGA: [2,5,2,5,2,5,N]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>spin unpolarized</dt><dd><p>LDA : [1,1,1,N]
GGA : [4,4,4,N]
MGGA: [5,5,5,N]</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xc_deriv.transform_lxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xc_deriv.</span></span><span class="sig-name descname"><span class="pre">transform_lxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kxc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lxc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xc_deriv.html#transform_lxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xc_deriv.transform_lxc" title="Link to this definition">#</a></dt>
<dd><p>Transform libxc vxc functional output to the derivative tensor of parameters
in rho: [density, nabla_x, nabla_y, nabla_z, tau]. The output tensor has the
shape:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>spin polarized</dt><dd><p>LDA : [2,1,2,1,2,1,2,1,N]
GGA : [2,4,2,4,2,4,2,4,N]
MGGA: [2,5,2,5,2,5,2,5,N]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>spin unpolarized</dt><dd><p>LDA : [1,1,1,1,N]
GGA : [4,4,4,4,N]
MGGA: [5,5,5,5,N]</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xc_deriv.transform_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xc_deriv.</span></span><span class="sig-name descname"><span class="pre">transform_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xc_deriv.html#transform_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xc_deriv.transform_vxc" title="Link to this definition">#</a></dt>
<dd><p>Transform libxc functional derivatives to the derivative tensor of
parameters in rho:</p>
<blockquote>
<div><dl class="simple">
<dt>[[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a],</dt><dd><p>[density_b, (nabla_x)_b, (nabla_y)_b, (nabla_z)_b, tau_b]].</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>The output tensor has the shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>spin polarized</dt><dd><p>LDA : [2,1,N]
GGA : [2,4,N]
MGGA: [2,5,N]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>spin unpolarized</dt><dd><p>LDA : [1,N]
GGA : [4,N]
MGGA: [5,N]</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xc_deriv.transform_xc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xc_deriv.</span></span><span class="sig-name descname"><span class="pre">transform_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xc_deriv.html#transform_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xc_deriv.transform_xc" title="Link to this definition">#</a></dt>
<dd><p>General transformation to construct XC derivative tensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xc_deriv.ts2ud">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xc_deriv.</span></span><span class="sig-name descname"><span class="pre">ts2ud</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xc_deriv.html#ts2ud"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xc_deriv.ts2ud" title="Link to this definition">#</a></dt>
<dd><p>XC derivatives total-density/spin-density representations to
spin-up/spin-down representations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xc_deriv.ud2ts">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xc_deriv.</span></span><span class="sig-name descname"><span class="pre">ud2ts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_ud</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xc_deriv.html#ud2ts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xc_deriv.ud2ts" title="Link to this definition">#</a></dt>
<dd><p>XC derivatives spin-up/spin-down representations to
total-density/spin-density representations</p>
</dd></dl>

</section>
<section id="module-pyscf.dft.xcfun">
<span id="pyscf-dft-xcfun-module"></span><h2>pyscf.dft.xcfun module<a class="headerlink" href="#module-pyscf.dft.xcfun" title="Link to this heading">#</a></h2>
<p>XC functional, the interface to xcfun (<a class="github reference external" href="https://github.com/dftlibs/xcfun">dftlibs/xcfun</a>)
U. Ekstrom et al, J. Chem. Theory Comput., 6, 1971</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.define_xc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">define_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#define_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.define_xc" title="Link to this definition">#</a></dt>
<dd><p>Define XC functional.  See also <a class="reference internal" href="#pyscf.dft.xcfun.eval_xc" title="pyscf.dft.xcfun.eval_xc"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_xc()</span></code></a> for the rules of input description.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></p>
<dl class="simple">
<dt>description<span class="classifier">str</span></dt><dd><p>A string to describe the linear combination of different XC functionals.
The X and C functional are separated by comma like .8*LDA+.2*B86,VWN.
If HF was appeared in the string, it stands for the exact exchange.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA or GGA or MGGA</p>
</dd>
<dt>hyb<span class="classifier">float</span></dt><dd><p>hybrid functional coefficient</p>
</dd>
<dt>rsh<span class="classifier">a list of three floats</span></dt><dd><p>coefficients (omega, alpha, beta) for range-separated hybrid functional.
omega is the exponent factor in attenuated Coulomb operator e^{-omega r_{12}}/r_{12}
alpha is the coefficient for long-range part, hybrid coefficient
can be obtained by alpha + beta</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s1">&#39;.2*HF + .08*LDA + .72*B88, .81*LYP + .19*VWN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.3783361189611</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s1">&#39;LDA*.08 + .72*B88 + .2*HF, .81*LYP + .19*VWN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.3783361189611</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">eval_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">exc</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">rho</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">... </span>    <span class="n">vrho</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rho</span>
<span class="gp">... </span>    <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">vrho</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">fxc</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 2nd order functional derivative</span>
<span class="gp">... </span>    <span class="n">kxc</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 3rd order functional derivative</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span><span class="p">,</span> <span class="n">fxc</span><span class="p">,</span> <span class="n">kxc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="n">eval_xc</span><span class="p">,</span> <span class="n">xctype</span><span class="o">=</span><span class="s1">&#39;LDA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">48.8525211046668</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.define_xc_">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">define_xc_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#define_xc_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.define_xc_" title="Link to this definition">#</a></dt>
<dd><p>Define XC functional.  See also <a class="reference internal" href="#pyscf.dft.xcfun.eval_xc" title="pyscf.dft.xcfun.eval_xc"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_xc()</span></code></a> for the rules of input description.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></p>
<dl class="simple">
<dt>description<span class="classifier">str</span></dt><dd><p>A string to describe the linear combination of different XC functionals.
The X and C functional are separated by comma like .8*LDA+.2*B86,VWN.
If HF was appeared in the string, it stands for the exact exchange.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA or GGA or MGGA</p>
</dd>
<dt>hyb<span class="classifier">float</span></dt><dd><p>hybrid functional coefficient</p>
</dd>
<dt>rsh<span class="classifier">a list of three floats</span></dt><dd><p>coefficients (omega, alpha, beta) for range-separated hybrid functional.
omega is the exponent factor in attenuated Coulomb operator e^{-omega r_{12}}/r_{12}
alpha is the coefficient for long-range part, hybrid coefficient
can be obtained by alpha + beta</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s1">&#39;.2*HF + .08*LDA + .72*B88, .81*LYP + .19*VWN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.3783361189611</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="s1">&#39;LDA*.08 + .72*B88 + .2*HF, .81*LYP + .19*VWN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.3783361189611</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">eval_xc</span><span class="p">(</span><span class="n">xc_code</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">exc</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">rho</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">... </span>    <span class="n">vrho</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rho</span>
<span class="gp">... </span>    <span class="n">vxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">vrho</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">fxc</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 2nd order functional derivative</span>
<span class="gp">... </span>    <span class="n">kxc</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 3rd order functional derivative</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">exc</span><span class="p">,</span> <span class="n">vxc</span><span class="p">,</span> <span class="n">fxc</span><span class="p">,</span> <span class="n">kxc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">define_xc_</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">_numint</span><span class="p">,</span> <span class="n">eval_xc</span><span class="p">,</span> <span class="n">xctype</span><span class="o">=</span><span class="s1">&#39;LDA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">48.8525211046668</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.eval_xc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">eval_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#eval_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.eval_xc" title="Link to this definition">#</a></dt>
<dd><p>Interface to call xcfun library to evaluate XC functional, potential
and functional derivatives. Return derivatives following libxc convention.</p>
<p>See also <a class="reference internal" href="#pyscf.dft.libxc.eval_xc" title="pyscf.dft.libxc.eval_xc"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyscf.dft.libxc.eval_xc()</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.eval_xc1">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">eval_xc1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#eval_xc1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.eval_xc1" title="Link to this definition">#</a></dt>
<dd><p>Similar to eval_xc.
Returns an array with the order of derivatives following xcfun convention.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.eval_xc_eff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">eval_xc_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#eval_xc_eff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.eval_xc_eff" title="Link to this definition">#</a></dt>
<dd><p>Returns the derivative tensor against the density parameters</p>
<p>[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a]</p>
<p>or spin-polarized density parameters</p>
<dl class="simple">
<dt>[[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a],</dt><dd><p>[density_b, (nabla_x)_b, (nabla_y)_b, (nabla_z)_b, tau_b]].</p>
</dd>
</dl>
<p>It differs from the eval_xc method in the derivatives of non-local part.
The eval_xc method returns the XC functional derivatives to sigma
(<a href="#id9"><span class="problematic" id="id10">|</span></a>nabla rho|^2)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>rho: 2-dimensional or 3-dimensional array</dt><dd><p>Total density or (spin-up, spin-down) densities (and their
derivatives if GGA or MGGA functionals) on grids</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>deriv: int</dt><dd><p>derivative orders</p>
</dd>
<dt>omega: float</dt><dd><p>define the exponent in the attenuated Coulomb for RSH functional</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.hybrid_coeff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">hybrid_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#hybrid_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.hybrid_coeff" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.is_gga">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">is_gga</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#is_gga"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.is_gga" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.is_hybrid_xc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">is_hybrid_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#is_hybrid_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.is_hybrid_xc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.is_lda">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">is_lda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#is_lda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.is_lda" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.is_meta_gga">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">is_meta_gga</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#is_meta_gga"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.is_meta_gga" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.is_nlc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">is_nlc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#is_nlc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.is_nlc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.max_deriv_order">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">max_deriv_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#max_deriv_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.max_deriv_order" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.nlc_coeff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">nlc_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#nlc_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.nlc_coeff" title="Link to this definition">#</a></dt>
<dd><p>Get NLC coefficients</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.parse_xc">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">parse_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#parse_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.parse_xc" title="Link to this definition">#</a></dt>
<dd><p>Rules to input functional description:</p>
<ul class="simple">
<li><p>The given functional description must be a one-line string.</p></li>
<li><p>The functional description is case-insensitive.</p></li>
<li><p>The functional description string has two parts, separated by ,.  The
first part describes the exchange functional, the second is the correlation
functional.</p>
<ul>
<li><p>If , not appeared in string, the entire string is treated as the
name of a compound functional (containing both the exchange and
the correlation functional) which was declared in the functional
aliases list. The full list of functional aliases can be obtained by
calling the function pyscf.dft.xcfun.XC_ALIAS.keys() .</p></li>
<li><p>To input only X functional (without C functional), leave the second
part blank. E.g. description=slater, means a functional with LDA
contribution only.</p></li>
<li><p>To neglect the contribution of X functional (just apply C functional),
leave blank in the first part, e.g. description=,vwn means a
functional with VWN only.</p></li>
<li><p>If compound XC functional is specified, no matter whether it is in the
X part (the string in front of comma) or the C part (the string behind
comma), both X and C functionals of the compound XC functional will be
used.</p></li>
</ul>
</li>
<li><p>The functional name can be placed in arbitrary order.  Two names need to
be separated by operators + or -.  Blank spaces are ignored.
NOTE the parser only reads operators + - *.  / is not supported.</p></li>
<li><p>A functional name can have at most one factor.  If the factor is not
given, it is set to 1.  Compound functional can be scaled as a unit. For
example 0.5*b3lyp is equivalent to
HF*0.1 + .04*LDA + .36*B88, .405*LYP + .095*VWN</p></li>
<li><p>String HF stands for exact exchange (HF K matrix).  HF can be put in
the correlation functional part (after comma). Putting HF in the
correlation part is the same to putting HF in the exchange part.</p></li>
<li><p>String RSH means range-separated operator. Its format is
RSH(omega, alpha, beta).  Another way to input RSH is to use keywords
SR_HF and LR_HF: SR_HF(0.1) * alpha_plus_beta and LR_HF(0.1) *
alpha where the number in parenthesis is the value of omega.</p></li>
<li><p>Be careful with the convention of GGA functional, in which the LDA
contribution has been included.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.parse_xc_name">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">parse_xc_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#parse_xc_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.parse_xc_name" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.print_XC_CODES">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">print_XC_CODES</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#print_XC_CODES"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.print_XC_CODES" title="Link to this definition">#</a></dt>
<dd><p>Dump the built-in xcfun XC_CODES in a readable format.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.rsh_coeff">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">rsh_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#rsh_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.rsh_coeff" title="Link to this definition">#</a></dt>
<dd><p>Get Range-separated-hybrid coefficients</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.test_deriv_order">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">test_deriv_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#test_deriv_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.test_deriv_order" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.xcfun.xc_type">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.xcfun.</span></span><span class="sig-name descname"><span class="pre">xc_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/xcfun.html#xc_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.xcfun.xc_type" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.dft">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyscf.dft" title="Link to this heading">#</a></h2>
<section id="density-functional-theory">
<h3>Density functional theory<a class="headerlink" href="#density-functional-theory" title="Link to this heading">#</a></h3>
<p>Simple usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;def2-tzvp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;pbe,pbe&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.DFT">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.</span></span><span class="sig-name descname"><span class="pre">DFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.DFT" title="Link to this definition">#</a></dt>
<dd><p>A wrap function to create DFT object (RKS or UKS).</p>
<p>Restricted Kohn-Sham
SCF base class.   non-relativistic RHF.</p>
<blockquote>
<div><dl>
<dt>Attributes:</dt><dd><dl>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB.  Default equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>chkfile<span class="classifier">str</span></dt><dd><p>checkpoint file to save MOs, orbital energies etc.  Writing to
chkfile can be disabled if this attribute is set to None or False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>converge threshold.  Default is 1e-9</p>
</dd>
<dt>conv_tol_grad<span class="classifier">float</span></dt><dd><p>gradients converge threshold.  Default is sqrt(conv_tol)</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>max number of iterations.  If max_cycle &lt;= 0, SCF iteration will
be skipped and the kernel function will compute only the total
energy based on the initial guess. Default value is 50.</p>
</dd>
<dt>init_guess<span class="classifier">str</span></dt><dd><p>initial guess method.  It can be one of minao, atom, huckel, hcore, 1e, sap, chkfile.
Default is minao</p>
</dd>
<dt>sap_basis<span class="classifier">str or dict</span></dt><dd><p>basis for SAP initial guess, either filename or path as str or
internal format dictionary.</p>
</dd>
<dt>DIIS<span class="classifier">DIIS class</span></dt><dd><p>The class to generate diis object.  It can be one of
diis.SCF_DIIS, diis.ADIIS, diis.EDIIS.</p>
</dd>
<dt>diis<span class="classifier">boolean or object of DIIS class defined in <code class="xref py py-mod docutils literal notranslate"><span class="pre">scf.diis</span></code>.</span></dt><dd><p>Default is the object associated to the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.DIIS</span></code>.
Set it to None/False to turn off DIIS.
Note if this attribute is initialized as a DIIS object, the SCF driver
will use this object in the iteration. The DIIS information (vector
basis and error vector) will be held inside this object. When kernel
function is called again, the old states (vector basis and error
vector) will be reused.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size.  By default, 8 Fock matrices and errors vector are stored.</p>
</dd>
<dt>diis_damp<span class="classifier">float</span></dt><dd><p>DIIS damping factor.  Default is 0.</p>
</dd>
<dt>diis_start_cycle<span class="classifier">int</span></dt><dd><p>The step to start DIIS.  Default is 1.</p>
</dd>
<dt>diis_file: str</dt><dd><p>File to store DIIS vectors and error vectors.</p>
</dd>
<dt>level_shift<span class="classifier">float or int</span></dt><dd><p>Level shift (in AU) for virtual space.  Default is 0.</p>
</dd>
<dt>direct_scf<span class="classifier">bool</span></dt><dd><p>Direct SCF is used by default.</p>
</dd>
<dt>direct_scf_tol<span class="classifier">float</span></dt><dd><p>Direct SCF cutoff threshold.  Default is 1e-13.</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
environment.</p>
</dd>
<dt>conv_check<span class="classifier">bool</span></dt><dd><p>An extra cycle to check convergence after SCF iterations.</p>
</dd>
<dt>check_convergence<span class="classifier">function(envs) =&gt; bool</span></dt><dd><p>A hook for overloading convergence criteria in SCF iterations.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether the SCF iteration converged</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total HF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>mo_energy :</dt><dd><p>Orbital energies</p>
</dd>
<dt>mo_occ</dt><dd><p>Orbital occupancy</p>
</dd>
<dt>mo_coeff</dt><dd><p>Orbital coefficients</p>
</dd>
<dt>cycles<span class="classifier">int</span></dt><dd><p>The number of iteration cycles performed</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;cc-pvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">SCF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">level_shift</span> <span class="o">=</span> <span class="mf">.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="go">-1.0811707843775884</span>
</pre></div>
</div>
<dl>
<dt>Attributes for Kohn-Sham DFT:</dt><dd><dl>
<dt>xc<span class="classifier">str</span></dt><dd><p>X_name,C_name for the XC functional.  Default is lda,vwn</p>
</dd>
<dt>nlc<span class="classifier">str</span></dt><dd><p>NLC_name for the NLC functional.  Default is  (i.e., None)</p>
</dd>
<dt>omega<span class="classifier">float</span></dt><dd><p>Omega of the range-separated Coulomb operator e^{-omega r_{12}^2} / r_{12}</p>
</dd>
<dt>grids<span class="classifier">Grids object</span></dt><dd><p>grids.level (0 - 9)  big number for large mesh grids. Default is 3</p>
<dl>
<dt>radii_adjust</dt><dd><div class="line-block">
<div class="line">radi.treutler_atomic_radii_adjust (default)</div>
<div class="line">radi.becke_atomic_radii_adjust</div>
<div class="line">None : to switch off atomic radii adjustment</div>
</div>
</dd>
<dt>grids.atomic_radii</dt><dd><div class="line-block">
<div class="line">radi.BRAGG_RADII  (default)</div>
<div class="line">radi.COVALENT_RADII</div>
<div class="line">None : to switch off atomic radii adjustment</div>
</div>
</dd>
<dt>grids.radi_method  scheme for radial grids</dt><dd><div class="line-block">
<div class="line">radi.treutler  (default)</div>
<div class="line">radi.delley</div>
<div class="line">radi.mura_knowles</div>
<div class="line">radi.gauss_chebyshev</div>
</div>
</dd>
<dt>grids.becke_scheme  weight partition function</dt><dd><div class="line-block">
<div class="line">gen_grid.original_becke  (default)</div>
<div class="line">gen_grid.stratmann</div>
</div>
</dd>
<dt>grids.prune  scheme to reduce number of grids</dt><dd><div class="line-block">
<div class="line">gen_grid.nwchem_prune  (default)</div>
<div class="line">gen_grid.sg1_prune</div>
<div class="line">gen_grid.treutler_prune</div>
<div class="line">None : to switch off grids pruning</div>
</div>
</dd>
</dl>
<p>grids.symmetry  True/False  to symmetrize mesh grids (TODO)</p>
<p>grids.atom_grid  Set (radial, angular) grids for particular atoms.
Eg, grids.atom_grid = {H: (20,110)} will generate 20 radial
grids and 110 angular grids for H atom.</p>
</dd>
<dt>small_rho_cutoff<span class="classifier">float</span></dt><dd><p>Drop grids if their contribution to total electrons smaller than
this cutoff value.  Default is 1e-7.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;b3lyp&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.415443079840458</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.DKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.</span></span><span class="sig-name descname"><span class="pre">DKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft.html#DKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.DKS" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.GKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.</span></span><span class="sig-name descname"><span class="pre">GKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft.html#GKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.GKS" title="Link to this definition">#</a></dt>
<dd><p>Generalized Kohn-Sham</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.KS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.</span></span><span class="sig-name descname"><span class="pre">KS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft.html#KS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.KS" title="Link to this definition">#</a></dt>
<dd><p>A wrap function to create DFT object (RKS or UKS).</p>
<p>Restricted Kohn-Sham
SCF base class.   non-relativistic RHF.</p>
<blockquote>
<div><dl>
<dt>Attributes:</dt><dd><dl>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB.  Default equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>chkfile<span class="classifier">str</span></dt><dd><p>checkpoint file to save MOs, orbital energies etc.  Writing to
chkfile can be disabled if this attribute is set to None or False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>converge threshold.  Default is 1e-9</p>
</dd>
<dt>conv_tol_grad<span class="classifier">float</span></dt><dd><p>gradients converge threshold.  Default is sqrt(conv_tol)</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>max number of iterations.  If max_cycle &lt;= 0, SCF iteration will
be skipped and the kernel function will compute only the total
energy based on the initial guess. Default value is 50.</p>
</dd>
<dt>init_guess<span class="classifier">str</span></dt><dd><p>initial guess method.  It can be one of minao, atom, huckel, hcore, 1e, sap, chkfile.
Default is minao</p>
</dd>
<dt>sap_basis<span class="classifier">str or dict</span></dt><dd><p>basis for SAP initial guess, either filename or path as str or
internal format dictionary.</p>
</dd>
<dt>DIIS<span class="classifier">DIIS class</span></dt><dd><p>The class to generate diis object.  It can be one of
diis.SCF_DIIS, diis.ADIIS, diis.EDIIS.</p>
</dd>
<dt>diis<span class="classifier">boolean or object of DIIS class defined in <code class="xref py py-mod docutils literal notranslate"><span class="pre">scf.diis</span></code>.</span></dt><dd><p>Default is the object associated to the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.DIIS</span></code>.
Set it to None/False to turn off DIIS.
Note if this attribute is initialized as a DIIS object, the SCF driver
will use this object in the iteration. The DIIS information (vector
basis and error vector) will be held inside this object. When kernel
function is called again, the old states (vector basis and error
vector) will be reused.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size.  By default, 8 Fock matrices and errors vector are stored.</p>
</dd>
<dt>diis_damp<span class="classifier">float</span></dt><dd><p>DIIS damping factor.  Default is 0.</p>
</dd>
<dt>diis_start_cycle<span class="classifier">int</span></dt><dd><p>The step to start DIIS.  Default is 1.</p>
</dd>
<dt>diis_file: str</dt><dd><p>File to store DIIS vectors and error vectors.</p>
</dd>
<dt>level_shift<span class="classifier">float or int</span></dt><dd><p>Level shift (in AU) for virtual space.  Default is 0.</p>
</dd>
<dt>direct_scf<span class="classifier">bool</span></dt><dd><p>Direct SCF is used by default.</p>
</dd>
<dt>direct_scf_tol<span class="classifier">float</span></dt><dd><p>Direct SCF cutoff threshold.  Default is 1e-13.</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
environment.</p>
</dd>
<dt>conv_check<span class="classifier">bool</span></dt><dd><p>An extra cycle to check convergence after SCF iterations.</p>
</dd>
<dt>check_convergence<span class="classifier">function(envs) =&gt; bool</span></dt><dd><p>A hook for overloading convergence criteria in SCF iterations.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether the SCF iteration converged</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total HF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>mo_energy :</dt><dd><p>Orbital energies</p>
</dd>
<dt>mo_occ</dt><dd><p>Orbital occupancy</p>
</dd>
<dt>mo_coeff</dt><dd><p>Orbital coefficients</p>
</dd>
<dt>cycles<span class="classifier">int</span></dt><dd><p>The number of iteration cycles performed</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;cc-pvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">SCF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">level_shift</span> <span class="o">=</span> <span class="mf">.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="go">-1.0811707843775884</span>
</pre></div>
</div>
<dl>
<dt>Attributes for Kohn-Sham DFT:</dt><dd><dl>
<dt>xc<span class="classifier">str</span></dt><dd><p>X_name,C_name for the XC functional.  Default is lda,vwn</p>
</dd>
<dt>nlc<span class="classifier">str</span></dt><dd><p>NLC_name for the NLC functional.  Default is  (i.e., None)</p>
</dd>
<dt>omega<span class="classifier">float</span></dt><dd><p>Omega of the range-separated Coulomb operator e^{-omega r_{12}^2} / r_{12}</p>
</dd>
<dt>grids<span class="classifier">Grids object</span></dt><dd><p>grids.level (0 - 9)  big number for large mesh grids. Default is 3</p>
<dl>
<dt>radii_adjust</dt><dd><div class="line-block">
<div class="line">radi.treutler_atomic_radii_adjust (default)</div>
<div class="line">radi.becke_atomic_radii_adjust</div>
<div class="line">None : to switch off atomic radii adjustment</div>
</div>
</dd>
<dt>grids.atomic_radii</dt><dd><div class="line-block">
<div class="line">radi.BRAGG_RADII  (default)</div>
<div class="line">radi.COVALENT_RADII</div>
<div class="line">None : to switch off atomic radii adjustment</div>
</div>
</dd>
<dt>grids.radi_method  scheme for radial grids</dt><dd><div class="line-block">
<div class="line">radi.treutler  (default)</div>
<div class="line">radi.delley</div>
<div class="line">radi.mura_knowles</div>
<div class="line">radi.gauss_chebyshev</div>
</div>
</dd>
<dt>grids.becke_scheme  weight partition function</dt><dd><div class="line-block">
<div class="line">gen_grid.original_becke  (default)</div>
<div class="line">gen_grid.stratmann</div>
</div>
</dd>
<dt>grids.prune  scheme to reduce number of grids</dt><dd><div class="line-block">
<div class="line">gen_grid.nwchem_prune  (default)</div>
<div class="line">gen_grid.sg1_prune</div>
<div class="line">gen_grid.treutler_prune</div>
<div class="line">None : to switch off grids pruning</div>
</div>
</dd>
</dl>
<p>grids.symmetry  True/False  to symmetrize mesh grids (TODO)</p>
<p>grids.atom_grid  Set (radial, angular) grids for particular atoms.
Eg, grids.atom_grid = {H: (20,110)} will generate 20 radial
grids and 110 angular grids for H atom.</p>
</dd>
<dt>small_rho_cutoff<span class="classifier">float</span></dt><dd><p>Drop grids if their contribution to total electrons smaller than
this cutoff value.  Default is 1e-7.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;b3lyp&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.415443079840458</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.RKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.</span></span><span class="sig-name descname"><span class="pre">RKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft.html#RKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.RKS" title="Link to this definition">#</a></dt>
<dd><p>Restricted Kohn-Sham
SCF base class.   non-relativistic RHF.</p>
<blockquote>
<div><dl>
<dt>Attributes:</dt><dd><dl>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB.  Default equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>chkfile<span class="classifier">str</span></dt><dd><p>checkpoint file to save MOs, orbital energies etc.  Writing to
chkfile can be disabled if this attribute is set to None or False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>converge threshold.  Default is 1e-9</p>
</dd>
<dt>conv_tol_grad<span class="classifier">float</span></dt><dd><p>gradients converge threshold.  Default is sqrt(conv_tol)</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>max number of iterations.  If max_cycle &lt;= 0, SCF iteration will
be skipped and the kernel function will compute only the total
energy based on the initial guess. Default value is 50.</p>
</dd>
<dt>init_guess<span class="classifier">str</span></dt><dd><p>initial guess method.  It can be one of minao, atom, huckel, hcore, 1e, sap, chkfile.
Default is minao</p>
</dd>
<dt>sap_basis<span class="classifier">str or dict</span></dt><dd><p>basis for SAP initial guess, either filename or path as str or
internal format dictionary.</p>
</dd>
<dt>DIIS<span class="classifier">DIIS class</span></dt><dd><p>The class to generate diis object.  It can be one of
diis.SCF_DIIS, diis.ADIIS, diis.EDIIS.</p>
</dd>
<dt>diis<span class="classifier">boolean or object of DIIS class defined in <code class="xref py py-mod docutils literal notranslate"><span class="pre">scf.diis</span></code>.</span></dt><dd><p>Default is the object associated to the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.DIIS</span></code>.
Set it to None/False to turn off DIIS.
Note if this attribute is initialized as a DIIS object, the SCF driver
will use this object in the iteration. The DIIS information (vector
basis and error vector) will be held inside this object. When kernel
function is called again, the old states (vector basis and error
vector) will be reused.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size.  By default, 8 Fock matrices and errors vector are stored.</p>
</dd>
<dt>diis_damp<span class="classifier">float</span></dt><dd><p>DIIS damping factor.  Default is 0.</p>
</dd>
<dt>diis_start_cycle<span class="classifier">int</span></dt><dd><p>The step to start DIIS.  Default is 1.</p>
</dd>
<dt>diis_file: str</dt><dd><p>File to store DIIS vectors and error vectors.</p>
</dd>
<dt>level_shift<span class="classifier">float or int</span></dt><dd><p>Level shift (in AU) for virtual space.  Default is 0.</p>
</dd>
<dt>direct_scf<span class="classifier">bool</span></dt><dd><p>Direct SCF is used by default.</p>
</dd>
<dt>direct_scf_tol<span class="classifier">float</span></dt><dd><p>Direct SCF cutoff threshold.  Default is 1e-13.</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
environment.</p>
</dd>
<dt>conv_check<span class="classifier">bool</span></dt><dd><p>An extra cycle to check convergence after SCF iterations.</p>
</dd>
<dt>check_convergence<span class="classifier">function(envs) =&gt; bool</span></dt><dd><p>A hook for overloading convergence criteria in SCF iterations.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results:</p>
<blockquote>
<div><dl class="simple">
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether the SCF iteration converged</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total HF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>mo_energy :</dt><dd><p>Orbital energies</p>
</dd>
<dt>mo_occ</dt><dd><p>Orbital occupancy</p>
</dd>
<dt>mo_coeff</dt><dd><p>Orbital coefficients</p>
</dd>
<dt>cycles<span class="classifier">int</span></dt><dd><p>The number of iteration cycles performed</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;cc-pvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">SCF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">level_shift</span> <span class="o">=</span> <span class="mf">.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="go">-1.0811707843775884</span>
</pre></div>
</div>
<dl>
<dt>Attributes for Kohn-Sham DFT:</dt><dd><dl>
<dt>xc<span class="classifier">str</span></dt><dd><p>X_name,C_name for the XC functional.  Default is lda,vwn</p>
</dd>
<dt>nlc<span class="classifier">str</span></dt><dd><p>NLC_name for the NLC functional.  Default is  (i.e., None)</p>
</dd>
<dt>omega<span class="classifier">float</span></dt><dd><p>Omega of the range-separated Coulomb operator e^{-omega r_{12}^2} / r_{12}</p>
</dd>
<dt>grids<span class="classifier">Grids object</span></dt><dd><p>grids.level (0 - 9)  big number for large mesh grids. Default is 3</p>
<dl>
<dt>radii_adjust</dt><dd><div class="line-block">
<div class="line">radi.treutler_atomic_radii_adjust (default)</div>
<div class="line">radi.becke_atomic_radii_adjust</div>
<div class="line">None : to switch off atomic radii adjustment</div>
</div>
</dd>
<dt>grids.atomic_radii</dt><dd><div class="line-block">
<div class="line">radi.BRAGG_RADII  (default)</div>
<div class="line">radi.COVALENT_RADII</div>
<div class="line">None : to switch off atomic radii adjustment</div>
</div>
</dd>
<dt>grids.radi_method  scheme for radial grids</dt><dd><div class="line-block">
<div class="line">radi.treutler  (default)</div>
<div class="line">radi.delley</div>
<div class="line">radi.mura_knowles</div>
<div class="line">radi.gauss_chebyshev</div>
</div>
</dd>
<dt>grids.becke_scheme  weight partition function</dt><dd><div class="line-block">
<div class="line">gen_grid.original_becke  (default)</div>
<div class="line">gen_grid.stratmann</div>
</div>
</dd>
<dt>grids.prune  scheme to reduce number of grids</dt><dd><div class="line-block">
<div class="line">gen_grid.nwchem_prune  (default)</div>
<div class="line">gen_grid.sg1_prune</div>
<div class="line">gen_grid.treutler_prune</div>
<div class="line">None : to switch off grids pruning</div>
</div>
</dd>
</dl>
<p>grids.symmetry  True/False  to symmetrize mesh grids (TODO)</p>
<p>grids.atom_grid  Set (radial, angular) grids for particular atoms.
Eg, grids.atom_grid = {H: (20,110)} will generate 20 radial
grids and 110 angular grids for H atom.</p>
</dd>
<dt>small_rho_cutoff<span class="classifier">float</span></dt><dd><p>Drop grids if their contribution to total electrons smaller than
this cutoff value.  Default is 1e-7.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;b3lyp&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-76.415443079840458</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.ROKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.</span></span><span class="sig-name descname"><span class="pre">ROKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft.html#ROKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.ROKS" title="Link to this definition">#</a></dt>
<dd><p>Restricted open-shell Kohn-Sham
See pyscf/dft/rks.py RKS class for the usage of the attributes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.UKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.</span></span><span class="sig-name descname"><span class="pre">UKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft.html#UKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.UKS" title="Link to this definition">#</a></dt>
<dd><p>Unrestricted Kohn-Sham
See pyscf/dft/rks.py RKS class for document of the attributes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.X2C">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.</span></span><span class="sig-name descname"><span class="pre">X2C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft.html#X2C"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.dft.X2C" title="Link to this definition">#</a></dt>
<dd><p>X2C Kohn-Sham</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.dft.X2C_KS">
<span class="sig-prename descclassname"><span class="pre">pyscf.dft.</span></span><span class="sig-name descname"><span class="pre">X2C_KS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.dft.X2C_KS" title="Link to this definition">#</a></dt>
<dd><p>X2C Kohn-Sham</p>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subpackages">Subpackages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.LebedevGrid">pyscf.dft.LebedevGrid module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_110"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_110()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_1202"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_1202()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_14"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_14()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_1454"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_1454()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_146"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_146()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_170"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_170()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_1730"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_1730()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_194"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_194()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_2030"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_2030()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_230"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_230()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_2354"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_2354()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_26"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_26()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_266"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_266()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_2702"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_2702()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_302"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_302()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_3074"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_3074()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_3470"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_3470()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_350"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_350()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_38"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_38()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_3890"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_3890()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_4334"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_4334()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_434"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_434()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_4802"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_4802()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_50"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_50()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_5294"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_5294()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_5810"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_5810()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_590"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_590()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_6"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_6()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_74"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_74()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_770"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_770()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_86"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_86()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.MakeAngularGrid_974"><code class="docutils literal notranslate"><span class="pre">MakeAngularGrid_974()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.LebedevGrid.SphGenOh"><code class="docutils literal notranslate"><span class="pre">SphGenOh()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.dft_parser">pyscf.dft.dft_parser module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.dks">pyscf.dft.dks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.DKS"><code class="docutils literal notranslate"><span class="pre">DKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.DKS.CasidaTDDFT"><code class="docutils literal notranslate"><span class="pre">DKS.CasidaTDDFT</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.DKS.TDA"><code class="docutils literal notranslate"><span class="pre">DKS.TDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.DKS.TDDFT"><code class="docutils literal notranslate"><span class="pre">DKS.TDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.DKS.TDHF"><code class="docutils literal notranslate"><span class="pre">DKS.TDHF</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.DKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">DKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.DKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">DKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.DKS.x2c"><code class="docutils literal notranslate"><span class="pre">DKS.x2c()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.DKS.x2c1e"><code class="docutils literal notranslate"><span class="pre">DKS.x2c1e()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.collinear"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.collinear</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.dump_flags"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.energy_elec"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.get_veff"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.spin_samples"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.spin_samples</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.to_dhf"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_dhf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.to_dks"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_dks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.to_ghf"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_ghf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.to_gks"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_gks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.to_hf"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_hf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.to_ks"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_ks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.to_rhf"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_rhf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.to_rks"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_rks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.to_uhf"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_uhf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.KohnShamDFT.to_uks"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_uks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.RDKS"><code class="docutils literal notranslate"><span class="pre">RDKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.RDKS.CasidaTDDFT"><code class="docutils literal notranslate"><span class="pre">RDKS.CasidaTDDFT</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.RDKS.TDA"><code class="docutils literal notranslate"><span class="pre">RDKS.TDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.RDKS.TDDFT"><code class="docutils literal notranslate"><span class="pre">RDKS.TDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.RDKS.TDHF"><code class="docutils literal notranslate"><span class="pre">RDKS.TDHF</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.RDKS.to_dhf"><code class="docutils literal notranslate"><span class="pre">RDKS.to_dhf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.RDKS.x2c"><code class="docutils literal notranslate"><span class="pre">RDKS.x2c()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.RDKS.x2c1e"><code class="docutils literal notranslate"><span class="pre">RDKS.x2c1e()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.RKS"><code class="docutils literal notranslate"><span class="pre">RKS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.UDKS"><code class="docutils literal notranslate"><span class="pre">UDKS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.UKS"><code class="docutils literal notranslate"><span class="pre">UKS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.energy_elec"><code class="docutils literal notranslate"><span class="pre">energy_elec()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.dks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.gen_grid">pyscf.dft.gen_grid module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids"><code class="docutils literal notranslate"><span class="pre">Grids</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.alignment"><code class="docutils literal notranslate"><span class="pre">Grids.alignment</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.atomic_radii"><code class="docutils literal notranslate"><span class="pre">Grids.atomic_radii</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.becke_scheme"><code class="docutils literal notranslate"><span class="pre">Grids.becke_scheme()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.build"><code class="docutils literal notranslate"><span class="pre">Grids.build()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.cutoff"><code class="docutils literal notranslate"><span class="pre">Grids.cutoff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.dump_flags"><code class="docutils literal notranslate"><span class="pre">Grids.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.gen_atomic_grids"><code class="docutils literal notranslate"><span class="pre">Grids.gen_atomic_grids()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.gen_partition"><code class="docutils literal notranslate"><span class="pre">Grids.gen_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.get_partition"><code class="docutils literal notranslate"><span class="pre">Grids.get_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.kernel"><code class="docutils literal notranslate"><span class="pre">Grids.kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.level"><code class="docutils literal notranslate"><span class="pre">Grids.level</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.make_mask"><code class="docutils literal notranslate"><span class="pre">Grids.make_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.prune"><code class="docutils literal notranslate"><span class="pre">Grids.prune()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.prune_by_density_"><code class="docutils literal notranslate"><span class="pre">Grids.prune_by_density_()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.radi_method"><code class="docutils literal notranslate"><span class="pre">Grids.radi_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.radii_adjust"><code class="docutils literal notranslate"><span class="pre">Grids.radii_adjust()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.reset"><code class="docutils literal notranslate"><span class="pre">Grids.reset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.size"><code class="docutils literal notranslate"><span class="pre">Grids.size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.Grids.to_gpu"><code class="docutils literal notranslate"><span class="pre">Grids.to_gpu()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.arg_group_grids"><code class="docutils literal notranslate"><span class="pre">arg_group_grids()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.gen_atomic_grids"><code class="docutils literal notranslate"><span class="pre">gen_atomic_grids()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.gen_partition"><code class="docutils literal notranslate"><span class="pre">gen_partition()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.get_partition"><code class="docutils literal notranslate"><span class="pre">get_partition()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.make_mask"><code class="docutils literal notranslate"><span class="pre">make_mask()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.nwchem_prune"><code class="docutils literal notranslate"><span class="pre">nwchem_prune()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.original_becke"><code class="docutils literal notranslate"><span class="pre">original_becke()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.sg1_prune"><code class="docutils literal notranslate"><span class="pre">sg1_prune()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.stratmann"><code class="docutils literal notranslate"><span class="pre">stratmann()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gen_grid.treutler_prune"><code class="docutils literal notranslate"><span class="pre">treutler_prune()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.gks">pyscf.dft.gks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS"><code class="docutils literal notranslate"><span class="pre">GKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.CasidaTDDFT"><code class="docutils literal notranslate"><span class="pre">GKS.CasidaTDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.TDA"><code class="docutils literal notranslate"><span class="pre">GKS.TDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.TDDFT"><code class="docutils literal notranslate"><span class="pre">GKS.TDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.TDDFTNoHybrid"><code class="docutils literal notranslate"><span class="pre">GKS.TDDFTNoHybrid()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.TDHF"><code class="docutils literal notranslate"><span class="pre">GKS.TDHF</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.collinear"><code class="docutils literal notranslate"><span class="pre">GKS.collinear</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">GKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">GKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.get_veff"><code class="docutils literal notranslate"><span class="pre">GKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">GKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.spin_samples"><code class="docutils literal notranslate"><span class="pre">GKS.spin_samples</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">GKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.GKS.to_hf"><code class="docutils literal notranslate"><span class="pre">GKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.gks_symm">pyscf.dft.gks_symm module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS"><code class="docutils literal notranslate"><span class="pre">GKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS.CasidaTDDFT"><code class="docutils literal notranslate"><span class="pre">GKS.CasidaTDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS.TDA"><code class="docutils literal notranslate"><span class="pre">GKS.TDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS.TDDFT"><code class="docutils literal notranslate"><span class="pre">GKS.TDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS.TDDFTNoHybrid"><code class="docutils literal notranslate"><span class="pre">GKS.TDDFTNoHybrid()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS.TDHF"><code class="docutils literal notranslate"><span class="pre">GKS.TDHF</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS.collinear"><code class="docutils literal notranslate"><span class="pre">GKS.collinear</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">GKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">GKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS.get_veff"><code class="docutils literal notranslate"><span class="pre">GKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">GKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.gks_symm.GKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">GKS.to_gpu()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.libxc">pyscf.dft.libxc module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.available_libxc_functionals"><code class="docutils literal notranslate"><span class="pre">available_libxc_functionals()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.define_xc"><code class="docutils literal notranslate"><span class="pre">define_xc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.define_xc_"><code class="docutils literal notranslate"><span class="pre">define_xc_()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.eval_xc"><code class="docutils literal notranslate"><span class="pre">eval_xc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.eval_xc1"><code class="docutils literal notranslate"><span class="pre">eval_xc1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.eval_xc_eff"><code class="docutils literal notranslate"><span class="pre">eval_xc_eff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.hybrid_coeff"><code class="docutils literal notranslate"><span class="pre">hybrid_coeff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.is_gga"><code class="docutils literal notranslate"><span class="pre">is_gga()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.is_hybrid_xc"><code class="docutils literal notranslate"><span class="pre">is_hybrid_xc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.is_lda"><code class="docutils literal notranslate"><span class="pre">is_lda()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.is_meta_gga"><code class="docutils literal notranslate"><span class="pre">is_meta_gga()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.is_nlc"><code class="docutils literal notranslate"><span class="pre">is_nlc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.libxc_reference"><code class="docutils literal notranslate"><span class="pre">libxc_reference()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.libxc_reference_doi"><code class="docutils literal notranslate"><span class="pre">libxc_reference_doi()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.libxc_version"><code class="docutils literal notranslate"><span class="pre">libxc_version()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.max_deriv_order"><code class="docutils literal notranslate"><span class="pre">max_deriv_order()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.needs_laplacian"><code class="docutils literal notranslate"><span class="pre">needs_laplacian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.nlc_coeff"><code class="docutils literal notranslate"><span class="pre">nlc_coeff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.parse_xc"><code class="docutils literal notranslate"><span class="pre">parse_xc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.parse_xc_name"><code class="docutils literal notranslate"><span class="pre">parse_xc_name()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.print_XC_CODES"><code class="docutils literal notranslate"><span class="pre">print_XC_CODES()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.rsh_coeff"><code class="docutils literal notranslate"><span class="pre">rsh_coeff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.test_deriv_order"><code class="docutils literal notranslate"><span class="pre">test_deriv_order()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.xc_reference"><code class="docutils literal notranslate"><span class="pre">xc_reference()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.libxc.xc_type"><code class="docutils literal notranslate"><span class="pre">xc_type()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.numint">pyscf.dft.numint module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.LibXCMixin"><code class="docutils literal notranslate"><span class="pre">LibXCMixin</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.LibXCMixin.eval_xc"><code class="docutils literal notranslate"><span class="pre">LibXCMixin.eval_xc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.LibXCMixin.eval_xc1"><code class="docutils literal notranslate"><span class="pre">LibXCMixin.eval_xc1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.LibXCMixin.eval_xc_eff"><code class="docutils literal notranslate"><span class="pre">LibXCMixin.eval_xc_eff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.LibXCMixin.hybrid_coeff"><code class="docutils literal notranslate"><span class="pre">LibXCMixin.hybrid_coeff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.LibXCMixin.libxc"><code class="docutils literal notranslate"><span class="pre">LibXCMixin.libxc</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.LibXCMixin.nlc_coeff"><code class="docutils literal notranslate"><span class="pre">LibXCMixin.nlc_coeff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.LibXCMixin.omega"><code class="docutils literal notranslate"><span class="pre">LibXCMixin.omega</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.LibXCMixin.rsh_and_hybrid_coeff"><code class="docutils literal notranslate"><span class="pre">LibXCMixin.rsh_and_hybrid_coeff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.LibXCMixin.rsh_coeff"><code class="docutils literal notranslate"><span class="pre">LibXCMixin.rsh_coeff()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt"><code class="docutils literal notranslate"><span class="pre">NumInt</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.block_loop"><code class="docutils literal notranslate"><span class="pre">NumInt.block_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.cache_xc_kernel"><code class="docutils literal notranslate"><span class="pre">NumInt.cache_xc_kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.cache_xc_kernel1"><code class="docutils literal notranslate"><span class="pre">NumInt.cache_xc_kernel1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.cutoff"><code class="docutils literal notranslate"><span class="pre">NumInt.cutoff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.eval_ao"><code class="docutils literal notranslate"><span class="pre">NumInt.eval_ao()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.eval_rho"><code class="docutils literal notranslate"><span class="pre">NumInt.eval_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.eval_rho1"><code class="docutils literal notranslate"><span class="pre">NumInt.eval_rho1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.eval_rho2"><code class="docutils literal notranslate"><span class="pre">NumInt.eval_rho2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.get_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt.get_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.get_rho"><code class="docutils literal notranslate"><span class="pre">NumInt.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.get_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt.get_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.make_mask"><code class="docutils literal notranslate"><span class="pre">NumInt.make_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.nr_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.nr_nlc_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_nlc_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.nr_rks"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_rks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.nr_rks_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_rks_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.nr_rks_fxc_st"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_rks_fxc_st()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.nr_sap"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_sap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.nr_sap_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_sap_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.nr_uks"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_uks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.nr_uks_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_uks_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.nr_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.NumInt.to_gpu"><code class="docutils literal notranslate"><span class="pre">NumInt.to_gpu()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.cache_xc_kernel"><code class="docutils literal notranslate"><span class="pre">cache_xc_kernel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.cache_xc_kernel1"><code class="docutils literal notranslate"><span class="pre">cache_xc_kernel1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.eval_ao"><code class="docutils literal notranslate"><span class="pre">eval_ao()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.eval_mat"><code class="docutils literal notranslate"><span class="pre">eval_mat()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.eval_rho"><code class="docutils literal notranslate"><span class="pre">eval_rho()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.eval_rho1"><code class="docutils literal notranslate"><span class="pre">eval_rho1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.eval_rho2"><code class="docutils literal notranslate"><span class="pre">eval_rho2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.get_rho"><code class="docutils literal notranslate"><span class="pre">get_rho()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.nr_fxc"><code class="docutils literal notranslate"><span class="pre">nr_fxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.nr_nlc_vxc"><code class="docutils literal notranslate"><span class="pre">nr_nlc_vxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.nr_rks"><code class="docutils literal notranslate"><span class="pre">nr_rks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.nr_rks_fxc"><code class="docutils literal notranslate"><span class="pre">nr_rks_fxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.nr_rks_fxc_st"><code class="docutils literal notranslate"><span class="pre">nr_rks_fxc_st()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.nr_rks_vxc"><code class="docutils literal notranslate"><span class="pre">nr_rks_vxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.nr_sap_vxc"><code class="docutils literal notranslate"><span class="pre">nr_sap_vxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.nr_uks"><code class="docutils literal notranslate"><span class="pre">nr_uks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.nr_uks_fxc"><code class="docutils literal notranslate"><span class="pre">nr_uks_fxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.nr_uks_vxc"><code class="docutils literal notranslate"><span class="pre">nr_uks_vxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint.nr_vxc"><code class="docutils literal notranslate"><span class="pre">nr_vxc()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.numint2c">pyscf.dft.numint2c module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C"><code class="docutils literal notranslate"><span class="pre">NumInt2C</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.block_loop"><code class="docutils literal notranslate"><span class="pre">NumInt2C.block_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.cache_xc_kernel"><code class="docutils literal notranslate"><span class="pre">NumInt2C.cache_xc_kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.cache_xc_kernel1"><code class="docutils literal notranslate"><span class="pre">NumInt2C.cache_xc_kernel1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.collinear"><code class="docutils literal notranslate"><span class="pre">NumInt2C.collinear</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.collinear_samples"><code class="docutils literal notranslate"><span class="pre">NumInt2C.collinear_samples</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.collinear_thrd"><code class="docutils literal notranslate"><span class="pre">NumInt2C.collinear_thrd</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.eval_ao"><code class="docutils literal notranslate"><span class="pre">NumInt2C.eval_ao()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.eval_rho"><code class="docutils literal notranslate"><span class="pre">NumInt2C.eval_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.eval_rho1"><code class="docutils literal notranslate"><span class="pre">NumInt2C.eval_rho1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.eval_rho2"><code class="docutils literal notranslate"><span class="pre">NumInt2C.eval_rho2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.eval_xc_eff"><code class="docutils literal notranslate"><span class="pre">NumInt2C.eval_xc_eff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.get_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.get_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.get_rho"><code class="docutils literal notranslate"><span class="pre">NumInt2C.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.get_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.get_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.make_mask"><code class="docutils literal notranslate"><span class="pre">NumInt2C.make_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.mcfun_eval_xc_adapter"><code class="docutils literal notranslate"><span class="pre">NumInt2C.mcfun_eval_xc_adapter()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.nr_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.nr_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.nr_gks_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.nr_gks_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.nr_gks_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.nr_gks_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.nr_nlc_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.nr_nlc_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.nr_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.nr_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.NumInt2C.spin_samples"><code class="docutils literal notranslate"><span class="pre">NumInt2C.spin_samples</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.eval_rho"><code class="docutils literal notranslate"><span class="pre">eval_rho()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.numint2c.mcfun_eval_xc_adapter"><code class="docutils literal notranslate"><span class="pre">mcfun_eval_xc_adapter()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.r_numint">pyscf.dft.r_numint module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt"><code class="docutils literal notranslate"><span class="pre">RNumInt</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.block_loop"><code class="docutils literal notranslate"><span class="pre">RNumInt.block_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.cache_xc_kernel"><code class="docutils literal notranslate"><span class="pre">RNumInt.cache_xc_kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.cache_xc_kernel1"><code class="docutils literal notranslate"><span class="pre">RNumInt.cache_xc_kernel1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.collinear"><code class="docutils literal notranslate"><span class="pre">RNumInt.collinear</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.collinear_samples"><code class="docutils literal notranslate"><span class="pre">RNumInt.collinear_samples</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.collinear_thrd"><code class="docutils literal notranslate"><span class="pre">RNumInt.collinear_thrd</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.eval_ao"><code class="docutils literal notranslate"><span class="pre">RNumInt.eval_ao()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.eval_rho"><code class="docutils literal notranslate"><span class="pre">RNumInt.eval_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.eval_rho1"><code class="docutils literal notranslate"><span class="pre">RNumInt.eval_rho1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.eval_rho2"><code class="docutils literal notranslate"><span class="pre">RNumInt.eval_rho2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.eval_xc_eff"><code class="docutils literal notranslate"><span class="pre">RNumInt.eval_xc_eff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.get_fxc"><code class="docutils literal notranslate"><span class="pre">RNumInt.get_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.get_rho"><code class="docutils literal notranslate"><span class="pre">RNumInt.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.get_vxc"><code class="docutils literal notranslate"><span class="pre">RNumInt.get_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.mcfun_eval_xc_adapter"><code class="docutils literal notranslate"><span class="pre">RNumInt.mcfun_eval_xc_adapter()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.r_fxc"><code class="docutils literal notranslate"><span class="pre">RNumInt.r_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.r_vxc"><code class="docutils literal notranslate"><span class="pre">RNumInt.r_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.RNumInt.spin_samples"><code class="docutils literal notranslate"><span class="pre">RNumInt.spin_samples</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.cache_xc_kernel"><code class="docutils literal notranslate"><span class="pre">cache_xc_kernel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.cache_xc_kernel1"><code class="docutils literal notranslate"><span class="pre">cache_xc_kernel1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.eval_ao"><code class="docutils literal notranslate"><span class="pre">eval_ao()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.eval_rho"><code class="docutils literal notranslate"><span class="pre">eval_rho()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.get_rho"><code class="docutils literal notranslate"><span class="pre">get_rho()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.r_fxc"><code class="docutils literal notranslate"><span class="pre">r_fxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.r_numint.r_vxc"><code class="docutils literal notranslate"><span class="pre">r_vxc()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.radi">pyscf.dft.radi module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.radi.becke"><code class="docutils literal notranslate"><span class="pre">becke()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.radi.becke_atomic_radii_adjust"><code class="docutils literal notranslate"><span class="pre">becke_atomic_radii_adjust()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.radi.delley"><code class="docutils literal notranslate"><span class="pre">delley()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.radi.gauss_chebyshev"><code class="docutils literal notranslate"><span class="pre">gauss_chebyshev()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.radi.gauss_legendre"><code class="docutils literal notranslate"><span class="pre">gauss_legendre()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.radi.mura_knowles"><code class="docutils literal notranslate"><span class="pre">mura_knowles()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.radi.murray"><code class="docutils literal notranslate"><span class="pre">murray()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.radi.treutler"><code class="docutils literal notranslate"><span class="pre">treutler()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.radi.treutler_ahlrichs"><code class="docutils literal notranslate"><span class="pre">treutler_ahlrichs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.radi.treutler_atomic_radii_adjust"><code class="docutils literal notranslate"><span class="pre">treutler_atomic_radii_adjust()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.rks">pyscf.dft.rks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.check_sanity"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.check_sanity()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.define_xc_"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.define_xc_()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.do_nlc"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.do_nlc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.dump_flags"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.initialize_grids"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.initialize_grids()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.omega"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.omega</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.reset"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.reset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.to_ghf"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_ghf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.to_gks"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_gks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.to_gpu"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.to_hf"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_hf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.to_rhf"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_rhf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.to_rks"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_rks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.to_uhf"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_uhf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.KohnShamDFT.to_uks"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_uks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS"><code class="docutils literal notranslate"><span class="pre">RKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.CasidaTDDFT"><code class="docutils literal notranslate"><span class="pre">RKS.CasidaTDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.Gradients"><code class="docutils literal notranslate"><span class="pre">RKS.Gradients()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.Hessian"><code class="docutils literal notranslate"><span class="pre">RKS.Hessian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.TDA"><code class="docutils literal notranslate"><span class="pre">RKS.TDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.TDDFT"><code class="docutils literal notranslate"><span class="pre">RKS.TDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.TDDFTNoHybrid"><code class="docutils literal notranslate"><span class="pre">RKS.TDDFTNoHybrid()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.TDHF"><code class="docutils literal notranslate"><span class="pre">RKS.TDHF</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.dRPA"><code class="docutils literal notranslate"><span class="pre">RKS.dRPA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.dTDA"><code class="docutils literal notranslate"><span class="pre">RKS.dTDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">RKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">RKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.get_veff"><code class="docutils literal notranslate"><span class="pre">RKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.get_vsap"><code class="docutils literal notranslate"><span class="pre">RKS.get_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.init_guess_by_vsap"><code class="docutils literal notranslate"><span class="pre">RKS.init_guess_by_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">RKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">RKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.RKS.to_hf"><code class="docutils literal notranslate"><span class="pre">RKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.define_xc_"><code class="docutils literal notranslate"><span class="pre">define_xc_()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.energy_elec"><code class="docutils literal notranslate"><span class="pre">energy_elec()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.get_vsap"><code class="docutils literal notranslate"><span class="pre">get_vsap()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.init_guess_by_vsap"><code class="docutils literal notranslate"><span class="pre">init_guess_by_vsap()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks.prune_small_rho_grids_"><code class="docutils literal notranslate"><span class="pre">prune_small_rho_grids_()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.rks_symm">pyscf.dft.rks_symm module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.RKS"><code class="docutils literal notranslate"><span class="pre">RKS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.ROKS"><code class="docutils literal notranslate"><span class="pre">ROKS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.CasidaTDDFT"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.CasidaTDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.Gradients"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.Gradients()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.Hessian"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.Hessian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.TDA"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.TDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.TDDFT"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.TDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.TDDFTNoHybrid"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.TDDFTNoHybrid()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.TDHF"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.TDHF</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.dRPA"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.dRPA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.dTDA"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.dTDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.get_veff"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.get_vsap"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.get_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.init_guess_by_vsap"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.init_guess_by_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedRKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">SymAdaptedRKS.to_gpu()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.Gradients"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.Gradients()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.Hessian"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.Hessian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.TDA"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.TDA</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.TDDFT"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.TDDFT</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.TDDFTNoHybrid"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.TDDFTNoHybrid</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.TDHF"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.TDHF</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.dRPA"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.dRPA</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.dTDA"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.dTDA</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.get_veff"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.get_vsap"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.get_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.init_guess_by_vsap"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.init_guess_by_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.rks_symm.SymAdaptedROKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">SymAdaptedROKS.to_gpu()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.roks">pyscf.dft.roks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS"><code class="docutils literal notranslate"><span class="pre">ROKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.Gradients"><code class="docutils literal notranslate"><span class="pre">ROKS.Gradients()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.Hessian"><code class="docutils literal notranslate"><span class="pre">ROKS.Hessian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.TDA"><code class="docutils literal notranslate"><span class="pre">ROKS.TDA</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.TDDFT"><code class="docutils literal notranslate"><span class="pre">ROKS.TDDFT</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.TDDFTNoHybrid"><code class="docutils literal notranslate"><span class="pre">ROKS.TDDFTNoHybrid</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.TDHF"><code class="docutils literal notranslate"><span class="pre">ROKS.TDHF</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.dRPA"><code class="docutils literal notranslate"><span class="pre">ROKS.dRPA</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.dTDA"><code class="docutils literal notranslate"><span class="pre">ROKS.dTDA</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">ROKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">ROKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.get_veff"><code class="docutils literal notranslate"><span class="pre">ROKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.get_vsap"><code class="docutils literal notranslate"><span class="pre">ROKS.get_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.init_guess_by_vsap"><code class="docutils literal notranslate"><span class="pre">ROKS.init_guess_by_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">ROKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">ROKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.ROKS.to_hf"><code class="docutils literal notranslate"><span class="pre">ROKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.roks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.sap">pyscf.dft.sap module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.sap.sap_effective_charge"><code class="docutils literal notranslate"><span class="pre">sap_effective_charge()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.sap_data">pyscf.dft.sap_data module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.uks">pyscf.dft.uks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS"><code class="docutils literal notranslate"><span class="pre">UKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.CasidaTDDFT"><code class="docutils literal notranslate"><span class="pre">UKS.CasidaTDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.Gradients"><code class="docutils literal notranslate"><span class="pre">UKS.Gradients()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.Hessian"><code class="docutils literal notranslate"><span class="pre">UKS.Hessian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.TDA"><code class="docutils literal notranslate"><span class="pre">UKS.TDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.TDDFT"><code class="docutils literal notranslate"><span class="pre">UKS.TDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.TDDFTNoHybrid"><code class="docutils literal notranslate"><span class="pre">UKS.TDDFTNoHybrid()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.TDHF"><code class="docutils literal notranslate"><span class="pre">UKS.TDHF</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.dRPA"><code class="docutils literal notranslate"><span class="pre">UKS.dRPA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.dTDA"><code class="docutils literal notranslate"><span class="pre">UKS.dTDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">UKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">UKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.get_veff"><code class="docutils literal notranslate"><span class="pre">UKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.get_vsap"><code class="docutils literal notranslate"><span class="pre">UKS.get_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.init_guess_by_vsap"><code class="docutils literal notranslate"><span class="pre">UKS.init_guess_by_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.initialize_grids"><code class="docutils literal notranslate"><span class="pre">UKS.initialize_grids()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">UKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">UKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.UKS.to_hf"><code class="docutils literal notranslate"><span class="pre">UKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.energy_elec"><code class="docutils literal notranslate"><span class="pre">energy_elec()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks.get_vsap"><code class="docutils literal notranslate"><span class="pre">get_vsap()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.uks_symm">pyscf.dft.uks_symm module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.CasidaTDDFT"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.CasidaTDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.Gradients"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.Gradients()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.Hessian"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.Hessian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.TDA"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.TDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.TDDFT"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.TDDFT()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.TDDFTNoHybrid"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.TDDFTNoHybrid()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.TDHF"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.TDHF</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.dRPA"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.dRPA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.dTDA"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.dTDA()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.get_veff"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.get_vsap"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.get_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.init_guess_by_vsap"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.init_guess_by_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.SymAdaptedUKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">SymAdaptedUKS.to_gpu()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.uks_symm.UKS"><code class="docutils literal notranslate"><span class="pre">UKS</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.xc_deriv">pyscf.dft.xc_deriv module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xc_deriv.count_combinations"><code class="docutils literal notranslate"><span class="pre">count_combinations()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xc_deriv.transform_fxc"><code class="docutils literal notranslate"><span class="pre">transform_fxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xc_deriv.transform_kxc"><code class="docutils literal notranslate"><span class="pre">transform_kxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xc_deriv.transform_lxc"><code class="docutils literal notranslate"><span class="pre">transform_lxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xc_deriv.transform_vxc"><code class="docutils literal notranslate"><span class="pre">transform_vxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xc_deriv.transform_xc"><code class="docutils literal notranslate"><span class="pre">transform_xc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xc_deriv.ts2ud"><code class="docutils literal notranslate"><span class="pre">ts2ud()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xc_deriv.ud2ts"><code class="docutils literal notranslate"><span class="pre">ud2ts()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft.xcfun">pyscf.dft.xcfun module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.define_xc"><code class="docutils literal notranslate"><span class="pre">define_xc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.define_xc_"><code class="docutils literal notranslate"><span class="pre">define_xc_()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.eval_xc"><code class="docutils literal notranslate"><span class="pre">eval_xc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.eval_xc1"><code class="docutils literal notranslate"><span class="pre">eval_xc1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.eval_xc_eff"><code class="docutils literal notranslate"><span class="pre">eval_xc_eff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.hybrid_coeff"><code class="docutils literal notranslate"><span class="pre">hybrid_coeff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.is_gga"><code class="docutils literal notranslate"><span class="pre">is_gga()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.is_hybrid_xc"><code class="docutils literal notranslate"><span class="pre">is_hybrid_xc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.is_lda"><code class="docutils literal notranslate"><span class="pre">is_lda()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.is_meta_gga"><code class="docutils literal notranslate"><span class="pre">is_meta_gga()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.is_nlc"><code class="docutils literal notranslate"><span class="pre">is_nlc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.max_deriv_order"><code class="docutils literal notranslate"><span class="pre">max_deriv_order()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.nlc_coeff"><code class="docutils literal notranslate"><span class="pre">nlc_coeff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.parse_xc"><code class="docutils literal notranslate"><span class="pre">parse_xc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.parse_xc_name"><code class="docutils literal notranslate"><span class="pre">parse_xc_name()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.print_XC_CODES"><code class="docutils literal notranslate"><span class="pre">print_XC_CODES()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.rsh_coeff"><code class="docutils literal notranslate"><span class="pre">rsh_coeff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.test_deriv_order"><code class="docutils literal notranslate"><span class="pre">test_deriv_order()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.xcfun.xc_type"><code class="docutils literal notranslate"><span class="pre">xc_type()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.dft">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#density-functional-theory">Density functional theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.DFT"><code class="docutils literal notranslate"><span class="pre">DFT()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.DKS"><code class="docutils literal notranslate"><span class="pre">DKS()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.GKS"><code class="docutils literal notranslate"><span class="pre">GKS()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.KS"><code class="docutils literal notranslate"><span class="pre">KS()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.RKS"><code class="docutils literal notranslate"><span class="pre">RKS()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.ROKS"><code class="docutils literal notranslate"><span class="pre">ROKS()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.UKS"><code class="docutils literal notranslate"><span class="pre">UKS()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.X2C"><code class="docutils literal notranslate"><span class="pre">X2C()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.dft.X2C_KS"><code class="docutils literal notranslate"><span class="pre">X2C_KS()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/pyscf/pyscf.github.io/edit/master/source/pyscf_api_docs/pyscf.dft.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright 2024, The PySCF Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>