
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>5.1.14. pyscf.fci package &#8212; PySCF 2.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pyscf.geomopt package" href="pyscf.geomopt.html" />
    <link rel="prev" title="5.1.13.1.1. pyscf.extras.mbd package" href="pyscf.extras.mbd.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=amber>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#pyscf_api_docs/pyscf.fci" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="PySCF 2.0.0 documentation"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/pyscf-logo-white.svg" height="26"
                   alt="PySCF 2.0.0 documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.0</span>
          <span class="md-header-nav__topic"> 5.1.14. pyscf.fci package </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../overview.html" class="md-tabs__link">Overview</a></li>
            
            <li class="md-tabs__item"><a href="../install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../quickstart.html" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../about.html" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="pyscf.html" class="md-tabs__link"><span class="section-number">5. </span>pyscf package</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="PySCF 2.0.0 documentation" class="md-nav__button md-logo">
      
        <img src="../_static/pyscf-logo-white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="PySCF 2.0.0 documentation">PySCF 2.0</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html" class="md-nav__link">2. Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickstart.html" class="md-nav__link">Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../user.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html" class="md-nav__link">5. API</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#subpackages" class="md-nav__link">5.1. Subpackages</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#submodules" class="md-nav__link">5.2. Submodules</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf.post_scf" class="md-nav__link">5.3. pyscf.post_scf module</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf" class="md-nav__link">5.4. Module contents</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../interface.html" class="md-nav__link">6. Interface</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about.html" class="md-nav__link">7. About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#pyscf-api-docs-pyscf-fci--page-root" class="md-nav__link">5.1.14. pyscf.fci package</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#submodules" class="md-nav__link">5.1.14.1. Submodules</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.addons" class="md-nav__link">5.1.14.2. pyscf.fci.addons module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.cistring" class="md-nav__link">5.1.14.3. pyscf.fci.cistring module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_ep" class="md-nav__link">5.1.14.4. pyscf.fci.direct_ep module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_nosym" class="md-nav__link">5.1.14.5. pyscf.fci.direct_nosym module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_spin0" class="md-nav__link">5.1.14.6. pyscf.fci.direct_spin0 module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_spin0_symm" class="md-nav__link">5.1.14.7. pyscf.fci.direct_spin0_symm module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_spin1" class="md-nav__link">5.1.14.8. pyscf.fci.direct_spin1 module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_spin1_symm" class="md-nav__link">5.1.14.9. pyscf.fci.direct_spin1_symm module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_uhf" class="md-nav__link">5.1.14.10. pyscf.fci.direct_uhf module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.fci_slow" class="md-nav__link">5.1.14.11. pyscf.fci.fci_slow module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.rdm" class="md-nav__link">5.1.14.12. pyscf.fci.rdm module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.selected_ci" class="md-nav__link">5.1.14.13. pyscf.fci.selected_ci module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.selected_ci_slow" class="md-nav__link">5.1.14.14. pyscf.fci.selected_ci_slow module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.selected_ci_spin0" class="md-nav__link">5.1.14.15. pyscf.fci.selected_ci_spin0 module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.selected_ci_spin0_symm" class="md-nav__link">5.1.14.16. pyscf.fci.selected_ci_spin0_symm module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.selected_ci_symm" class="md-nav__link">5.1.14.17. pyscf.fci.selected_ci_symm module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.spin_op" class="md-nav__link">5.1.14.18. pyscf.fci.spin_op module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci" class="md-nav__link">5.1.14.19. Module contents</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/pyscf_api_docs/pyscf.fci.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="pyscf-api-docs-pyscf-fci--page-root">pyscf.fci package<a class="headerlink" href="#pyscf-api-docs-pyscf-fci--page-root" title="Permalink to this headline">¶</a></h1>

<h2 id="submodules">Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>


<span id="pyscf-fci-addons-module"></span><h2 id="module-pyscf.fci.addons">pyscf.fci.addons module<a class="headerlink" href="#module-pyscf.fci.addons" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyscf.fci.addons.cre_a">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">cre_a</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ci0</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">neleca_nelecb</span></em>, <em class="sig-param"><span class="n">ap_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#cre_a"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.cre_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct (N+1)-electron wavefunction by adding an alpha electron in
the N-electron wavefunction.</p>
<p>… math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span>\<span class="n">rangle</span> <span class="o">=</span> \<span class="n">hat</span><span class="p">{</span><span class="n">a</span><span class="p">}</span><span class="o">^+</span><span class="n">_p</span> <span class="o">|</span><span class="n">N</span>\<span class="n">rangle</span>
</pre></div>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci0<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>(neleca,nelecb)<span class="classifier">(int,int)</span></dt><dd><p>Number of (alpha, beta) electrons of the input CI function</p>
</dd>
<dt>ap_id<span class="classifier">int</span></dt><dd><p>Orbital index (0-based), for the creation operator</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array, row for alpha strings and column for beta strings. Note it
has different number of rows to the input CI coefficients.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.cre_b">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">cre_b</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ci0</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">neleca_nelecb</span></em>, <em class="sig-param"><span class="n">ap_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#cre_b"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.cre_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct (N+1)-electron wavefunction by adding a beta electron in
the N-electron wavefunction.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci0<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>(neleca,nelecb)<span class="classifier">(int,int)</span></dt><dd><p>Number of (alpha, beta) electrons of the input CI function</p>
</dd>
<dt>ap_id<span class="classifier">int</span></dt><dd><p>Orbital index (0-based), for the creation operator</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array, row for alpha strings and column for beta strings. Note it
has different number of columns to the input CI coefficients.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.cylindrical_init_guess">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">cylindrical_init_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">orbsym</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">singlet</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#cylindrical_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.cylindrical_init_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>FCI initial guess for system of cylindrical symmetry.
(In testing)</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'O; O 1 1.2'</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orbsym</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ci0</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">cylindrical_init_guess</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">orbsym</span><span class="p">,</span> <span class="n">wfnsym</span><span class="o">=</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ci0</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ci0</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">cylindrical_init_guess</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">orbsym</span><span class="p">,</span> <span class="n">wfnsym</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ci0</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.des_a">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">des_a</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ci0</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">neleca_nelecb</span></em>, <em class="sig-param"><span class="n">ap_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#des_a"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.des_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct (N-1)-electron wavefunction by removing an alpha electron from
the N-electron wavefunction.</p>
<p>… math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span>\<span class="n">rangle</span> <span class="o">=</span> \<span class="n">hat</span><span class="p">{</span><span class="n">a</span><span class="p">}</span><span class="n">_p</span> <span class="o">|</span><span class="n">N</span>\<span class="n">rangle</span>
</pre></div>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci0<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>(neleca,nelecb)<span class="classifier">(int,int)</span></dt><dd><p>Number of (alpha, beta) electrons of the input CI function</p>
</dd>
<dt>ap_id<span class="classifier">int</span></dt><dd><p>Orbital index (0-based), for the annihilation operator</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array, row for alpha strings and column for beta strings.  Note it
has different number of rows to the input CI coefficients</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.des_b">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">des_b</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ci0</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">neleca_nelecb</span></em>, <em class="sig-param"><span class="n">ap_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#des_b"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.des_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct (N-1)-electron wavefunction by removing a beta electron from
N-electron wavefunction.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci0<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>(neleca,nelecb)<span class="classifier">(int,int)</span></dt><dd><p>Number of (alpha, beta) electrons of the input CI function</p>
</dd>
<dt>ap_id<span class="classifier">int</span></dt><dd><p>Orbital index (0-based), for the annihilation operator</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array, row for alpha strings and column for beta strings. Note it
has different number of columns to the input CI coefficients.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.det_overlap">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">det_overlap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">string1</span></em>, <em class="sig-param"><span class="n">string2</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">s</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#det_overlap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.det_overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Determinants overlap on non-orthogonal one-particle basis</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.fix_spin">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">fix_spin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciobj</span></em>, <em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">ss</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#fix_spin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.fix_spin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.fix_spin_">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">fix_spin_</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fciobj</span></em>, <em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">ss</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#fix_spin_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.fix_spin_" title="Permalink to this definition">¶</a></dt>
<dd><p>If FCI solver cannot stay on spin eigenfunction, this function can
add a shift to the states which have wrong spin.</p>
<div class="math notranslate nohighlight">
\[(H + shift*S^2) |\Psi\rangle = E |\Psi\rangle\]</div>
<dl class="simple">
<dt>Args:</dt><dd><p>fciobj : An instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shift<span class="classifier">float</span></dt><dd><p>Level shift for states which have different spin</p>
</dd>
<dt>ss<span class="classifier">number</span></dt><dd><p>S^2 expection value == s*(s+1)</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>A modified FCI object based on fciobj.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.guess_wfnsym">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">guess_wfnsym</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ci</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">orbsym</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#guess_wfnsym"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.guess_wfnsym" title="Permalink to this definition">¶</a></dt>
<dd><p>Guess the wavefunction symmetry based on the non-zero elements in the
given CI coefficients.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>nelec<span class="classifier">int or 2-item list</span></dt><dd><p>Number of electrons, or 2-item list for (alpha, beta) electrons</p>
</dd>
<dt>orbsym<span class="classifier">list of int</span></dt><dd><p>The irrep ID for each orbital.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Irrep ID</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.initguess_triplet">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">initguess_triplet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">binstring</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#initguess_triplet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.initguess_triplet" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a triplet initial guess for FCI solver</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.large_ci">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">large_ci</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ci</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">return_strs</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#large_ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.large_ci" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for the largest CI coefficients</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.overlap">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">overlap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bra</span></em>, <em class="sig-param"><span class="n">ket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">s</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#overlap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Overlap between two CI wavefunctions</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>s<span class="classifier">2D array or a list of 2D array</span></dt><dd><p>The overlap matrix of non-orthogonal one-particle basis</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.symm_initguess">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">symm_initguess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">orbsym</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">irrep_nelec</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#symm_initguess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.symm_initguess" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate CI wavefunction initial guess which has the given symmetry.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>nelec<span class="classifier">int or 2-item list</span></dt><dd><p>Number of electrons, or 2-item list for (alpha, beta) electrons</p>
</dd>
<dt>orbsym<span class="classifier">list of int</span></dt><dd><p>The irrep ID for each orbital.</p>
</dd>
</dl>
</dd>
<dt>Kwags:</dt><dd><dl class="simple">
<dt>wfnsym<span class="classifier">int</span></dt><dd><p>The irrep ID of target symmetry</p>
</dd>
<dt>irrep_nelec<span class="classifier">dict</span></dt><dd><p>Freeze occupancy for certain irreps</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>CI coefficients 2D array which has the target symmetry.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.symmetrize_wfn">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">symmetrize_wfn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ci</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">orbsym</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#symmetrize_wfn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.symmetrize_wfn" title="Permalink to this definition">¶</a></dt>
<dd><p>Symmetrize the CI wavefunction by zeroing out the determinants which
do not have the right symmetry.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>nelec<span class="classifier">int or 2-item list</span></dt><dd><p>Number of electrons, or 2-item list for (alpha, beta) electrons</p>
</dd>
<dt>orbsym<span class="classifier">list of int</span></dt><dd><p>The irrep ID for each orbital.</p>
</dd>
</dl>
</dd>
<dt>Kwags:</dt><dd><dl class="simple">
<dt>wfnsym<span class="classifier">int</span></dt><dd><p>The irrep ID of target symmetry</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array which is the symmetrized CI coefficients</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.transform_ci">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">transform_ci</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ci</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">u</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#transform_ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.transform_ci" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform CI coefficients to the representation in new one-particle basis.
Solving CI problem for Hamiltonian h1, h2 defined in old basis,
CI_old = fci.kernel(h1, h2, …)
Given orbital rotation u, the CI problem can be either solved by
transforming the Hamiltonian, or transforming the coefficients.
CI_new = fci.kernel(u^T*h1*u, …) = transform_ci_for_orbital_rotation(CI_old, u)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>u<span class="classifier">2D array or a list of 2D array</span></dt><dd><p>the orbital rotation to transform the old one-particle basis to new
one-particle basis. If u is not a squared matrix, the resultant CI
coefficients array may have different shape to the input CI
coefficients.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.addons.transform_ci_for_orbital_rotation">
<code class="sig-prename descclassname">pyscf.fci.addons.</code><code class="sig-name descname">transform_ci_for_orbital_rotation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ci</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">u</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#transform_ci_for_orbital_rotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.addons.transform_ci_for_orbital_rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform CI coefficients (dimension conserved) to the representation in
new one-particle basis.  Solving CI problem for Hamiltonian h1, h2 defined
in old basis,
CI_old = fci.kernel(h1, h2, …)
Given orbital rotation u, the CI problem can be either solved by
transforming the Hamiltonian, or transforming the coefficients.
CI_new = fci.kernel(u^T*h1*u, …) = transform_ci_for_orbital_rotation(CI_old, u)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>u<span class="classifier">a squared 2D array or a list of 2D array</span></dt><dd><p>the orbital rotation to transform the old one-particle basis to new
one-particle basis</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>


<span id="pyscf-fci-cistring-module"></span><h2 id="module-pyscf.fci.cistring">pyscf.fci.cistring module<a class="headerlink" href="#module-pyscf.fci.cistring" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyscf.fci.cistring.OIndexList">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">OIndexList</code><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#OIndexList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.OIndexList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.addr2str">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">addr2str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">addr</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#addr2str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.addr2str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert CI determinant address to string</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.addr2str_o0">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">addr2str_o0</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">addr</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#addr2str_o0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.addr2str_o0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.addr2str_o1">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">addr2str_o1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">addr</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#addr2str_o1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.addr2str_o1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.addrs2str">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">addrs2str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">addrs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#addrs2str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.addrs2str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of CI determinant address to string</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.cre_des_sign">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">cre_des_sign</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">q</span></em>, <em class="sig-param"><span class="n">string0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#cre_des_sign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.cre_des_sign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.cre_sign">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">cre_sign</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">string0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#cre_sign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.cre_sign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.des_sign">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">des_sign</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">string0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#des_sign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.des_sign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.gen_cre_str_index">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">gen_cre_str_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_cre_str_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_cre_str_index" title="Permalink to this definition">¶</a></dt>
<dd><p>linkstr_index to map between N electron string to N+1 electron string.
It maps the given string to the address of the string which is generated by
the creation operator.</p>
<p>For given string str0, index[str0] is nvir x 4 array.  Each entry
[i(cre),–,str1,sign] means starting from str0, creating i, to get str1.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.gen_cre_str_index_o0">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">gen_cre_str_index_o0</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_cre_str_index_o0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_cre_str_index_o0" title="Permalink to this definition">¶</a></dt>
<dd><p>Slow version of gen_cre_str_index function</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.gen_cre_str_index_o1">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">gen_cre_str_index_o1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_cre_str_index_o1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_cre_str_index_o1" title="Permalink to this definition">¶</a></dt>
<dd><p>C implementation of gen_cre_str_index function</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.gen_des_str_index">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">gen_des_str_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_des_str_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_des_str_index" title="Permalink to this definition">¶</a></dt>
<dd><p>linkstr_index to map between N electron string to N-1 electron string.
It maps the given string to the address of the string which is generated by
the annihilation operator.</p>
<p>For given string str0, index[str0] is nvir x 4 array.  Each entry
[–,i(des),str1,sign] means starting from str0, annihilating i, to get str1.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.gen_des_str_index_o0">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">gen_des_str_index_o0</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_des_str_index_o0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_des_str_index_o0" title="Permalink to this definition">¶</a></dt>
<dd><p>Slow version of gen_des_str_index function</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.gen_des_str_index_o1">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">gen_des_str_index_o1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_des_str_index_o1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_des_str_index_o1" title="Permalink to this definition">¶</a></dt>
<dd><p>C implementation of gen_des_str_index function</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.gen_linkstr_index">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">gen_linkstr_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nocc</span></em>, <em class="sig-param"><span class="n">strs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tril</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_linkstr_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_linkstr_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Look up table, for the strings relationship in terms of a
creation-annihilating operator pair.</p>
<p>For given string str0, index[str0] is (nocc+nocc*nvir) x 4 array.
The first nocc rows [i(:occ),i(:occ),str0,sign] are occupied-occupied
excitations, which do not change the string. The next nocc*nvir rows
[a(:vir),i(:occ),str1,sign] are occupied-virtual exciations, starting from
str0, annihilating i, creating a, to get str1.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.gen_linkstr_index_o0">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">gen_linkstr_index_o0</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">strs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_linkstr_index_o0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_linkstr_index_o0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.gen_linkstr_index_o1">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">gen_linkstr_index_o1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">strs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tril</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_linkstr_index_o1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_linkstr_index_o1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.gen_linkstr_index_trilidx">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">gen_linkstr_index_trilidx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nocc</span></em>, <em class="sig-param"><span class="n">strs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_linkstr_index_trilidx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_linkstr_index_trilidx" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate linkstr_index with the assumption that <span class="math notranslate nohighlight">\(p^+ q|0\rangle\)</span>
where <span class="math notranslate nohighlight">\(p &gt; q\)</span>.
So the resultant link_index has the structure <code class="docutils literal notranslate"><span class="pre">[pq,</span> <span class="pre">*,</span> <span class="pre">str1,</span> <span class="pre">sign]</span></code>.
It is identical to a call to <code class="docutils literal notranslate"><span class="pre">reform_linkstr_index(gen_linkstr_index(...))</span></code>.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.gen_strings4orblist">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">gen_strings4orblist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.cistring.gen_strings4orblist" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate string from the given orbital list.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>list of int64.  One int64 element represents one string in binary format.
The binary format takes the convention that the one bit stands for one
orbital, bit-1 means occupied and bit-0 means unoccupied.  The lowest
(right-most) bit corresponds to the lowest orbital in the orb_list.</p>
</dd>
</dl>
<p>Exampels:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">make_strings</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[0b11, 0b101, 0b110, 0b1001, 0b1010, 0b1100]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">make_strings</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[0b1010, 0b1001, 0b11, 0b1100, 0b110, 0b101]</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.make_strings">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">make_strings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orb_list</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#make_strings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.make_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate string from the given orbital list.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>list of int64.  One int64 element represents one string in binary format.
The binary format takes the convention that the one bit stands for one
orbital, bit-1 means occupied and bit-0 means unoccupied.  The lowest
(right-most) bit corresponds to the lowest orbital in the orb_list.</p>
</dd>
</dl>
<p>Exampels:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">make_strings</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[0b11, 0b101, 0b110, 0b1001, 0b1010, 0b1100]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">make_strings</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[0b1010, 0b1001, 0b11, 0b1100, 0b110, 0b101]</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.num_strings">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">num_strings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">m</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#num_strings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.num_strings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.parity">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">parity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">string0</span></em>, <em class="sig-param"><span class="n">string1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#parity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.parity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.reform_linkstr_index">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">reform_linkstr_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">link_index</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#reform_linkstr_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.reform_linkstr_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Compress the (a, i) pair index in linkstr_index to a lower triangular
index. The compressed indices can match the 4-fold symmetry of integrals.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.str2addr">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">str2addr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">string</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#str2addr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.str2addr" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert string to CI determinant address</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.strs2addr">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">strs2addr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">strings</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#strs2addr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.strs2addr" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of string to CI determinant address</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.sub_addrs">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">sub_addrs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">orbital_indices</span></em>, <em class="sig-param"><span class="n">sub_nelec</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#sub_addrs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.sub_addrs" title="Permalink to this definition">¶</a></dt>
<dd><p>The addresses of the determinants which include the specified orbital
indices. The size of the returned addresses is equal to the number of
determinants of (norb, nelec) system.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.cistring.tn_strs">
<code class="sig-prename descclassname">pyscf.fci.cistring.</code><code class="sig-name descname">tn_strs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#tn_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.cistring.tn_strs" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate strings for Tn amplitudes.  Eg n=1 (T1) has nvir*nocc strings,
n=2 (T2) has nvir*(nvir-1)/2 * nocc*(nocc-1)/2 strings.</p>
</dd></dl>


<span id="pyscf-fci-direct-ep-module"></span><h2 id="module-pyscf.fci.direct_ep">pyscf.fci.direct_ep module<a class="headerlink" href="#module-pyscf.fci.direct_ep" title="Permalink to this headline">¶</a></h2>
<p>Electron phonon coupling</p>
<dl class="simple">
<dt>Ref:</dt><dd><p>arXiv:1602.04195</p>
</dd>
</dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.contract_1e">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.contract_2e_hubbard">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">contract_2e_hubbard</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_2e_hubbard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_2e_hubbard" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.contract_all">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">contract_all</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">g</span></em>, <em class="sig-param"><span class="n">hpp</span></em>, <em class="sig-param"><span class="n">ci0</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.contract_ep">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">contract_ep</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">g</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_ep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_ep" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.contract_pp">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">contract_pp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hpp</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_pp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_pp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.cre_phonon">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">cre_phonon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em>, <em class="sig-param"><span class="n">site_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#cre_phonon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.cre_phonon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.des_phonon">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">des_phonon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em>, <em class="sig-param"><span class="n">site_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#des_phonon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.des_phonon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.kernel">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">g</span></em>, <em class="sig-param"><span class="n">hpp</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-09</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.make_hdiag">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">g</span></em>, <em class="sig-param"><span class="n">hpp</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.make_rdm12e">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">make_rdm12e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#make_rdm12e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.make_rdm12e" title="Permalink to this definition">¶</a></dt>
<dd><p>1-electron and 2-electron density matrices
dm_pq = &lt;<a href="#id41"><span class="problematic" id="id42">|p^+ q|</span></a>&gt;
dm_{pqrs} = &lt;<a href="#id43"><span class="problematic" id="id44">|p^+ r^+ q s|</span></a>&gt;  (note 2pdm is ordered in chemist notation)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.make_rdm1e">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">make_rdm1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#make_rdm1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.make_rdm1e" title="Permalink to this definition">¶</a></dt>
<dd><p>1-electron density matrix dm_pq = &lt;<a href="#id45"><span class="problematic" id="id46">|p^+ q|</span></a>&gt;</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.make_rdm1p">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">make_rdm1p</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#make_rdm1p"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.make_rdm1p" title="Permalink to this definition">¶</a></dt>
<dd><p>1-phonon density matrix dm_pq = &lt;<a href="#id47"><span class="problematic" id="id48">|p^+ q|</span></a>&gt;</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.make_shape">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">make_shape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#make_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.make_shape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.slices_for">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">slices_for</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">psite_id</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#slices_for"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.slices_for" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.slices_for_cre">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">slices_for_cre</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">psite_id</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#slices_for_cre"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.slices_for_cre" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_ep.slices_for_des">
<code class="sig-prename descclassname">pyscf.fci.direct_ep.</code><code class="sig-name descname">slices_for_des</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">psite_id</span></em>, <em class="sig-param"><span class="n">nsite</span></em>, <em class="sig-param"><span class="n">nphonon</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#slices_for_des"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_ep.slices_for_des" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>


<span id="pyscf-fci-direct-nosym-module"></span><h2 id="module-pyscf.fci.direct_nosym">pyscf.fci.direct_nosym module<a class="headerlink" href="#module-pyscf.fci.direct_nosym" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) …</p>
<dl class="py attribute">
<dt id="pyscf.fci.direct_nosym.FCI">
<code class="sig-prename descclassname">pyscf.fci.direct_nosym.</code><code class="sig-name descname">FCI</code><a class="headerlink" href="#pyscf.fci.direct_nosym.FCI" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_nosym.FCISolver" title="pyscf.fci.direct_nosym.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_nosym.FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt id="pyscf.fci.direct_nosym.FCISolver">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.direct_nosym.</code><code class="sig-name descname">FCISolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_spin1.FCISolver</span></code></a></p>
<dl class="py method">
<dt id="pyscf.fci.direct_nosym.FCISolver.absorb_h1e">
<code class="sig-name descname">absorb_h1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fac</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver.absorb_h1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver.absorb_h1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_nosym.FCISolver.contract_1e">
<code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver.contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_nosym.FCISolver.contract_2e">
<code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver.contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_nosym.FCISolver.eig">
<code class="sig-name descname">eig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">op</span></em>, <em class="sig-param"><span class="n">x0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">precond</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver.eig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver.eig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_nosym.FCISolver.kernel">
<code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver.kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_nosym.absorb_h1e">
<code class="sig-prename descclassname">pyscf.fci.direct_nosym.</code><code class="sig-name descname">absorb_h1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fac</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#absorb_h1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.absorb_h1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_nosym.contract_1e">
<code class="sig-prename descclassname">pyscf.fci.direct_nosym.</code><code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_nosym.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.direct_nosym.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 2-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
<p>Note the input arg eri is NOT the 2e hamiltonian matrix, the 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= eri_{pq,rs} p^+ q r^+ s \\
    &amp;= (pq|rs) p^+ r^+ s q - (pq|rs) \delta_{qr} p^+ s\end{split}\]</div>
<p>So eri is defined as</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_nosym.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_nosym.energy">
<code class="sig-prename descclassname">pyscf.fci.direct_nosym.</code><code class="sig-name descname">energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the FCI electronic energy for given Hamiltonian and FCI vector.</p>
</dd></dl>


<span id="pyscf-fci-direct-spin0-module"></span><h2 id="module-pyscf.fci.direct_spin0">pyscf.fci.direct_spin0 module<a class="headerlink" href="#module-pyscf.fci.direct_spin0" title="Permalink to this headline">¶</a></h2>
<p>FCI solver for Singlet state</p>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) …</p>
<p>direct_spin0 solver is specified for singlet state. However, calling this
solver sometimes ends up with the error “State not singlet x.xxxxxxe-06” due
to numerical issues. Calling direct_spin1 for singlet state is slightly
slower but more robust than direct_spin0 especially when combining to energy
penalty method (<code class="xref py py-func docutils literal notranslate"><span class="pre">fix_spin_()</span></code>)</p>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin0.FCI">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">FCI</code><a class="headerlink" href="#pyscf.fci.direct_spin0.FCI" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_spin0.FCISolver" title="pyscf.fci.direct_spin0.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_spin0.FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt id="pyscf.fci.direct_spin0.FCISolver">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">FCISolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_spin1.FCISolver</span></code></a></p>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.contract_1e">
<code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.contract_2e">
<code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.energy">
<code class="sig-name descname">energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the FCI electronic energy for given Hamiltonian and FCI vector.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.gen_linkstr">
<code class="sig-name descname">gen_linkstr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">tril</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">spin</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.gen_linkstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.gen_linkstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.get_init_guess">
<code class="sig-name descname">get_init_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nroots</span></em>, <em class="sig-param"><span class="n">hdiag</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.get_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.get_init_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.kernel">
<code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.make_hdiag">
<code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.make_rdm1">
<code class="sig-name descname">make_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.make_rdm12">
<code class="sig-name descname">make_rdm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.make_rdm12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.make_rdm12" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id1"><span class="problematic" id="id2">`</span></a>langle <a href="#id49"><span class="problematic" id="id50">q_</span></a>alpha^dagger <a href="#id51"><span class="problematic" id="id52">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id53"><span class="problematic" id="id54">q_</span></a>beta^dagger  <a href="#id55"><span class="problematic" id="id56">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id3"><span class="problematic" id="id4">`</span></a>langle <a href="#id57"><span class="problematic" id="id58">p_</span></a>alpha^dagger <a href="#id59"><span class="problematic" id="id60">r_</span></a>alpha^dagger <a href="#id61"><span class="problematic" id="id62">s_</span></a>alpha <a href="#id63"><span class="problematic" id="id64">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id65"><span class="problematic" id="id66">p_</span></a>beta^dagger  <a href="#id67"><span class="problematic" id="id68">r_</span></a>alpha^dagger <a href="#id69"><span class="problematic" id="id70">s_</span></a>alpha <a href="#id71"><span class="problematic" id="id72">q_</span></a>betarangle +
langle <a href="#id73"><span class="problematic" id="id74">p_</span></a>alpha^dagger <a href="#id75"><span class="problematic" id="id76">r_</span></a>beta^dagger  <a href="#id77"><span class="problematic" id="id78">s_</span></a>beta  <a href="#id79"><span class="problematic" id="id80">q_</span></a>alpharangle +
langle <a href="#id81"><span class="problematic" id="id82">p_</span></a>beta^dagger  <a href="#id83"><span class="problematic" id="id84">r_</span></a>beta^dagger  <a href="#id85"><span class="problematic" id="id86">s_</span></a>beta  <a href="#id87"><span class="problematic" id="id88">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(‘pq,qp’, h1, 1pdm) + 1/2 * einsum(‘pqrs,pqrs’, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.make_rdm1s">
<code class="sig-name descname">make_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.make_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.make_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.trans_rdm1">
<code class="sig-name descname">trans_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.trans_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.trans_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced transition 1-particle transition density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id5"><span class="problematic" id="id6">`</span></a>langle <a href="#id89"><span class="problematic" id="id90">q_</span></a>alpha^dagger <a href="#id91"><span class="problematic" id="id92">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id93"><span class="problematic" id="id94">q_</span></a>beta^dagger <a href="#id95"><span class="problematic" id="id96">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.trans_rdm12">
<code class="sig-name descname">trans_rdm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.trans_rdm12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.trans_rdm12" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced transition 1- and 2-particle transition density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0.FCISolver.trans_rdm1s">
<code class="sig-name descname">trans_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.trans_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.trans_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta).
See also function <a class="reference internal" href="#pyscf.fci.direct_spin0.make_rdm1s" title="pyscf.fci.direct_spin0.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.contract_1e">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.energy">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.energy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.get_init_guess">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">get_init_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nroots</span></em>, <em class="sig-param"><span class="n">hdiag</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#get_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.get_init_guess" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.kernel">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_shift</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">1e-14</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">400</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.kernel_ms0">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">kernel_ms0</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fci</span></em>, <em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_memory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#kernel_ms0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.kernel_ms0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.make_hdiag">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.make_rdm1">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">make_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.make_rdm12">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">make_rdm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#make_rdm12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.make_rdm12" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id7"><span class="problematic" id="id8">`</span></a>langle <a href="#id97"><span class="problematic" id="id98">q_</span></a>alpha^dagger <a href="#id99"><span class="problematic" id="id100">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id101"><span class="problematic" id="id102">q_</span></a>beta^dagger  <a href="#id103"><span class="problematic" id="id104">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id9"><span class="problematic" id="id10">`</span></a>langle <a href="#id105"><span class="problematic" id="id106">p_</span></a>alpha^dagger <a href="#id107"><span class="problematic" id="id108">r_</span></a>alpha^dagger <a href="#id109"><span class="problematic" id="id110">s_</span></a>alpha <a href="#id111"><span class="problematic" id="id112">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id113"><span class="problematic" id="id114">p_</span></a>beta^dagger  <a href="#id115"><span class="problematic" id="id116">r_</span></a>alpha^dagger <a href="#id117"><span class="problematic" id="id118">s_</span></a>alpha <a href="#id119"><span class="problematic" id="id120">q_</span></a>betarangle +
langle <a href="#id121"><span class="problematic" id="id122">p_</span></a>alpha^dagger <a href="#id123"><span class="problematic" id="id124">r_</span></a>beta^dagger  <a href="#id125"><span class="problematic" id="id126">s_</span></a>beta  <a href="#id127"><span class="problematic" id="id128">q_</span></a>alpharangle +
langle <a href="#id129"><span class="problematic" id="id130">p_</span></a>beta^dagger  <a href="#id131"><span class="problematic" id="id132">r_</span></a>beta^dagger  <a href="#id133"><span class="problematic" id="id134">s_</span></a>beta  <a href="#id135"><span class="problematic" id="id136">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(‘pq,qp’, h1, 1pdm) + 1/2 * einsum(‘pqrs,pqrs’, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.make_rdm1s">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">make_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#make_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.make_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.trans_rdm1">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">trans_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#trans_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.trans_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced transition 1-particle transition density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id11"><span class="problematic" id="id12">`</span></a>langle <a href="#id137"><span class="problematic" id="id138">q_</span></a>alpha^dagger <a href="#id139"><span class="problematic" id="id140">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id141"><span class="problematic" id="id142">q_</span></a>beta^dagger <a href="#id143"><span class="problematic" id="id144">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.trans_rdm12">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">trans_rdm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#trans_rdm12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.trans_rdm12" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced transition 1- and 2-particle transition density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0.trans_rdm1s">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0.</code><code class="sig-name descname">trans_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#trans_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.trans_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta).
See also function <a class="reference internal" href="#pyscf.fci.direct_spin0.make_rdm1s" title="pyscf.fci.direct_spin0.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>


<span id="pyscf-fci-direct-spin0-symm-module"></span><h2 id="module-pyscf.fci.direct_spin0_symm">pyscf.fci.direct_spin0_symm module<a class="headerlink" href="#module-pyscf.fci.direct_spin0_symm" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) …</p>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin0_symm.FCI">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0_symm.</code><code class="sig-name descname">FCI</code><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCI" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_spin0_symm.FCISolver" title="pyscf.fci.direct_spin0_symm.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_spin0_symm.FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.direct_spin0_symm.</code><code class="sig-name descname">FCISolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin0.FCISolver" title="pyscf.fci.direct_spin0.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_spin0.FCISolver</span></code></a></p>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver.absorb_h1e">
<code class="sig-name descname">absorb_h1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fac</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver.absorb_h1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.absorb_h1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver.contract_1e">
<code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver.contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver.contract_2e">
<code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver.contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver.davidson_only">
<code class="sig-name descname">davidson_only</code><em class="property"> = True</em><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.davidson_only" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver.dump_flags">
<code class="sig-name descname">dump_flags</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver.dump_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver.get_init_guess">
<code class="sig-name descname">get_init_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nroots</span></em>, <em class="sig-param"><span class="n">hdiag</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver.get_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.get_init_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver.guess_wfnsym">
<code class="sig-name descname">guess_wfnsym</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fcivec</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver.guess_wfnsym"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.guess_wfnsym" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver.kernel">
<code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver.kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver.make_hdiag">
<code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver.make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver.pspace">
<code class="sig-name descname">pspace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">hdiag</span></em>, <em class="sig-param"><span class="n">np</span><span class="o">=</span><span class="default_value">400</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver.pspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.pspace" title="Permalink to this definition">¶</a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin0_symm.FCISolver.pspace_size">
<code class="sig-name descname">pspace_size</code><em class="property"> = 0</em><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.pspace_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0_symm.contract_1e">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0_symm.</code><code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0_symm.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0_symm.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0_symm.energy">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0_symm.</code><code class="sig-name descname">energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.energy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0_symm.get_init_guess">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0_symm.</code><code class="sig-name descname">get_init_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nroots</span></em>, <em class="sig-param"><span class="n">hdiag</span></em>, <em class="sig-param"><span class="n">orbsym</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#get_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.get_init_guess" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin0_symm.kernel">
<code class="sig-prename descclassname">pyscf.fci.direct_spin0_symm.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_shift</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">1e-14</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">400</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>


<span id="pyscf-fci-direct-spin1-module"></span><h2 id="module-pyscf.fci.direct_spin1">pyscf.fci.direct_spin1 module<a class="headerlink" href="#module-pyscf.fci.direct_spin1" title="Permalink to this headline">¶</a></h2>
<p>Full CI solver for spin-free Hamiltonian.  This solver can be used to compute
doublet, triplet,…</p>
<p>The CI wfn are stored as a 2D array [alpha,beta], where each row corresponds
to an alpha string.  For each row (alpha string), there are
total-num-beta-strings of columns.  Each column corresponds to a beta string.</p>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) …</p>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1.FCI">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">FCI</code><a class="headerlink" href="#pyscf.fci.direct_spin1.FCI" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_spin1.FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt id="pyscf.fci.direct_spin1.FCIBase">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">FCIBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.lib.misc.StreamObject</span></code></a></p>
<p>Full CI solver</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code>.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Total number of iterations. Default is 100</p>
</dd>
<dt>max_space<span class="classifier">tuple of int</span></dt><dd><p>Davidson iteration space size. Default is 14.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Energy convergence tolerance. Default is 1e-10.</p>
</dd>
<dt>level_shift<span class="classifier">float</span></dt><dd><p>Level shift applied in the preconditioner to avoid singularity.
Default is 1e-3</p>
</dd>
<dt>davidson_only<span class="classifier">bool</span></dt><dd><p>By default, the entire Hamiltonian matrix will be constructed and
diagonalized if the system is small (see attribute pspace_size).
Setting this parameter to True will enforce the eigenvalue
problems being solved by Davidson subspace algorithm.  This flag
should be enabled when initial guess is given or particular spin
symmetry or point-group symmetry is required because the initial
guess or symmetry are completely ignored in the direct diagonlization.</p>
</dd>
<dt>pspace_size<span class="classifier">int</span></dt><dd><p>The dimension of Hamiltonian matrix over which Davidson iteration
algorithm will be used for the eigenvalue problem.  Default is 400.
This is roughly corresponding to a (6e,6o) system.</p>
</dd>
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of states to be solved.  Default is 1, the ground state.</p>
</dd>
<dt>spin<span class="classifier">int or None</span></dt><dd><p>Spin (2S = nalpha-nbeta) of the system.  If this attribute is None,
spin will be determined by the argument nelec (number of electrons)
of the kernel function.</p>
</dd>
<dt>wfnsym<span class="classifier">str or int</span></dt><dd><p>Symmetry of wavefunction.  It is used only in direct_spin1_symm
and direct_spin0_symm solver.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>eci<span class="classifier">float or a list of float</span></dt><dd><p>FCI energy(ies)</p>
</dd>
<dt>ci<span class="classifier">nparray</span></dt><dd><p>FCI wfn vector(s)</p>
</dd>
<dt>converged<span class="classifier">bool (or a list of bool for multiple roots)</span></dt><dd><p>Whether davidson iteration is converged</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">ao2mo</span><span class="p">,</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'Li 0 0 0; Li 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'sto-3g'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h1</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">get_hcore</span><span class="p">())</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">eri</span><span class="p">,</span> <span class="n">h1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mol</span><span class="o">.</span><span class="n">nelec</span><span class="p">,</span> <span class="n">ecore</span><span class="o">=</span><span class="n">mol</span><span class="o">.</span><span class="n">energy_nuc</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">-14.4197890826</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.absorb_h1e">
<code class="sig-name descname">absorb_h1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fac</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.absorb_h1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.absorb_h1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.contract_1e">
<code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.contract_2e">
<code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.contract_ss">
<code class="sig-name descname">contract_ss</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.contract_ss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.contract_ss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1.FCIBase.conv_tol">
<code class="sig-name descname">conv_tol</code><em class="property"> = 1e-10</em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.conv_tol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1.FCIBase.conv_tol_residual">
<code class="sig-name descname">conv_tol_residual</code><em class="property"> = None</em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.conv_tol_residual" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1.FCIBase.davidson_only">
<code class="sig-name descname">davidson_only</code><em class="property"> = False</em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.davidson_only" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.dump_flags">
<code class="sig-name descname">dump_flags</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.dump_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.e_tot">
<em class="property">property </em><code class="sig-name descname">e_tot</code><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.e_tot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.eig">
<code class="sig-name descname">eig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">op</span></em>, <em class="sig-param"><span class="n">x0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">precond</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.eig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.eig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.energy">
<code class="sig-name descname">energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the FCI electronic energy for given Hamiltonian and FCI vector.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.gen_linkstr">
<code class="sig-name descname">gen_linkstr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">tril</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">spin</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.gen_linkstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.gen_linkstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.get_init_guess">
<code class="sig-name descname">get_init_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nroots</span></em>, <em class="sig-param"><span class="n">hdiag</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.get_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.get_init_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.kernel">
<code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.large_ci">
<code class="sig-name descname">large_ci</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">return_strs</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.large_ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.large_ci" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1.FCIBase.lessio">
<code class="sig-name descname">lessio</code><em class="property"> = False</em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.lessio" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1.FCIBase.level_shift">
<code class="sig-name descname">level_shift</code><em class="property"> = 0.001</em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.level_shift" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1.FCIBase.lindep">
<code class="sig-name descname">lindep</code><em class="property"> = 1e-14</em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.lindep" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.make_hdiag">
<code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.make_precond">
<code class="sig-name descname">make_precond</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hdiag</span></em>, <em class="sig-param"><span class="n">pspaceig</span></em>, <em class="sig-param"><span class="n">pspaceci</span></em>, <em class="sig-param"><span class="n">addr</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_precond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_precond" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.make_rdm1">
<code class="sig-name descname">make_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.make_rdm12">
<code class="sig-name descname">make_rdm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_rdm12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_rdm12" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id13"><span class="problematic" id="id14">`</span></a>langle <a href="#id145"><span class="problematic" id="id146">q_</span></a>alpha^dagger <a href="#id147"><span class="problematic" id="id148">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id149"><span class="problematic" id="id150">q_</span></a>beta^dagger  <a href="#id151"><span class="problematic" id="id152">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id15"><span class="problematic" id="id16">`</span></a>langle <a href="#id153"><span class="problematic" id="id154">p_</span></a>alpha^dagger <a href="#id155"><span class="problematic" id="id156">r_</span></a>alpha^dagger <a href="#id157"><span class="problematic" id="id158">s_</span></a>alpha <a href="#id159"><span class="problematic" id="id160">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id161"><span class="problematic" id="id162">p_</span></a>beta^dagger  <a href="#id163"><span class="problematic" id="id164">r_</span></a>alpha^dagger <a href="#id165"><span class="problematic" id="id166">s_</span></a>alpha <a href="#id167"><span class="problematic" id="id168">q_</span></a>betarangle +
langle <a href="#id169"><span class="problematic" id="id170">p_</span></a>alpha^dagger <a href="#id171"><span class="problematic" id="id172">r_</span></a>beta^dagger  <a href="#id173"><span class="problematic" id="id174">s_</span></a>beta  <a href="#id175"><span class="problematic" id="id176">q_</span></a>alpharangle +
langle <a href="#id177"><span class="problematic" id="id178">p_</span></a>beta^dagger  <a href="#id179"><span class="problematic" id="id180">r_</span></a>beta^dagger  <a href="#id181"><span class="problematic" id="id182">s_</span></a>beta  <a href="#id183"><span class="problematic" id="id184">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(‘pq,qp’, h1, 1pdm) + 1/2 * einsum(‘pqrs,pqrs’, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.make_rdm12s">
<code class="sig-name descname">make_rdm12s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_rdm12s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_rdm12s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 1- and 2-particle density matrices.
The return values include two lists, a list of 1-particle density matrices
and a list of 2-particle density matrices.  The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,beta,beta) for 2-particle density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
<p>Energy should be computed as
E = einsum(‘pq,qp’, h1, 1pdm) + 1/2 * einsum(‘pqrs,pqrs’, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.make_rdm1s">
<code class="sig-name descname">make_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.make_rdm2">
<code class="sig-name descname">make_rdm2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_rdm2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_rdm2" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced 2-particle density matrice</p>
<p>NOTE the 2pdm is <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger s r\rangle\)</span> but
stored as [p,r,q,s]</p>
</dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1.FCIBase.max_cycle">
<code class="sig-name descname">max_cycle</code><em class="property"> = 100</em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.max_cycle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1.FCIBase.max_space">
<code class="sig-name descname">max_space</code><em class="property"> = 12</em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.max_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.nstates">
<em class="property">property </em><code class="sig-name descname">nstates</code><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.nstates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.pspace">
<code class="sig-name descname">pspace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">hdiag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">np</span><span class="o">=</span><span class="default_value">400</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.pspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.pspace" title="Permalink to this definition">¶</a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1.FCIBase.pspace_size">
<code class="sig-name descname">pspace_size</code><em class="property"> = 400</em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.pspace_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.spin_square">
<code class="sig-name descname">spin_square</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.spin_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.spin_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin square for RHF-FCI CI wfn only (obtained from spin-degenerated
Hamiltonian)</p>
</dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1.FCIBase.threads">
<code class="sig-name descname">threads</code><em class="property"> = None</em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.threads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.trans_rdm1">
<code class="sig-name descname">trans_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.trans_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced transition 1-particle transition density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id17"><span class="problematic" id="id18">`</span></a>langle <a href="#id185"><span class="problematic" id="id186">q_</span></a>alpha^dagger <a href="#id187"><span class="problematic" id="id188">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id189"><span class="problematic" id="id190">q_</span></a>beta^dagger <a href="#id191"><span class="problematic" id="id192">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.trans_rdm12">
<code class="sig-name descname">trans_rdm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.trans_rdm12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm12" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced transition 1- and 2-particle transition density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.trans_rdm12s">
<code class="sig-name descname">trans_rdm12s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.trans_rdm12s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm12s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 1- and 2-particle transition density matrices.
The return values include two lists, a list of 1-particle transition
density matrices and a list of 2-particle transition density matrices.
The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle transition density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,alpha,alpha), (beta,beta,beta,beta) for 2-particle transition
density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCIBase.trans_rdm1s">
<code class="sig-name descname">trans_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.trans_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta).
See also function <a class="reference internal" href="#pyscf.fci.direct_spin1.make_rdm1s" title="pyscf.fci.direct_spin1.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt id="pyscf.fci.direct_spin1.FCISolver">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">FCISolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCISolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCISolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCIBase" title="pyscf.fci.direct_spin1.FCIBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_spin1.FCIBase</span></code></a></p>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1.FCISolver.transform_ci_for_orbital_rotation">
<code class="sig-name descname">transform_ci_for_orbital_rotation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">u</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCISolver.transform_ci_for_orbital_rotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCISolver.transform_ci_for_orbital_rotation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.absorb_h1e">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">absorb_h1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fac</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#absorb_h1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.absorb_h1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.contract_1e">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.energy">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the FCI electronic energy for given Hamiltonian and FCI vector.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.get_init_guess">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">get_init_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nroots</span></em>, <em class="sig-param"><span class="n">hdiag</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#get_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.get_init_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.kernel">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_shift</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">1e-14</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">400</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.kernel_ms1">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">kernel_ms1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fci</span></em>, <em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_memory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#kernel_ms1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.kernel_ms1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.make_diag_precond">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">make_diag_precond</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hdiag</span></em>, <em class="sig-param"><span class="n">pspaceig</span></em>, <em class="sig-param"><span class="n">pspaceci</span></em>, <em class="sig-param"><span class="n">addr</span></em>, <em class="sig-param"><span class="n">level_shift</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_diag_precond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_diag_precond" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.make_hdiag">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.make_pspace_precond">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">make_pspace_precond</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hdiag</span></em>, <em class="sig-param"><span class="n">pspaceig</span></em>, <em class="sig-param"><span class="n">pspaceci</span></em>, <em class="sig-param"><span class="n">addr</span></em>, <em class="sig-param"><span class="n">level_shift</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_pspace_precond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_pspace_precond" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.make_rdm1">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">make_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.make_rdm12">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">make_rdm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_rdm12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_rdm12" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id19"><span class="problematic" id="id20">`</span></a>langle <a href="#id193"><span class="problematic" id="id194">q_</span></a>alpha^dagger <a href="#id195"><span class="problematic" id="id196">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id197"><span class="problematic" id="id198">q_</span></a>beta^dagger  <a href="#id199"><span class="problematic" id="id200">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id21"><span class="problematic" id="id22">`</span></a>langle <a href="#id201"><span class="problematic" id="id202">p_</span></a>alpha^dagger <a href="#id203"><span class="problematic" id="id204">r_</span></a>alpha^dagger <a href="#id205"><span class="problematic" id="id206">s_</span></a>alpha <a href="#id207"><span class="problematic" id="id208">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id209"><span class="problematic" id="id210">p_</span></a>beta^dagger  <a href="#id211"><span class="problematic" id="id212">r_</span></a>alpha^dagger <a href="#id213"><span class="problematic" id="id214">s_</span></a>alpha <a href="#id215"><span class="problematic" id="id216">q_</span></a>betarangle +
langle <a href="#id217"><span class="problematic" id="id218">p_</span></a>alpha^dagger <a href="#id219"><span class="problematic" id="id220">r_</span></a>beta^dagger  <a href="#id221"><span class="problematic" id="id222">s_</span></a>beta  <a href="#id223"><span class="problematic" id="id224">q_</span></a>alpharangle +
langle <a href="#id225"><span class="problematic" id="id226">p_</span></a>beta^dagger  <a href="#id227"><span class="problematic" id="id228">r_</span></a>beta^dagger  <a href="#id229"><span class="problematic" id="id230">s_</span></a>beta  <a href="#id231"><span class="problematic" id="id232">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(‘pq,qp’, h1, 1pdm) + 1/2 * einsum(‘pqrs,pqrs’, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.make_rdm12s">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">make_rdm12s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_rdm12s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_rdm12s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 1- and 2-particle density matrices.
The return values include two lists, a list of 1-particle density matrices
and a list of 2-particle density matrices.  The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,beta,beta) for 2-particle density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
<p>Energy should be computed as
E = einsum(‘pq,qp’, h1, 1pdm) + 1/2 * einsum(‘pqrs,pqrs’, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.make_rdm1s">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">make_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.pspace">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">pspace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">hdiag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">np</span><span class="o">=</span><span class="default_value">400</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#pspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.pspace" title="Permalink to this definition">¶</a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.trans_rdm1">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">trans_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#trans_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.trans_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced transition 1-particle transition density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id23"><span class="problematic" id="id24">`</span></a>langle <a href="#id233"><span class="problematic" id="id234">q_</span></a>alpha^dagger <a href="#id235"><span class="problematic" id="id236">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id237"><span class="problematic" id="id238">q_</span></a>beta^dagger <a href="#id239"><span class="problematic" id="id240">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.trans_rdm12">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">trans_rdm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#trans_rdm12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.trans_rdm12" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced transition 1- and 2-particle transition density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.trans_rdm12s">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">trans_rdm12s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#trans_rdm12s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.trans_rdm12s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 1- and 2-particle transition density matrices.
The return values include two lists, a list of 1-particle transition
density matrices and a list of 2-particle transition density matrices.
The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle transition density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,alpha,alpha), (beta,beta,beta,beta) for 2-particle transition
density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1.trans_rdm1s">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1.</code><code class="sig-name descname">trans_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#trans_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.trans_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta).
See also function <a class="reference internal" href="#pyscf.fci.direct_spin1.make_rdm1s" title="pyscf.fci.direct_spin1.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>


<span id="pyscf-fci-direct-spin1-symm-module"></span><h2 id="module-pyscf.fci.direct_spin1_symm">pyscf.fci.direct_spin1_symm module<a class="headerlink" href="#module-pyscf.fci.direct_spin1_symm" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) …</p>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1_symm.FCI">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1_symm.</code><code class="sig-name descname">FCI</code><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCI" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_spin1_symm.FCISolver" title="pyscf.fci.direct_spin1_symm.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_spin1_symm.FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.direct_spin1_symm.</code><code class="sig-name descname">FCISolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_spin1.FCISolver</span></code></a></p>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver.absorb_h1e">
<code class="sig-name descname">absorb_h1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fac</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.absorb_h1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.absorb_h1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver.contract_1e">
<code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver.contract_2e">
<code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver.davidson_only">
<code class="sig-name descname">davidson_only</code><em class="property"> = True</em><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.davidson_only" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver.dump_flags">
<code class="sig-name descname">dump_flags</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.dump_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver.get_init_guess">
<code class="sig-name descname">get_init_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nroots</span></em>, <em class="sig-param"><span class="n">hdiag</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.get_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.get_init_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver.guess_wfnsym">
<code class="sig-name descname">guess_wfnsym</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fcivec</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.guess_wfnsym"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.guess_wfnsym" title="Permalink to this definition">¶</a></dt>
<dd><p>Guess point group symmetry of the FCI wavefunction.  If fcivec is
given, the symmetry of fcivec is used.  Otherwise the symmetry is
based on the HF determinant.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver.kernel">
<code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver.make_hdiag">
<code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver.pspace">
<code class="sig-name descname">pspace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">hdiag</span></em>, <em class="sig-param"><span class="n">np</span><span class="o">=</span><span class="default_value">400</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.pspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.pspace" title="Permalink to this definition">¶</a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.direct_spin1_symm.FCISolver.pspace_size">
<code class="sig-name descname">pspace_size</code><em class="property"> = 0</em><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.pspace_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1_symm.contract_1e">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1_symm.</code><code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1_symm.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1_symm.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1_symm.energy">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1_symm.</code><code class="sig-name descname">energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.energy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1_symm.gen_str_irrep">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1_symm.</code><code class="sig-name descname">gen_str_irrep</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">strs</span></em>, <em class="sig-param"><span class="n">orbsym</span></em>, <em class="sig-param"><span class="n">link_index</span></em>, <em class="sig-param"><span class="n">rank_eri</span></em>, <em class="sig-param"><span class="n">irrep_eri</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#gen_str_irrep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.gen_str_irrep" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1_symm.get_init_guess">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1_symm.</code><code class="sig-name descname">get_init_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nroots</span></em>, <em class="sig-param"><span class="n">hdiag</span></em>, <em class="sig-param"><span class="n">orbsym</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#get_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.get_init_guess" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1_symm.kernel">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1_symm.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_shift</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">1e-14</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">400</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_spin1_symm.reorder_eri">
<code class="sig-prename descclassname">pyscf.fci.direct_spin1_symm.</code><code class="sig-name descname">reorder_eri</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">orbsym</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#reorder_eri"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.reorder_eri" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>


<span id="pyscf-fci-direct-uhf-module"></span><h2 id="module-pyscf.fci.direct_uhf">pyscf.fci.direct_uhf module<a class="headerlink" href="#module-pyscf.fci.direct_uhf" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) …</p>
<dl class="py attribute">
<dt id="pyscf.fci.direct_uhf.FCI">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">FCI</code><a class="headerlink" href="#pyscf.fci.direct_uhf.FCI" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_uhf.FCISolver" title="pyscf.fci.direct_uhf.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_uhf.FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt id="pyscf.fci.direct_uhf.FCISolver">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">FCISolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#FCISolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_spin1.FCISolver</span></code></a></p>
<dl class="py method">
<dt id="pyscf.fci.direct_uhf.FCISolver.absorb_h1e">
<code class="sig-name descname">absorb_h1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fac</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#FCISolver.absorb_h1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.absorb_h1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_uhf.FCISolver.contract_1e">
<code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#FCISolver.contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_uhf.FCISolver.contract_2e">
<code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#FCISolver.contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_uhf.FCISolver.make_hdiag">
<code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#FCISolver.make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_uhf.FCISolver.make_rdm1">
<code class="sig-name descname">make_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#FCISolver.make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_uhf.FCISolver.pspace">
<code class="sig-name descname">pspace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">hdiag</span></em>, <em class="sig-param"><span class="n">np</span><span class="o">=</span><span class="default_value">400</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#FCISolver.pspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.pspace" title="Permalink to this definition">¶</a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_uhf.FCISolver.spin_square">
<code class="sig-name descname">spin_square</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#FCISolver.spin_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.spin_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin square for RHF-FCI CI wfn only (obtained from spin-degenerated
Hamiltonian)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.direct_uhf.FCISolver.trans_rdm1">
<code class="sig-name descname">trans_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#FCISolver.trans_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.trans_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced transition 1-particle transition density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id25"><span class="problematic" id="id26">`</span></a>langle <a href="#id241"><span class="problematic" id="id242">q_</span></a>alpha^dagger <a href="#id243"><span class="problematic" id="id244">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id245"><span class="problematic" id="id246">q_</span></a>beta^dagger <a href="#id247"><span class="problematic" id="id248">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.absorb_h1e">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">absorb_h1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fac</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#absorb_h1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.absorb_h1e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.contract_1e">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.contract_2e_hubbard">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">contract_2e_hubbard</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">opt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#contract_2e_hubbard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.contract_2e_hubbard" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.energy">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.energy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.kernel">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_shift</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">1e-14</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">400</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.make_hdiag">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.make_rdm1">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">make_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.make_rdm12s">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">make_rdm12s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#make_rdm12s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.make_rdm12s" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.make_rdm1s">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">make_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#make_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.make_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.pspace">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">pspace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">hdiag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">np</span><span class="o">=</span><span class="default_value">400</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#pspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.pspace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.trans_rdm1">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">trans_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#trans_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.trans_rdm1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.trans_rdm12s">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">trans_rdm12s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reorder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#trans_rdm12s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.trans_rdm12s" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.direct_uhf.trans_rdm1s">
<code class="sig-prename descclassname">pyscf.fci.direct_uhf.</code><code class="sig-name descname">trans_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#trans_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.trans_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>


<span id="pyscf-fci-fci-slow-module"></span><h2 id="module-pyscf.fci.fci_slow">pyscf.fci.fci_slow module<a class="headerlink" href="#module-pyscf.fci.fci_slow" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyscf.fci.fci_slow.absorb_h1e">
<code class="sig-prename descclassname">pyscf.fci.fci_slow.</code><code class="sig-name descname">absorb_h1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fac</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#absorb_h1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.fci_slow.absorb_h1e" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.fci_slow.contract_1e">
<code class="sig-prename descclassname">pyscf.fci.fci_slow.</code><code class="sig-name descname">contract_1e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f1e</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#contract_1e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.fci_slow.contract_1e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.fci_slow.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.fci_slow.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">opt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.fci_slow.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute E_{pq}E_{rs}|CI&gt;</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.fci_slow.contract_2e_hubbard">
<code class="sig-prename descclassname">pyscf.fci.fci_slow.</code><code class="sig-name descname">contract_2e_hubbard</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">opt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#contract_2e_hubbard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.fci_slow.contract_2e_hubbard" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.fci_slow.kernel">
<code class="sig-prename descclassname">pyscf.fci.fci_slow.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.fci_slow.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.fci_slow.make_hdiag">
<code class="sig-prename descclassname">pyscf.fci.fci_slow.</code><code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">opt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.fci_slow.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.fci_slow.make_rdm1">
<code class="sig-prename descclassname">pyscf.fci.fci_slow.</code><code class="sig-name descname">make_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">opt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.fci_slow.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.fci_slow.make_rdm12">
<code class="sig-prename descclassname">pyscf.fci.fci_slow.</code><code class="sig-name descname">make_rdm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">opt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#make_rdm12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.fci_slow.make_rdm12" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.fci_slow.reorder_rdm">
<code class="sig-prename descclassname">pyscf.fci.fci_slow.</code><code class="sig-name descname">reorder_rdm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1</span></em>, <em class="sig-param"><span class="n">rdm2</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#reorder_rdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.fci_slow.reorder_rdm" title="Permalink to this definition">¶</a></dt>
<dd><p>reorder from rdm2(pq,rs) = &lt;E^p_q E^r_s&gt; to rdm2(pq,rs) = &lt;e^{pr}_{qs}&gt;.
Although the “reoredered rdm2” is still in Mulliken order (rdm2[e1,e1,e2,e2]),
it is the true 2e DM (dotting it with int2e gives the energy of 2e parts)</p>
</dd></dl>


<span id="pyscf-fci-rdm-module"></span><h2 id="module-pyscf.fci.rdm">pyscf.fci.rdm module<a class="headerlink" href="#module-pyscf.fci.rdm" title="Permalink to this headline">¶</a></h2>
<p>FCI 1, 2, 3, 4-particle density matrices.</p>
<p>Note the 1-particle density matrix has the same convention as the mean-field
1-particle density matrix (see McWeeney’s book Eq 5.4.20), which is</p>
<blockquote>
<div><p>dm[p,q] = &lt; q^+ p &gt;</p>
</div></blockquote>
<dl class="simple">
<dt>The contraction between 1-particle Hamiltonian and 1-pdm is</dt><dd><p>E = einsum(‘pq,qp’, h1, 1pdm)</p>
</dd>
<dt>Different conventions are used in the high order density matrices:</dt><dd><p>dm[p,q,r,s,…] = &lt; p^+ r^+ … s q &gt;</p>
</dd>
</dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.make_dm123">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">make_dm123</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_dm123"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.rdm.make_dm123" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced 1, 2 and 3-particle density matrices.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this function, 2pdm[p,q,r,s] is <span class="math notranslate nohighlight">\(\langle p^\dagger q r^\dagger s\rangle\)</span>;
3pdm[p,q,r,s,t,u] is <span class="math notranslate nohighlight">\(\langle p^\dagger q r^\dagger s t^\dagger u\rangle\)</span>.</p>
<p>After calling reorder_dm123, the 2pdm and 3pdm are transformed to
the normal density matrices:
2pdm[p,r,q,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger s r\rangle\)</span>
3pdm[p,s,q,t,r,u] = <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger r^\dagger u t s\rangle\)</span>.</p>
</div>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.make_dm1234">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">make_dm1234</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_dm1234"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.rdm.make_dm1234" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced 1, 2, 3 and 4-particle density matrices.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this function, 2pdm[p,q,r,s] is <span class="math notranslate nohighlight">\(\langle p^\dagger q r^\dagger s\rangle\)</span>;
3pdm[p,q,r,s,t,u] is <span class="math notranslate nohighlight">\(\langle p^\dagger q r^\dagger s t^\dagger u\rangle\)</span>;
4pdm[p,q,r,s,t,u,v,w] is <span class="math notranslate nohighlight">\(\langle p^\dagger q r^\dagger s t^\dagger u v^\dagger w\rangle\)</span>.</p>
<p>After calling reorder_dm123, the 2pdm and 3pdm are transformed to
the normal density matrices:
2pdm[p,r,q,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger s r\rangle\)</span>
3pdm[p,s,q,t,r,u] = <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger r^\dagger u t s\rangle\)</span>.
4pdm[p,t,q,u,r,v,s,w] = <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger r^\dagger s^dagger w v u t\rangle\)</span>.</p>
</div>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.make_rdm1">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">make_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.rdm.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.make_rdm12">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">make_rdm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">symm</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.rdm.make_rdm12" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.make_rdm12_ms0">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">make_rdm12_ms0</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">symm</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_rdm12_ms0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.rdm.make_rdm12_ms0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.make_rdm12_spin1">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">make_rdm12_spin1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">symm</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_rdm12_spin1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.rdm.make_rdm12_spin1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.make_rdm1_ms0">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">make_rdm1_ms0</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_rdm1_ms0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.rdm.make_rdm1_ms0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.make_rdm1_spin1">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">make_rdm1_spin1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_rdm1_spin1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.rdm.make_rdm1_spin1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.reorder_dm12">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">reorder_dm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1</span></em>, <em class="sig-param"><span class="n">rdm2</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#reorder_dm12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.rdm.reorder_dm12" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.reorder_dm123">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">reorder_dm123</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1</span></em>, <em class="sig-param"><span class="n">rdm2</span></em>, <em class="sig-param"><span class="n">rdm3</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#reorder_dm123"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.rdm.reorder_dm123" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.reorder_dm1234">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">reorder_dm1234</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1</span></em>, <em class="sig-param"><span class="n">rdm2</span></em>, <em class="sig-param"><span class="n">rdm3</span></em>, <em class="sig-param"><span class="n">rdm4</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#reorder_dm1234"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.rdm.reorder_dm1234" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.rdm.reorder_rdm">
<code class="sig-prename descclassname">pyscf.fci.rdm.</code><code class="sig-name descname">reorder_rdm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdm1</span></em>, <em class="sig-param"><span class="n">rdm2</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#reorder_rdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.rdm.reorder_rdm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>


<span id="pyscf-fci-selected-ci-module"></span><h2 id="module-pyscf.fci.selected_ci">pyscf.fci.selected_ci module<a class="headerlink" href="#module-pyscf.fci.selected_ci" title="Permalink to this headline">¶</a></h2>
<p>Selected CI</p>
<p>Simple usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">ao2mo</span><span class="p">,</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'C 0 0 0; C 0 0 1'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h1</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">get_hcore</span><span class="p">())</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h2</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">selected_ci</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mol</span><span class="o">.</span><span class="n">nelectron</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<dl class="py attribute">
<dt id="pyscf.fci.selected_ci.SCI">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">SCI</code><a class="headerlink" href="#pyscf.fci.selected_ci.SCI" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.selected_ci.SelectedCI" title="pyscf.fci.selected_ci.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.selected_ci.SelectedCI</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt id="pyscf.fci.selected_ci.SelectedCI">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">SelectedCI</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.direct_spin1.FCISolver</span></code></a></p>
<dl class="py attribute">
<dt id="pyscf.fci.selected_ci.SelectedCI.ci_coeff_cutoff">
<code class="sig-name descname">ci_coeff_cutoff</code><em class="property"> = 0.0005</em><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.ci_coeff_cutoff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.contract_2e">
<code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.contract_ss">
<code class="sig-name descname">contract_ss</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.contract_ss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.contract_ss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.selected_ci.SelectedCI.conv_tol">
<code class="sig-name descname">conv_tol</code><em class="property"> = 1e-09</em><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.conv_tol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.dump_flags">
<code class="sig-name descname">dump_flags</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.dump_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.enlarge_space">
<code class="sig-name descname">enlarge_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.enlarge_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.gen_linkstr">
<code class="sig-name descname">gen_linkstr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">tril</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">spin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ci_strs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.gen_linkstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.gen_linkstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.get_init_guess">
<code class="sig-name descname">get_init_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ci_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nroots</span></em>, <em class="sig-param"><span class="n">hdiag</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.get_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.get_init_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.kernel">
<code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_memory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.kernel_fixed_space">
<code class="sig-name descname">kernel_fixed_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci_strs</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_memory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.kernel_fixed_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.large_ci">
<code class="sig-name descname">large_ci</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">return_strs</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.large_ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.large_ci" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.make_hdiag">
<code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">ci_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.make_rdm1">
<code class="sig-name descname">make_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin-traced 1-particle density matrix.</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.make_rdm12">
<code class="sig-name descname">make_rdm12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm12" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id27"><span class="problematic" id="id28">`</span></a>langle <a href="#id249"><span class="problematic" id="id250">q_</span></a>alpha^dagger <a href="#id251"><span class="problematic" id="id252">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id253"><span class="problematic" id="id254">q_</span></a>beta^dagger  <a href="#id255"><span class="problematic" id="id256">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id29"><span class="problematic" id="id30">`</span></a>langle <a href="#id257"><span class="problematic" id="id258">p_</span></a>alpha^dagger <a href="#id259"><span class="problematic" id="id260">r_</span></a>alpha^dagger <a href="#id261"><span class="problematic" id="id262">s_</span></a>alpha <a href="#id263"><span class="problematic" id="id264">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id265"><span class="problematic" id="id266">p_</span></a>beta^dagger  <a href="#id267"><span class="problematic" id="id268">r_</span></a>alpha^dagger <a href="#id269"><span class="problematic" id="id270">s_</span></a>alpha <a href="#id271"><span class="problematic" id="id272">q_</span></a>betarangle +
langle <a href="#id273"><span class="problematic" id="id274">p_</span></a>alpha^dagger <a href="#id275"><span class="problematic" id="id276">r_</span></a>beta^dagger  <a href="#id277"><span class="problematic" id="id278">s_</span></a>beta  <a href="#id279"><span class="problematic" id="id280">q_</span></a>alpharangle +
langle <a href="#id281"><span class="problematic" id="id282">p_</span></a>beta^dagger  <a href="#id283"><span class="problematic" id="id284">r_</span></a>beta^dagger  <a href="#id285"><span class="problematic" id="id286">s_</span></a>beta  <a href="#id287"><span class="problematic" id="id288">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(‘pq,qp’, h1, 1pdm) + 1/2 * einsum(‘pqrs,pqrs’, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.make_rdm12s">
<code class="sig-name descname">make_rdm12s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm12s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm12s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 1- and 2-particle density matrices.
The return values include two lists, a list of 1-particle density matrices
and a list of 2-particle density matrices.  The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,beta,beta) for 2-particle density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
<p>Energy should be computed as
E = einsum(‘pq,qp’, h1, 1pdm) + 1/2 * einsum(‘pqrs,pqrs’, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.make_rdm1s">
<code class="sig-name descname">make_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.make_rdm2">
<code class="sig-name descname">make_rdm2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm2" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin-traced two-particle density matrix.</p>
<dl class="simple">
<dt>2pdm[p,q,r,s] = :math:<a href="#id31"><span class="problematic" id="id32">`</span></a>langle <a href="#id289"><span class="problematic" id="id290">p_</span></a>alpha^dagger <a href="#id291"><span class="problematic" id="id292">r_</span></a>alpha^dagger <a href="#id293"><span class="problematic" id="id294">s_</span></a>alpha <a href="#id295"><span class="problematic" id="id296">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id297"><span class="problematic" id="id298">p_</span></a>beta^dagger  <a href="#id299"><span class="problematic" id="id300">r_</span></a>alpha^dagger <a href="#id301"><span class="problematic" id="id302">s_</span></a>alpha <a href="#id303"><span class="problematic" id="id304">q_</span></a>betarangle +
langle <a href="#id305"><span class="problematic" id="id306">p_</span></a>alpha^dagger <a href="#id307"><span class="problematic" id="id308">r_</span></a>beta^dagger  <a href="#id309"><span class="problematic" id="id310">s_</span></a>beta  <a href="#id311"><span class="problematic" id="id312">q_</span></a>alpharangle +
langle <a href="#id313"><span class="problematic" id="id314">p_</span></a>beta^dagger  <a href="#id315"><span class="problematic" id="id316">r_</span></a>beta^dagger  <a href="#id317"><span class="problematic" id="id318">s_</span></a>beta  <a href="#id319"><span class="problematic" id="id320">q_</span></a>betarangle`.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.make_rdm2s">
<code class="sig-name descname">make_rdm2s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm2s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm2s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 2-particle density matrices.
The return values include three density matrices:
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta), (beta,beta,beta,beta)</p>
<p>2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span></p>
</dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.selected_ci.SelectedCI.select_cutoff">
<code class="sig-name descname">select_cutoff</code><em class="property"> = 0.0005</em><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.select_cutoff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.spin_square">
<code class="sig-name descname">spin_square</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.spin_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.spin_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin square for RHF-FCI CI wfn only (obtained from spin-degenerated
Hamiltonian)</p>
</dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.selected_ci.SelectedCI.start_tol">
<code class="sig-name descname">start_tol</code><em class="property"> = 0.0003</em><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.start_tol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt id="pyscf.fci.selected_ci.SelectedCI.tol_decay_rate">
<code class="sig-name descname">tol_decay_rate</code><em class="property"> = 0.3</em><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.tol_decay_rate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.trans_rdm1">
<code class="sig-name descname">trans_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.trans_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.trans_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced transition 1-particle density matrices.
See also function <a class="reference internal" href="#pyscf.fci.selected_ci.make_rdm1" title="pyscf.fci.selected_ci.make_rdm1"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a></p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id33"><span class="problematic" id="id34">`</span></a>langle <a href="#id321"><span class="problematic" id="id322">q_</span></a>alpha^dagger <a href="#id323"><span class="problematic" id="id324">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id325"><span class="problematic" id="id326">q_</span></a>beta^dagger <a href="#id327"><span class="problematic" id="id328">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci.SelectedCI.trans_rdm1s">
<code class="sig-name descname">trans_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra</span></em>, <em class="sig-param"><span class="n">ciket</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.trans_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.trans_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
See also function <a class="reference internal" href="#pyscf.fci.selected_ci.make_rdm1s" title="pyscf.fci.selected_ci.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.contract_ss">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">contract_ss</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#contract_ss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.contract_ss" title="Permalink to this definition">¶</a></dt>
<dd><p>S^2 <a href="#id35"><span class="problematic" id="id36">|</span></a>Psirangle</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.cre_des_linkstr">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">cre_des_linkstr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">tril</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#cre_des_linkstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.cre_des_linkstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.cre_des_linkstr_tril">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">cre_des_linkstr_tril</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#cre_des_linkstr_tril"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.cre_des_linkstr_tril" title="Permalink to this definition">¶</a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.des_des_linkstr">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">des_des_linkstr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">tril</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#des_des_linkstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.des_des_linkstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.des_des_linkstr_tril">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">des_des_linkstr_tril</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#des_des_linkstr_tril"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.des_des_linkstr_tril" title="Permalink to this definition">¶</a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.enlarge_space">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">enlarge_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">myci</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#enlarge_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.enlarge_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.from_fci">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">from_fci</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">ci_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#from_fci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.from_fci" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.gen_cre_linkstr">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">gen_cre_linkstr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#gen_cre_linkstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.gen_cre_linkstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.gen_des_linkstr">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">gen_des_linkstr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#gen_des_linkstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.gen_des_linkstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.kernel">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_shift</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">1e-14</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">400</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">select_cutoff</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">ci_coeff_cutoff</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.kernel_fixed_space">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">kernel_fixed_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">myci</span></em>, <em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci_strs</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_memory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#kernel_fixed_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.kernel_fixed_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.kernel_float_space">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">kernel_float_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">myci</span></em>, <em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_memory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#kernel_float_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.kernel_float_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.make_hdiag">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">ci_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.make_rdm1">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">make_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin-traced 1-particle density matrix.</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.make_rdm1s">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">make_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#make_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.make_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeney’s book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(‘pq,qp’, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.make_rdm2">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">make_rdm2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#make_rdm2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.make_rdm2" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin-traced two-particle density matrix.</p>
<dl class="simple">
<dt>2pdm[p,q,r,s] = :math:<a href="#id37"><span class="problematic" id="id38">`</span></a>langle <a href="#id329"><span class="problematic" id="id330">p_</span></a>alpha^dagger <a href="#id331"><span class="problematic" id="id332">r_</span></a>alpha^dagger <a href="#id333"><span class="problematic" id="id334">s_</span></a>alpha <a href="#id335"><span class="problematic" id="id336">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id337"><span class="problematic" id="id338">p_</span></a>beta^dagger  <a href="#id339"><span class="problematic" id="id340">r_</span></a>alpha^dagger <a href="#id341"><span class="problematic" id="id342">s_</span></a>alpha <a href="#id343"><span class="problematic" id="id344">q_</span></a>betarangle +
langle <a href="#id345"><span class="problematic" id="id346">p_</span></a>alpha^dagger <a href="#id347"><span class="problematic" id="id348">r_</span></a>beta^dagger  <a href="#id349"><span class="problematic" id="id350">s_</span></a>beta  <a href="#id351"><span class="problematic" id="id352">q_</span></a>alpharangle +
langle <a href="#id353"><span class="problematic" id="id354">p_</span></a>beta^dagger  <a href="#id355"><span class="problematic" id="id356">r_</span></a>beta^dagger  <a href="#id357"><span class="problematic" id="id358">s_</span></a>beta  <a href="#id359"><span class="problematic" id="id360">q_</span></a>betarangle`.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.make_rdm2s">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">make_rdm2s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#make_rdm2s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.make_rdm2s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated 2-particle density matrices.
The return values include three density matrices:
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta), (beta,beta,beta,beta)</p>
<p>2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span></p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.select_strs">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">select_strs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">myci</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">eri_pq_max</span></em>, <em class="sig-param"><span class="n">civec_max</span></em>, <em class="sig-param"><span class="n">strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#select_strs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.select_strs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.spin_square">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">spin_square</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#spin_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.spin_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin square for RHF-FCI CI wfn only (obtained from spin-degenerated
Hamiltonian)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.to_fci">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">to_fci</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#to_fci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.to_fci" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.trans_rdm1">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">trans_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra_strs</span></em>, <em class="sig-param"><span class="n">ciket_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#trans_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.trans_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin traced transition 1-particle density matrices.
See also function <a class="reference internal" href="#pyscf.fci.selected_ci.make_rdm1" title="pyscf.fci.selected_ci.make_rdm1"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a></p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id39"><span class="problematic" id="id40">`</span></a>langle <a href="#id361"><span class="problematic" id="id362">q_</span></a>alpha^dagger <a href="#id363"><span class="problematic" id="id364">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id365"><span class="problematic" id="id366">q_</span></a>beta^dagger <a href="#id367"><span class="problematic" id="id368">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci.trans_rdm1s">
<code class="sig-prename descclassname">pyscf.fci.selected_ci.</code><code class="sig-name descname">trans_rdm1s</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cibra_strs</span></em>, <em class="sig-param"><span class="n">ciket_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#trans_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci.trans_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
See also function <a class="reference internal" href="#pyscf.fci.selected_ci.make_rdm1s" title="pyscf.fci.selected_ci.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>


<span id="pyscf-fci-selected-ci-slow-module"></span><h2 id="module-pyscf.fci.selected_ci_slow">pyscf.fci.selected_ci_slow module<a class="headerlink" href="#module-pyscf.fci.selected_ci_slow" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyscf.fci.selected_ci_slow.SelectedCI">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.selected_ci_slow.</code><code class="sig-name descname">SelectedCI</code><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#SelectedCI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.SelectedCI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_slow.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_slow.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute E_{pq}E_{rs}|CI&gt;</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_slow.cre_des_linkstr">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_slow.</code><code class="sig-name descname">cre_des_linkstr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#cre_des_linkstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.cre_des_linkstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_slow.des_des_linkstr">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_slow.</code><code class="sig-name descname">des_des_linkstr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#des_des_linkstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.des_des_linkstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_slow.enlarge_space">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_slow.</code><code class="sig-name descname">enlarge_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">myci</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#enlarge_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.enlarge_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_slow.kernel">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_slow.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_slow.make_hdiag">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_slow.</code><code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">g2e</span></em>, <em class="sig-param"><span class="n">ci_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_slow.make_rdm1">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_slow.</code><code class="sig-name descname">make_rdm1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_slow.make_rdm2">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_slow.</code><code class="sig-name descname">make_rdm2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#make_rdm2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.make_rdm2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>


<span id="pyscf-fci-selected-ci-spin0-module"></span><h2 id="module-pyscf.fci.selected_ci_spin0">pyscf.fci.selected_ci_spin0 module<a class="headerlink" href="#module-pyscf.fci.selected_ci_spin0" title="Permalink to this headline">¶</a></h2>
<dl class="py attribute">
<dt id="pyscf.fci.selected_ci_spin0.SCI">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_spin0.</code><code class="sig-name descname">SCI</code><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.SCI" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.selected_ci_spin0.SelectedCI" title="pyscf.fci.selected_ci_spin0.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.selected_ci_spin0.SelectedCI</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt id="pyscf.fci.selected_ci_spin0.SelectedCI">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.selected_ci_spin0.</code><code class="sig-name descname">SelectedCI</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#SelectedCI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.SelectedCI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.selected_ci.SelectedCI" title="pyscf.fci.selected_ci.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.selected_ci.SelectedCI</span></code></a></p>
<dl class="py method">
<dt id="pyscf.fci.selected_ci_spin0.SelectedCI.contract_2e">
<code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#SelectedCI.contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.SelectedCI.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci_spin0.SelectedCI.enlarge_space">
<code class="sig-name descname">enlarge_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.SelectedCI.enlarge_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci_spin0.SelectedCI.make_hdiag">
<code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">ci_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#SelectedCI.make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.SelectedCI.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_spin0.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_spin0.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_spin0.enlarge_space">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_spin0.</code><code class="sig-name descname">enlarge_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">myci</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#enlarge_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.enlarge_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_spin0.kernel">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_spin0.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_shift</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">1e-14</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">400</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">select_cutoff</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">ci_coeff_cutoff</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_spin0.make_hdiag">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_spin0.</code><code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">ci_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>


<span id="pyscf-fci-selected-ci-spin0-symm-module"></span><h2 id="module-pyscf.fci.selected_ci_spin0_symm">pyscf.fci.selected_ci_spin0_symm module<a class="headerlink" href="#module-pyscf.fci.selected_ci_spin0_symm" title="Permalink to this headline">¶</a></h2>
<dl class="py attribute">
<dt id="pyscf.fci.selected_ci_spin0_symm.SCI">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_spin0_symm.</code><code class="sig-name descname">SCI</code><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.SCI" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI" title="pyscf.fci.selected_ci_spin0_symm.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.selected_ci_spin0_symm.SelectedCI</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt id="pyscf.fci.selected_ci_spin0_symm.SelectedCI">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.selected_ci_spin0_symm.</code><code class="sig-name descname">SelectedCI</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0_symm.html#SelectedCI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.selected_ci_symm.SelectedCI" title="pyscf.fci.selected_ci_symm.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.selected_ci_symm.SelectedCI</span></code></a></p>
<dl class="py method">
<dt id="pyscf.fci.selected_ci_spin0_symm.SelectedCI.contract_2e">
<code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0_symm.html#SelectedCI.contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci_spin0_symm.SelectedCI.enlarge_space">
<code class="sig-name descname">enlarge_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI.enlarge_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci_spin0_symm.SelectedCI.make_hdiag">
<code class="sig-name descname">make_hdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">ci_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0_symm.html#SelectedCI.make_hdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI.make_hdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_spin0_symm.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_spin0_symm.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0_symm.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_spin0_symm.kernel">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_spin0_symm.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_shift</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">1e-14</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">400</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">select_cutoff</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">ci_coeff_cutoff</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0_symm.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>


<span id="pyscf-fci-selected-ci-symm-module"></span><h2 id="module-pyscf.fci.selected_ci_symm">pyscf.fci.selected_ci_symm module<a class="headerlink" href="#module-pyscf.fci.selected_ci_symm" title="Permalink to this headline">¶</a></h2>
<dl class="py attribute">
<dt id="pyscf.fci.selected_ci_symm.SCI">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_symm.</code><code class="sig-name descname">SCI</code><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SCI" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.selected_ci_symm.SelectedCI" title="pyscf.fci.selected_ci_symm.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.selected_ci_symm.SelectedCI</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt id="pyscf.fci.selected_ci_symm.SelectedCI">
<em class="property">class </em><code class="sig-prename descclassname">pyscf.fci.selected_ci_symm.</code><code class="sig-name descname">SelectedCI</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#SelectedCI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SelectedCI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.selected_ci.SelectedCI" title="pyscf.fci.selected_ci.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.fci.selected_ci.SelectedCI</span></code></a></p>
<dl class="py method">
<dt id="pyscf.fci.selected_ci_symm.SelectedCI.contract_2e">
<code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#SelectedCI.contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SelectedCI.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci_symm.SelectedCI.get_init_guess">
<code class="sig-name descname">get_init_guess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ci_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">nroots</span></em>, <em class="sig-param"><span class="n">hdiag</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#SelectedCI.get_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SelectedCI.get_init_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci_symm.SelectedCI.guess_wfnsym">
<code class="sig-name descname">guess_wfnsym</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">fcivec</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#SelectedCI.guess_wfnsym"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SelectedCI.guess_wfnsym" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt id="pyscf.fci.selected_ci_symm.SelectedCI.kernel">
<code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#SelectedCI.kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SelectedCI.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_symm.contract_2e">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_symm.</code><code class="sig-name descname">contract_2e</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">civec_strs</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">link_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#contract_2e"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.contract_2e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_symm.kernel">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_symm.</code><code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1e</span></em>, <em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">ci0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">level_shift</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">lindep</span><span class="o">=</span><span class="default_value">1e-14</span></em>, <em class="sig-param"><span class="n">max_cycle</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">max_space</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">nroots</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">davidson_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pspace_size</span><span class="o">=</span><span class="default_value">400</span></em>, <em class="sig-param"><span class="n">orbsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wfnsym</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">select_cutoff</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">ci_coeff_cutoff</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">ecore</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.selected_ci_symm.reorder4irrep">
<code class="sig-prename descclassname">pyscf.fci.selected_ci_symm.</code><code class="sig-name descname">reorder4irrep</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eri</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">link_index</span></em>, <em class="sig-param"><span class="n">orbsym</span></em>, <em class="sig-param"><span class="n">offdiag</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#reorder4irrep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.reorder4irrep" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>


<span id="pyscf-fci-spin-op-module"></span><h2 id="module-pyscf.fci.spin_op">pyscf.fci.spin_op module<a class="headerlink" href="#module-pyscf.fci.spin_op" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyscf.fci.spin_op.contract_ss">
<code class="sig-prename descclassname">pyscf.fci.spin_op.</code><code class="sig-name descname">contract_ss</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#contract_ss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.spin_op.contract_ss" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract spin square operator with FCI wavefunction <span class="math notranslate nohighlight">\(S^2 |CI&gt;\)</span></p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.spin_op.local_spin">
<code class="sig-prename descclassname">pyscf.fci.spin_op.</code><code class="sig-name descname">local_spin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">mo_coeff</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ovlp</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">aolst</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#local_spin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.spin_op.local_spin" title="Permalink to this definition">¶</a></dt>
<dd><p>Local spin expectation value, which is defined as</p>
<p>&lt;CI|(local S^2)|CI&gt;</p>
<p>The local S^2 operator only couples the orbitals specified in aolst. The
cross term which involves the interaction between the local part (in aolst)
and non-local part (not in aolst) is not included. As a result, the value
of local_spin is not additive. In other words, if local_spin is computed
twice with the complementary aolst in the two runs, the summation does not
equal to the S^2 of the entire system.</p>
<p>For a complete list of AOs, the value of local_spin is equivalent to &lt;CI|S^2|CI&gt;</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.spin_op.make_rdm2_abba">
<code class="sig-prename descclassname">pyscf.fci.spin_op.</code><code class="sig-name descname">make_rdm2_abba</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#make_rdm2_abba"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.spin_op.make_rdm2_abba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.spin_op.make_rdm2_baab">
<code class="sig-prename descclassname">pyscf.fci.spin_op.</code><code class="sig-name descname">make_rdm2_baab</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#make_rdm2_baab"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.spin_op.make_rdm2_baab" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="pyscf.fci.spin_op.spin_square">
<code class="sig-prename descclassname">pyscf.fci.spin_op.</code><code class="sig-name descname">spin_square</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em>, <em class="sig-param"><span class="n">mo_coeff</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ovlp</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#spin_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.spin_op.spin_square" title="Permalink to this definition">¶</a></dt>
<dd><p>General spin square operator.</p>
<p>… math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_</span><span class="o">+*</span><span class="n">S_</span><span class="o">-|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> <span class="n">n_</span>\<span class="n">alpha</span> <span class="o">+</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">alpha</span> <span class="p">}</span> \\
<span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_</span><span class="o">-*</span><span class="n">S_</span><span class="o">+|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> <span class="n">n_</span>\<span class="n">beta</span> <span class="o">+</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">beta</span> <span class="p">}</span> \\
<span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_z</span><span class="o">*</span><span class="n">S_z</span><span class="o">|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}(</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">alpha</span> <span class="p">}</span>
                 <span class="o">-</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">beta</span> <span class="p">}</span>
                 <span class="o">-</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">alpha</span><span class="p">}</span>
                 <span class="o">+</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">beta</span><span class="p">})</span>
                 <span class="o">+</span> <span class="p">(</span><span class="n">n_</span>\<span class="n">alpha</span><span class="o">+</span><span class="n">n_</span>\<span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
</pre></div>
</div>
<p>Given the overlap betwen non-degenerate alpha and beta orbitals, this
function can compute the expectation value spin square operator for
UHF-FCI wavefunction</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.spin_op.spin_square0">
<code class="sig-prename descclassname">pyscf.fci.spin_op.</code><code class="sig-name descname">spin_square0</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fcivec</span></em>, <em class="sig-param"><span class="n">norb</span></em>, <em class="sig-param"><span class="n">nelec</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#spin_square0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.spin_op.spin_square0" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin square for RHF-FCI CI wfn only (obtained from spin-degenerated
Hamiltonian)</p>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.spin_op.spin_square_general">
<code class="sig-prename descclassname">pyscf.fci.spin_op.</code><code class="sig-name descname">spin_square_general</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dm1a</span></em>, <em class="sig-param"><span class="n">dm1b</span></em>, <em class="sig-param"><span class="n">dm2aa</span></em>, <em class="sig-param"><span class="n">dm2ab</span></em>, <em class="sig-param"><span class="n">dm2bb</span></em>, <em class="sig-param"><span class="n">mo_coeff</span></em>, <em class="sig-param"><span class="n">ovlp</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#spin_square_general"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.spin_op.spin_square_general" title="Permalink to this definition">¶</a></dt>
<dd><p>General spin square operator.</p>
<p>… math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_</span><span class="o">+*</span><span class="n">S_</span><span class="o">-|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> <span class="n">n_</span>\<span class="n">alpha</span> <span class="o">+</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">alpha</span> <span class="p">}</span> \\
<span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_</span><span class="o">-*</span><span class="n">S_</span><span class="o">+|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> <span class="n">n_</span>\<span class="n">beta</span> <span class="o">+</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">beta</span> <span class="p">}</span> \\
<span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_z</span><span class="o">*</span><span class="n">S_z</span><span class="o">|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}(</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">alpha</span> <span class="p">}</span>
                 <span class="o">-</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">beta</span> <span class="p">}</span>
                 <span class="o">-</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">alpha</span><span class="p">}</span>
                 <span class="o">+</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">beta</span><span class="p">})</span>
                 <span class="o">+</span> <span class="p">(</span><span class="n">n_</span>\<span class="n">alpha</span><span class="o">+</span><span class="n">n_</span>\<span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
</pre></div>
</div>
<p>Given the overlap betwen non-degenerate alpha and beta orbitals, this
function can compute the expectation value spin square operator for
UHF-FCI wavefunction</p>
</dd></dl>


<span id="module-contents"></span><h2 id="module-pyscf.fci">Module contents<a class="headerlink" href="#module-pyscf.fci" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) …</p>
<dl class="py function">
<dt id="pyscf.fci.FCI">
<code class="sig-prename descclassname">pyscf.fci.</code><code class="sig-name descname">FCI</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol_or_mf</span></em>, <em class="sig-param"><span class="n">mo</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">singlet</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci.html#FCI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.FCI" title="Permalink to this definition">¶</a></dt>
<dd><p>FCI solver</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>mol_or_mf :</dt><dd><p>A Mole object or an SCF object</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>mo :</dt><dd><p>Molecular orbital coefficients</p>
</dd>
<dt>singlet :</dt><dd><p>Whether to enable spin symmetry for S=0 RHF-based FCI solver.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A FCI object</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pyscf.fci.solver">
<code class="sig-prename descclassname">pyscf.fci.</code><code class="sig-name descname">solver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">singlet</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">symm</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci.html#solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.fci.solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="pyscf.extras.mbd.html" title="5.1.13.1.1. pyscf.extras.mbd package"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> <span class="section-number">5.1.13.1.1. </span>pyscf.extras.mbd package </span>
              </div>
            </a>
          
          
            <a href="pyscf.geomopt.html" title="pyscf.geomopt package"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> pyscf.geomopt package </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>