<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>pyscf.fci package &#8212; PySCF</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pyscf.geomopt package" href="pyscf.geomopt.html" />
    <link rel="prev" title="pyscf.eph package" href="pyscf.eph.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=pyscf data-md-color-accent=pyscf>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#pyscf_api_docs/pyscf.fci" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="PySCF"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.3</span>
          <span class="md-header-nav__topic"> pyscf.fci package </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../quickstart.html" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../develop.html" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../about.html" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="pyscf.html" class="md-tabs__link">pyscf package</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="PySCF" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="PySCF">PySCF 2.3</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../install.html" class="md-nav__link">Install PySCF</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#advanced-build-options" class="md-nav__link">Advanced build options</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#install-pyscf-extensions" class="md-nav__link">Install PySCF extensions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#troubleshooting" class="md-nav__link">Troubleshooting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickstart.html" class="md-nav__link">Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../user.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html" class="md-nav__link">API</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#subpackages" class="md-nav__link">Subpackages</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#submodules" class="md-nav__link">Submodules</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf.post_scf" class="md-nav__link">pyscf.post_scf module</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf" class="md-nav__link">Module contents</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about.html" class="md-nav__link">About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#pyscf-api-docs-pyscf-fci--page-root" class="md-nav__link">pyscf.fci package</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#submodules" class="md-nav__link">Submodules</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.addons" class="md-nav__link">pyscf.fci.addons module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.addons.SpinPenaltyFCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SpinPenaltyFCISolver</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.SpinPenaltyMod" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SpinPenaltyMod</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.cre_a" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cre_a()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.cre_b" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cre_b()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.cylindrical_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cylindrical_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.des_a" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">des_a()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.des_b" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">des_b()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.det_overlap" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">det_overlap()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.fix_spin" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">fix_spin()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.fix_spin_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">fix_spin_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.guess_wfnsym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">guess_wfnsym()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.initguess_triplet" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">initguess_triplet()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.large_ci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">large_ci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.overlap" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">overlap()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.symm_initguess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">symm_initguess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.symmetrize_wfn" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">symmetrize_wfn()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.transform_ci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">transform_ci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.addons.transform_ci_for_orbital_rotation" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">transform_ci_for_orbital_rotation()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.cistring" class="md-nav__link">pyscf.fci.cistring module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.OIndexList" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">OIndexList</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.addr2str" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">addr2str()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.addr2str_o0" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">addr2str_o0()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.addr2str_o1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">addr2str_o1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.addrs2str" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">addrs2str()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.cre_des_sign" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cre_des_sign()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.cre_sign" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cre_sign()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.des_sign" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">des_sign()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_cre_str_index" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_cre_str_index()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_cre_str_index_o0" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_cre_str_index_o0()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_cre_str_index_o1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_cre_str_index_o1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_des_str_index" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_des_str_index()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_des_str_index_o0" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_des_str_index_o0()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_des_str_index_o1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_des_str_index_o1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_linkstr_index" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_linkstr_index()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_linkstr_index_o0" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_linkstr_index_o0()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_linkstr_index_o1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_linkstr_index_o1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_linkstr_index_trilidx" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_linkstr_index_trilidx()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_occslst" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_occslst()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.gen_strings4orblist" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_strings4orblist()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.make_strings" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_strings()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.num_strings" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">num_strings()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.parity" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">parity()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.reform_linkstr_index" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">reform_linkstr_index()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.str2addr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">str2addr()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.strs2addr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">strs2addr()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.sub_addrs" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">sub_addrs()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.cistring.tn_strs" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">tn_strs()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_ep" class="md-nav__link">pyscf.fci.direct_ep module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.contract_2e_hubbard" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e_hubbard()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.contract_all" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_all()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.contract_ep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_ep()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.contract_pp" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_pp()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.cre_phonon" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cre_phonon()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.des_phonon" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">des_phonon()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.make_rdm12e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm12e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.make_rdm1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.make_rdm1p" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1p()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.make_shape" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_shape()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.slices_for" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">slices_for()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.slices_for_cre" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">slices_for_cre()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_ep.slices_for_des" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">slices_for_des()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_nosym" class="md-nav__link">pyscf.fci.direct_nosym module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_nosym.FCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_nosym.FCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_nosym.FCISolver.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_nosym.FCISolver.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_nosym.FCISolver.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_nosym.FCISolver.eig" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.eig()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_nosym.FCISolver.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_nosym.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_nosym.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_nosym.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_nosym.energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_spin0" class="md-nav__link">pyscf.fci.direct_spin0 module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.energy()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.gen_linkstr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.gen_linkstr()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.trans_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.trans_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.trans_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.trans_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.FCISolver.trans_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.trans_rdm1s()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.kernel_ms0" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel_ms0()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.trans_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.trans_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0.trans_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_rdm1s()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_spin0_symm" class="md-nav__link">pyscf.fci.direct_spin0_symm module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.contract_ss" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_ss()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.davidson_only" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.davidson_only</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.guess_wfnsym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.guess_wfnsym()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.pspace" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.pspace()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.FCISolver.pspace_size" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.pspace_size</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin0_symm.get_init_guess_cyl_sym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_init_guess_cyl_sym()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_spin1" class="md-nav__link">pyscf.fci.direct_spin1 module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.contract_ss" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.contract_ss()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.conv_tol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.conv_tol</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.conv_tol_residual" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.conv_tol_residual</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.davidson_only" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.davidson_only</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.e_tot" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.e_tot</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.eig" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.eig()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.energy()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.gen_linkstr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.gen_linkstr()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.large_ci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.large_ci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.lessio" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.lessio</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.level_shift" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.level_shift</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.lindep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.lindep</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.make_precond" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.make_precond()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.make_rdm12s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.make_rdm12s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.make_rdm2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.make_rdm2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.max_cycle" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.max_cycle</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.max_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.max_space</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.nstates" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.nstates</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.pspace" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.pspace()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.pspace_size" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.pspace_size</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.spin_square" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.spin_square()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.threads" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.threads</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.trans_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.trans_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm12s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.trans_rdm12s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIBase.trans_rdm1s()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCISolver.transform_ci_for_orbital_rotation" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.transform_ci_for_orbital_rotation()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.FCIvector" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCIvector</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.kernel_ms1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel_ms1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.make_diag_precond" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_diag_precond()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.make_pspace_precond" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_pspace_precond()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.make_rdm12s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm12s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.pspace" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">pspace()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.trans_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.trans_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.trans_rdm12s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_rdm12s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1.trans_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_rdm1s()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_spin1_cyl_sym" class="md-nav__link">pyscf.fci.direct_spin1_cyl_sym module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.guess_wfnsym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.guess_wfnsym()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm12s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_rdm12s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.pspace" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.pspace()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.trans_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.trans_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm12s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.trans_rdm12s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.trans_rdm1s()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.argsort_strs_by_irrep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">argsort_strs_by_irrep()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.gen_str_irrep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_str_irrep()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.guess_wfnsym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">guess_wfnsym()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.reorder_eri" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">reorder_eri()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_cyl_sym.sym_allowed_indices" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">sym_allowed_indices()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_spin1_symm" class="md-nav__link">pyscf.fci.direct_spin1_symm module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver.contract_ss" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_ss()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver.guess_wfnsym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.guess_wfnsym()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver.pspace" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.pspace()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.FCISolver.pspace_size" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.pspace_size</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.argsort_strs_by_irrep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">argsort_strs_by_irrep()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.gen_str_irrep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_str_irrep()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.get_init_guess_cyl_sym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_init_guess_cyl_sym()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.guess_wfnsym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">guess_wfnsym()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.reorder_eri" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">reorder_eri()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_spin1_symm.sym_allowed_indices" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">sym_allowed_indices()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.direct_uhf" class="md-nav__link">pyscf.fci.direct_uhf module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.FCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.FCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.FCISolver.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.FCISolver.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.FCISolver.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.FCISolver.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.FCISolver.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.FCISolver.pspace" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.pspace()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.FCISolver.spin_square" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.spin_square()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.FCISolver.trans_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.trans_rdm1()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.contract_2e_hubbard" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e_hubbard()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.pspace" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">pspace()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.direct_uhf.trans_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_rdm1()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.fci_dhf_slow" class="md-nav__link">pyscf.fci.fci_dhf_slow module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver.energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.energy()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver.make_rdm2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.make_rdm2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver.pspace" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.pspace()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.FCISolver.spin_square" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCISolver.spin_square()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.kernel_dhf" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel_dhf()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_dhf_slow.reorder_rdm" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">reorder_rdm()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.fci_slow" class="md-nav__link">pyscf.fci.fci_slow module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.fci_slow.absorb_h1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">absorb_h1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_slow.contract_1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_slow.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_slow.contract_2e_hubbard" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e_hubbard()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_slow.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_slow.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_slow.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_slow.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.fci_slow.reorder_rdm" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">reorder_rdm()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.rdm" class="md-nav__link">pyscf.fci.rdm module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.make_dm123" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_dm123()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.make_dm1234" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_dm1234()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.make_rdm12_ms0" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm12_ms0()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.make_rdm12_spin1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm12_spin1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.make_rdm1_ms0" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1_ms0()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.make_rdm1_spin1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1_spin1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.reorder_dm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">reorder_dm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.reorder_dm123" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">reorder_dm123()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.reorder_dm1234" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">reorder_dm1234()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.rdm.reorder_rdm" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">reorder_rdm()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.selected_ci" class="md-nav__link">pyscf.fci.selected_ci module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SCIvector" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SCIvector</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.ci_coeff_cutoff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.ci_coeff_cutoff</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.contract_ss" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.contract_ss()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.conv_tol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.conv_tol</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.enlarge_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.enlarge_space()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.gen_linkstr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.gen_linkstr()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.kernel_fixed_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.kernel_fixed_space()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.large_ci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.large_ci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.make_rdm12s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.make_rdm12s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.make_rdm2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.make_rdm2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.make_rdm2s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.make_rdm2s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.select_cutoff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.select_cutoff</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.spin_square" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.spin_square()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.start_tol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.start_tol</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.tol_decay_rate" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.tol_decay_rate</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.trans_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.trans_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.SelectedCI.trans_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.trans_rdm1s()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.contract_ss" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_ss()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.cre_des_linkstr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cre_des_linkstr()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.cre_des_linkstr_tril" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cre_des_linkstr_tril()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.des_des_linkstr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">des_des_linkstr()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.des_des_linkstr_tril" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">des_des_linkstr_tril()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.enlarge_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">enlarge_space()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.from_fci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">from_fci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.gen_cre_linkstr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_cre_linkstr()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.gen_des_linkstr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_des_linkstr()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.kernel_fixed_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel_fixed_space()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.kernel_float_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel_float_space()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.make_rdm2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm2()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.make_rdm2s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm2s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.select_strs" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">select_strs()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.spin_square" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">spin_square()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.to_fci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">to_fci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.trans_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci.trans_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_rdm1s()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.selected_ci_slow" class="md-nav__link">pyscf.fci.selected_ci_slow module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_slow.SelectedCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_slow.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_slow.cre_des_linkstr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cre_des_linkstr()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_slow.des_des_linkstr" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">des_des_linkstr()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_slow.enlarge_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">enlarge_space()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_slow.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_slow.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_hdiag()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_slow.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_slow.make_rdm2" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm2()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.selected_ci_spin0" class="md-nav__link">pyscf.fci.selected_ci_spin0 module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0.SCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0.SelectedCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0.SelectedCI.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0.SelectedCI.enlarge_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.enlarge_space()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0.SelectedCI.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.make_hdiag()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0.enlarge_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">enlarge_space()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_hdiag()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.selected_ci_spin0_symm" class="md-nav__link">pyscf.fci.selected_ci_spin0_symm module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0_symm.SCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI.enlarge_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.enlarge_space()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI.make_hdiag" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.make_hdiag()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0_symm.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_spin0_symm.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.selected_ci_symm" class="md-nav__link">pyscf.fci.selected_ci_symm module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_symm.SCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_symm.SelectedCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_symm.SelectedCI.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_symm.SelectedCI.get_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.get_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_symm.SelectedCI.guess_wfnsym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.guess_wfnsym()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_symm.SelectedCI.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SelectedCI.kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_symm.contract_2e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_2e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_symm.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.selected_ci_symm.reorder4irrep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">reorder4irrep()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci.spin_op" class="md-nav__link">pyscf.fci.spin_op module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.spin_op.contract_ss" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">contract_ss()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.spin_op.local_spin" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">local_spin()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.spin_op.make_rdm2_abba" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm2_abba()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.spin_op.make_rdm2_baab" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm2_baab()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.spin_op.spin_square" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">spin_square()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.spin_op.spin_square0" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">spin_square0()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.spin_op.spin_square_general" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">spin_square_general()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.fci" class="md-nav__link">Module contents</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.fci.FCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FCI()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.fci.solver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">solver()</span></code></a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/pyscf_api_docs/pyscf.fci.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="pyscf-fci-package">
<h1 id="pyscf-api-docs-pyscf-fci--page-root">pyscf.fci package<a class="headerlink" href="#pyscf-api-docs-pyscf-fci--page-root" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2 id="submodules">Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pyscf.fci.addons">
<span id="pyscf-fci-addons-module"></span><h2 id="module-pyscf.fci.addons">pyscf.fci.addons module<a class="headerlink" href="#module-pyscf.fci.addons" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.addons.SpinPenaltyFCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">SpinPenaltyFCISolver</span></span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#SpinPenaltyFCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.SpinPenaltyFCISolver" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.addons.SpinPenaltyMod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">SpinPenaltyMod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#SpinPenaltyMod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.SpinPenaltyMod" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.cre_a">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">cre_a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neleca_nelecb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#cre_a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.cre_a" title="Permalink to this definition"></a></dt>
<dd><p>Construct (N+1)-electron wavefunction by adding an alpha electron in
the N-electron wavefunction.</p>
<p> math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span>\<span class="n">rangle</span> <span class="o">=</span> \<span class="n">hat</span><span class="p">{</span><span class="n">a</span><span class="p">}</span><span class="o">^+</span><span class="n">_p</span> <span class="o">|</span><span class="n">N</span>\<span class="n">rangle</span>
</pre></div>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci0<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>(neleca,nelecb)<span class="classifier">(int,int)</span></dt><dd><p>Number of (alpha, beta) electrons of the input CI function</p>
</dd>
<dt>ap_id<span class="classifier">int</span></dt><dd><p>Orbital index (0-based), for the creation operator</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array, row for alpha strings and column for beta strings. Note it
has different number of rows to the input CI coefficients.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.cre_b">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">cre_b</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neleca_nelecb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#cre_b"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.cre_b" title="Permalink to this definition"></a></dt>
<dd><p>Construct (N+1)-electron wavefunction by adding a beta electron in
the N-electron wavefunction.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci0<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>(neleca,nelecb)<span class="classifier">(int,int)</span></dt><dd><p>Number of (alpha, beta) electrons of the input CI function</p>
</dd>
<dt>ap_id<span class="classifier">int</span></dt><dd><p>Orbital index (0-based), for the creation operator</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array, row for alpha strings and column for beta strings. Note it
has different number of columns to the input CI coefficients.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.cylindrical_init_guess">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">cylindrical_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#cylindrical_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.cylindrical_init_guess" title="Permalink to this definition"></a></dt>
<dd><p>FCI initial guess for system of cylindrical symmetry.
(In testing)</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'O; O 1 1.2'</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orbsym</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ci0</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">cylindrical_init_guess</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">orbsym</span><span class="p">,</span> <span class="n">wfnsym</span><span class="o">=</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ci0</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ci0</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">cylindrical_init_guess</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">orbsym</span><span class="p">,</span> <span class="n">wfnsym</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ci0</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.des_a">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">des_a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neleca_nelecb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#des_a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.des_a" title="Permalink to this definition"></a></dt>
<dd><p>Construct (N-1)-electron wavefunction by removing an alpha electron from
the N-electron wavefunction.</p>
<p> math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span>\<span class="n">rangle</span> <span class="o">=</span> \<span class="n">hat</span><span class="p">{</span><span class="n">a</span><span class="p">}</span><span class="n">_p</span> <span class="o">|</span><span class="n">N</span>\<span class="n">rangle</span>
</pre></div>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci0<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>(neleca,nelecb)<span class="classifier">(int,int)</span></dt><dd><p>Number of (alpha, beta) electrons of the input CI function</p>
</dd>
<dt>ap_id<span class="classifier">int</span></dt><dd><p>Orbital index (0-based), for the annihilation operator</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array, row for alpha strings and column for beta strings.  Note it
has different number of rows to the input CI coefficients</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.des_b">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">des_b</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neleca_nelecb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#des_b"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.des_b" title="Permalink to this definition"></a></dt>
<dd><p>Construct (N-1)-electron wavefunction by removing a beta electron from
N-electron wavefunction.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci0<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>(neleca,nelecb)<span class="classifier">(int,int)</span></dt><dd><p>Number of (alpha, beta) electrons of the input CI function</p>
</dd>
<dt>ap_id<span class="classifier">int</span></dt><dd><p>Orbital index (0-based), for the annihilation operator</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array, row for alpha strings and column for beta strings. Note it
has different number of columns to the input CI coefficients.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.det_overlap">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">det_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#det_overlap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.det_overlap" title="Permalink to this definition"></a></dt>
<dd><p>Determinants overlap on non-orthogonal one-particle basis</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.fix_spin">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">fix_spin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fciobj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#fix_spin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.fix_spin" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.fix_spin_">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">fix_spin_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fciobj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#fix_spin_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.fix_spin_" title="Permalink to this definition"></a></dt>
<dd><p>If FCI solver cannot stay on spin eigenfunction, this function can
add a shift to the states which have wrong spin.</p>
<div class="math notranslate nohighlight">
\[(H + shift*S^2) |\Psi\rangle = E |\Psi\rangle\]</div>
<dl class="simple">
<dt>Args:</dt><dd><p>fciobj : An instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shift<span class="classifier">float</span></dt><dd><p>Level shift for states which have different spin</p>
</dd>
<dt>ss<span class="classifier">number</span></dt><dd><p>S^2 expection value == s*(s+1)</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>A modified FCI object based on fciobj.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.guess_wfnsym">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">guess_wfnsym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#guess_wfnsym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.guess_wfnsym" title="Permalink to this definition"></a></dt>
<dd><p>Guess the wavefunction symmetry based on the non-zero elements in the
given CI coefficients.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>nelec<span class="classifier">int or 2-item list</span></dt><dd><p>Number of electrons, or 2-item list for (alpha, beta) electrons</p>
</dd>
<dt>orbsym<span class="classifier">list of int</span></dt><dd><p>The irrep ID for each orbital.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Irrep ID</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.initguess_triplet">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">initguess_triplet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binstring</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#initguess_triplet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.initguess_triplet" title="Permalink to this definition"></a></dt>
<dd><p>Generate a triplet initial guess for FCI solver</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.large_ci">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">large_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_strs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#large_ci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.large_ci" title="Permalink to this definition"></a></dt>
<dd><p>Search for the largest CI coefficients</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.overlap">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#overlap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.overlap" title="Permalink to this definition"></a></dt>
<dd><p>Overlap between two CI wavefunctions</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>s<span class="classifier">2D array or a list of 2D array</span></dt><dd><p>The overlap matrix of non-orthogonal one-particle basis</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.symm_initguess">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">symm_initguess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irrep_nelec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#symm_initguess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.symm_initguess" title="Permalink to this definition"></a></dt>
<dd><p>Generate CI wavefunction initial guess which has the given symmetry.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>nelec<span class="classifier">int or 2-item list</span></dt><dd><p>Number of electrons, or 2-item list for (alpha, beta) electrons</p>
</dd>
<dt>orbsym<span class="classifier">list of int</span></dt><dd><p>The irrep ID for each orbital.</p>
</dd>
</dl>
</dd>
<dt>Kwags:</dt><dd><dl class="simple">
<dt>wfnsym<span class="classifier">int</span></dt><dd><p>The irrep ID of target symmetry</p>
</dd>
<dt>irrep_nelec<span class="classifier">dict</span></dt><dd><p>Freeze occupancy for certain irreps</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>CI coefficients 2D array which has the target symmetry.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.symmetrize_wfn">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">symmetrize_wfn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#symmetrize_wfn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.symmetrize_wfn" title="Permalink to this definition"></a></dt>
<dd><p>Symmetrize the CI wavefunction by zeroing out the determinants which
do not have the right symmetry.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ci<span class="classifier">2D array</span></dt><dd><p>CI coefficients, row for alpha strings and column for beta strings.</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>Number of orbitals.</p>
</dd>
<dt>nelec<span class="classifier">int or 2-item list</span></dt><dd><p>Number of electrons, or 2-item list for (alpha, beta) electrons</p>
</dd>
<dt>orbsym<span class="classifier">list of int</span></dt><dd><p>The irrep ID for each orbital.</p>
</dd>
</dl>
</dd>
<dt>Kwags:</dt><dd><dl class="simple">
<dt>wfnsym<span class="classifier">int</span></dt><dd><p>The irrep ID of target symmetry</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array which is the symmetrized CI coefficients</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.transform_ci">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">transform_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#transform_ci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.transform_ci" title="Permalink to this definition"></a></dt>
<dd><p>Transform CI coefficients to the representation in new one-particle basis.
Solving CI problem for Hamiltonian h1, h2 defined in old basis,
CI_old = fci.kernel(h1, h2, )
Given orbital rotation u, the CI problem can be either solved by
transforming the Hamiltonian, or transforming the coefficients.
CI_new = fci.kernel(u^T*h1*u, ) = transform_ci_for_orbital_rotation(CI_old, u)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>u<span class="classifier">2D array or a list of 2D array</span></dt><dd><p>the orbital rotation to transform the old one-particle basis to new
one-particle basis. If u is not a squared matrix, the resultant CI
coefficients array may have different shape to the input CI
coefficients.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.addons.transform_ci_for_orbital_rotation">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.addons.</span></span><span class="sig-name descname"><span class="pre">transform_ci_for_orbital_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/addons.html#transform_ci_for_orbital_rotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.addons.transform_ci_for_orbital_rotation" title="Permalink to this definition"></a></dt>
<dd><p>Transform CI coefficients (dimension conserved) to the representation in
new one-particle basis.  Solving CI problem for Hamiltonian h1, h2 defined
in old basis,
CI_old = fci.kernel(h1, h2, )
Given orbital rotation u, the CI problem can be either solved by
transforming the Hamiltonian, or transforming the coefficients.
CI_new = fci.kernel(u^T*h1*u, ) = transform_ci_for_orbital_rotation(CI_old, u)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>u<span class="classifier">a squared 2D array or a list of 2D array</span></dt><dd><p>the orbital rotation to transform the old one-particle basis to new
one-particle basis</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-pyscf.fci.cistring">
<span id="pyscf-fci-cistring-module"></span><h2 id="module-pyscf.fci.cistring">pyscf.fci.cistring module<a class="headerlink" href="#module-pyscf.fci.cistring" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.cistring.OIndexList">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">OIndexList</span></span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#OIndexList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.OIndexList" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.addr2str">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">addr2str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#addr2str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.addr2str" title="Permalink to this definition"></a></dt>
<dd><p>Convert CI determinant address to string</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.addr2str_o0">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">addr2str_o0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#addr2str_o0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.addr2str_o0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.addr2str_o1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">addr2str_o1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#addr2str_o1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.addr2str_o1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.addrs2str">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">addrs2str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addrs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#addrs2str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.addrs2str" title="Permalink to this definition"></a></dt>
<dd><p>Convert a list of CI determinant address to string</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.cre_des_sign">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">cre_des_sign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#cre_des_sign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.cre_des_sign" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.cre_sign">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">cre_sign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#cre_sign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.cre_sign" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.des_sign">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">des_sign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#des_sign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.des_sign" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_cre_str_index">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_cre_str_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_cre_str_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_cre_str_index" title="Permalink to this definition"></a></dt>
<dd><p>linkstr_index to map between N electron string to N+1 electron string.
It maps the given string to the address of the string which is generated by
the creation operator.</p>
<p>For given string str0, index[str0] is nvir x 4 array.  Each entry
[i(cre),,str1,sign] means starting from str0, creating i, to get str1.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_cre_str_index_o0">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_cre_str_index_o0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_cre_str_index_o0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_cre_str_index_o0" title="Permalink to this definition"></a></dt>
<dd><p>Slow version of gen_cre_str_index function</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_cre_str_index_o1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_cre_str_index_o1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_cre_str_index_o1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_cre_str_index_o1" title="Permalink to this definition"></a></dt>
<dd><p>C implementation of gen_cre_str_index function</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_des_str_index">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_des_str_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_des_str_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_des_str_index" title="Permalink to this definition"></a></dt>
<dd><p>linkstr_index to map between N electron string to N-1 electron string.
It maps the given string to the address of the string which is generated by
the annihilation operator.</p>
<p>For given string str0, index[str0] is nvir x 4 array.  Each entry
[,i(des),str1,sign] means starting from str0, annihilating i, to get str1.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_des_str_index_o0">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_des_str_index_o0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_des_str_index_o0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_des_str_index_o0" title="Permalink to this definition"></a></dt>
<dd><p>Slow version of gen_des_str_index function</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_des_str_index_o1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_des_str_index_o1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_des_str_index_o1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_des_str_index_o1" title="Permalink to this definition"></a></dt>
<dd><p>C implementation of gen_des_str_index function</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_linkstr_index">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_linkstr_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tril</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_linkstr_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_linkstr_index" title="Permalink to this definition"></a></dt>
<dd><p>Look up table, for the strings relationship in terms of a
creation-annihilating operator pair.</p>
<p>For given string str0, index[str0] is (nocc+nocc*nvir) x 4 array.
The first nocc rows [i(:occ),i(:occ),str0,sign] are occupied-occupied
excitations, which do not change the string. The next nocc*nvir rows
[a(:vir),i(:occ),str1,sign] are occupied-virtual exciations, starting from
str0, annihilating i, creating a, to get str1.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_linkstr_index_o0">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_linkstr_index_o0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_linkstr_index_o0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_linkstr_index_o0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_linkstr_index_o1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_linkstr_index_o1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tril</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_linkstr_index_o1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_linkstr_index_o1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_linkstr_index_trilidx">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_linkstr_index_trilidx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_linkstr_index_trilidx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_linkstr_index_trilidx" title="Permalink to this definition"></a></dt>
<dd><p>Generate linkstr_index with the assumption that <span class="math notranslate nohighlight">\(p^+ q|0\rangle\)</span>
where <span class="math notranslate nohighlight">\(p &gt; q\)</span>.
So the resultant link_index has the structure <code class="docutils literal notranslate"><span class="pre">[pq,</span> <span class="pre">*,</span> <span class="pre">str1,</span> <span class="pre">sign]</span></code>.
It is identical to a call to <code class="docutils literal notranslate"><span class="pre">reform_linkstr_index(gen_linkstr_index(...))</span></code>.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_occslst">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_occslst</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#gen_occslst"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.gen_occslst" title="Permalink to this definition"></a></dt>
<dd><p>Generate occupied orbital list for each string.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>List of lists of int32. Each inner list has length equal to the number of
electrons, and contains the occupied orbitals in the corresponding string.</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">make_strings</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)]</span>
<span class="go">['0b11', '0b101', '0b110', '0b1001', '0b1010', '0b1100']</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen_occslst</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">OIndexList([[0, 1],</span>
<span class="go">            [0, 2],</span>
<span class="go">            [1, 2],</span>
<span class="go">            [0, 3],</span>
<span class="go">            [1, 3],</span>
<span class="go">            [2, 3]], dtype=int32)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.gen_strings4orblist">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">gen_strings4orblist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.cistring.gen_strings4orblist" title="Permalink to this definition"></a></dt>
<dd><p>Generate string from the given orbital list.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>list of int64.  One int64 element represents one string in binary format.
The binary format takes the convention that the one bit stands for one
orbital, bit-1 means occupied and bit-0 means unoccupied.  The lowest
(right-most) bit corresponds to the lowest orbital in the orb_list.</p>
</dd>
</dl>
<p>Exampels:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">make_strings</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[0b11, 0b101, 0b110, 0b1001, 0b1010, 0b1100]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">make_strings</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[0b1010, 0b1001, 0b11, 0b1100, 0b110, 0b101]</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.make_strings">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">make_strings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#make_strings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.make_strings" title="Permalink to this definition"></a></dt>
<dd><p>Generate string from the given orbital list.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>list of int64.  One int64 element represents one string in binary format.
The binary format takes the convention that the one bit stands for one
orbital, bit-1 means occupied and bit-0 means unoccupied.  The lowest
(right-most) bit corresponds to the lowest orbital in the orb_list.</p>
</dd>
</dl>
<p>Exampels:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">make_strings</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[0b11, 0b101, 0b110, 0b1001, 0b1010, 0b1100]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">make_strings</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[0b1010, 0b1001, 0b11, 0b1100, 0b110, 0b101]</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.num_strings">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">num_strings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#num_strings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.num_strings" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.parity">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">parity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#parity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.parity" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.reform_linkstr_index">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">reform_linkstr_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">link_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#reform_linkstr_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.reform_linkstr_index" title="Permalink to this definition"></a></dt>
<dd><p>Compress the (a, i) pair index in linkstr_index to a lower triangular
index. The compressed indices can match the 4-fold symmetry of integrals.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.str2addr">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">str2addr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#str2addr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.str2addr" title="Permalink to this definition"></a></dt>
<dd><p>Convert string to CI determinant address</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.strs2addr">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">strs2addr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#strs2addr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.strs2addr" title="Permalink to this definition"></a></dt>
<dd><p>Convert a list of string to CI determinant address</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.sub_addrs">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">sub_addrs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_nelec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#sub_addrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.sub_addrs" title="Permalink to this definition"></a></dt>
<dd><p>The addresses of the determinants which include the specified orbital
indices. The size of the returned addresses is equal to the number of
determinants of (norb, nelec) system.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.cistring.tn_strs">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.cistring.</span></span><span class="sig-name descname"><span class="pre">tn_strs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/cistring.html#tn_strs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.cistring.tn_strs" title="Permalink to this definition"></a></dt>
<dd><p>Generate strings for Tn amplitudes.  Eg n=1 (T1) has nvir*nocc strings,
n=2 (T2) has nvir*(nvir-1)/2 * nocc*(nocc-1)/2 strings.</p>
</dd></dl>
</section>
<section id="module-pyscf.fci.direct_ep">
<span id="pyscf-fci-direct-ep-module"></span><h2 id="module-pyscf.fci.direct_ep">pyscf.fci.direct_ep module<a class="headerlink" href="#module-pyscf.fci.direct_ep" title="Permalink to this heading"></a></h2>
<p>Electron phonon coupling</p>
<dl class="simple">
<dt>Ref:</dt><dd><p>arXiv:1602.04195</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.contract_1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_1e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_2e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.contract_2e_hubbard">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">contract_2e_hubbard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_2e_hubbard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_2e_hubbard" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.contract_all">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">contract_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hpp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_all" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.contract_ep">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">contract_ep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_ep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_ep" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.contract_pp">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">contract_pp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hpp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#contract_pp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.contract_pp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.cre_phonon">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">cre_phonon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#cre_phonon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.cre_phonon" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.des_phonon">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">des_phonon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#des_phonon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.des_phonon" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hpp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.make_hdiag">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hpp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.make_hdiag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.make_rdm12e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">make_rdm12e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#make_rdm12e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.make_rdm12e" title="Permalink to this definition"></a></dt>
<dd><p>1-electron and 2-electron density matrices
dm_pq = &lt;<a href="#id75"><span class="problematic" id="id76">|p^+ q|</span></a>&gt;
dm_{pqrs} = &lt;<a href="#id77"><span class="problematic" id="id78">|p^+ r^+ q s|</span></a>&gt;  (note 2pdm is ordered in chemist notation)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.make_rdm1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">make_rdm1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#make_rdm1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.make_rdm1e" title="Permalink to this definition"></a></dt>
<dd><p>1-electron density matrix dm_pq = &lt;<a href="#id79"><span class="problematic" id="id80">|p^+ q|</span></a>&gt;</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.make_rdm1p">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">make_rdm1p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#make_rdm1p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.make_rdm1p" title="Permalink to this definition"></a></dt>
<dd><p>1-phonon density matrix dm_pq = &lt;<a href="#id81"><span class="problematic" id="id82">|p^+ q|</span></a>&gt;</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.make_shape">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">make_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#make_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.make_shape" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.slices_for">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">slices_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psite_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#slices_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.slices_for" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.slices_for_cre">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">slices_for_cre</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psite_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#slices_for_cre"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.slices_for_cre" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_ep.slices_for_des">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_ep.</span></span><span class="sig-name descname"><span class="pre">slices_for_des</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psite_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphonon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_ep.html#slices_for_des"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_ep.slices_for_des" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.fci.direct_nosym">
<span id="pyscf-fci-direct-nosym-module"></span><h2 id="module-pyscf.fci.direct_nosym">pyscf.fci.direct_nosym module<a class="headerlink" href="#module-pyscf.fci.direct_nosym" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) </p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_nosym.FCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_nosym.</span></span><span class="sig-name descname"><span class="pre">FCI</span></span><a class="headerlink" href="#pyscf.fci.direct_nosym.FCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_nosym.FCISolver" title="pyscf.fci.direct_nosym.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.direct_nosym.FCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_nosym.</span></span><span class="sig-name descname"><span class="pre">FCISolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_nosym.FCISolver.absorb_h1e">
<span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver.absorb_h1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_nosym.FCISolver.contract_1e">
<span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver.contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver.contract_1e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_nosym.FCISolver.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver.contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_nosym.FCISolver.eig">
<span class="sig-name descname"><span class="pre">eig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver.eig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver.eig" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_nosym.FCISolver.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.FCISolver.kernel" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h1e: ndarray</dt><dd><p>1-electron Hamiltonian</p>
</dd>
<dt>eri: ndarray</dt><dd><p>2-electron integrals in chemists notation</p>
</dd>
<dt>norb: int</dt><dd><p>Number of orbitals</p>
</dd>
<dt>nelec: int or (int, int)</dt><dd><p>Number of electrons of the system</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ci0: ndarray</dt><dd><p>Initial guess</p>
</dd>
<dt>link_index: ndarray</dt><dd><p>A lookup table to cache the addresses of CI determinants in
wave-function vector</p>
</dd>
<dt>tol: float</dt><dd><p>Convergence tolerance</p>
</dd>
<dt>lindep: float</dt><dd><p>Linear dependence threshold</p>
</dd>
<dt>max_cycle: int</dt><dd><p>Max. iterations for diagonalization</p>
</dd>
<dt>max_space: int</dt><dd><p>Max. trial vectors to store for sub-space diagonalization method</p>
</dd>
<dt>nroots: int</dt><dd><p>Number of states to solve</p>
</dd>
<dt>davidson_only: bool</dt><dd><p>Whether to call subspace diagonlization (davidson solver) or do a
full diagonlization (lapack eigh) for small systems</p>
</dd>
<dt>pspace_size: int</dt><dd><p>Number of determinants as the threshold of small systems,</p>
</dd>
<dt>hop: function(c) =&gt; array_like_c</dt><dd><p>Function to use for the Hamiltonian multiplication with trial vector</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: davidson solver requires more arguments. For the parameters not
dispatched, they can be passed to davidson solver via the extra keyword
arguments <a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_nosym.absorb_h1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_nosym.</span></span><span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#absorb_h1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_nosym.contract_1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_nosym.</span></span><span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.contract_1e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_nosym.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_nosym.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 2-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
<p>Note the input arg eri is NOT the 2e hamiltonian matrix, the 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= eri_{pq,rs} p^+ q r^+ s \\
    &amp;= (pq|rs) p^+ r^+ s q - (pq|rs) \delta_{qr} p^+ s\end{split}\]</div>
<p>So eri is defined as</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_nosym.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_nosym.energy">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_nosym.</span></span><span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_nosym.energy" title="Permalink to this definition"></a></dt>
<dd><p>Compute the FCI electronic energy for given Hamiltonian and FCI vector.</p>
</dd></dl>
</section>
<section id="module-pyscf.fci.direct_spin0">
<span id="pyscf-fci-direct-spin0-module"></span><h2 id="module-pyscf.fci.direct_spin0">pyscf.fci.direct_spin0 module<a class="headerlink" href="#module-pyscf.fci.direct_spin0" title="Permalink to this heading"></a></h2>
<p>FCI solver for Singlet state</p>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) </p>
<p>direct_spin0 solver is specified for singlet state. However, calling this
solver sometimes ends up with the error State not singlet x.xxxxxxe-06 due
to numerical issues. Calling direct_spin1 for singlet state is slightly
slower but more robust than direct_spin0 especially when combining to energy
penalty method (<code class="xref py py-func docutils literal notranslate"><span class="pre">fix_spin_()</span></code>)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">FCI</span></span><a class="headerlink" href="#pyscf.fci.direct_spin0.FCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_spin0.FCISolver" title="pyscf.fci.direct_spin0.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">FCISolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.contract_1e">
<span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.contract_1e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.energy">
<span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.energy" title="Permalink to this definition"></a></dt>
<dd><p>Compute the FCI electronic energy for given Hamiltonian and FCI vector.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.gen_linkstr">
<span class="sig-name descname"><span class="pre">gen_linkstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tril</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.gen_linkstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.gen_linkstr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.get_init_guess">
<span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.get_init_guess" title="Permalink to this definition"></a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.kernel" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h1e: ndarray</dt><dd><p>1-electron Hamiltonian</p>
</dd>
<dt>eri: ndarray</dt><dd><p>2-electron integrals in chemists notation</p>
</dd>
<dt>norb: int</dt><dd><p>Number of orbitals</p>
</dd>
<dt>nelec: int or (int, int)</dt><dd><p>Number of electrons of the system</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ci0: ndarray</dt><dd><p>Initial guess</p>
</dd>
<dt>link_index: ndarray</dt><dd><p>A lookup table to cache the addresses of CI determinants in
wave-function vector</p>
</dd>
<dt>tol: float</dt><dd><p>Convergence tolerance</p>
</dd>
<dt>lindep: float</dt><dd><p>Linear dependence threshold</p>
</dd>
<dt>max_cycle: int</dt><dd><p>Max. iterations for diagonalization</p>
</dd>
<dt>max_space: int</dt><dd><p>Max. trial vectors to store for sub-space diagonalization method</p>
</dd>
<dt>nroots: int</dt><dd><p>Number of states to solve</p>
</dd>
<dt>davidson_only: bool</dt><dd><p>Whether to call subspace diagonlization (davidson solver) or do a
full diagonlization (lapack eigh) for small systems</p>
</dd>
<dt>pspace_size: int</dt><dd><p>Number of determinants as the threshold of small systems,</p>
</dd>
<dt>hop: function(c) =&gt; array_like_c</dt><dd><p>Function to use for the Hamiltonian multiplication with trial vector</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: davidson solver requires more arguments. For the parameters not
dispatched, they can be passed to davidson solver via the extra keyword
arguments <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.make_hdiag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.make_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.make_rdm12">
<span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.make_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id5"><span class="problematic" id="id6">`</span></a>langle <a href="#id83"><span class="problematic" id="id84">q_</span></a>alpha^dagger <a href="#id85"><span class="problematic" id="id86">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id87"><span class="problematic" id="id88">q_</span></a>beta^dagger  <a href="#id89"><span class="problematic" id="id90">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id7"><span class="problematic" id="id8">`</span></a>langle <a href="#id91"><span class="problematic" id="id92">p_</span></a>alpha^dagger <a href="#id93"><span class="problematic" id="id94">r_</span></a>alpha^dagger <a href="#id95"><span class="problematic" id="id96">s_</span></a>alpha <a href="#id97"><span class="problematic" id="id98">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id99"><span class="problematic" id="id100">p_</span></a>beta^dagger  <a href="#id101"><span class="problematic" id="id102">r_</span></a>alpha^dagger <a href="#id103"><span class="problematic" id="id104">s_</span></a>alpha <a href="#id105"><span class="problematic" id="id106">q_</span></a>betarangle +
langle <a href="#id107"><span class="problematic" id="id108">p_</span></a>alpha^dagger <a href="#id109"><span class="problematic" id="id110">r_</span></a>beta^dagger  <a href="#id111"><span class="problematic" id="id112">s_</span></a>beta  <a href="#id113"><span class="problematic" id="id114">q_</span></a>alpharangle +
langle <a href="#id115"><span class="problematic" id="id116">p_</span></a>beta^dagger  <a href="#id117"><span class="problematic" id="id118">r_</span></a>beta^dagger  <a href="#id119"><span class="problematic" id="id120">s_</span></a>beta  <a href="#id121"><span class="problematic" id="id122">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(pq,qp, h1, 1pdm) + 1/2 * einsum(pqrs,pqrs, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.make_rdm1s">
<span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.make_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.trans_rdm1">
<span class="sig-name descname"><span class="pre">trans_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.trans_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.trans_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1-particle transition density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id9"><span class="problematic" id="id10">`</span></a>langle <a href="#id123"><span class="problematic" id="id124">q_</span></a>alpha^dagger <a href="#id125"><span class="problematic" id="id126">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id127"><span class="problematic" id="id128">q_</span></a>beta^dagger <a href="#id129"><span class="problematic" id="id130">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.trans_rdm12">
<span class="sig-name descname"><span class="pre">trans_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.trans_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.trans_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1- and 2-particle transition density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.FCISolver.trans_rdm1s">
<span class="sig-name descname"><span class="pre">trans_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#FCISolver.trans_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.FCISolver.trans_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta).
See also function <a class="reference internal" href="#pyscf.fci.direct_spin0.make_rdm1s" title="pyscf.fci.direct_spin0.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.contract_1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.contract_1e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.energy">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.energy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.get_init_guess">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.get_init_guess" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.kernel_ms0">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">kernel_ms0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#kernel_ms0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.kernel_ms0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.make_hdiag">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.make_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.make_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.make_rdm12">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.make_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id11"><span class="problematic" id="id12">`</span></a>langle <a href="#id131"><span class="problematic" id="id132">q_</span></a>alpha^dagger <a href="#id133"><span class="problematic" id="id134">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id135"><span class="problematic" id="id136">q_</span></a>beta^dagger  <a href="#id137"><span class="problematic" id="id138">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id13"><span class="problematic" id="id14">`</span></a>langle <a href="#id139"><span class="problematic" id="id140">p_</span></a>alpha^dagger <a href="#id141"><span class="problematic" id="id142">r_</span></a>alpha^dagger <a href="#id143"><span class="problematic" id="id144">s_</span></a>alpha <a href="#id145"><span class="problematic" id="id146">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id147"><span class="problematic" id="id148">p_</span></a>beta^dagger  <a href="#id149"><span class="problematic" id="id150">r_</span></a>alpha^dagger <a href="#id151"><span class="problematic" id="id152">s_</span></a>alpha <a href="#id153"><span class="problematic" id="id154">q_</span></a>betarangle +
langle <a href="#id155"><span class="problematic" id="id156">p_</span></a>alpha^dagger <a href="#id157"><span class="problematic" id="id158">r_</span></a>beta^dagger  <a href="#id159"><span class="problematic" id="id160">s_</span></a>beta  <a href="#id161"><span class="problematic" id="id162">q_</span></a>alpharangle +
langle <a href="#id163"><span class="problematic" id="id164">p_</span></a>beta^dagger  <a href="#id165"><span class="problematic" id="id166">r_</span></a>beta^dagger  <a href="#id167"><span class="problematic" id="id168">s_</span></a>beta  <a href="#id169"><span class="problematic" id="id170">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(pq,qp, h1, 1pdm) + 1/2 * einsum(pqrs,pqrs, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.make_rdm1s">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.make_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.trans_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">trans_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#trans_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.trans_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1-particle transition density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id15"><span class="problematic" id="id16">`</span></a>langle <a href="#id171"><span class="problematic" id="id172">q_</span></a>alpha^dagger <a href="#id173"><span class="problematic" id="id174">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id175"><span class="problematic" id="id176">q_</span></a>beta^dagger <a href="#id177"><span class="problematic" id="id178">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.trans_rdm12">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">trans_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#trans_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.trans_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1- and 2-particle transition density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0.trans_rdm1s">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0.</span></span><span class="sig-name descname"><span class="pre">trans_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0.html#trans_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0.trans_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta).
See also function <a class="reference internal" href="#pyscf.fci.direct_spin0.make_rdm1s" title="pyscf.fci.direct_spin0.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>
</section>
<section id="module-pyscf.fci.direct_spin0_symm">
<span id="pyscf-fci-direct-spin0-symm-module"></span><h2 id="module-pyscf.fci.direct_spin0_symm">pyscf.fci.direct_spin0_symm module<a class="headerlink" href="#module-pyscf.fci.direct_spin0_symm" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) </p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0_symm.</span></span><span class="sig-name descname"><span class="pre">FCI</span></span><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_spin0_symm.FCISolver" title="pyscf.fci.direct_spin0_symm.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0_symm.</span></span><span class="sig-name descname"><span class="pre">FCISolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin0.FCISolver" title="pyscf.fci.direct_spin0.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.absorb_h1e">
<span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.contract_1e">
<span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.contract_1e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver.contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.contract_ss">
<span class="sig-name descname"><span class="pre">contract_ss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.contract_ss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.contract_ss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.davidson_only">
<span class="sig-name descname"><span class="pre">davidson_only</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.davidson_only" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.dump_flags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.get_init_guess">
<span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#FCISolver.get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.get_init_guess" title="Permalink to this definition"></a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.guess_wfnsym">
<span class="sig-name descname"><span class="pre">guess_wfnsym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.guess_wfnsym" title="Permalink to this definition"></a></dt>
<dd><p>Guess point group symmetry of the FCI wavefunction.  If fcivec is
given, the symmetry of fcivec is used.  Otherwise the symmetry is
same to the HF determinant.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.kernel" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h1e: ndarray</dt><dd><p>1-electron Hamiltonian</p>
</dd>
<dt>eri: ndarray</dt><dd><p>2-electron integrals in chemists notation</p>
</dd>
<dt>norb: int</dt><dd><p>Number of orbitals</p>
</dd>
<dt>nelec: int or (int, int)</dt><dd><p>Number of electrons of the system</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ci0: ndarray</dt><dd><p>Initial guess</p>
</dd>
<dt>link_index: ndarray</dt><dd><p>A lookup table to cache the addresses of CI determinants in
wave-function vector</p>
</dd>
<dt>tol: float</dt><dd><p>Convergence tolerance</p>
</dd>
<dt>lindep: float</dt><dd><p>Linear dependence threshold</p>
</dd>
<dt>max_cycle: int</dt><dd><p>Max. iterations for diagonalization</p>
</dd>
<dt>max_space: int</dt><dd><p>Max. trial vectors to store for sub-space diagonalization method</p>
</dd>
<dt>nroots: int</dt><dd><p>Number of states to solve</p>
</dd>
<dt>davidson_only: bool</dt><dd><p>Whether to call subspace diagonlization (davidson solver) or do a
full diagonlization (lapack eigh) for small systems</p>
</dd>
<dt>pspace_size: int</dt><dd><p>Number of determinants as the threshold of small systems,</p>
</dd>
<dt>hop: function(c) =&gt; array_like_c</dt><dd><p>Function to use for the Hamiltonian multiplication with trial vector</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: davidson solver requires more arguments. For the parameters not
dispatched, they can be passed to davidson solver via the extra keyword
arguments <a href="#id17"><span class="problematic" id="id18">**</span></a>kwargs</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.make_hdiag">
<span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.pspace">
<span class="sig-name descname"><span class="pre">pspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.pspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.pspace" title="Permalink to this definition"></a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.FCISolver.pspace_size">
<span class="sig-name descname"><span class="pre">pspace_size</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">400</span></em><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.FCISolver.pspace_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0_symm.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.contract_2e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.get_init_guess">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0_symm.</span></span><span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.get_init_guess" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin0_symm.get_init_guess_cyl_sym">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin0_symm.</span></span><span class="sig-name descname"><span class="pre">get_init_guess_cyl_sym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin0_symm.html#get_init_guess_cyl_sym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin0_symm.get_init_guess_cyl_sym" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.fci.direct_spin1">
<span id="pyscf-fci-direct-spin1-module"></span><h2 id="module-pyscf.fci.direct_spin1">pyscf.fci.direct_spin1 module<a class="headerlink" href="#module-pyscf.fci.direct_spin1" title="Permalink to this heading"></a></h2>
<p>Full CI solver for spin-free Hamiltonian.  This solver can be used to compute
doublet, triplet,</p>
<p>The CI wfn are stored as a 2D array [alpha,beta], where each row corresponds
to an alpha string.  For each row (alpha string), there are
total-num-beta-strings of columns.  Each column corresponds to a beta string.</p>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) </p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">FCI</span></span><a class="headerlink" href="#pyscf.fci.direct_spin1.FCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">FCIBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a></p>
<p>Full CI solver</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code>.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Total number of iterations. Default is 100</p>
</dd>
<dt>max_space<span class="classifier">tuple of int</span></dt><dd><p>Davidson iteration space size. Default is 14.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Energy convergence tolerance. Default is 1e-10.</p>
</dd>
<dt>level_shift<span class="classifier">float</span></dt><dd><p>Level shift applied in the preconditioner to avoid singularity.
Default is 1e-3</p>
</dd>
<dt>davidson_only<span class="classifier">bool</span></dt><dd><p>By default, the entire Hamiltonian matrix will be constructed and
diagonalized if the system is small (see attribute pspace_size).
Setting this parameter to True will enforce the eigenvalue
problems being solved by Davidson subspace algorithm.  This flag
should be enabled when initial guess is given or particular spin
symmetry or point-group symmetry is required because the initial
guess or symmetry are completely ignored in the direct diagonlization.</p>
</dd>
<dt>pspace_size<span class="classifier">int</span></dt><dd><p>The dimension of Hamiltonian matrix over which Davidson iteration
algorithm will be used for the eigenvalue problem.  Default is 400.
This is roughly corresponding to a (6e,6o) system.</p>
</dd>
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of states to be solved.  Default is 1, the ground state.</p>
</dd>
<dt>spin<span class="classifier">int or None</span></dt><dd><p>Spin (2S = nalpha-nbeta) of the system.  If this attribute is None,
spin will be determined by the argument nelec (number of electrons)
of the kernel function.</p>
</dd>
<dt>wfnsym<span class="classifier">str or int</span></dt><dd><p>Symmetry of wavefunction.  It is used only in direct_spin1_symm
and direct_spin0_symm solver.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>eci<span class="classifier">float or a list of float</span></dt><dd><p>FCI energy(ies)</p>
</dd>
<dt>ci<span class="classifier">nparray</span></dt><dd><p>FCI wfn vector(s)</p>
</dd>
<dt>converged<span class="classifier">bool (or a list of bool for multiple roots)</span></dt><dd><p>Whether davidson iteration is converged</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">ao2mo</span><span class="p">,</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'Li 0 0 0; Li 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'sto-3g'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h1</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">get_hcore</span><span class="p">())</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">eri</span><span class="p">,</span> <span class="n">h1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mol</span><span class="o">.</span><span class="n">nelec</span><span class="p">,</span> <span class="n">ecore</span><span class="o">=</span><span class="n">mol</span><span class="o">.</span><span class="n">energy_nuc</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">-14.4197890826</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.absorb_h1e">
<span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.absorb_h1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.contract_1e">
<span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.contract_1e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.contract_ss">
<span class="sig-name descname"><span class="pre">contract_ss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.contract_ss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.contract_ss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.conv_tol">
<span class="sig-name descname"><span class="pre">conv_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-10</span></em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.conv_tol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.conv_tol_residual">
<span class="sig-name descname"><span class="pre">conv_tol_residual</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.conv_tol_residual" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.davidson_only">
<span class="sig-name descname"><span class="pre">davidson_only</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.davidson_only" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.dump_flags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.e_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_tot</span></span><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.e_tot" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.eig">
<span class="sig-name descname"><span class="pre">eig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.eig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.eig" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.energy">
<span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.energy" title="Permalink to this definition"></a></dt>
<dd><p>Compute the FCI electronic energy for given Hamiltonian and FCI vector.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.gen_linkstr">
<span class="sig-name descname"><span class="pre">gen_linkstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tril</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.gen_linkstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.gen_linkstr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.get_init_guess">
<span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.get_init_guess" title="Permalink to this definition"></a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.kernel" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h1e: ndarray</dt><dd><p>1-electron Hamiltonian</p>
</dd>
<dt>eri: ndarray</dt><dd><p>2-electron integrals in chemists notation</p>
</dd>
<dt>norb: int</dt><dd><p>Number of orbitals</p>
</dd>
<dt>nelec: int or (int, int)</dt><dd><p>Number of electrons of the system</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ci0: ndarray</dt><dd><p>Initial guess</p>
</dd>
<dt>link_index: ndarray</dt><dd><p>A lookup table to cache the addresses of CI determinants in
wave-function vector</p>
</dd>
<dt>tol: float</dt><dd><p>Convergence tolerance</p>
</dd>
<dt>lindep: float</dt><dd><p>Linear dependence threshold</p>
</dd>
<dt>max_cycle: int</dt><dd><p>Max. iterations for diagonalization</p>
</dd>
<dt>max_space: int</dt><dd><p>Max. trial vectors to store for sub-space diagonalization method</p>
</dd>
<dt>nroots: int</dt><dd><p>Number of states to solve</p>
</dd>
<dt>davidson_only: bool</dt><dd><p>Whether to call subspace diagonlization (davidson solver) or do a
full diagonlization (lapack eigh) for small systems</p>
</dd>
<dt>pspace_size: int</dt><dd><p>Number of determinants as the threshold of small systems,</p>
</dd>
<dt>hop: function(c) =&gt; array_like_c</dt><dd><p>Function to use for the Hamiltonian multiplication with trial vector</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: davidson solver requires more arguments. For the parameters not
dispatched, they can be passed to davidson solver via the extra keyword
arguments <a href="#id19"><span class="problematic" id="id20">**</span></a>kwargs</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.large_ci">
<span class="sig-name descname"><span class="pre">large_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_strs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.large_ci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.large_ci" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.lessio">
<span class="sig-name descname"><span class="pre">lessio</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.lessio" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.level_shift">
<span class="sig-name descname"><span class="pre">level_shift</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.001</span></em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.level_shift" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.lindep">
<span class="sig-name descname"><span class="pre">lindep</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-14</span></em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.lindep" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.make_hdiag">
<span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.make_precond">
<span class="sig-name descname"><span class="pre">make_precond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspaceig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspaceci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_precond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_precond" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.make_rdm12">
<span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id21"><span class="problematic" id="id22">`</span></a>langle <a href="#id179"><span class="problematic" id="id180">q_</span></a>alpha^dagger <a href="#id181"><span class="problematic" id="id182">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id183"><span class="problematic" id="id184">q_</span></a>beta^dagger  <a href="#id185"><span class="problematic" id="id186">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id23"><span class="problematic" id="id24">`</span></a>langle <a href="#id187"><span class="problematic" id="id188">p_</span></a>alpha^dagger <a href="#id189"><span class="problematic" id="id190">r_</span></a>alpha^dagger <a href="#id191"><span class="problematic" id="id192">s_</span></a>alpha <a href="#id193"><span class="problematic" id="id194">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id195"><span class="problematic" id="id196">p_</span></a>beta^dagger  <a href="#id197"><span class="problematic" id="id198">r_</span></a>alpha^dagger <a href="#id199"><span class="problematic" id="id200">s_</span></a>alpha <a href="#id201"><span class="problematic" id="id202">q_</span></a>betarangle +
langle <a href="#id203"><span class="problematic" id="id204">p_</span></a>alpha^dagger <a href="#id205"><span class="problematic" id="id206">r_</span></a>beta^dagger  <a href="#id207"><span class="problematic" id="id208">s_</span></a>beta  <a href="#id209"><span class="problematic" id="id210">q_</span></a>alpharangle +
langle <a href="#id211"><span class="problematic" id="id212">p_</span></a>beta^dagger  <a href="#id213"><span class="problematic" id="id214">r_</span></a>beta^dagger  <a href="#id215"><span class="problematic" id="id216">s_</span></a>beta  <a href="#id217"><span class="problematic" id="id218">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(pq,qp, h1, 1pdm) + 1/2 * einsum(pqrs,pqrs, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.make_rdm12s">
<span class="sig-name descname"><span class="pre">make_rdm12s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_rdm12s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_rdm12s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1- and 2-particle density matrices.
The return values include two lists, a list of 1-particle density matrices
and a list of 2-particle density matrices.  The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,beta,beta) for 2-particle density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
<p>Energy should be computed as
E = einsum(pq,qp, h1, 1pdm) + 1/2 * einsum(pqrs,pqrs, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.make_rdm1s">
<span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.make_rdm2">
<span class="sig-name descname"><span class="pre">make_rdm2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.make_rdm2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.make_rdm2" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced 2-particle density matrice</p>
<p>NOTE the 2pdm is <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger s r\rangle\)</span> but
stored as [p,r,q,s]</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.max_cycle">
<span class="sig-name descname"><span class="pre">max_cycle</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100</span></em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.max_cycle" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.max_space">
<span class="sig-name descname"><span class="pre">max_space</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">12</span></em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.max_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.nstates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nstates</span></span><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.nstates" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.pspace">
<span class="sig-name descname"><span class="pre">pspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.pspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.pspace" title="Permalink to this definition"></a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.pspace_size">
<span class="sig-name descname"><span class="pre">pspace_size</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">400</span></em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.pspace_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.spin_square">
<span class="sig-name descname"><span class="pre">spin_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.spin_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.spin_square" title="Permalink to this definition"></a></dt>
<dd><p>Spin square for RHF-FCI CI wfn only (obtained from spin-degenerated
Hamiltonian)</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.threads">
<span class="sig-name descname"><span class="pre">threads</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.threads" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.trans_rdm1">
<span class="sig-name descname"><span class="pre">trans_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.trans_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1-particle transition density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id25"><span class="problematic" id="id26">`</span></a>langle <a href="#id219"><span class="problematic" id="id220">q_</span></a>alpha^dagger <a href="#id221"><span class="problematic" id="id222">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id223"><span class="problematic" id="id224">q_</span></a>beta^dagger <a href="#id225"><span class="problematic" id="id226">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.trans_rdm12">
<span class="sig-name descname"><span class="pre">trans_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.trans_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1- and 2-particle transition density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.trans_rdm12s">
<span class="sig-name descname"><span class="pre">trans_rdm12s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.trans_rdm12s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm12s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1- and 2-particle transition density matrices.
The return values include two lists, a list of 1-particle transition
density matrices and a list of 2-particle transition density matrices.
The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle transition density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,alpha,alpha), (beta,beta,beta,beta) for 2-particle transition
density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIBase.trans_rdm1s">
<span class="sig-name descname"><span class="pre">trans_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIBase.trans_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIBase.trans_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta).
See also function <a class="reference internal" href="#pyscf.fci.direct_spin1.make_rdm1s" title="pyscf.fci.direct_spin1.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">FCISolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCISolver" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCIBase" title="pyscf.fci.direct_spin1.FCIBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCIBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCISolver.transform_ci_for_orbital_rotation">
<span class="sig-name descname"><span class="pre">transform_ci_for_orbital_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCISolver.transform_ci_for_orbital_rotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCISolver.transform_ci_for_orbital_rotation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.FCIvector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">FCIvector</span></span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#FCIvector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.FCIvector" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
<p>An 2D np array for FCI coefficients</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.absorb_h1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#absorb_h1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.contract_1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.contract_1e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.energy">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.energy" title="Permalink to this definition"></a></dt>
<dd><p>Compute the FCI electronic energy for given Hamiltonian and FCI vector.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.get_init_guess">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.get_init_guess" title="Permalink to this definition"></a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.kernel_ms1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">kernel_ms1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#kernel_ms1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.kernel_ms1" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h1e: ndarray</dt><dd><p>1-electron Hamiltonian</p>
</dd>
<dt>eri: ndarray</dt><dd><p>2-electron integrals in chemists notation</p>
</dd>
<dt>norb: int</dt><dd><p>Number of orbitals</p>
</dd>
<dt>nelec: int or (int, int)</dt><dd><p>Number of electrons of the system</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ci0: ndarray</dt><dd><p>Initial guess</p>
</dd>
<dt>link_index: ndarray</dt><dd><p>A lookup table to cache the addresses of CI determinants in
wave-function vector</p>
</dd>
<dt>tol: float</dt><dd><p>Convergence tolerance</p>
</dd>
<dt>lindep: float</dt><dd><p>Linear dependence threshold</p>
</dd>
<dt>max_cycle: int</dt><dd><p>Max. iterations for diagonalization</p>
</dd>
<dt>max_space: int</dt><dd><p>Max. trial vectors to store for sub-space diagonalization method</p>
</dd>
<dt>nroots: int</dt><dd><p>Number of states to solve</p>
</dd>
<dt>davidson_only: bool</dt><dd><p>Whether to call subspace diagonlization (davidson solver) or do a
full diagonlization (lapack eigh) for small systems</p>
</dd>
<dt>pspace_size: int</dt><dd><p>Number of determinants as the threshold of small systems,</p>
</dd>
<dt>hop: function(c) =&gt; array_like_c</dt><dd><p>Function to use for the Hamiltonian multiplication with trial vector</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: davidson solver requires more arguments. For the parameters not
dispatched, they can be passed to davidson solver via the extra keyword
arguments <a href="#id27"><span class="problematic" id="id28">**</span></a>kwargs</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.make_diag_precond">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">make_diag_precond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspaceig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspaceci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_diag_precond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_diag_precond" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.make_hdiag">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.make_pspace_precond">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">make_pspace_precond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspaceig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspaceci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_pspace_precond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_pspace_precond" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.make_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.make_rdm12">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id29"><span class="problematic" id="id30">`</span></a>langle <a href="#id227"><span class="problematic" id="id228">q_</span></a>alpha^dagger <a href="#id229"><span class="problematic" id="id230">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id231"><span class="problematic" id="id232">q_</span></a>beta^dagger  <a href="#id233"><span class="problematic" id="id234">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id31"><span class="problematic" id="id32">`</span></a>langle <a href="#id235"><span class="problematic" id="id236">p_</span></a>alpha^dagger <a href="#id237"><span class="problematic" id="id238">r_</span></a>alpha^dagger <a href="#id239"><span class="problematic" id="id240">s_</span></a>alpha <a href="#id241"><span class="problematic" id="id242">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id243"><span class="problematic" id="id244">p_</span></a>beta^dagger  <a href="#id245"><span class="problematic" id="id246">r_</span></a>alpha^dagger <a href="#id247"><span class="problematic" id="id248">s_</span></a>alpha <a href="#id249"><span class="problematic" id="id250">q_</span></a>betarangle +
langle <a href="#id251"><span class="problematic" id="id252">p_</span></a>alpha^dagger <a href="#id253"><span class="problematic" id="id254">r_</span></a>beta^dagger  <a href="#id255"><span class="problematic" id="id256">s_</span></a>beta  <a href="#id257"><span class="problematic" id="id258">q_</span></a>alpharangle +
langle <a href="#id259"><span class="problematic" id="id260">p_</span></a>beta^dagger  <a href="#id261"><span class="problematic" id="id262">r_</span></a>beta^dagger  <a href="#id263"><span class="problematic" id="id264">s_</span></a>beta  <a href="#id265"><span class="problematic" id="id266">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(pq,qp, h1, 1pdm) + 1/2 * einsum(pqrs,pqrs, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.make_rdm12s">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">make_rdm12s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_rdm12s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_rdm12s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1- and 2-particle density matrices.
The return values include two lists, a list of 1-particle density matrices
and a list of 2-particle density matrices.  The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,beta,beta) for 2-particle density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
<p>Energy should be computed as
E = einsum(pq,qp, h1, 1pdm) + 1/2 * einsum(pqrs,pqrs, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.make_rdm1s">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.make_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.pspace">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">pspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#pspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.pspace" title="Permalink to this definition"></a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.trans_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">trans_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#trans_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.trans_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1-particle transition density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id33"><span class="problematic" id="id34">`</span></a>langle <a href="#id267"><span class="problematic" id="id268">q_</span></a>alpha^dagger <a href="#id269"><span class="problematic" id="id270">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id271"><span class="problematic" id="id272">q_</span></a>beta^dagger <a href="#id273"><span class="problematic" id="id274">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.trans_rdm12">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">trans_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#trans_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.trans_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1- and 2-particle transition density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.trans_rdm12s">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">trans_rdm12s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#trans_rdm12s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.trans_rdm12s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1- and 2-particle transition density matrices.
The return values include two lists, a list of 1-particle transition
density matrices and a list of 2-particle transition density matrices.
The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle transition density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,alpha,alpha), (beta,beta,beta,beta) for 2-particle transition
density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1.trans_rdm1s">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1.</span></span><span class="sig-name descname"><span class="pre">trans_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1.html#trans_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1.trans_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta).
See also function <a class="reference internal" href="#pyscf.fci.direct_spin1.make_rdm1s" title="pyscf.fci.direct_spin1.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>
</section>
<section id="module-pyscf.fci.direct_spin1_cyl_sym">
<span id="pyscf-fci-direct-spin1-cyl-sym-module"></span><h2 id="module-pyscf.fci.direct_spin1_cyl_sym">pyscf.fci.direct_spin1_cyl_sym module<a class="headerlink" href="#module-pyscf.fci.direct_spin1_cyl_sym" title="Permalink to this heading"></a></h2>
<p>Cylindrical symmetry</p>
<p>This module is much slower than direct_spin1_symm.</p>
<p>In this implementation, complex orbitals is used to construct the Hamiltonian.
FCI wavefunction (called complex wavefunction here) is solved using the complex
Hamiltonian. For 2D irreps, the real part and the imaginary part of the complex
FCI wavefunction are identical to the Ex and Ey wavefunction obtained from
direct_spin1_symm module. However, any observables from the complex FCI
wavefunction should have an indentical one from either Ex or Ey wavefunction
of direct_spin1_symm.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_cyl_sym.</span></span><span class="sig-name descname"><span class="pre">FCI</span></span><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver" title="pyscf.fci.direct_spin1_cyl_sym.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_cyl_sym.</span></span><span class="sig-name descname"><span class="pre">FCISolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#FCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1_symm.FCISolver" title="pyscf.fci.direct_spin1_symm.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.absorb_h1e">
<span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_nosym.html#FCISolver.absorb_h1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.contract_1e">
<span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#FCISolver.contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.contract_1e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#FCISolver.contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.get_init_guess">
<span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#FCISolver.get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.get_init_guess" title="Permalink to this definition"></a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.guess_wfnsym">
<span class="sig-name descname"><span class="pre">guess_wfnsym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.guess_wfnsym" title="Permalink to this definition"></a></dt>
<dd><p>Guess point group symmetry of the FCI wavefunction.  If fcivec is
given, the symmetry of fcivec is used.  Otherwise the symmetry is
same to the HF determinant.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#FCISolver.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.kernel" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h1e: ndarray</dt><dd><p>1-electron Hamiltonian</p>
</dd>
<dt>eri: ndarray</dt><dd><p>2-electron integrals in chemists notation</p>
</dd>
<dt>norb: int</dt><dd><p>Number of orbitals</p>
</dd>
<dt>nelec: int or (int, int)</dt><dd><p>Number of electrons of the system</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ci0: ndarray</dt><dd><p>Initial guess</p>
</dd>
<dt>link_index: ndarray</dt><dd><p>A lookup table to cache the addresses of CI determinants in
wave-function vector</p>
</dd>
<dt>tol: float</dt><dd><p>Convergence tolerance</p>
</dd>
<dt>lindep: float</dt><dd><p>Linear dependence threshold</p>
</dd>
<dt>max_cycle: int</dt><dd><p>Max. iterations for diagonalization</p>
</dd>
<dt>max_space: int</dt><dd><p>Max. trial vectors to store for sub-space diagonalization method</p>
</dd>
<dt>nroots: int</dt><dd><p>Number of states to solve</p>
</dd>
<dt>davidson_only: bool</dt><dd><p>Whether to call subspace diagonlization (davidson solver) or do a
full diagonlization (lapack eigh) for small systems</p>
</dd>
<dt>pspace_size: int</dt><dd><p>Number of determinants as the threshold of small systems,</p>
</dd>
<dt>hop: function(c) =&gt; array_like_c</dt><dd><p>Function to use for the Hamiltonian multiplication with trial vector</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: davidson solver requires more arguments. For the parameters not
dispatched, they can be passed to davidson solver via the extra keyword
arguments <a href="#id35"><span class="problematic" id="id36">**</span></a>kwargs</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_hdiag">
<span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm12">
<span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id37"><span class="problematic" id="id38">`</span></a>langle <a href="#id275"><span class="problematic" id="id276">q_</span></a>alpha^dagger <a href="#id277"><span class="problematic" id="id278">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id279"><span class="problematic" id="id280">q_</span></a>beta^dagger  <a href="#id281"><span class="problematic" id="id282">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id39"><span class="problematic" id="id40">`</span></a>langle <a href="#id283"><span class="problematic" id="id284">p_</span></a>alpha^dagger <a href="#id285"><span class="problematic" id="id286">r_</span></a>alpha^dagger <a href="#id287"><span class="problematic" id="id288">s_</span></a>alpha <a href="#id289"><span class="problematic" id="id290">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id291"><span class="problematic" id="id292">p_</span></a>beta^dagger  <a href="#id293"><span class="problematic" id="id294">r_</span></a>alpha^dagger <a href="#id295"><span class="problematic" id="id296">s_</span></a>alpha <a href="#id297"><span class="problematic" id="id298">q_</span></a>betarangle +
langle <a href="#id299"><span class="problematic" id="id300">p_</span></a>alpha^dagger <a href="#id301"><span class="problematic" id="id302">r_</span></a>beta^dagger  <a href="#id303"><span class="problematic" id="id304">s_</span></a>beta  <a href="#id305"><span class="problematic" id="id306">q_</span></a>alpharangle +
langle <a href="#id307"><span class="problematic" id="id308">p_</span></a>beta^dagger  <a href="#id309"><span class="problematic" id="id310">r_</span></a>beta^dagger  <a href="#id311"><span class="problematic" id="id312">s_</span></a>beta  <a href="#id313"><span class="problematic" id="id314">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(pq,qp, h1, 1pdm) + 1/2 * einsum(pqrs,pqrs, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm12s">
<span class="sig-name descname"><span class="pre">make_rdm12s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm12s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1- and 2-particle density matrices.
The return values include two lists, a list of 1-particle density matrices
and a list of 2-particle density matrices.  The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,beta,beta) for 2-particle density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
<p>Energy should be computed as
E = einsum(pq,qp, h1, 1pdm) + 1/2 * einsum(pqrs,pqrs, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm1s">
<span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.pspace">
<span class="sig-name descname"><span class="pre">pspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#FCISolver.pspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.pspace" title="Permalink to this definition"></a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm1">
<span class="sig-name descname"><span class="pre">trans_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1-particle transition density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id41"><span class="problematic" id="id42">`</span></a>langle <a href="#id315"><span class="problematic" id="id316">q_</span></a>alpha^dagger <a href="#id317"><span class="problematic" id="id318">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id319"><span class="problematic" id="id320">q_</span></a>beta^dagger <a href="#id321"><span class="problematic" id="id322">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm12">
<span class="sig-name descname"><span class="pre">trans_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1- and 2-particle transition density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm12s">
<span class="sig-name descname"><span class="pre">trans_rdm12s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm12s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1- and 2-particle transition density matrices.
The return values include two lists, a list of 1-particle transition
density matrices and a list of 2-particle transition density matrices.
The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle transition density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,alpha,alpha), (beta,beta,beta,beta) for 2-particle transition
density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm1s">
<span class="sig-name descname"><span class="pre">trans_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.trans_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta).
See also function <a class="reference internal" href="#pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm1s" title="pyscf.fci.direct_spin1_cyl_sym.FCISolver.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.argsort_strs_by_irrep">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_cyl_sym.</span></span><span class="sig-name descname"><span class="pre">argsort_strs_by_irrep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_momentum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_gerades</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#argsort_strs_by_irrep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.argsort_strs_by_irrep" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_cyl_sym.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.contract_2e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.gen_str_irrep">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_cyl_sym.</span></span><span class="sig-name descname"><span class="pre">gen_str_irrep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank_eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irrep_eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_momentum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_gerades</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#gen_str_irrep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.gen_str_irrep" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.get_init_guess">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_cyl_sym.</span></span><span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_allowed_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.get_init_guess" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.guess_wfnsym">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_cyl_sym.</span></span><span class="sig-name descname"><span class="pre">guess_wfnsym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#guess_wfnsym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.guess_wfnsym" title="Permalink to this definition"></a></dt>
<dd><p>Guess point group symmetry of the FCI wavefunction.  If fcivec is
given, the symmetry of fcivec is used.  Otherwise the symmetry is
same to the HF determinant.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.reorder_eri">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_cyl_sym.</span></span><span class="sig-name descname"><span class="pre">reorder_eri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_momentum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_gerades</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#reorder_eri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.reorder_eri" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_cyl_sym.sym_allowed_indices">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_cyl_sym.</span></span><span class="sig-name descname"><span class="pre">sym_allowed_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_cyl_sym.html#sym_allowed_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_cyl_sym.sym_allowed_indices" title="Permalink to this definition"></a></dt>
<dd><p>Indices of symmetry allowed determinants for each irrep</p>
</dd></dl>
</section>
<section id="module-pyscf.fci.direct_spin1_symm">
<span id="pyscf-fci-direct-spin1-symm-module"></span><h2 id="module-pyscf.fci.direct_spin1_symm">pyscf.fci.direct_spin1_symm module<a class="headerlink" href="#module-pyscf.fci.direct_spin1_symm" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) </p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">FCI</span></span><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_spin1_symm.FCISolver" title="pyscf.fci.direct_spin1_symm.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">FCISolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver.absorb_h1e">
<span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver.contract_1e">
<span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.contract_1e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver.contract_ss">
<span class="sig-name descname"><span class="pre">contract_ss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.contract_ss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.contract_ss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.dump_flags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver.get_init_guess">
<span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.get_init_guess" title="Permalink to this definition"></a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver.guess_wfnsym">
<span class="sig-name descname"><span class="pre">guess_wfnsym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.guess_wfnsym" title="Permalink to this definition"></a></dt>
<dd><p>Guess point group symmetry of the FCI wavefunction.  If fcivec is
given, the symmetry of fcivec is used.  Otherwise the symmetry is
same to the HF determinant.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.kernel" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h1e: ndarray</dt><dd><p>1-electron Hamiltonian</p>
</dd>
<dt>eri: ndarray</dt><dd><p>2-electron integrals in chemists notation</p>
</dd>
<dt>norb: int</dt><dd><p>Number of orbitals</p>
</dd>
<dt>nelec: int or (int, int)</dt><dd><p>Number of electrons of the system</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ci0: ndarray</dt><dd><p>Initial guess</p>
</dd>
<dt>link_index: ndarray</dt><dd><p>A lookup table to cache the addresses of CI determinants in
wave-function vector</p>
</dd>
<dt>tol: float</dt><dd><p>Convergence tolerance</p>
</dd>
<dt>lindep: float</dt><dd><p>Linear dependence threshold</p>
</dd>
<dt>max_cycle: int</dt><dd><p>Max. iterations for diagonalization</p>
</dd>
<dt>max_space: int</dt><dd><p>Max. trial vectors to store for sub-space diagonalization method</p>
</dd>
<dt>nroots: int</dt><dd><p>Number of states to solve</p>
</dd>
<dt>davidson_only: bool</dt><dd><p>Whether to call subspace diagonlization (davidson solver) or do a
full diagonlization (lapack eigh) for small systems</p>
</dd>
<dt>pspace_size: int</dt><dd><p>Number of determinants as the threshold of small systems,</p>
</dd>
<dt>hop: function(c) =&gt; array_like_c</dt><dd><p>Function to use for the Hamiltonian multiplication with trial vector</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: davidson solver requires more arguments. For the parameters not
dispatched, they can be passed to davidson solver via the extra keyword
arguments <a href="#id43"><span class="problematic" id="id44">**</span></a>kwargs</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver.make_hdiag">
<span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver.pspace">
<span class="sig-name descname"><span class="pre">pspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#FCISolver.pspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.pspace" title="Permalink to this definition"></a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.FCISolver.pspace_size">
<span class="sig-name descname"><span class="pre">pspace_size</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">400</span></em><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.FCISolver.pspace_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.argsort_strs_by_irrep">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">argsort_strs_by_irrep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#argsort_strs_by_irrep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.argsort_strs_by_irrep" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.contract_2e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.energy">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.energy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.gen_str_irrep">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">gen_str_irrep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank_eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irrep_eri</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#gen_str_irrep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.gen_str_irrep" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.get_init_guess">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.get_init_guess" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.get_init_guess_cyl_sym">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">get_init_guess_cyl_sym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#get_init_guess_cyl_sym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.get_init_guess_cyl_sym" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.guess_wfnsym">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">guess_wfnsym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#guess_wfnsym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.guess_wfnsym" title="Permalink to this definition"></a></dt>
<dd><p>Guess point group symmetry of the FCI wavefunction.  If fcivec is
given, the symmetry of fcivec is used.  Otherwise the symmetry is
same to the HF determinant.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.reorder_eri">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">reorder_eri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#reorder_eri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.reorder_eri" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_spin1_symm.sym_allowed_indices">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_spin1_symm.</span></span><span class="sig-name descname"><span class="pre">sym_allowed_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_spin1_symm.html#sym_allowed_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_spin1_symm.sym_allowed_indices" title="Permalink to this definition"></a></dt>
<dd><p>Indices of symmetry allowed determinants for each irrep</p>
</dd></dl>
</section>
<section id="module-pyscf.fci.direct_uhf">
<span id="pyscf-fci-direct-uhf-module"></span><h2 id="module-pyscf.fci.direct_uhf">pyscf.fci.direct_uhf module<a class="headerlink" href="#module-pyscf.fci.direct_uhf" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) </p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.FCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">FCI</span></span><a class="headerlink" href="#pyscf.fci.direct_uhf.FCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.direct_uhf.FCISolver" title="pyscf.fci.direct_uhf.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.FCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">FCISolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#FCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.FCISolver.absorb_h1e">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.FCISolver.contract_1e">
<span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.contract_1e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.FCISolver.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.FCISolver.make_hdiag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.FCISolver.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.make_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.FCISolver.pspace">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.pspace" title="Permalink to this definition"></a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.FCISolver.spin_square">
<span class="sig-name descname"><span class="pre">spin_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ovlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcisolver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.spin_square" title="Permalink to this definition"></a></dt>
<dd><p>General spin square operator.</p>
<p> math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_</span><span class="o">+*</span><span class="n">S_</span><span class="o">-|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> <span class="n">n_</span>\<span class="n">alpha</span> <span class="o">+</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">alpha</span> <span class="p">}</span> \\
<span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_</span><span class="o">-*</span><span class="n">S_</span><span class="o">+|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> <span class="n">n_</span>\<span class="n">beta</span> <span class="o">+</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">beta</span> <span class="p">}</span> \\
<span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_z</span><span class="o">*</span><span class="n">S_z</span><span class="o">|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}(</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">alpha</span> <span class="p">}</span>
                 <span class="o">-</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">beta</span> <span class="p">}</span>
                 <span class="o">-</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">alpha</span><span class="p">}</span>
                 <span class="o">+</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">beta</span><span class="p">})</span>
                 <span class="o">+</span> <span class="p">(</span><span class="n">n_</span>\<span class="n">alpha</span><span class="o">+</span><span class="n">n_</span>\<span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
</pre></div>
</div>
<p>Given the overlap betwen non-degenerate alpha and beta orbitals, this
function can compute the expectation value spin square operator for
UHF-FCI wavefunction</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.FCISolver.trans_rdm1">
<span class="sig-name descname"><span class="pre">trans_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.direct_uhf.FCISolver.trans_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1-particle transition density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id45"><span class="problematic" id="id46">`</span></a>langle <a href="#id323"><span class="problematic" id="id324">q_</span></a>alpha^dagger <a href="#id325"><span class="problematic" id="id326">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id327"><span class="problematic" id="id328">q_</span></a>beta^dagger <a href="#id329"><span class="problematic" id="id330">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.absorb_h1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#absorb_h1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.contract_1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.contract_1e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.contract_2e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.contract_2e_hubbard">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">contract_2e_hubbard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#contract_2e_hubbard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.contract_2e_hubbard" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.energy">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.energy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.make_hdiag">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.make_hdiag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.make_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.make_rdm1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.pspace">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">pspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#pspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.pspace" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.direct_uhf.trans_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.direct_uhf.</span></span><span class="sig-name descname"><span class="pre">trans_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/direct_uhf.html#trans_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.direct_uhf.trans_rdm1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.fci.fci_dhf_slow">
<span id="pyscf-fci-fci-dhf-slow-module"></span><h2 id="module-pyscf.fci.fci_dhf_slow">pyscf.fci.fci_dhf_slow module<a class="headerlink" href="#module-pyscf.fci.fci_dhf_slow" title="Permalink to this heading"></a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_dhf_slow.</span></span><span class="sig-name descname"><span class="pre">FCI</span></span><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.fci_dhf_slow.FCISolver" title="pyscf.fci.fci_dhf_slow.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_dhf_slow.</span></span><span class="sig-name descname"><span class="pre">FCISolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver.absorb_h1e">
<span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver.absorb_h1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver.contract_1e">
<span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver.contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver.contract_1e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 1-electron Hamiltonian with a FCI vector to get a new FCI
vector.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver.contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver.energy">
<span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver.energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver.energy" title="Permalink to this definition"></a></dt>
<dd><p>Compute the FCI electronic energy for given Hamiltonian and FCI vector.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver.kernel" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h1e: ndarray</dt><dd><p>1-electron Hamiltonian</p>
</dd>
<dt>eri: ndarray</dt><dd><p>2-electron integrals in chemists notation</p>
</dd>
<dt>norb: int</dt><dd><p>Number of orbitals</p>
</dd>
<dt>nelec: int or (int, int)</dt><dd><p>Number of electrons of the system</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ci0: ndarray</dt><dd><p>Initial guess</p>
</dd>
<dt>link_index: ndarray</dt><dd><p>A lookup table to cache the addresses of CI determinants in
wave-function vector</p>
</dd>
<dt>tol: float</dt><dd><p>Convergence tolerance</p>
</dd>
<dt>lindep: float</dt><dd><p>Linear dependence threshold</p>
</dd>
<dt>max_cycle: int</dt><dd><p>Max. iterations for diagonalization</p>
</dd>
<dt>max_space: int</dt><dd><p>Max. trial vectors to store for sub-space diagonalization method</p>
</dd>
<dt>nroots: int</dt><dd><p>Number of states to solve</p>
</dd>
<dt>davidson_only: bool</dt><dd><p>Whether to call subspace diagonlization (davidson solver) or do a
full diagonlization (lapack eigh) for small systems</p>
</dd>
<dt>pspace_size: int</dt><dd><p>Number of determinants as the threshold of small systems,</p>
</dd>
<dt>hop: function(c) =&gt; array_like_c</dt><dd><p>Function to use for the Hamiltonian multiplication with trial vector</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: davidson solver requires more arguments. For the parameters not
dispatched, they can be passed to davidson solver via the extra keyword
arguments <a href="#id47"><span class="problematic" id="id48">**</span></a>kwargs</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver.make_hdiag">
<span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver.make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver.make_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin-traced one-particle density matrix</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver.make_rdm12">
<span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver.make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver.make_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id49"><span class="problematic" id="id50">`</span></a>langle <a href="#id331"><span class="problematic" id="id332">q_</span></a>alpha^dagger <a href="#id333"><span class="problematic" id="id334">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id335"><span class="problematic" id="id336">q_</span></a>beta^dagger  <a href="#id337"><span class="problematic" id="id338">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id51"><span class="problematic" id="id52">`</span></a>langle <a href="#id339"><span class="problematic" id="id340">p_</span></a>alpha^dagger <a href="#id341"><span class="problematic" id="id342">r_</span></a>alpha^dagger <a href="#id343"><span class="problematic" id="id344">s_</span></a>alpha <a href="#id345"><span class="problematic" id="id346">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id347"><span class="problematic" id="id348">p_</span></a>beta^dagger  <a href="#id349"><span class="problematic" id="id350">r_</span></a>alpha^dagger <a href="#id351"><span class="problematic" id="id352">s_</span></a>alpha <a href="#id353"><span class="problematic" id="id354">q_</span></a>betarangle +
langle <a href="#id355"><span class="problematic" id="id356">p_</span></a>alpha^dagger <a href="#id357"><span class="problematic" id="id358">r_</span></a>beta^dagger  <a href="#id359"><span class="problematic" id="id360">s_</span></a>beta  <a href="#id361"><span class="problematic" id="id362">q_</span></a>alpharangle +
langle <a href="#id363"><span class="problematic" id="id364">p_</span></a>beta^dagger  <a href="#id365"><span class="problematic" id="id366">r_</span></a>beta^dagger  <a href="#id367"><span class="problematic" id="id368">s_</span></a>beta  <a href="#id369"><span class="problematic" id="id370">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(pq,qp, h1, 1pdm) + 1/2 * einsum(pqrs,pqrs, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver.make_rdm2">
<span class="sig-name descname"><span class="pre">make_rdm2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver.make_rdm2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver.make_rdm2" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced 2-particle density matrice</p>
<p>NOTE the 2pdm is <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger s r\rangle\)</span> but
stored as [p,r,q,s]</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver.pspace">
<span class="sig-name descname"><span class="pre">pspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver.pspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver.pspace" title="Permalink to this definition"></a></dt>
<dd><p>pspace Hamiltonian to improve Davidson preconditioner. See, CPL, 169, 463</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.FCISolver.spin_square">
<span class="sig-name descname"><span class="pre">spin_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#FCISolver.spin_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.FCISolver.spin_square" title="Permalink to this definition"></a></dt>
<dd><p>Spin square for RHF-FCI CI wfn only (obtained from spin-degenerated
Hamiltonian)</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.absorb_h1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_dhf_slow.</span></span><span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#absorb_h1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_dhf_slow.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Compute a^dagger_p a_q a^dagger_r a_s <a href="#id53"><span class="problematic" id="id54">|</span></a>CI&gt;</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_dhf_slow.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.kernel_dhf">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_dhf_slow.</span></span><span class="sig-name descname"><span class="pre">kernel_dhf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#kernel_dhf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.kernel_dhf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.make_hdiag">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_dhf_slow.</span></span><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.make_hdiag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.make_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_dhf_slow.</span></span><span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.make_rdm1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.make_rdm12">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_dhf_slow.</span></span><span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.make_rdm12" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_dhf_slow.reorder_rdm">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_dhf_slow.</span></span><span class="sig-name descname"><span class="pre">reorder_rdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_dhf_slow.html#reorder_rdm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_dhf_slow.reorder_rdm" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.fci.fci_slow">
<span id="pyscf-fci-fci-slow-module"></span><h2 id="module-pyscf.fci.fci_slow">pyscf.fci.fci_slow module<a class="headerlink" href="#module-pyscf.fci.fci_slow" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_slow.absorb_h1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_slow.</span></span><span class="sig-name descname"><span class="pre">absorb_h1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#absorb_h1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_slow.absorb_h1e" title="Permalink to this definition"></a></dt>
<dd><p>Modify 2e Hamiltonian to include 1e Hamiltonian contribution.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_slow.contract_1e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_slow.</span></span><span class="sig-name descname"><span class="pre">contract_1e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#contract_1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_slow.contract_1e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_slow.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_slow.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_slow.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Compute E_{pq}E_{rs}|CI&gt;</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_slow.contract_2e_hubbard">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_slow.</span></span><span class="sig-name descname"><span class="pre">contract_2e_hubbard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#contract_2e_hubbard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_slow.contract_2e_hubbard" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_slow.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_slow.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_slow.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_slow.make_hdiag">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_slow.</span></span><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_slow.make_hdiag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_slow.make_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_slow.</span></span><span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_slow.make_rdm1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_slow.make_rdm12">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_slow.</span></span><span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_slow.make_rdm12" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.fci_slow.reorder_rdm">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.fci_slow.</span></span><span class="sig-name descname"><span class="pre">reorder_rdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/fci_slow.html#reorder_rdm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.fci_slow.reorder_rdm" title="Permalink to this definition"></a></dt>
<dd><p>reorder from rdm2(pq,rs) = &lt;E^p_q E^r_s&gt; to rdm2(pq,rs) = &lt;e^{pr}_{qs}&gt;.
Although the reoredered rdm2 is still in Mulliken order (rdm2[e1,e1,e2,e2]),
it is the true 2e DM (dotting it with int2e gives the energy of 2e parts)</p>
</dd></dl>
</section>
<section id="module-pyscf.fci.rdm">
<span id="pyscf-fci-rdm-module"></span><h2 id="module-pyscf.fci.rdm">pyscf.fci.rdm module<a class="headerlink" href="#module-pyscf.fci.rdm" title="Permalink to this heading"></a></h2>
<p>FCI 1, 2, 3, 4-particle density matrices.</p>
<p>Note the 1-particle density matrix has the same convention as the mean-field
1-particle density matrix (see McWeeneys book Eq 5.4.20), which is</p>
<blockquote>
<div><p>dm[p,q] = &lt; q^+ p &gt;</p>
</div></blockquote>
<dl class="simple">
<dt>The contraction between 1-particle Hamiltonian and 1-pdm is</dt><dd><p>E = einsum(pq,qp, h1, 1pdm)</p>
</dd>
<dt>Different conventions are used in the high order density matrices:</dt><dd><p>dm[p,q,r,s,] = &lt; p^+ r^+  s q &gt;</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.make_dm123">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">make_dm123</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_dm123"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.rdm.make_dm123" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced 1, 2 and 3-particle density matrices.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this function, 2pdm[p,q,r,s] is <span class="math notranslate nohighlight">\(\langle p^\dagger q r^\dagger s\rangle\)</span>;
3pdm[p,q,r,s,t,u] is <span class="math notranslate nohighlight">\(\langle p^\dagger q r^\dagger s t^\dagger u\rangle\)</span>.</p>
<p>After calling reorder_dm123, the 2pdm and 3pdm are transformed to
the normal density matrices:
2pdm[p,r,q,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger s r\rangle\)</span>
3pdm[p,s,q,t,r,u] = <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger r^\dagger u t s\rangle\)</span>.</p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.make_dm1234">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">make_dm1234</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_dm1234"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.rdm.make_dm1234" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced 1, 2, 3 and 4-particle density matrices.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this function, 2pdm[p,q,r,s] is <span class="math notranslate nohighlight">\(\langle p^\dagger q r^\dagger s\rangle\)</span>;
3pdm[p,q,r,s,t,u] is <span class="math notranslate nohighlight">\(\langle p^\dagger q r^\dagger s t^\dagger u\rangle\)</span>;
4pdm[p,q,r,s,t,u,v,w] is <span class="math notranslate nohighlight">\(\langle p^\dagger q r^\dagger s t^\dagger u v^\dagger w\rangle\)</span>.</p>
<p>After calling reorder_dm123, the 2pdm and 3pdm are transformed to
the normal density matrices:
2pdm[p,r,q,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger s r\rangle\)</span>
3pdm[p,s,q,t,r,u] = <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger r^\dagger u t s\rangle\)</span>.
4pdm[p,t,q,u,r,v,s,w] = <span class="math notranslate nohighlight">\(\langle p^\dagger q^\dagger r^\dagger s^dagger w v u t\rangle\)</span>.</p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.make_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.rdm.make_rdm1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.make_rdm12">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.rdm.make_rdm12" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.make_rdm12_ms0">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">make_rdm12_ms0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_rdm12_ms0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.rdm.make_rdm12_ms0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.make_rdm12_spin1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">make_rdm12_spin1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_rdm12_spin1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.rdm.make_rdm12_spin1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.make_rdm1_ms0">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">make_rdm1_ms0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_rdm1_ms0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.rdm.make_rdm1_ms0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.make_rdm1_spin1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">make_rdm1_spin1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#make_rdm1_spin1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.rdm.make_rdm1_spin1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.reorder_dm12">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">reorder_dm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#reorder_dm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.rdm.reorder_dm12" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.reorder_dm123">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">reorder_dm123</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#reorder_dm123"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.rdm.reorder_dm123" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.reorder_dm1234">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">reorder_dm1234</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#reorder_dm1234"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.rdm.reorder_dm1234" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.rdm.reorder_rdm">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.rdm.</span></span><span class="sig-name descname"><span class="pre">reorder_rdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/rdm.html#reorder_rdm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.rdm.reorder_rdm" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.fci.selected_ci">
<span id="pyscf-fci-selected-ci-module"></span><h2 id="module-pyscf.fci.selected_ci">pyscf.fci.selected_ci module<a class="headerlink" href="#module-pyscf.fci.selected_ci" title="Permalink to this heading"></a></h2>
<p>Selected CI.</p>
<p>This is an inefficient dialect of Selected CI using the same structure as
determinant based FCI algorithm. For the efficient Selected CI programs,
Dice program (<a class="reference external" href="https://github.com/sanshar/Dice.git">https://github.com/sanshar/Dice.git</a>) is a good candidate.</p>
<p>Simple usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">ao2mo</span><span class="p">,</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'C 0 0 0; C 0 0 1'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h1</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">get_hcore</span><span class="p">())</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h2</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">selected_ci</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mol</span><span class="o">.</span><span class="n">nelectron</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">SCI</span></span><a class="headerlink" href="#pyscf.fci.selected_ci.SCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.selected_ci.SelectedCI" title="pyscf.fci.selected_ci.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelectedCI</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SCIvector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">SCIvector</span></span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SCIvector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SCIvector" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
<p>An 2D np array for selected CI coefficients</p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">SelectedCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.direct_spin1.FCISolver" title="pyscf.fci.direct_spin1.FCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.ci_coeff_cutoff">
<span class="sig-name descname"><span class="pre">ci_coeff_cutoff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0005</span></em><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.ci_coeff_cutoff" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.contract_ss">
<span class="sig-name descname"><span class="pre">contract_ss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.contract_ss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.contract_ss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.conv_tol">
<span class="sig-name descname"><span class="pre">conv_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-09</span></em><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.conv_tol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.dump_flags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.enlarge_space">
<span class="sig-name descname"><span class="pre">enlarge_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.enlarge_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.gen_linkstr">
<span class="sig-name descname"><span class="pre">gen_linkstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tril</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.gen_linkstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.gen_linkstr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.get_init_guess">
<span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.get_init_guess" title="Permalink to this definition"></a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.kernel" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h1e: ndarray</dt><dd><p>1-electron Hamiltonian</p>
</dd>
<dt>eri: ndarray</dt><dd><p>2-electron integrals in chemists notation</p>
</dd>
<dt>norb: int</dt><dd><p>Number of orbitals</p>
</dd>
<dt>nelec: int or (int, int)</dt><dd><p>Number of electrons of the system</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ci0: ndarray</dt><dd><p>Initial guess</p>
</dd>
<dt>link_index: ndarray</dt><dd><p>A lookup table to cache the addresses of CI determinants in
wave-function vector</p>
</dd>
<dt>tol: float</dt><dd><p>Convergence tolerance</p>
</dd>
<dt>lindep: float</dt><dd><p>Linear dependence threshold</p>
</dd>
<dt>max_cycle: int</dt><dd><p>Max. iterations for diagonalization</p>
</dd>
<dt>max_space: int</dt><dd><p>Max. trial vectors to store for sub-space diagonalization method</p>
</dd>
<dt>nroots: int</dt><dd><p>Number of states to solve</p>
</dd>
<dt>davidson_only: bool</dt><dd><p>Whether to call subspace diagonlization (davidson solver) or do a
full diagonlization (lapack eigh) for small systems</p>
</dd>
<dt>pspace_size: int</dt><dd><p>Number of determinants as the threshold of small systems,</p>
</dd>
<dt>hop: function(c) =&gt; array_like_c</dt><dd><p>Function to use for the Hamiltonian multiplication with trial vector</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: davidson solver requires more arguments. For the parameters not
dispatched, they can be passed to davidson solver via the extra keyword
arguments <a href="#id55"><span class="problematic" id="id56">**</span></a>kwargs</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.kernel_fixed_space">
<span class="sig-name descname"><span class="pre">kernel_fixed_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.kernel_fixed_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.large_ci">
<span class="sig-name descname"><span class="pre">large_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_strs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.large_ci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.large_ci" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.make_hdiag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin-traced 1-particle density matrix.</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.make_rdm12">
<span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm12" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced 1- and 2-particle density matrices.</p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id57"><span class="problematic" id="id58">`</span></a>langle <a href="#id371"><span class="problematic" id="id372">q_</span></a>alpha^dagger <a href="#id373"><span class="problematic" id="id374">p_</span></a>alpha rangle +</dt><dd><p>langle <a href="#id375"><span class="problematic" id="id376">q_</span></a>beta^dagger  <a href="#id377"><span class="problematic" id="id378">p_</span></a>beta rangle`;</p>
</dd>
<dt>2pdm[p,q,r,s] = :math:<a href="#id59"><span class="problematic" id="id60">`</span></a>langle <a href="#id379"><span class="problematic" id="id380">p_</span></a>alpha^dagger <a href="#id381"><span class="problematic" id="id382">r_</span></a>alpha^dagger <a href="#id383"><span class="problematic" id="id384">s_</span></a>alpha <a href="#id385"><span class="problematic" id="id386">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id387"><span class="problematic" id="id388">p_</span></a>beta^dagger  <a href="#id389"><span class="problematic" id="id390">r_</span></a>alpha^dagger <a href="#id391"><span class="problematic" id="id392">s_</span></a>alpha <a href="#id393"><span class="problematic" id="id394">q_</span></a>betarangle +
langle <a href="#id395"><span class="problematic" id="id396">p_</span></a>alpha^dagger <a href="#id397"><span class="problematic" id="id398">r_</span></a>beta^dagger  <a href="#id399"><span class="problematic" id="id400">s_</span></a>beta  <a href="#id401"><span class="problematic" id="id402">q_</span></a>alpharangle +
langle <a href="#id403"><span class="problematic" id="id404">p_</span></a>beta^dagger  <a href="#id405"><span class="problematic" id="id406">r_</span></a>beta^dagger  <a href="#id407"><span class="problematic" id="id408">s_</span></a>beta  <a href="#id409"><span class="problematic" id="id410">q_</span></a>betarangle`.</p>
</dd>
</dl>
<p>Energy should be computed as
E = einsum(pq,qp, h1, 1pdm) + 1/2 * einsum(pqrs,pqrs, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.make_rdm12s">
<span class="sig-name descname"><span class="pre">make_rdm12s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm12s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm12s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1- and 2-particle density matrices.
The return values include two lists, a list of 1-particle density matrices
and a list of 2-particle density matrices.  The density matrices are:
(alpha,alpha), (beta,beta) for 1-particle density matrices;
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta),
(beta,beta,beta,beta) for 2-particle density matrices.</p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p\rangle\)</span>;
2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span>.</p>
<p>Energy should be computed as
E = einsum(pq,qp, h1, 1pdm) + 1/2 * einsum(pqrs,pqrs, eri, 2pdm)
where h1[p,q] = &lt;p|h|q&gt; and eri[p,q,r,s] = (pq|rs)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.make_rdm1s">
<span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.make_rdm2">
<span class="sig-name descname"><span class="pre">make_rdm2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm2" title="Permalink to this definition"></a></dt>
<dd><p>Spin-traced two-particle density matrix.</p>
<dl class="simple">
<dt>2pdm[p,q,r,s] = :math:<a href="#id61"><span class="problematic" id="id62">`</span></a>langle <a href="#id411"><span class="problematic" id="id412">p_</span></a>alpha^dagger <a href="#id413"><span class="problematic" id="id414">r_</span></a>alpha^dagger <a href="#id415"><span class="problematic" id="id416">s_</span></a>alpha <a href="#id417"><span class="problematic" id="id418">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id419"><span class="problematic" id="id420">p_</span></a>beta^dagger  <a href="#id421"><span class="problematic" id="id422">r_</span></a>alpha^dagger <a href="#id423"><span class="problematic" id="id424">s_</span></a>alpha <a href="#id425"><span class="problematic" id="id426">q_</span></a>betarangle +
langle <a href="#id427"><span class="problematic" id="id428">p_</span></a>alpha^dagger <a href="#id429"><span class="problematic" id="id430">r_</span></a>beta^dagger  <a href="#id431"><span class="problematic" id="id432">s_</span></a>beta  <a href="#id433"><span class="problematic" id="id434">q_</span></a>alpharangle +
langle <a href="#id435"><span class="problematic" id="id436">p_</span></a>beta^dagger  <a href="#id437"><span class="problematic" id="id438">r_</span></a>beta^dagger  <a href="#id439"><span class="problematic" id="id440">s_</span></a>beta  <a href="#id441"><span class="problematic" id="id442">q_</span></a>betarangle`.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.make_rdm2s">
<span class="sig-name descname"><span class="pre">make_rdm2s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.make_rdm2s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.make_rdm2s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 2-particle density matrices.
The return values include three density matrices:
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta), (beta,beta,beta,beta)</p>
<p>2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span></p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.select_cutoff">
<span class="sig-name descname"><span class="pre">select_cutoff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0005</span></em><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.select_cutoff" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.spin_square">
<span class="sig-name descname"><span class="pre">spin_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.spin_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.spin_square" title="Permalink to this definition"></a></dt>
<dd><p>Spin square for RHF-FCI CI wfn only (obtained from spin-degenerated
Hamiltonian)</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.start_tol">
<span class="sig-name descname"><span class="pre">start_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0003</span></em><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.start_tol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.tol_decay_rate">
<span class="sig-name descname"><span class="pre">tol_decay_rate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.3</span></em><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.tol_decay_rate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.trans_rdm1">
<span class="sig-name descname"><span class="pre">trans_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.trans_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.trans_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1-particle density matrices.
See also function <a class="reference internal" href="#pyscf.fci.selected_ci.make_rdm1" title="pyscf.fci.selected_ci.make_rdm1"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a></p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id63"><span class="problematic" id="id64">`</span></a>langle <a href="#id443"><span class="problematic" id="id444">q_</span></a>alpha^dagger <a href="#id445"><span class="problematic" id="id446">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id447"><span class="problematic" id="id448">q_</span></a>beta^dagger <a href="#id449"><span class="problematic" id="id450">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.SelectedCI.trans_rdm1s">
<span class="sig-name descname"><span class="pre">trans_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#SelectedCI.trans_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.SelectedCI.trans_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
See also function <a class="reference internal" href="#pyscf.fci.selected_ci.make_rdm1s" title="pyscf.fci.selected_ci.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.contract_ss">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">contract_ss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#contract_ss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.contract_ss" title="Permalink to this definition"></a></dt>
<dd><p>S^2 <a href="#id65"><span class="problematic" id="id66">|</span></a>Psirangle</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.cre_des_linkstr">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">cre_des_linkstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tril</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#cre_des_linkstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.cre_des_linkstr" title="Permalink to this definition"></a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.cre_des_linkstr_tril">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">cre_des_linkstr_tril</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#cre_des_linkstr_tril"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.cre_des_linkstr_tril" title="Permalink to this definition"></a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.des_des_linkstr">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">des_des_linkstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tril</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#des_des_linkstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.des_des_linkstr" title="Permalink to this definition"></a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.des_des_linkstr_tril">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">des_des_linkstr_tril</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#des_des_linkstr_tril"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.des_des_linkstr_tril" title="Permalink to this definition"></a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.enlarge_space">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">enlarge_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">myci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#enlarge_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.enlarge_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.from_fci">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">from_fci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#from_fci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.from_fci" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.gen_cre_linkstr">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">gen_cre_linkstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#gen_cre_linkstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.gen_cre_linkstr" title="Permalink to this definition"></a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.gen_des_linkstr">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">gen_des_linkstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#gen_des_linkstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.gen_des_linkstr" title="Permalink to this definition"></a></dt>
<dd><p>Given intermediates, the link table to generate input strs</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_coeff_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.kernel_fixed_space">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">kernel_fixed_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">myci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#kernel_fixed_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.kernel_fixed_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.kernel_float_space">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">kernel_float_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">myci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#kernel_float_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.kernel_float_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.make_hdiag">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.make_hdiag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.make_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.make_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin-traced 1-particle density matrix.</p>
<p>dm1[p,q] = &lt;q_alpha^dagger p_alpha&gt; + &lt;q_beta^dagger p_beta&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20)
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.make_rdm1s">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.make_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 1-particle density matrices.
The return values include two density matrices: (alpha,alpha), (beta,beta)</p>
<p>dm1[p,q] = &lt;q^dagger p&gt;</p>
<p>The convention is based on McWeeneys book, Eq (5.4.20).
The contraction between 1-particle Hamiltonian and rdm1 is
E = einsum(pq,qp, h1, rdm1)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.make_rdm2">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">make_rdm2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#make_rdm2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.make_rdm2" title="Permalink to this definition"></a></dt>
<dd><p>Spin-traced two-particle density matrix.</p>
<dl class="simple">
<dt>2pdm[p,q,r,s] = :math:<a href="#id67"><span class="problematic" id="id68">`</span></a>langle <a href="#id451"><span class="problematic" id="id452">p_</span></a>alpha^dagger <a href="#id453"><span class="problematic" id="id454">r_</span></a>alpha^dagger <a href="#id455"><span class="problematic" id="id456">s_</span></a>alpha <a href="#id457"><span class="problematic" id="id458">q_</span></a>alpharangle +</dt><dd><p>langle <a href="#id459"><span class="problematic" id="id460">p_</span></a>beta^dagger  <a href="#id461"><span class="problematic" id="id462">r_</span></a>alpha^dagger <a href="#id463"><span class="problematic" id="id464">s_</span></a>alpha <a href="#id465"><span class="problematic" id="id466">q_</span></a>betarangle +
langle <a href="#id467"><span class="problematic" id="id468">p_</span></a>alpha^dagger <a href="#id469"><span class="problematic" id="id470">r_</span></a>beta^dagger  <a href="#id471"><span class="problematic" id="id472">s_</span></a>beta  <a href="#id473"><span class="problematic" id="id474">q_</span></a>alpharangle +
langle <a href="#id475"><span class="problematic" id="id476">p_</span></a>beta^dagger  <a href="#id477"><span class="problematic" id="id478">r_</span></a>beta^dagger  <a href="#id479"><span class="problematic" id="id480">s_</span></a>beta  <a href="#id481"><span class="problematic" id="id482">q_</span></a>betarangle`.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.make_rdm2s">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">make_rdm2s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#make_rdm2s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.make_rdm2s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated 2-particle density matrices.
The return values include three density matrices:
(alpha,alpha,alpha,alpha), (alpha,alpha,beta,beta), (beta,beta,beta,beta)</p>
<p>2pdm[p,q,r,s] = <span class="math notranslate nohighlight">\(\langle p^\dagger r^\dagger s q\rangle\)</span></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.select_strs">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">select_strs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">myci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri_pq_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#select_strs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.select_strs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.spin_square">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">spin_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#spin_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.spin_square" title="Permalink to this definition"></a></dt>
<dd><p>Spin square for RHF-FCI CI wfn only (obtained from spin-degenerated
Hamiltonian)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.to_fci">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">to_fci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#to_fci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.to_fci" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.trans_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">trans_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#trans_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.trans_rdm1" title="Permalink to this definition"></a></dt>
<dd><p>Spin traced transition 1-particle density matrices.
See also function <a class="reference internal" href="#pyscf.fci.selected_ci.make_rdm1" title="pyscf.fci.selected_ci.make_rdm1"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a></p>
<dl class="simple">
<dt>1pdm[p,q] = :math:<a href="#id69"><span class="problematic" id="id70">`</span></a>langle <a href="#id483"><span class="problematic" id="id484">q_</span></a>alpha^dagger <a href="#id485"><span class="problematic" id="id486">p_</span></a>alpha rangle</dt><dd><ul class="simple">
<li><p>langle <a href="#id487"><span class="problematic" id="id488">q_</span></a>beta^dagger <a href="#id489"><span class="problematic" id="id490">p_</span></a>beta rangle`</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci.trans_rdm1s">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci.</span></span><span class="sig-name descname"><span class="pre">trans_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cibra_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciket_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci.html#trans_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci.trans_rdm1s" title="Permalink to this definition"></a></dt>
<dd><p>Spin separated transition 1-particle density matrices.
See also function <a class="reference internal" href="#pyscf.fci.selected_ci.make_rdm1s" title="pyscf.fci.selected_ci.make_rdm1s"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a></p>
<p>1pdm[p,q] = <span class="math notranslate nohighlight">\(\langle q^\dagger p \rangle\)</span></p>
</dd></dl>
</section>
<section id="module-pyscf.fci.selected_ci_slow">
<span id="pyscf-fci-selected-ci-slow-module"></span><h2 id="module-pyscf.fci.selected_ci_slow">pyscf.fci.selected_ci_slow module<a class="headerlink" href="#module-pyscf.fci.selected_ci_slow" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_slow.SelectedCI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_slow.</span></span><span class="sig-name descname"><span class="pre">SelectedCI</span></span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#SelectedCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.SelectedCI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_slow.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_slow.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Compute E_{pq}E_{rs}|CI&gt;</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_slow.cre_des_linkstr">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_slow.</span></span><span class="sig-name descname"><span class="pre">cre_des_linkstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#cre_des_linkstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.cre_des_linkstr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_slow.des_des_linkstr">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_slow.</span></span><span class="sig-name descname"><span class="pre">des_des_linkstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#des_des_linkstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.des_des_linkstr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_slow.enlarge_space">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_slow.</span></span><span class="sig-name descname"><span class="pre">enlarge_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">myci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#enlarge_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.enlarge_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_slow.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_slow.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_slow.make_hdiag">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_slow.</span></span><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g2e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.make_hdiag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_slow.make_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_slow.</span></span><span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.make_rdm1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_slow.make_rdm2">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_slow.</span></span><span class="sig-name descname"><span class="pre">make_rdm2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_slow.html#make_rdm2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_slow.make_rdm2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.fci.selected_ci_spin0">
<span id="pyscf-fci-selected-ci-spin0-module"></span><h2 id="module-pyscf.fci.selected_ci_spin0">pyscf.fci.selected_ci_spin0 module<a class="headerlink" href="#module-pyscf.fci.selected_ci_spin0" title="Permalink to this heading"></a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0.SCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_spin0.</span></span><span class="sig-name descname"><span class="pre">SCI</span></span><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.SCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.selected_ci_spin0.SelectedCI" title="pyscf.fci.selected_ci_spin0.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelectedCI</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0.SelectedCI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_spin0.</span></span><span class="sig-name descname"><span class="pre">SelectedCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#SelectedCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.SelectedCI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.selected_ci.SelectedCI" title="pyscf.fci.selected_ci.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelectedCI</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0.SelectedCI.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#SelectedCI.contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.SelectedCI.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0.SelectedCI.enlarge_space">
<span class="sig-name descname"><span class="pre">enlarge_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.SelectedCI.enlarge_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0.SelectedCI.make_hdiag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.SelectedCI.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_spin0.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.contract_2e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0.enlarge_space">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_spin0.</span></span><span class="sig-name descname"><span class="pre">enlarge_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">myci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#enlarge_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.enlarge_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_spin0.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_coeff_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0.make_hdiag">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_spin0.</span></span><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0.html#make_hdiag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0.make_hdiag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.fci.selected_ci_spin0_symm">
<span id="pyscf-fci-selected-ci-spin0-symm-module"></span><h2 id="module-pyscf.fci.selected_ci_spin0_symm">pyscf.fci.selected_ci_spin0_symm module<a class="headerlink" href="#module-pyscf.fci.selected_ci_spin0_symm" title="Permalink to this heading"></a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0_symm.SCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_spin0_symm.</span></span><span class="sig-name descname"><span class="pre">SCI</span></span><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.SCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI" title="pyscf.fci.selected_ci_spin0_symm.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelectedCI</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0_symm.SelectedCI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_spin0_symm.</span></span><span class="sig-name descname"><span class="pre">SelectedCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0_symm.html#SelectedCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.selected_ci_symm.SelectedCI" title="pyscf.fci.selected_ci_symm.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelectedCI</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0_symm.SelectedCI.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0_symm.html#SelectedCI.contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0_symm.SelectedCI.enlarge_space">
<span class="sig-name descname"><span class="pre">enlarge_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI.enlarge_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0_symm.SelectedCI.make_hdiag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_hdiag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.SelectedCI.make_hdiag" title="Permalink to this definition"></a></dt>
<dd><p>Diagonal Hamiltonian for Davidson preconditioner</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>compress (bool) : whether to remove symmetry forbidden elements</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0_symm.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_spin0_symm.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0_symm.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.contract_2e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_spin0_symm.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_spin0_symm.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_coeff_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_spin0_symm.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_spin0_symm.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.fci.selected_ci_symm">
<span id="pyscf-fci-selected-ci-symm-module"></span><h2 id="module-pyscf.fci.selected_ci_symm">pyscf.fci.selected_ci_symm module<a class="headerlink" href="#module-pyscf.fci.selected_ci_symm" title="Permalink to this heading"></a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_symm.SCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_symm.</span></span><span class="sig-name descname"><span class="pre">SCI</span></span><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SCI" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.fci.selected_ci_symm.SelectedCI" title="pyscf.fci.selected_ci_symm.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelectedCI</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_symm.SelectedCI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_symm.</span></span><span class="sig-name descname"><span class="pre">SelectedCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#SelectedCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SelectedCI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.fci.selected_ci.SelectedCI" title="pyscf.fci.selected_ci.SelectedCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelectedCI</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_symm.SelectedCI.contract_2e">
<span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#SelectedCI.contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SelectedCI.contract_2e" title="Permalink to this definition"></a></dt>
<dd><p>Contract the 4-index tensor eri[pqrs] with a FCI vector</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}|output\rangle = E_{pq} E_{rs} eri_{pq,rs} |CI\rangle \\\end{split}\\\begin{split}E_{pq}E_{rs} = E_{pr,qs} + \delta_{qr} E_{ps} \\\end{split}\\E_{pq} = p^+ q + \bar{p}^+ \bar{q}\\E_{pr,qs} = p^+ r^+ s q + \bar{p}^+ r^+ s \bar{q} + ...\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(p,q,...\)</span> means spin-up orbitals and <span class="math notranslate nohighlight">\(\bar{p}, \bar{q}\)</span> means
spin-down orbitals.</p>
<p>Note the input argument eri is NOT the 2e hamiltonian tensor. 2e hamiltonian is</p>
<div class="math notranslate nohighlight">
\[\begin{split}h2e &amp;= (pq|rs) E_{pr,qs} \\
    &amp;= (pq|rs) (E_{pq}E_{rs} - \delta_{qr} E_{ps}) \\
    &amp;= eri_{pq,rs} E_{pq}E_{rs} \\\end{split}\]</div>
<p>So the relation between eri and hamiltonian (the 2e-integral tensor) is</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (1/Nelec) \sum_q (pq|qs)\]</div>
<p>to restore the symmetry between pq and rs,</p>
<div class="math notranslate nohighlight">
\[eri_{pq,rs} = (pq|rs) - (.5/Nelec) [\sum_q (pq|qs) + \sum_p (pq|rp)]\]</div>
<p>See also <code class="xref py py-func docutils literal notranslate"><span class="pre">direct_spin1.absorb_h1e()</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_symm.SelectedCI.get_init_guess">
<span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#SelectedCI.get_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SelectedCI.get_init_guess" title="Permalink to this definition"></a></dt>
<dd><p>Initial guess is the single Slater determinant</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_symm.SelectedCI.guess_wfnsym">
<span class="sig-name descname"><span class="pre">guess_wfnsym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#SelectedCI.guess_wfnsym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SelectedCI.guess_wfnsym" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_symm.SelectedCI.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#SelectedCI.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.SelectedCI.kernel" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h1e: ndarray</dt><dd><p>1-electron Hamiltonian</p>
</dd>
<dt>eri: ndarray</dt><dd><p>2-electron integrals in chemists notation</p>
</dd>
<dt>norb: int</dt><dd><p>Number of orbitals</p>
</dd>
<dt>nelec: int or (int, int)</dt><dd><p>Number of electrons of the system</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ci0: ndarray</dt><dd><p>Initial guess</p>
</dd>
<dt>link_index: ndarray</dt><dd><p>A lookup table to cache the addresses of CI determinants in
wave-function vector</p>
</dd>
<dt>tol: float</dt><dd><p>Convergence tolerance</p>
</dd>
<dt>lindep: float</dt><dd><p>Linear dependence threshold</p>
</dd>
<dt>max_cycle: int</dt><dd><p>Max. iterations for diagonalization</p>
</dd>
<dt>max_space: int</dt><dd><p>Max. trial vectors to store for sub-space diagonalization method</p>
</dd>
<dt>nroots: int</dt><dd><p>Number of states to solve</p>
</dd>
<dt>davidson_only: bool</dt><dd><p>Whether to call subspace diagonlization (davidson solver) or do a
full diagonlization (lapack eigh) for small systems</p>
</dd>
<dt>pspace_size: int</dt><dd><p>Number of determinants as the threshold of small systems,</p>
</dd>
<dt>hop: function(c) =&gt; array_like_c</dt><dd><p>Function to use for the Hamiltonian multiplication with trial vector</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: davidson solver requires more arguments. For the parameters not
dispatched, they can be passed to davidson solver via the extra keyword
arguments <a href="#id71"><span class="problematic" id="id72">**</span></a>kwargs</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_symm.contract_2e">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_symm.</span></span><span class="sig-name descname"><span class="pre">contract_2e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civec_strs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#contract_2e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.contract_2e" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_symm.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_symm.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">davidson_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pspace_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_coeff_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.selected_ci_symm.reorder4irrep">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.selected_ci_symm.</span></span><span class="sig-name descname"><span class="pre">reorder4irrep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offdiag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/selected_ci_symm.html#reorder4irrep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.selected_ci_symm.reorder4irrep" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.fci.spin_op">
<span id="pyscf-fci-spin-op-module"></span><h2 id="module-pyscf.fci.spin_op">pyscf.fci.spin_op module<a class="headerlink" href="#module-pyscf.fci.spin_op" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.spin_op.contract_ss">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.spin_op.</span></span><span class="sig-name descname"><span class="pre">contract_ss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#contract_ss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.spin_op.contract_ss" title="Permalink to this definition"></a></dt>
<dd><p>Contract spin square operator with FCI wavefunction <span class="math notranslate nohighlight">\(S^2 |CI&gt;\)</span></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.spin_op.local_spin">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.spin_op.</span></span><span class="sig-name descname"><span class="pre">local_spin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ovlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aolst</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#local_spin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.spin_op.local_spin" title="Permalink to this definition"></a></dt>
<dd><p>Local spin expectation value, which is defined as</p>
<p>&lt;CI|(local S^2)|CI&gt;</p>
<p>The local S^2 operator only couples the orbitals specified in aolst. The
cross term which involves the interaction between the local part (in aolst)
and non-local part (not in aolst) is not included. As a result, the value
of local_spin is not additive. In other words, if local_spin is computed
twice with the complementary aolst in the two runs, the summation does not
equal to the S^2 of the entire system.</p>
<p>For a complete list of AOs, the value of local_spin is equivalent to &lt;CI|S^2|CI&gt;</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.spin_op.make_rdm2_abba">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.spin_op.</span></span><span class="sig-name descname"><span class="pre">make_rdm2_abba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#make_rdm2_abba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.spin_op.make_rdm2_abba" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.spin_op.make_rdm2_baab">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.spin_op.</span></span><span class="sig-name descname"><span class="pre">make_rdm2_baab</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#make_rdm2_baab"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.spin_op.make_rdm2_baab" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.spin_op.spin_square">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.spin_op.</span></span><span class="sig-name descname"><span class="pre">spin_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ovlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcisolver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#spin_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.spin_op.spin_square" title="Permalink to this definition"></a></dt>
<dd><p>General spin square operator.</p>
<p> math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_</span><span class="o">+*</span><span class="n">S_</span><span class="o">-|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> <span class="n">n_</span>\<span class="n">alpha</span> <span class="o">+</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">alpha</span> <span class="p">}</span> \\
<span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_</span><span class="o">-*</span><span class="n">S_</span><span class="o">+|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> <span class="n">n_</span>\<span class="n">beta</span> <span class="o">+</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">beta</span> <span class="p">}</span> \\
<span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_z</span><span class="o">*</span><span class="n">S_z</span><span class="o">|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}(</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">alpha</span> <span class="p">}</span>
                 <span class="o">-</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">beta</span> <span class="p">}</span>
                 <span class="o">-</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">alpha</span><span class="p">}</span>
                 <span class="o">+</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">beta</span><span class="p">})</span>
                 <span class="o">+</span> <span class="p">(</span><span class="n">n_</span>\<span class="n">alpha</span><span class="o">+</span><span class="n">n_</span>\<span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
</pre></div>
</div>
<p>Given the overlap betwen non-degenerate alpha and beta orbitals, this
function can compute the expectation value spin square operator for
UHF-FCI wavefunction</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.spin_op.spin_square0">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.spin_op.</span></span><span class="sig-name descname"><span class="pre">spin_square0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#spin_square0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.spin_op.spin_square0" title="Permalink to this definition"></a></dt>
<dd><p>Spin square for RHF-FCI CI wfn only (obtained from spin-degenerated
Hamiltonian)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.spin_op.spin_square_general">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.spin_op.</span></span><span class="sig-name descname"><span class="pre">spin_square_general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm1a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm1b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2aa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2ab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm2bb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ovlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci/spin_op.html#spin_square_general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.spin_op.spin_square_general" title="Permalink to this definition"></a></dt>
<dd><p>General spin square operator.</p>
<p> math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_</span><span class="o">+*</span><span class="n">S_</span><span class="o">-|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> <span class="n">n_</span>\<span class="n">alpha</span> <span class="o">+</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">alpha</span> <span class="p">}</span> \\
<span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_</span><span class="o">-*</span><span class="n">S_</span><span class="o">+|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> <span class="n">n_</span>\<span class="n">beta</span> <span class="o">+</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">beta</span> <span class="p">}</span> \\
<span class="o">&lt;</span><span class="n">CI</span><span class="o">|</span><span class="n">S_z</span><span class="o">*</span><span class="n">S_z</span><span class="o">|</span><span class="n">CI</span><span class="o">&gt;</span> <span class="o">&amp;=</span> \<span class="n">delta_</span><span class="p">{</span><span class="n">ik</span><span class="p">}</span>\<span class="n">delta_</span><span class="p">{</span><span class="n">jl</span><span class="p">}(</span><span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">alpha</span> <span class="p">}</span>
                 <span class="o">-</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">alpha</span> <span class="n">k</span>\<span class="n">alpha</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">beta</span> <span class="p">}</span>
                 <span class="o">-</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">alpha</span> <span class="n">l</span>\<span class="n">alpha</span><span class="p">}</span>
                 <span class="o">+</span> <span class="n">Gamma_</span><span class="p">{</span><span class="n">i</span>\<span class="n">beta</span> <span class="n">k</span>\<span class="n">beta</span> <span class="p">,</span><span class="n">j</span>\<span class="n">beta</span> <span class="n">l</span>\<span class="n">beta</span><span class="p">})</span>
                 <span class="o">+</span> <span class="p">(</span><span class="n">n_</span>\<span class="n">alpha</span><span class="o">+</span><span class="n">n_</span>\<span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
</pre></div>
</div>
<p>Given the overlap betwen non-degenerate alpha and beta orbitals, this
function can compute the expectation value spin square operator for
UHF-FCI wavefunction</p>
</dd></dl>
</section>
<section id="module-pyscf.fci">
<span id="module-contents"></span><h2 id="module-pyscf.fci">Module contents<a class="headerlink" href="#module-pyscf.fci" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>Different FCI solvers are implemented to support different type of symmetry.</dt><dd><p>Symmetry</p>
</dd>
</dl>
<p>File                Point group   Spin singlet   Real hermitian*    Alpha/beta degeneracy
direct_spin0_symm   Yes           Yes            Yes                Yes
direct_spin1_symm   Yes           No             Yes                Yes
direct_spin0        No            Yes            Yes                Yes
direct_spin1        No            No             Yes                Yes
direct_uhf          No            No             Yes                No
direct_nosym        No            No             No**               Yes
fci_dhf_slow        No            No             No***              No</p>
<ul class="simple">
<li><p>Real hermitian Hamiltonian implies (ij|kl) = (ji|kl) = (ij|lk) = (ji|lk)</p></li>
</ul>
<p>** Hamiltonian is real but not hermitian, (ij|kl) != (ji|kl) 
<a href="#id73"><span class="problematic" id="id74">**</span></a>* Hamiltonian is complex hermitian (DHF case) or real hermitian (GHF case)</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.FCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.</span></span><span class="sig-name descname"><span class="pre">FCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol_or_mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci.html#FCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.FCI" title="Permalink to this definition"></a></dt>
<dd><p>FCI solver</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>mol_or_mf :</dt><dd><p>A Mole object or an SCF object</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>mo :</dt><dd><p>Molecular orbital coefficients</p>
</dd>
<dt>singlet :</dt><dd><p>Whether to enable spin symmetry for S=0 RHF-based FCI solver.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A FCI object</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.fci.solver">
<span class="sig-prename descclassname"><span class="pre">pyscf.fci.</span></span><span class="sig-name descname"><span class="pre">solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/fci.html#solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.fci.solver" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="pyscf.eph.html" title="pyscf.eph package"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> pyscf.eph package </span>
              </div>
            </a>
          
          
            <a href="pyscf.geomopt.html" title="pyscf.geomopt package"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> pyscf.geomopt package </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>