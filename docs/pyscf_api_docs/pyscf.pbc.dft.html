
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pyscf.pbc.dft package &#8212; PySCF</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf-pst.css?v=ed6b5f64" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=dfec817d"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pyscf_api_docs/pyscf.pbc.dft';</script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.7" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-64x64.png" class="logo__image only-light" alt=""/>
    <img src="../_static/logo-64x64.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">PySCF</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../news.html">
    News
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../news.html">
    News
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pyscf.adc.html">pyscf.adc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.agf2.html">pyscf.agf2 package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.ao2mo.html">pyscf.ao2mo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.cc.html">pyscf.cc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.ci.html">pyscf.ci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.data.html">pyscf.data package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.df.html">pyscf.df package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.grad.html">pyscf.df.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.hessian.html">pyscf.df.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.dft.html">pyscf.dft package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.dft.xc.html">pyscf.dft.xc package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.eph.html">pyscf.eph package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.fci.html">pyscf.fci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.geomopt.html">pyscf.geomopt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.grad.html">pyscf.grad package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.gto.html">pyscf.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.gto.basis.html">pyscf.gto.basis package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.gw.html">pyscf.gw package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.hessian.html">pyscf.hessian package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.lib.html">pyscf.lib package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.lo.html">pyscf.lo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mcscf.html">pyscf.mcscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mp.html">pyscf.mp package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mrpt.html">pyscf.mrpt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.nac.html">pyscf.nac package</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="pyscf.pbc.html">pyscf.pbc package</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.adc.html">pyscf.pbc.adc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ao2mo.html">pyscf.pbc.ao2mo package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.cc.html">pyscf.pbc.cc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ci.html">pyscf.pbc.ci package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.df.html">pyscf.pbc.df package</a></li>
<li class="toctree-l2 current active has-children"><a class="current reference internal" href="#">pyscf.pbc.dft package</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html">pyscf.pbc.dft.multigrid package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.eph.html">pyscf.pbc.eph package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.geomopt.html">pyscf.pbc.geomopt package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.grad.html">pyscf.pbc.grad package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.pbc.gto.html">pyscf.pbc.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html">pyscf.pbc.gto.basis package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html">pyscf.pbc.gto.pseudo package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gw.html">pyscf.pbc.gw package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.lib.html">pyscf.pbc.lib package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mp.html">pyscf.pbc.mp package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpicc.html">pyscf.pbc.mpicc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpitools.html">pyscf.pbc.mpitools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.scf.html">pyscf.pbc.scf package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.symm.html">pyscf.pbc.symm package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tddft.html">pyscf.pbc.tddft package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tdscf.html">pyscf.pbc.tdscf package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tools.html">pyscf.pbc.tools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.x2c.html">pyscf.pbc.x2c package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.qmmm.html">pyscf.qmmm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.scf.html">pyscf.scf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.sgx.html">pyscf.sgx package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.solvent.html">pyscf.solvent package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.grad.html">pyscf.solvent.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.hessian.html">pyscf.solvent.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.soscf.html">pyscf.soscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.symm.html">pyscf.symm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tddft.html">pyscf.tddft package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tdscf.html">pyscf.tdscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tools.html">pyscf.tools package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.x2c.html">pyscf.x2c package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">pyscf.pbc.dft package</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pyscf-pbc-dft-package">
<h1>pyscf.pbc.dft package<a class="headerlink" href="#pyscf-pbc-dft-package" title="Link to this heading">#</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html">pyscf.pbc.dft.multigrid package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#module-pyscf.pbc.dft.multigrid.multigrid">pyscf.pbc.dft.multigrid.multigrid module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.MultiGridFFTDF"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.MultiGridFFTDF.build"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF.build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.MultiGridFFTDF.get_jk"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF.get_jk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.MultiGridFFTDF.get_nuc"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF.get_nuc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.MultiGridFFTDF.get_pp"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF.get_pp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.MultiGridFFTDF.get_rho"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF.get_rho()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.MultiGridFFTDF.reset"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF.reset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.cache_xc_kernel"><code class="docutils literal notranslate"><span class="pre">cache_xc_kernel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.cache_xc_kernel1"><code class="docutils literal notranslate"><span class="pre">cache_xc_kernel1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.eval_mat"><code class="docutils literal notranslate"><span class="pre">eval_mat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.eval_rho"><code class="docutils literal notranslate"><span class="pre">eval_rho()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.get_j_kpts"><code class="docutils literal notranslate"><span class="pre">get_j_kpts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.get_nuc"><code class="docutils literal notranslate"><span class="pre">get_nuc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.get_pp"><code class="docutils literal notranslate"><span class="pre">get_pp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.get_rho"><code class="docutils literal notranslate"><span class="pre">get_rho()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.multi_grids_tasks"><code class="docutils literal notranslate"><span class="pre">multi_grids_tasks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.multi_grids_tasks_for_ke_cut"><code class="docutils literal notranslate"><span class="pre">multi_grids_tasks_for_ke_cut()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.multi_grids_tasks_for_rcut"><code class="docutils literal notranslate"><span class="pre">multi_grids_tasks_for_rcut()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.multigrid"><code class="docutils literal notranslate"><span class="pre">multigrid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.multigrid_fftdf"><code class="docutils literal notranslate"><span class="pre">multigrid_fftdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.nr_rks"><code class="docutils literal notranslate"><span class="pre">nr_rks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.nr_rks_fxc"><code class="docutils literal notranslate"><span class="pre">nr_rks_fxc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.nr_rks_fxc_st"><code class="docutils literal notranslate"><span class="pre">nr_rks_fxc_st()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.nr_uks"><code class="docutils literal notranslate"><span class="pre">nr_uks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid.nr_uks_fxc"><code class="docutils literal notranslate"><span class="pre">nr_uks_fxc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#module-pyscf.pbc.dft.multigrid.multigrid_pair">pyscf.pbc.dft.multigrid.multigrid_pair module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.GridLevel_Info"><code class="docutils literal notranslate"><span class="pre">GridLevel_Info</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.GridLevel_Info.cutoff"><code class="docutils literal notranslate"><span class="pre">GridLevel_Info.cutoff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.GridLevel_Info.mesh"><code class="docutils literal notranslate"><span class="pre">GridLevel_Info.mesh</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.GridLevel_Info.nlevels"><code class="docutils literal notranslate"><span class="pre">GridLevel_Info.nlevels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.GridLevel_Info.rel_cutoff"><code class="docutils literal notranslate"><span class="pre">GridLevel_Info.rel_cutoff</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.MultiGridFFTDF2"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.MultiGridFFTDF2.get_pp"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF2.get_pp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.MultiGridFFTDF2.get_veff_ip1"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF2.get_veff_ip1()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.MultiGridFFTDF2.ke_ratio"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF2.ke_ratio</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.MultiGridFFTDF2.ngrids"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF2.ngrids</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.MultiGridFFTDF2.rel_cutoff"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF2.rel_cutoff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.MultiGridFFTDF2.reset"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF2.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.MultiGridFFTDF2.vpploc_part1_nuc_grad"><code class="docutils literal notranslate"><span class="pre">MultiGridFFTDF2.vpploc_part1_nuc_grad()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.PGFPair"><code class="docutils literal notranslate"><span class="pre">PGFPair</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.PGFPair.iL"><code class="docutils literal notranslate"><span class="pre">PGFPair.iL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.PGFPair.ipgf"><code class="docutils literal notranslate"><span class="pre">PGFPair.ipgf</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.PGFPair.ish"><code class="docutils literal notranslate"><span class="pre">PGFPair.ish</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.PGFPair.jpgf"><code class="docutils literal notranslate"><span class="pre">PGFPair.jpgf</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.PGFPair.jsh"><code class="docutils literal notranslate"><span class="pre">PGFPair.jsh</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.PGFPair.radius"><code class="docutils literal notranslate"><span class="pre">PGFPair.radius</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.RS_Grid"><code class="docutils literal notranslate"><span class="pre">RS_Grid</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.RS_Grid.comp"><code class="docutils literal notranslate"><span class="pre">RS_Grid.comp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.RS_Grid.data"><code class="docutils literal notranslate"><span class="pre">RS_Grid.data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.RS_Grid.gridlevel_info"><code class="docutils literal notranslate"><span class="pre">RS_Grid.gridlevel_info</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.RS_Grid.nlevels"><code class="docutils literal notranslate"><span class="pre">RS_Grid.nlevels</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.Task"><code class="docutils literal notranslate"><span class="pre">Task</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.Task.buf_size"><code class="docutils literal notranslate"><span class="pre">Task.buf_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.Task.ntasks"><code class="docutils literal notranslate"><span class="pre">Task.ntasks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.Task.pgfpairs"><code class="docutils literal notranslate"><span class="pre">Task.pgfpairs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.Task.radius"><code class="docutils literal notranslate"><span class="pre">Task.radius</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.TaskList"><code class="docutils literal notranslate"><span class="pre">TaskList</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.TaskList.gridlevel_info"><code class="docutils literal notranslate"><span class="pre">TaskList.gridlevel_info</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.TaskList.hermi"><code class="docutils literal notranslate"><span class="pre">TaskList.hermi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.TaskList.nlevels"><code class="docutils literal notranslate"><span class="pre">TaskList.nlevels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.TaskList.tasks"><code class="docutils literal notranslate"><span class="pre">TaskList.tasks</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.build_task_list"><code class="docutils literal notranslate"><span class="pre">build_task_list()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.eval_mat"><code class="docutils literal notranslate"><span class="pre">eval_mat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.eval_rho"><code class="docutils literal notranslate"><span class="pre">eval_rho()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.free_gridlevel_info"><code class="docutils literal notranslate"><span class="pre">free_gridlevel_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.free_rs_grid"><code class="docutils literal notranslate"><span class="pre">free_rs_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.free_task_list"><code class="docutils literal notranslate"><span class="pre">free_task_list()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.get_veff_ip1"><code class="docutils literal notranslate"><span class="pre">get_veff_ip1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.gradient_gs"><code class="docutils literal notranslate"><span class="pre">gradient_gs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.init_gridlevel_info"><code class="docutils literal notranslate"><span class="pre">init_gridlevel_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.init_rs_grid"><code class="docutils literal notranslate"><span class="pre">init_rs_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.multi_grids_tasks"><code class="docutils literal notranslate"><span class="pre">multi_grids_tasks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.nr_rks"><code class="docutils literal notranslate"><span class="pre">nr_rks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.multigrid_pair.nr_uks"><code class="docutils literal notranslate"><span class="pre">nr_uks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#module-pyscf.pbc.dft.multigrid.pp">pyscf.pbc.dft.multigrid.pp module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.pp.fake_cell_vloc_part1"><code class="docutils literal notranslate"><span class="pre">fake_cell_vloc_part1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.pp.get_pp_loc_part1_gs"><code class="docutils literal notranslate"><span class="pre">get_pp_loc_part1_gs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.pp.get_vpploc_part1_ip1"><code class="docutils literal notranslate"><span class="pre">get_vpploc_part1_ip1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.pp.make_rho_core"><code class="docutils literal notranslate"><span class="pre">make_rho_core()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.pp.vpploc_part1_nuc_grad"><code class="docutils literal notranslate"><span class="pre">vpploc_part1_nuc_grad()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#module-pyscf.pbc.dft.multigrid.utils">pyscf.pbc.dft.multigrid.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#module-pyscf.pbc.dft.multigrid">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.nr_rks"><code class="docutils literal notranslate"><span class="pre">nr_rks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html#pyscf.pbc.dft.multigrid.nr_uks"><code class="docutils literal notranslate"><span class="pre">nr_uks()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-pyscf.pbc.dft.cdft">
<span id="pyscf-pbc-dft-cdft-module"></span><h2>pyscf.pbc.dft.cdft module<a class="headerlink" href="#module-pyscf.pbc.dft.cdft" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.cdft.cdft">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.cdft.</span></span><span class="sig-name descname"><span class="pre">cdft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/cdft.html#cdft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.cdft.cdft" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Input:</dt><dd><p>mf – a mean field object for DFT or (in principle) HF (doesn’t really matter)
shift – float – a semi aribitrary energy which displaces the selected orbitals by the diagonal
orbital – int – indicating which orbital are shifted in the selected basis
basis – 2D numpy array – the working basis in the basis of AOs from ‘cell’ (Defaults to AO basis)</p>
</dd>
<dt>Returns:</dt><dd><p>mf – converged mean field object (with AO basis)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.cdft.fast_iao_mullikan_pop">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.cdft.</span></span><span class="sig-name descname"><span class="pre">fast_iao_mullikan_pop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/cdft.html#fast_iao_mullikan_pop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.cdft.fast_iao_mullikan_pop" title="Link to this definition">#</a></dt>
<dd><p>Input: mf – a preconverged mean field object
Returns: mullikan population analysis in the basisIAO a</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.gen_grid">
<span id="pyscf-pbc-dft-gen-grid-module"></span><h2>pyscf.pbc.dft.gen_grid module<a class="headerlink" href="#module-pyscf.pbc.dft.gen_grid" title="Link to this heading">#</a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.AtomicGrids">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">AtomicGrids</span></span><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.AtomicGrids" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.pbc.dft.gen_grid.BeckeGrids" title="pyscf.pbc.dft.gen_grid.BeckeGrids"><code class="xref py py-class docutils literal notranslate"><span class="pre">BeckeGrids</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.BeckeGrids">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">BeckeGrids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#BeckeGrids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.BeckeGrids" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.dft.html#pyscf.dft.gen_grid.Grids" title="pyscf.dft.gen_grid.Grids"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></a></p>
<p>Atomic grids for all-electron calculation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.BeckeGrids.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#BeckeGrids.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.BeckeGrids.build" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.BeckeGrids.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#BeckeGrids.make_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.BeckeGrids.make_mask" title="Link to this definition">#</a></dt>
<dd><p>Mask to indicate whether a shell is zero on grid.
The resultant mask array is an extension to the mask array used in
molecular code (see also pyscf.dft.numint.make_mask function).
For given shell ID and block ID, the value of the extended mask array
means the number of images in Ls that does not vanish.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.BeckeGrids.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.BeckeGrids.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">UniformGrids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a></p>
<p>Uniform Grid class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.build" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.coords">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">coords</span></span><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.coords" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-15</span></em><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.cutoff" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.kernel" title="Link to this definition">#</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids.make_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.make_mask" title="Link to this definition">#</a></dt>
<dd><p>Mask to indicate whether a shell is zero on grid.
The resultant mask array is an extension to the mask array used in
molecular code (see also pyscf.dft.numint.make_mask function).
For given shell ID and block ID, the value of the extended mask array
means the number of images in Ls that does not vanish.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.reset" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.weights">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weights</span></span><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.weights" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.gen_becke_grids">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">gen_becke_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_grid={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radi_method=&lt;function</span> <span class="pre">gauss_chebyshev&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune=&lt;function</span> <span class="pre">nwchem_prune&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.gen_becke_grids" title="Link to this definition">#</a></dt>
<dd><p>real-space grids using Becke scheme</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>coords<span class="classifier">(N, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
<p>weights : (N) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.get_becke_grids">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">get_becke_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_grid={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radi_method=&lt;function</span> <span class="pre">gauss_chebyshev&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune=&lt;function</span> <span class="pre">nwchem_prune&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#get_becke_grids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.get_becke_grids" title="Link to this definition">#</a></dt>
<dd><p>real-space grids using Becke scheme</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>coords<span class="classifier">(N, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
<p>weights : (N) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.make_mask">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#make_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.make_mask" title="Link to this definition">#</a></dt>
<dd><p>Mask to indicate whether a shell is zero on grid.
The resultant mask array is an extension to the mask array used in
molecular code (see also pyscf.dft.numint.make_mask function).
For given shell ID and block ID, the value of the extended mask array
means the number of images in Ls that does not vanish.</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.gks">
<span id="pyscf-pbc-dft-gks-module"></span><h2>pyscf.pbc.dft.gks module<a class="headerlink" href="#module-pyscf.pbc.dft.gks" title="Link to this heading">#</a></h2>
<p>Generalized collinear Kohn-Sham in the spin-orbital basis for periodic systems at a single k-point</p>
<dl class="simple">
<dt>See Also:</dt><dd><dl class="simple">
<dt>pyscf.pbc.dft.kgks.py<span class="classifier">General spin-orbital Kohn-Sham for periodic</span></dt><dd><p>systems with k-point sampling</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gks.</span></span><span class="sig-name descname"><span class="pre">GKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gks.html#GKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.ghf.GHF" title="pyscf.pbc.scf.ghf.GHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">GHF</span></code></a></p>
<p>GKS class adapted for PBCs at a single k-point.</p>
<p>This is a literal duplication of the molecular GKS class with some <cite>mol</cite>
variables replaced by <cite>cell</cite>.</p>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS.collinear">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collinear</span></span><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS.collinear" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gks.html#GKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of RKS energy.</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl>
<dt>Args:</dt><dd><p>ks : an instance of DFT class</p>
<dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>RKS electronic energy and the 2-electron contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for GKS.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gks.html#GKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS.spin_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spin_samples</span></span><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS.spin_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS.stability">
<span class="sig-name descname"><span class="pre">stability</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gks.html#GKS.stability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS.stability" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gks.html#GKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to GHF object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS.x2c">
<span class="sig-name descname"><span class="pre">x2c</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS.x2c" title="Link to this definition">#</a></dt>
<dd><p>Adds spin-orbit coupling effects to H0 through the x2c1e approximation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.GKS.x2c1e">
<span class="sig-name descname"><span class="pre">x2c1e</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gks.html#GKS.x2c1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gks.GKS.x2c1e" title="Link to this definition">#</a></dt>
<dd><p>Adds spin-orbit coupling effects to H0 through the x2c1e approximation</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for GKS.</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.kgks">
<span id="pyscf-pbc-dft-kgks-module"></span><h2>pyscf.pbc.dft.kgks module<a class="headerlink" href="#module-pyscf.pbc.dft.kgks" title="Link to this heading">#</a></h2>
<p>Generalized collinear Kohn-Sham in the spin-orbital basis for periodic systems with k-point sampling</p>
<dl class="simple">
<dt>See Also:</dt><dd><dl class="simple">
<dt>pyscf.pbc.dft.rks.py<span class="classifier">General spin-orbital Kohn-Sham for periodic</span></dt><dd><p>systems at a single k-point</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kgks.</span></span><span class="sig-name descname"><span class="pre">KGKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kgks.html#KGKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.kghf.KGHF" title="pyscf.pbc.scf.kghf.KGHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">KGHF</span></code></a></p>
<p>GKS class adapted for PBCs with k-point sampling.</p>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.collinear">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collinear</span></span><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.collinear" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kgks.html#KGKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Following pyscf.scf.hf.energy_elec()</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for KGKS</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">GKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, 2*nao, 2*nao) or (<a href="#id1"><span class="problematic" id="id2">*</span></a>, nkpts, 2*nao, 2*nao) ndarray
Veff = J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kgks.html#KGKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.spin_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spin_samples</span></span><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.spin_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.stability">
<span class="sig-name descname"><span class="pre">stability</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kgks.html#KGKS.stability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.stability" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kgks.html#KGKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to KGHF object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.x2c">
<span class="sig-name descname"><span class="pre">x2c</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.x2c" title="Link to this definition">#</a></dt>
<dd><p>Adds spin-orbit coupling effects to H0 through the x2c1e approximation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.KGKS.x2c1e">
<span class="sig-name descname"><span class="pre">x2c1e</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kgks.html#KGKS.x2c1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kgks.KGKS.x2c1e" title="Link to this definition">#</a></dt>
<dd><p>Adds spin-orbit coupling effects to H0 through the x2c1e approximation</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kgks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kgks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kgks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kgks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for KGKS</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">GKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, 2*nao, 2*nao) or (<a href="#id3"><span class="problematic" id="id4">*</span></a>, nkpts, 2*nao, 2*nao) ndarray
Veff = J + Vxc.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.krks">
<span id="pyscf-pbc-dft-krks-module"></span><h2>pyscf.pbc.dft.krks module<a class="headerlink" href="#module-pyscf.pbc.dft.krks" title="Link to this heading">#</a></h2>
<p>Non-relativistic Restricted Kohn-Sham for periodic systems with k-point sampling</p>
<dl class="simple">
<dt>See Also:</dt><dd><dl class="simple">
<dt>pyscf.pbc.dft.rks.py<span class="classifier">Non-relativistic Restricted Kohn-Sham for periodic</span></dt><dd><p>systems at a single k-point</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krks.</span></span><span class="sig-name descname"><span class="pre">KRKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#KRKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.khf.KRHF" title="pyscf.pbc.scf.khf.KRHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">KRHF</span></code></a></p>
<p>RKS class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#KRKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Following pyscf.scf.hf.energy_elec()</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a replica of pyscf.dft.rks.get_veff with kpts added.
This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, nao, nao) or (<a href="#id5"><span class="problematic" id="id6">*</span></a>, nkpts, nao, nao) ndarray
Veff = J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#KRKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#KRKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to KRHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.energy_elec">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krks.</span></span><span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.energy_elec" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krks.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a replica of pyscf.dft.rks.get_veff with kpts added.
This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, nao, nao) or (<a href="#id7"><span class="problematic" id="id8">*</span></a>, nkpts, nao, nao) ndarray
Veff = J + Vxc.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.krks_ksymm">
<span id="pyscf-pbc-dft-krks-ksymm-module"></span><h2>pyscf.pbc.dft.krks_ksymm module<a class="headerlink" href="#module-pyscf.pbc.dft.krks_ksymm" title="Link to this heading">#</a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KRKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krks_ksymm.</span></span><span class="sig-name descname"><span class="pre">KRKS</span></span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KRKS" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS" title="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">KsymAdaptedKRKS</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krks_ksymm.</span></span><span class="sig-name descname"><span class="pre">KsymAdaptedKRKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts=&lt;pyscf.pbc.lib.kpts.KPoints</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc='LDA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv='ewald'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks_ksymm.html#KsymAdaptedKRKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.krks.KRKS" title="pyscf.pbc.dft.krks.KRKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">KRKS</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.khf_ksymm.KsymAdaptedKRHF" title="pyscf.pbc.scf.khf_ksymm.KsymAdaptedKRHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">KsymAdaptedKRHF</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.dump_chk">
<span class="sig-name descname"><span class="pre">dump_chk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.dump_chk" title="Link to this definition">#</a></dt>
<dd><p>Serialize the SCF object and save it to the specified chkfile.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>envs_or_file:</dt><dd><p>If this argument is a file path, the serialized SCF object is
saved to the file specified by this argument.
If this attribute is a dict (created by locals()), the necessary
variables are saved to the file specified by the attribute mf.chkfile.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks_ksymm.html#KsymAdaptedKRKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.eig">
<span class="sig-name descname"><span class="pre">eig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_kpts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.eig" title="Link to this definition">#</a></dt>
<dd><p>Solver for generalized eigenvalue problem</p>
<div class="math notranslate nohighlight">
\[HC = SCE\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks_ksymm.html#KsymAdaptedKRKS.energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Following pyscf.scf.hf.energy_elec()</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_hcore">
<span class="sig-name descname"><span class="pre">get_hcore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_hcore" title="Link to this definition">#</a></dt>
<dd><p>Get the core Hamiltonian AO matrices at sampled k-points.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>kpts : (nkpts, 3) ndarray</p>
</dd>
<dt>Returns:</dt><dd><p>hcore : (nkpts, nao, nao) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_init_guess">
<span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_init_guess" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_jk">
<span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_jk" title="Link to this definition">#</a></dt>
<dd><p>Get the Coulomb (J) and exchange (K) AO matrices at sampled k-points.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dm_kpts<span class="classifier">(nkpts, nao, nao) ndarray</span></dt><dd><p>Density matrix at each k-point. It needs to be Hermitian.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>kpts_band<span class="classifier">(3,) ndarray</span></dt><dd><p>A list of arbitrary “band” k-point at which to evalute the matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>vj : (nkpts, nao, nao) ndarray
vk : (nkpts, nao, nao) ndarray
or list of vj and vk if the input dm_kpts is a list of DMs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_occ">
<span class="sig-name descname"><span class="pre">get_occ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_occ" title="Link to this definition">#</a></dt>
<dd><p>Label the occupancies for each orbital for sampled k-points.</p>
<p>This is a k-point version of scf.hf.SCF.get_occ</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_orbsym">
<span class="sig-name descname"><span class="pre">get_orbsym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_orbsym" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_ovlp">
<span class="sig-name descname"><span class="pre">get_ovlp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_ovlp" title="Link to this definition">#</a></dt>
<dd><p>Get the overlap AO matrices at sampled k-points.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>kpts : (nkpts, 3) ndarray</p>
</dd>
<dt>Returns:</dt><dd><p>ovlp_kpts : (nkpts, nao, nao) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a replica of pyscf.dft.rks.get_veff with kpts added.
This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, nao, nao) or (<a href="#id9"><span class="problematic" id="id10">*</span></a>, nkpts, nao, nao) ndarray
Veff = J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.init_guess_by_chkfile">
<span class="sig-name descname"><span class="pre">init_guess_by_chkfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.init_guess_by_chkfile" title="Link to this definition">#</a></dt>
<dd><p>Read the HF results from checkpoint file, then project it to the
basis defined by <code class="docutils literal notranslate"><span class="pre">mol</span></code></p>
<dl>
<dt>Kwargs:</dt><dd><dl>
<dt>project<span class="classifier">None or bool</span></dt><dd><p>Whether to project chkfile’s orbitals to the new basis.  Note when
the geometry of the chkfile and the given molecule are very
different, this projection can produce very poor initial guess.
In PES scanning, it is recommended to switch off project.</p>
<p>If project is set to None, the projection is only applied when the
basis sets of the chkfile’s molecule are different to the basis
sets of the given molecule (regardless whether the geometry of
the two molecules are different).  Note the basis sets are
considered to be different if the two molecules are derived from
the same molecule with different ordering of atoms.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Density matrix, 2D ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.kpts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kpts</span></span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.kpts" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.orbsym">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orbsym</span></span><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.orbsym" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks_ksymm.html#KsymAdaptedKRKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to KRHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krks_ksymm.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks_ksymm.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.get_rho" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks_ksymm.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krks_ksymm.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks_ksymm.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks_ksymm.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a replica of pyscf.dft.rks.get_veff with kpts added.
This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, nao, nao) or (<a href="#id11"><span class="problematic" id="id12">*</span></a>, nkpts, nao, nao) ndarray
Veff = J + Vxc.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.krkspu">
<span id="pyscf-pbc-dft-krkspu-module"></span><h2>pyscf.pbc.dft.krkspu module<a class="headerlink" href="#module-pyscf.pbc.dft.krkspu" title="Link to this heading">#</a></h2>
<p>Restricted DFT+U with kpoint sampling.
Based on KRHF routine.</p>
<p>Refs: PRB, 1998, 57, 1505.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.KRKSpU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">KRKSpU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_ao_lo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MINAO'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#KRKSpU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.KRKSpU" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.krks.KRKS" title="pyscf.pbc.dft.krks.KRKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">KRKS</span></code></a></p>
<p>RKSpU class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.KRKSpU.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krkspu.KRKSpU.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic energy for KRKSpU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.KRKSpU.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krkspu.KRKSpU.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional + Hubbard U terms.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a replica of pyscf.dft.rks.get_veff with kpts added.
This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, nao, nao) or (<a href="#id13"><span class="problematic" id="id14">*</span></a>, nkpts, nao, nao) ndarray
Veff = J + Vxc + V_U.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.KRKSpU.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#KRKSpU.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.KRKSpU.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.KRKSpU.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krkspu.KRKSpU.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to KRHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.energy_elec">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic energy for KRKSpU.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.format_idx">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">format_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#format_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.format_idx" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional + Hubbard U terms.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a replica of pyscf.dft.rks.get_veff with kpts added.
This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, nao, nao) or (<a href="#id15"><span class="problematic" id="id16">*</span></a>, nkpts, nao, nao) ndarray
Veff = J + Vxc + V_U.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.make_minao_lo">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">make_minao_lo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao_ref</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#make_minao_lo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.make_minao_lo" title="Link to this definition">#</a></dt>
<dd><p>Construct minao local orbitals.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.mdot">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">mdot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#mdot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.mdot" title="Link to this definition">#</a></dt>
<dd><p>Compute the dot product of a list of arrays in a single function call.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.proj_ref_ao">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">proj_ref_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#proj_ref_ao"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.proj_ref_ao" title="Link to this definition">#</a></dt>
<dd><p>Get a set of reference AO spanned by the calculation basis.
Not orthogonalized.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>return_labels: if True, return the labels as well.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.set_U">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">set_U</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#set_U"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.set_U" title="Link to this definition">#</a></dt>
<dd><p>Regularize the U_idx and U_val to each atom,
and set ks.U_idx, ks.U_val, ks.U_lab.</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.krkspu_ksymm">
<span id="pyscf-pbc-dft-krkspu-ksymm-module"></span><h2>pyscf.pbc.dft.krkspu_ksymm module<a class="headerlink" href="#module-pyscf.pbc.dft.krkspu_ksymm" title="Link to this heading">#</a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu_ksymm.KRKSpU">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu_ksymm.</span></span><span class="sig-name descname"><span class="pre">KRKSpU</span></span><a class="headerlink" href="#pyscf.pbc.dft.krkspu_ksymm.KRKSpU" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU" title="pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU"><code class="xref py py-class docutils literal notranslate"><span class="pre">KsymAdaptedKRKSpU</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu_ksymm.</span></span><span class="sig-name descname"><span class="pre">KsymAdaptedKRKSpU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts=&lt;pyscf.pbc.lib.kpts.KPoints</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc='LDA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv='ewald'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_idx=[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_val=[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_ao_lo='minao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao_ref='MINAO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu_ksymm.html#KsymAdaptedKRKSpU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS" title="pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">KsymAdaptedKRKS</span></code></a></p>
<p>RKSpU class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic energy for KRKSpU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional + Hubbard U terms.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a replica of pyscf.dft.rks.get_veff with kpts added.
This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, nao, nao) or (<a href="#id17"><span class="problematic" id="id18">*</span></a>, nkpts, nao, nao) ndarray
Veff = J + Vxc + V_U.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to KRHF object.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.kroks">
<span id="pyscf-pbc-dft-kroks-module"></span><h2>pyscf.pbc.dft.kroks module<a class="headerlink" href="#module-pyscf.pbc.dft.kroks" title="Link to this heading">#</a></h2>
<p>Restricted open-shell Kohn-Sham for periodic systems with k-point sampling</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kroks.</span></span><span class="sig-name descname"><span class="pre">KROKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kroks.html#KROKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.krohf.KROHF" title="pyscf.pbc.scf.krohf.KROHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">KROHF</span></code></a></p>
<p>RKS class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kroks.html#KROKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Following pyscf.scf.hf.energy_elec()</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.kroks.get_veff" title="pyscf.pbc.dft.kroks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kroks.html#KROKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to KROHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kroks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kroks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kroks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.kroks.get_veff" title="pyscf.pbc.dft.kroks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.kuks">
<span id="pyscf-pbc-dft-kuks-module"></span><h2>pyscf.pbc.dft.kuks module<a class="headerlink" href="#module-pyscf.pbc.dft.kuks" title="Link to this heading">#</a></h2>
<p>Non-relativistic Restricted Kohn-Sham for periodic systems with k-point sampling</p>
<dl class="simple">
<dt>See Also:</dt><dd><dl class="simple">
<dt>pyscf.pbc.dft.rks.py<span class="classifier">Non-relativistic Restricted Kohn-Sham for periodic</span></dt><dd><p>systems at a single k-point</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kuks.</span></span><span class="sig-name descname"><span class="pre">KUKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#KUKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.kuhf.KUHF" title="pyscf.pbc.scf.kuhf.KUHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">KUHF</span></code></a></p>
<p>UKS class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#KUKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Following pyscf.scf.hf.energy_elec()</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.kuks.get_veff" title="pyscf.pbc.dft.kuks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#KUKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#KUKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to KUHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.energy_elec">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kuks.</span></span><span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.energy_elec" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kuks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.kuks.get_veff" title="pyscf.pbc.dft.kuks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.kuks_ksymm">
<span id="pyscf-pbc-dft-kuks-ksymm-module"></span><h2>pyscf.pbc.dft.kuks_ksymm module<a class="headerlink" href="#module-pyscf.pbc.dft.kuks_ksymm" title="Link to this heading">#</a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KUKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kuks_ksymm.</span></span><span class="sig-name descname"><span class="pre">KUKS</span></span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KUKS" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS" title="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">KsymAdaptedKUKS</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kuks_ksymm.</span></span><span class="sig-name descname"><span class="pre">KsymAdaptedKUKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts=&lt;pyscf.pbc.lib.kpts.KPoints</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc='LDA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv='ewald'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks_ksymm.html#KsymAdaptedKUKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.kuks.KUKS" title="pyscf.pbc.dft.kuks.KUKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">KUKS</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.kuhf_ksymm.KsymAdaptedKUHF" title="pyscf.pbc.scf.kuhf_ksymm.KsymAdaptedKUHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">KsymAdaptedKUHF</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.dump_chk">
<span class="sig-name descname"><span class="pre">dump_chk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.dump_chk" title="Link to this definition">#</a></dt>
<dd><p>Serialize the SCF object and save it to the specified chkfile.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>envs_or_file:</dt><dd><p>If this argument is a file path, the serialized SCF object is
saved to the file specified by this argument.
If this attribute is a dict (created by locals()), the necessary
variables are saved to the file specified by the attribute mf.chkfile.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks_ksymm.html#KsymAdaptedKUKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.eig">
<span class="sig-name descname"><span class="pre">eig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_kpts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.eig" title="Link to this definition">#</a></dt>
<dd><p>Solver for generalized eigenvalue problem</p>
<div class="math notranslate nohighlight">
\[HC = SCE\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks_ksymm.html#KsymAdaptedKUKS.energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Following pyscf.scf.hf.energy_elec()</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_hcore">
<span class="sig-name descname"><span class="pre">get_hcore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_hcore" title="Link to this definition">#</a></dt>
<dd><p>Get the core Hamiltonian AO matrices at sampled k-points.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>kpts : (nkpts, 3) ndarray</p>
</dd>
<dt>Returns:</dt><dd><p>hcore : (nkpts, nao, nao) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_init_guess">
<span class="sig-name descname"><span class="pre">get_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_init_guess" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_jk">
<span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_jk" title="Link to this definition">#</a></dt>
<dd><p>Get the Coulomb (J) and exchange (K) AO matrices at sampled k-points.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dm_kpts<span class="classifier">(nkpts, nao, nao) ndarray</span></dt><dd><p>Density matrix at each k-point. It needs to be Hermitian.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>kpts_band<span class="classifier">(3,) ndarray</span></dt><dd><p>A list of arbitrary “band” k-point at which to evalute the matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>vj : (nkpts, nao, nao) ndarray
vk : (nkpts, nao, nao) ndarray
or list of vj and vk if the input dm_kpts is a list of DMs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_occ">
<span class="sig-name descname"><span class="pre">get_occ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_occ" title="Link to this definition">#</a></dt>
<dd><p>Label the occupancies for each orbital for sampled k-points.</p>
<p>This is a k-point version of scf.hf.SCF.get_occ</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_orbsym">
<span class="sig-name descname"><span class="pre">get_orbsym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_orbsym" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_ovlp">
<span class="sig-name descname"><span class="pre">get_ovlp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_ovlp" title="Link to this definition">#</a></dt>
<dd><p>Get the overlap AO matrices at sampled k-points.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>kpts : (nkpts, 3) ndarray</p>
</dd>
<dt>Returns:</dt><dd><p>ovlp_kpts : (nkpts, nao, nao) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.kuks_ksymm.get_veff" title="pyscf.pbc.dft.kuks_ksymm.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.init_guess_by_chkfile">
<span class="sig-name descname"><span class="pre">init_guess_by_chkfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.init_guess_by_chkfile" title="Link to this definition">#</a></dt>
<dd><p>Read the HF results from checkpoint file, then project it to the
basis defined by <code class="docutils literal notranslate"><span class="pre">mol</span></code></p>
<dl>
<dt>Kwargs:</dt><dd><dl>
<dt>project<span class="classifier">None or bool</span></dt><dd><p>Whether to project chkfile’s orbitals to the new basis.  Note when
the geometry of the chkfile and the given molecule are very
different, this projection can produce very poor initial guess.
In PES scanning, it is recommended to switch off project.</p>
<p>If project is set to None, the projection is only applied when the
basis sets of the chkfile’s molecule are different to the basis
sets of the given molecule (regardless whether the geometry of
the two molecules are different).  Note the basis sets are
considered to be different if the two molecules are derived from
the same molecule with different ordering of atoms.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Density matrix, 2D ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.kpts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kpts</span></span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.kpts" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.nelec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nelec</span></span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.nelec" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.orbsym">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orbsym</span></span><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.orbsym" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks_ksymm.html#KsymAdaptedKUKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to KRHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kuks_ksymm.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks_ksymm.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.get_rho" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks_ksymm.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kuks_ksymm.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks_ksymm.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks_ksymm.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.kuks_ksymm.get_veff" title="pyscf.pbc.dft.kuks_ksymm.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.kukspu">
<span id="pyscf-pbc-dft-kukspu-module"></span><h2>pyscf.pbc.dft.kukspu module<a class="headerlink" href="#module-pyscf.pbc.dft.kukspu" title="Link to this heading">#</a></h2>
<p>Unrestricted DFT+U with kpoint sampling.
Based on KUHF routine.</p>
<p>Refs: PRB, 1998, 57, 1505.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.KUKSpU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kukspu.</span></span><span class="sig-name descname"><span class="pre">KUKSpU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_ao_lo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MINAO'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kukspu.html#KUKSpU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kukspu.KUKSpU" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.kuks.KUKS" title="pyscf.pbc.dft.kuks.KUKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">KUKS</span></code></a></p>
<p>UKSpU class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.KUKSpU.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kukspu.KUKSpU.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic energy for KUKSpU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.KUKSpU.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kukspu.KUKSpU.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional + (Hubbard - double counting) for KUKSpU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.KUKSpU.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kukspu.html#KUKSpU.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kukspu.KUKSpU.nuc_grad_method" title="Link to this definition">#</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.KUKSpU.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kukspu.KUKSpU.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to KUHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.energy_elec">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kukspu.</span></span><span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kukspu.html#energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kukspu.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic energy for KUKSpU.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kukspu.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kukspu.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kukspu.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional + (Hubbard - double counting) for KUKSpU.</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.kukspu_ksymm">
<span id="pyscf-pbc-dft-kukspu-ksymm-module"></span><h2>pyscf.pbc.dft.kukspu_ksymm module<a class="headerlink" href="#module-pyscf.pbc.dft.kukspu_ksymm" title="Link to this heading">#</a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu_ksymm.KUKSpU">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kukspu_ksymm.</span></span><span class="sig-name descname"><span class="pre">KUKSpU</span></span><a class="headerlink" href="#pyscf.pbc.dft.kukspu_ksymm.KUKSpU" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU" title="pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU"><code class="xref py py-class docutils literal notranslate"><span class="pre">KsymAdaptedKUKSpU</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kukspu_ksymm.</span></span><span class="sig-name descname"><span class="pre">KsymAdaptedKUKSpU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts=&lt;pyscf.pbc.lib.kpts.KPoints</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc='LDA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv='ewald'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_idx=[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_val=[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_ao_lo='minao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao_ref='MINAO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kukspu_ksymm.html#KsymAdaptedKUKSpU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS" title="pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">KsymAdaptedKUKS</span></code></a></p>
<p>UKSpU class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic energy for KUKSpU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional + (Hubbard - double counting) for KUKSpU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to KRHF object.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.numint">
<span id="pyscf-pbc-dft-numint-module"></span><h2>pyscf.pbc.dft.numint module<a class="headerlink" href="#module-pyscf.pbc.dft.numint" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">KNumInt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a>, <a class="reference internal" href="pyscf.dft.html#pyscf.dft.numint.LibXCMixin" title="pyscf.dft.numint.LibXCMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LibXCMixin</span></code></a></p>
<p>Generalization of pyscf’s NumInt class for k-point sampling and
periodic images.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.block_loop">
<span class="sig-name descname"><span class="pre">block_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.block_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.block_loop" title="Link to this definition">#</a></dt>
<dd><p>Define this macro to loop over grids by blocks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.cache_xc_kernel">
<span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.cache_xc_kernel" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.cache_xc_kernel1">
<span class="sig-name descname"><span class="pre">cache_xc_kernel1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.cache_xc_kernel1" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.eval_ao">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.eval_ao" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>ao_kpts: (nkpts, [comp], ngrids, nao) ndarray</dt><dd><p>AO values at each k-point</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.eval_rho">
<span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.eval_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.eval_rho" title="Link to this definition">#</a></dt>
<dd><p>Collocate the density (opt. gradients) on the real-space grid.</p>
<dl>
<dt>Args:</dt><dd><p>cell : Mole or Cell object
ao_kpts : (nkpts, ngrids, nao) ndarray</p>
<blockquote>
<div><p>AO values at each k-point</p>
</div></blockquote>
<dl class="simple">
<dt>dm_kpts: (nkpts, nao, nao) ndarray</dt><dd><p>Density matrix at each k-point</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>rhoR : (ngrids,) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.eval_rho1">
<span class="sig-name descname"><span class="pre">eval_rho1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.eval_rho1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.eval_rho1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.eval_rho2">
<span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.eval_rho2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.eval_rho2" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.get_vxc">
<span class="sig-name descname"><span class="pre">get_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.get_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_rks" title="pyscf.pbc.dft.numint.nr_rks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code></a> and <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_uks" title="pyscf.pbc.dft.numint.nr_uks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code></a> for more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.make_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.make_mask" title="Link to this definition">#</a></dt>
<dd><p>Mask to indicate whether a shell is zero on grid.
The resultant mask array is an extension to the mask array used in
molecular code (see also pyscf.dft.numint.make_mask function).
For given shell ID and block ID, the value of the extended mask array
means the number of images in Ls that does not vanish.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.nr_rks">
<span class="sig-name descname"><span class="pre">nr_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.nr_rks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.nr_rks" title="Link to this definition">#</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.</p>
</dd>
<dt>kpts_band<span class="classifier">(3,) ndarray or (<a href="#id19"><span class="problematic" id="id20">*</span></a>,3) ndarray</span></dt><dd><p>A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.nr_rks_fxc">
<span class="sig-name descname"><span class="pre">nr_rks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.nr_rks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.nr_rks_fxc_st">
<span class="sig-name descname"><span class="pre">nr_rks_fxc_st</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.nr_rks_fxc_st" title="Link to this definition">#</a></dt>
<dd><p>Associated to singlet or triplet Hessian
Note the difference to nr_rks_fxc, dms_alpha is the response density
matrices of alpha spin, alpha+/-beta DM is applied due to singlet/triplet
coupling</p>
<p>Ref. CPL, 256, 454</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.nr_uks">
<span class="sig-name descname"><span class="pre">nr_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.nr_uks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.nr_uks" title="Link to this definition">#</a></dt>
<dd><p>Calculate UKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms :</dt><dd><p>Density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.
kpts_band : (3,) ndarray or (<a href="#id21"><span class="problematic" id="id22">*</span></a>,3) ndarray
A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.nr_uks_fxc">
<span class="sig-name descname"><span class="pre">nr_uks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.nr_uks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract UKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.nr_vxc">
<span class="sig-name descname"><span class="pre">nr_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.nr_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.nr_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_rks" title="pyscf.pbc.dft.numint.nr_rks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code></a> and <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_uks" title="pyscf.pbc.dft.numint.nr_uks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code></a> for more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">NumInt</span></span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a>, <a class="reference internal" href="pyscf.dft.html#pyscf.dft.numint.LibXCMixin" title="pyscf.dft.numint.LibXCMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LibXCMixin</span></code></a></p>
<p>Generalization of pyscf’s NumInt class for a single k-point shift and
periodic images.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.block_loop">
<span class="sig-name descname"><span class="pre">block_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.block_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.block_loop" title="Link to this definition">#</a></dt>
<dd><p>Define this macro to loop over grids by blocks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.cache_xc_kernel">
<span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.cache_xc_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.cache_xc_kernel" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.cache_xc_kernel1">
<span class="sig-name descname"><span class="pre">cache_xc_kernel1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.cache_xc_kernel1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.cache_xc_kernel1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-13</span></em><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.cutoff" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.eval_ao">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.eval_ao" title="Link to this definition">#</a></dt>
<dd><p>Collocate AO crystal orbitals (opt. gradients) on the real-space grid.</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">(nx*ny*nz, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>kpt<span class="classifier">(3,) ndarray</span></dt><dd><p>The k-point corresponding to the crystal AO.</p>
</dd>
<dt>deriv<span class="classifier">int</span></dt><dd><p>AO derivative order.  It affects the shape of the return array.
If deriv=0, the returned AO values are stored in a (N,nao) array.
Otherwise the AO values are stored in an array of shape (M,N,nao).
Here N is the number of grids, nao is the number of AO functions,
M is the size associated to the derivative deriv.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>aoR<span class="classifier">([4,] nx*ny*nz, nao=cell.nao_nr()) ndarray</span></dt><dd><p>The value of the AO crystal orbitals on the real-space grid by default.
If deriv=1, also contains the value of the orbitals gradient in the
x, y, and z directions.  It can be either complex or float array,
depending on the kpt argument.  If kpt is not given (gamma point),
aoR is a float array.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.dft.numint.eval_ao</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.eval_rho">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.eval_rho" title="Link to this definition">#</a></dt>
<dd><p>Collocate the density (opt. gradients) on the real-space grid.</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">([4,] nx*ny*nz, nao=cell.nao_nr()) ndarray</span></dt><dd><p>The value of the AO crystal orbitals on the real-space grid by default.
If xctype=’GGA’, also contains the value of the gradient in the x, y,
and z directions.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>rho<span class="classifier">([4,] nx*ny*nz) ndarray</span></dt><dd><p>The value of the density on the real-space grid. If xctype=’GGA’,
also contains the value of the gradient in the x, y, and z
directions.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.dft.numint.eval_rho</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.eval_rho1">
<span class="sig-name descname"><span class="pre">eval_rho1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.eval_rho1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.eval_rho1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.eval_rho2">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.eval_rho2" title="Link to this definition">#</a></dt>
<dd><p>Refer to <cite>pyscf.dft.numint.eval_rho2</cite> for full documentation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.get_fxc">
<span class="sig-name descname"><span class="pre">get_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.get_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.get_vxc">
<span class="sig-name descname"><span class="pre">get_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.get_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_rks" title="pyscf.pbc.dft.numint.nr_rks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code></a> and <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_uks" title="pyscf.pbc.dft.numint.nr_uks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code></a> for more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.make_mask">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.make_mask" title="Link to this definition">#</a></dt>
<dd><p>Mask to indicate whether a shell is zero on grid.
The resultant mask array is an extension to the mask array used in
molecular code (see also pyscf.dft.numint.make_mask function).
For given shell ID and block ID, the value of the extended mask array
means the number of images in Ls that does not vanish.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_fxc">
<span class="sig-name descname"><span class="pre">nr_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.nr_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_nlc_vxc">
<span class="sig-name descname"><span class="pre">nr_nlc_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_nlc_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate NLC functional and potential matrix on given grids</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>cell : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_rks">
<span class="sig-name descname"><span class="pre">nr_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.nr_rks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_rks" title="Link to this definition">#</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.</p>
</dd>
<dt>kpts_band<span class="classifier">(3,) ndarray or (<a href="#id23"><span class="problematic" id="id24">*</span></a>,3) ndarray</span></dt><dd><p>A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_rks_fxc">
<span class="sig-name descname"><span class="pre">nr_rks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_rks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_rks_fxc_st">
<span class="sig-name descname"><span class="pre">nr_rks_fxc_st</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_rks_fxc_st" title="Link to this definition">#</a></dt>
<dd><p>Associated to singlet or triplet Hessian
Note the difference to nr_rks_fxc, dms_alpha is the response density
matrices of alpha spin, alpha+/-beta DM is applied due to singlet/triplet
coupling</p>
<p>Ref. CPL, 256, 454</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_uks">
<span class="sig-name descname"><span class="pre">nr_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.nr_uks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_uks" title="Link to this definition">#</a></dt>
<dd><p>Calculate UKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms :</dt><dd><p>Density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.
kpts_band : (3,) ndarray or (<a href="#id25"><span class="problematic" id="id26">*</span></a>,3) ndarray
A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_uks_fxc">
<span class="sig-name descname"><span class="pre">nr_uks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_uks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract UKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_vxc">
<span class="sig-name descname"><span class="pre">nr_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.nr_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_rks" title="pyscf.pbc.dft.numint.nr_rks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code></a> and <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_uks" title="pyscf.pbc.dft.numint.nr_uks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code></a> for more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.cache_xc_kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#cache_xc_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.cache_xc_kernel" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.cache_xc_kernel1">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">cache_xc_kernel1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#cache_xc_kernel1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.cache_xc_kernel1" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.eval_ao">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#eval_ao"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.eval_ao" title="Link to this definition">#</a></dt>
<dd><p>Collocate AO crystal orbitals (opt. gradients) on the real-space grid.</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">(nx*ny*nz, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>kpt<span class="classifier">(3,) ndarray</span></dt><dd><p>The k-point corresponding to the crystal AO.</p>
</dd>
<dt>deriv<span class="classifier">int</span></dt><dd><p>AO derivative order.  It affects the shape of the return array.
If deriv=0, the returned AO values are stored in a (N,nao) array.
Otherwise the AO values are stored in an array of shape (M,N,nao).
Here N is the number of grids, nao is the number of AO functions,
M is the size associated to the derivative deriv.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>aoR<span class="classifier">([4,] nx*ny*nz, nao=cell.nao_nr()) ndarray</span></dt><dd><p>The value of the AO crystal orbitals on the real-space grid by default.
If deriv=1, also contains the value of the orbitals gradient in the
x, y, and z directions.  It can be either complex or float array,
depending on the kpt argument.  If kpt is not given (gamma point),
aoR is a float array.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.dft.numint.eval_ao</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.eval_ao_kpts">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_ao_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#eval_ao_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.eval_ao_kpts" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>ao_kpts: (nkpts, [comp], ngrids, nao) ndarray</dt><dd><p>AO values at each k-point</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.eval_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#eval_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.eval_rho" title="Link to this definition">#</a></dt>
<dd><p>Collocate the density (opt. gradients) on the real-space grid.</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">([4,] nx*ny*nz, nao=cell.nao_nr()) ndarray</span></dt><dd><p>The value of the AO crystal orbitals on the real-space grid by default.
If xctype=’GGA’, also contains the value of the gradient in the x, y,
and z directions.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>rho<span class="classifier">([4,] nx*ny*nz) ndarray</span></dt><dd><p>The value of the density on the real-space grid. If xctype=’GGA’,
also contains the value of the gradient in the x, y, and z
directions.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.dft.numint.eval_rho</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.eval_rho2">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#eval_rho2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.eval_rho2" title="Link to this definition">#</a></dt>
<dd><p>Refer to <cite>pyscf.dft.numint.eval_rho2</cite> for full documentation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Density in real space</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_nlc_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_nlc_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#nr_nlc_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_nlc_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate NLC functional and potential matrix on given grids</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a></p>
<p>cell : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not. It also indicates whether
the potential matrices in return are symmetric or not.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_rks">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#nr_rks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_rks" title="Link to this definition">#</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.</p>
</dd>
<dt>kpts_band<span class="classifier">(3,) ndarray or (<a href="#id27"><span class="problematic" id="id28">*</span></a>,3) ndarray</span></dt><dd><p>A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_rks_fxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#nr_rks_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_rks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_rks_fxc_st">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks_fxc_st</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#nr_rks_fxc_st"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_rks_fxc_st" title="Link to this definition">#</a></dt>
<dd><p>Associated to singlet or triplet Hessian
Note the difference to nr_rks_fxc, dms_alpha is the response density
matrices of alpha spin, alpha+/-beta DM is applied due to singlet/triplet
coupling</p>
<p>Ref. CPL, 256, 454</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_rks_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_rks_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.</p>
</dd>
<dt>kpts_band<span class="classifier">(3,) ndarray or (<a href="#id29"><span class="problematic" id="id30">*</span></a>,3) ndarray</span></dt><dd><p>A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_uks">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#nr_uks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_uks" title="Link to this definition">#</a></dt>
<dd><p>Calculate UKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms :</dt><dd><p>Density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.
kpts_band : (3,) ndarray or (<a href="#id31"><span class="problematic" id="id32">*</span></a>,3) ndarray
A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_uks_fxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_uks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#nr_uks_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_uks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract UKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_uks_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_uks_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_uks_vxc" title="Link to this definition">#</a></dt>
<dd><p>Calculate UKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms :</dt><dd><p>Density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.
kpts_band : (3,) ndarray or (<a href="#id33"><span class="problematic" id="id34">*</span></a>,3) ndarray
A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.numint2c">
<span id="pyscf-pbc-dft-numint2c-module"></span><h2>pyscf.pbc.dft.numint2c module<a class="headerlink" href="#module-pyscf.pbc.dft.numint2c" title="Link to this heading">#</a></h2>
<p>Numerical integration functions for (2-component) GKS and KGKS</p>
<dl class="simple">
<dt>Ref:</dt><dd><p>Phys. Rev. Research 5, 013036</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint2c.</span></span><span class="sig-name descname"><span class="pre">KNumInt2C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#KNumInt2C"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a>, <a class="reference internal" href="pyscf.dft.html#pyscf.dft.numint.LibXCMixin" title="pyscf.dft.numint.LibXCMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LibXCMixin</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.block_loop">
<span class="sig-name descname"><span class="pre">block_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.block_loop" title="Link to this definition">#</a></dt>
<dd><p>Define this macro to loop over grids by blocks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.cache_xc_kernel">
<span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#KNumInt2C.cache_xc_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.cache_xc_kernel" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.cache_xc_kernel1">
<span class="sig-name descname"><span class="pre">cache_xc_kernel1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#KNumInt2C.cache_xc_kernel1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.cache_xc_kernel1" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.collinear">
<span class="sig-name descname"><span class="pre">collinear</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'col'</span></em><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.collinear" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.collinear_samples">
<span class="sig-name descname"><span class="pre">collinear_samples</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">200</span></em><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.collinear_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.collinear_thrd">
<span class="sig-name descname"><span class="pre">collinear_thrd</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.99</span></em><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.collinear_thrd" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.eval_ao">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.eval_ao" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>ao_kpts: (nkpts, [comp], ngrids, nao) ndarray</dt><dd><p>AO values at each k-point</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.eval_rho">
<span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#KNumInt2C.eval_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.eval_rho" title="Link to this definition">#</a></dt>
<dd><p>Collocate the density (opt. gradients) on the real-space grid.</p>
<dl>
<dt>Args:</dt><dd><p>cell : Mole or Cell object
ao_kpts : (nkpts, ngrids, nao) ndarray</p>
<blockquote>
<div><p>AO values at each k-point</p>
</div></blockquote>
<dl class="simple">
<dt>dm_kpts: (nkpts, nao, nao) ndarray</dt><dd><p>Density matrix at each k-point</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>rhoR : (ngrids,) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.eval_rho1">
<span class="sig-name descname"><span class="pre">eval_rho1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pair_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#KNumInt2C.eval_rho1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.eval_rho1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.eval_rho2">
<span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#KNumInt2C.eval_rho2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.eval_rho2" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.eval_xc_eff">
<span class="sig-name descname"><span class="pre">eval_xc_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.eval_xc_eff" title="Link to this definition">#</a></dt>
<dd><p>Returns the derivative tensor against the density parameters</p>
<dl class="simple">
<dt>[[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a],</dt><dd><p>[density_b, (nabla_x)_b, (nabla_y)_b, (nabla_z)_b, tau_b]].</p>
</dd>
</dl>
<p>It differs from the eval_xc method in the derivatives of non-local part.
The eval_xc method returns the XC functional derivatives to sigma
(<a href="#id35"><span class="problematic" id="id36">|</span></a>nabla rho|^2)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>rho: 2-dimensional or 3-dimensional array</dt><dd><p>Total density and spin density (and their derivatives if GGA or MGGA
functionals) on grids</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>deriv: int</dt><dd><p>derivative orders</p>
</dd>
<dt>omega: float</dt><dd><p>define the exponent in the attenuated Coulomb for RSH functional</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.get_fxc">
<span class="sig-name descname"><span class="pre">get_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.get_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#KNumInt2C.get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.get_vxc">
<span class="sig-name descname"><span class="pre">get_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.get_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code> for more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.make_mask" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.mcfun_eval_xc_adapter">
<span class="sig-name descname"><span class="pre">mcfun_eval_xc_adapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.mcfun_eval_xc_adapter" title="Link to this definition">#</a></dt>
<dd><p>Wrapper to generate the eval_xc function required by mcfun</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.nr_fxc">
<span class="sig-name descname"><span class="pre">nr_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.nr_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.nr_gks_fxc">
<span class="sig-name descname"><span class="pre">nr_gks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.nr_gks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.nr_gks_vxc">
<span class="sig-name descname"><span class="pre">nr_gks_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.nr_gks_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code> for more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.nr_vxc">
<span class="sig-name descname"><span class="pre">nr_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#KNumInt2C.nr_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.nr_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code> for more details.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.KNumInt2C.spin_samples">
<span class="sig-name descname"><span class="pre">spin_samples</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">770</span></em><a class="headerlink" href="#pyscf.pbc.dft.numint2c.KNumInt2C.spin_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint2c.</span></span><span class="sig-name descname"><span class="pre">NumInt2C</span></span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#NumInt2C"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a>, <a class="reference internal" href="pyscf.dft.html#pyscf.dft.numint.LibXCMixin" title="pyscf.dft.numint.LibXCMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">LibXCMixin</span></code></a></p>
<p>Numerical integration methods for 2-component basis (used by GKS)</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.block_loop">
<span class="sig-name descname"><span class="pre">block_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.block_loop" title="Link to this definition">#</a></dt>
<dd><p>Define this macro to loop over grids by blocks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.cache_xc_kernel">
<span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#NumInt2C.cache_xc_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.cache_xc_kernel" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.cache_xc_kernel1">
<span class="sig-name descname"><span class="pre">cache_xc_kernel1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#NumInt2C.cache_xc_kernel1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.cache_xc_kernel1" title="Link to this definition">#</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.collinear">
<span class="sig-name descname"><span class="pre">collinear</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'col'</span></em><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.collinear" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.collinear_samples">
<span class="sig-name descname"><span class="pre">collinear_samples</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">200</span></em><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.collinear_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.collinear_thrd">
<span class="sig-name descname"><span class="pre">collinear_thrd</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.99</span></em><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.collinear_thrd" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.eval_ao">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.eval_ao" title="Link to this definition">#</a></dt>
<dd><p>Collocate AO crystal orbitals (opt. gradients) on the real-space grid.</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">(nx*ny*nz, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>kpt<span class="classifier">(3,) ndarray</span></dt><dd><p>The k-point corresponding to the crystal AO.</p>
</dd>
<dt>deriv<span class="classifier">int</span></dt><dd><p>AO derivative order.  It affects the shape of the return array.
If deriv=0, the returned AO values are stored in a (N,nao) array.
Otherwise the AO values are stored in an array of shape (M,N,nao).
Here N is the number of grids, nao is the number of AO functions,
M is the size associated to the derivative deriv.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>aoR<span class="classifier">([4,] nx*ny*nz, nao=cell.nao_nr()) ndarray</span></dt><dd><p>The value of the AO crystal orbitals on the real-space grid by default.
If deriv=1, also contains the value of the orbitals gradient in the
x, y, and z directions.  It can be either complex or float array,
depending on the kpt argument.  If kpt is not given (gamma point),
aoR is a float array.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.dft.numint.eval_ao</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.eval_rho">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.eval_rho" title="Link to this definition">#</a></dt>
<dd><p>Calculate the electron density and magnetization spin density in the
framework of 2-component real basis.
Calculate the electron density for LDA functional, and the density
derivatives for GGA and MGGA functionals.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">2D array of shape (N,nao) for LDA, 3D array of shape (4,N,nao) for GGA</span></dt><dd><p>or meta-GGA.  N is the number of grids, nao is the
number of AO functions.  If xctype is GGA (MGGA), ao[0] is AO value
and ao[1:3] are the AO gradients. ao[4:10] are second derivatives of
ao values if applicable.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <a class="reference internal" href="#pyscf.pbc.dft.numint2c.NumInt2C.make_mask" title="pyscf.pbc.dft.numint2c.NumInt2C.make_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></a></p>
</dd>
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of the return density.</p>
</dd>
<dt>hermi<span class="classifier">bool</span></dt><dd><p>dm is hermitian or not</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>1D array of size N to store electron density if xctype = LDA;  2D array
of (4,N) to store density and “density derivatives” for x,y,z components
if xctype = GGA; For meta-GGA, returns can be a (6,N) (with_lapl=True)
array where last two rows are nabla^2 rho and tau = 1/2(nabla f)^2
or (5,N) (with_lapl=False) where the last row is tau = 1/2(nabla f)^2</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 0 1; H 0 1 0&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">dm</span> <span class="o">+</span> <span class="n">dm</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span><span class="p">,</span> <span class="n">dx_rho</span><span class="p">,</span> <span class="n">dy_rho</span><span class="p">,</span> <span class="n">dz_rho</span> <span class="o">=</span> <span class="n">eval_rho</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">ao</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">xctype</span><span class="o">=</span><span class="s1">&#39;LDA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.eval_rho1">
<span class="sig-name descname"><span class="pre">eval_rho1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pair_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#NumInt2C.eval_rho1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.eval_rho1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.eval_rho2">
<span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/dft/numint2c.html#NumInt2C.eval_rho2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.eval_rho2" title="Link to this definition">#</a></dt>
<dd><p>Calculate the electron density for LDA functional and the density
derivatives for GGA functional in the framework of 2-component basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.eval_xc_eff">
<span class="sig-name descname"><span class="pre">eval_xc_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.eval_xc_eff" title="Link to this definition">#</a></dt>
<dd><p>Returns the derivative tensor against the density parameters</p>
<dl class="simple">
<dt>[[density_a, (nabla_x)_a, (nabla_y)_a, (nabla_z)_a, tau_a],</dt><dd><p>[density_b, (nabla_x)_b, (nabla_y)_b, (nabla_z)_b, tau_b]].</p>
</dd>
</dl>
<p>It differs from the eval_xc method in the derivatives of non-local part.
The eval_xc method returns the XC functional derivatives to sigma
(<a href="#id37"><span class="problematic" id="id38">|</span></a>nabla rho|^2)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>rho: 2-dimensional or 3-dimensional array</dt><dd><p>Total density and spin density (and their derivatives if GGA or MGGA
functionals) on grids</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>deriv: int</dt><dd><p>derivative orders</p>
</dd>
<dt>omega: float</dt><dd><p>define the exponent in the attenuated Coulomb for RSH functional</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.get_fxc">
<span class="sig-name descname"><span class="pre">get_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.get_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#NumInt2C.get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.get_vxc">
<span class="sig-name descname"><span class="pre">get_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.get_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code> for more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.make_mask" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.mcfun_eval_xc_adapter">
<span class="sig-name descname"><span class="pre">mcfun_eval_xc_adapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.mcfun_eval_xc_adapter" title="Link to this definition">#</a></dt>
<dd><p>Wrapper to generate the eval_xc function required by mcfun</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.nr_fxc">
<span class="sig-name descname"><span class="pre">nr_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#NumInt2C.nr_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.nr_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.nr_gks_fxc">
<span class="sig-name descname"><span class="pre">nr_gks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.nr_gks_fxc" title="Link to this definition">#</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether the input density matrix is hermitian</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.nr_gks_vxc">
<span class="sig-name descname"><span class="pre">nr_gks_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.nr_gks_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code> for more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.nr_vxc">
<span class="sig-name descname"><span class="pre">nr_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint2c.html#NumInt2C.nr_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.nr_vxc" title="Link to this definition">#</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code> for more details.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint2c.NumInt2C.spin_samples">
<span class="sig-name descname"><span class="pre">spin_samples</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">770</span></em><a class="headerlink" href="#pyscf.pbc.dft.numint2c.NumInt2C.spin_samples" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.rks">
<span id="pyscf-pbc-dft-rks-module"></span><h2>pyscf.pbc.dft.rks module<a class="headerlink" href="#module-pyscf.pbc.dft.rks" title="Link to this heading">#</a></h2>
<p>Non-relativistic Restricted Kohn-Sham for periodic systems at a single k-point</p>
<dl class="simple">
<dt>See Also:</dt><dd><dl class="simple">
<dt>pyscf.pbc.dft.krks.py<span class="classifier">Non-relativistic Restricted Kohn-Sham for periodic</span></dt><dd><p>systems with k-point sampling</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.rks.</span></span><span class="sig-name descname"><span class="pre">KohnShamDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.dft.html#pyscf.dft.rks.KohnShamDFT" title="pyscf.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a></p>
<p>PBC-KS</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.build" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.density_fit" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.initialize_grids">
<span class="sig-name descname"><span class="pre">initialize_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.initialize_grids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.initialize_grids" title="Link to this definition">#</a></dt>
<dd><p>Initialize self.grids the first time call get_veff</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.jk_method">
<span class="sig-name descname"><span class="pre">jk_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'FFTDF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.jk_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.jk_method" title="Link to this definition">#</a></dt>
<dd><p>Set up the schemes to evaluate Coulomb and exchange matrix</p>
<p>FFTDF: planewave density fitting using Fast Fourier Transform
AFTDF: planewave density fitting using analytic Fourier Transform
GDF: Gaussian density fitting
MDF: Gaussian and planewave mix density fitting
RS: range-separation JK builder
RSDF: range-separation density fitting</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.mix_density_fit">
<span class="sig-name descname"><span class="pre">mix_density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.mix_density_fit" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.reset" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.rs_density_fit">
<span class="sig-name descname"><span class="pre">rs_density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.rs_density_fit" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.to_gks">
<span class="sig-name descname"><span class="pre">to_gks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.to_gks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.to_gks" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a GKS object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.to_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.to_gpu" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert the input KS object to the associated HF object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.to_rks">
<span class="sig-name descname"><span class="pre">to_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.to_rks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.to_rks" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a RKS/ROKS object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.to_uks">
<span class="sig-name descname"><span class="pre">to_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.to_uks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.to_uks" title="Link to this definition">#</a></dt>
<dd><p>Convert the input mean-field object to a UKS object.</p>
<p>Note this conversion only changes the class of the mean-field object.
The total energy and wave-function are the same as them in the input
mean-field object.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.rks.</span></span><span class="sig-name descname"><span class="pre">RKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#RKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.hf.RHF" title="pyscf.pbc.scf.hf.RHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">RHF</span></code></a></p>
<p>RKS class adapted for PBCs.</p>
<p>This is a literal duplication of the molecular RKS class with some <cite>mol</cite>
variables replaced by <cite>cell</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#RKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of RKS energy.</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl>
<dt>Args:</dt><dd><p>ks : an instance of DFT class</p>
<dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>RKS electronic energy and the 2-electron contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.pbc.dft.rks.RKS" title="pyscf.pbc.dft.rks.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.get_vsap">
<span class="sig-name descname"><span class="pre">get_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.get_vsap" title="Link to this definition">#</a></dt>
<dd><p>Superposition of atomic potentials</p>
<p>S. Lehtola, Assessment of initial guesses for self-consistent
field calculations. Superposition of Atomic Potentials: simple yet
efficient, J. Chem. Theory Comput. 15, 1593 (2019). DOI:
10.1021/acs.jctc.8b01089. arXiv:1810.11659.</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, “Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals”, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, “Fully numerical Hartree-Fock and density functional
calculations. I. Atoms”, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.pbc.dft.rks.RKS" title="pyscf.pbc.dft.rks.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vsap = Vnuc + J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.init_guess_by_vsap">
<span class="sig-name descname"><span class="pre">init_guess_by_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.init_guess_by_vsap" title="Link to this definition">#</a></dt>
<dd><p>Form SAP guess</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#RKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to RHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.rks.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.rks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.pbc.dft.rks.RKS" title="pyscf.pbc.dft.rks.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.prune_small_rho_grids_">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.rks.</span></span><span class="sig-name descname"><span class="pre">prune_small_rho_grids_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#prune_small_rho_grids_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.prune_small_rho_grids_" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.pbc.dft.roks">
<span id="pyscf-pbc-dft-roks-module"></span><h2>pyscf.pbc.dft.roks module<a class="headerlink" href="#module-pyscf.pbc.dft.roks" title="Link to this heading">#</a></h2>
<p>Restricted open-shell Kohn-Sham for periodic systems at a single k-point</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.roks.</span></span><span class="sig-name descname"><span class="pre">ROKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/roks.html#ROKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.rohf.ROHF" title="pyscf.pbc.scf.rohf.ROHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">ROHF</span></code></a></p>
<p>UKS class adapted for PBCs.</p>
<p>This is a literal duplication of the molecular UKS class with some <cite>mol</cite>
variables replaced by <cite>cell</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/roks.html#ROKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic part of Hartree-Fock energy, for given core hamiltonian and
HF potential</p>
<p>… math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> \<span class="n">sum_</span><span class="p">{</span><span class="n">ij</span><span class="p">}</span><span class="n">h_</span><span class="p">{</span><span class="n">ij</span><span class="p">}</span> \<span class="n">gamma_</span><span class="p">{</span><span class="n">ji</span><span class="p">}</span>
  <span class="o">+</span> \<span class="n">frac</span><span class="p">{</span><span class="mi">1</span><span class="p">}{</span><span class="mi">2</span><span class="p">}</span>\<span class="n">sum_</span><span class="p">{</span><span class="n">ijkl</span><span class="p">}</span> \<span class="n">gamma_</span><span class="p">{</span><span class="n">ji</span><span class="p">}</span>\<span class="n">gamma_</span><span class="p">{</span><span class="n">lk</span><span class="p">}</span> \<span class="n">langle</span> <span class="n">ik</span><span class="o">||</span><span class="n">jl</span>\<span class="n">rangle</span>
</pre></div>
</div>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mf : an instance of SCF class</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-particle density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
<dt>vhf<span class="classifier">2D ndarray</span></dt><dd><p>HF potential</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Hartree-Fock electronic energy and the Coulomb energy</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">energy_elec</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
<span class="go">(-1.5176090667746334, 0.60917167853723675)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">energy_elec</span><span class="p">(</span><span class="n">dm</span><span class="p">)</span>
<span class="go">(-1.5176090667746334, 0.60917167853723675)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.roks.get_veff" title="pyscf.pbc.dft.roks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.get_vsap">
<span class="sig-name descname"><span class="pre">get_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.get_vsap" title="Link to this definition">#</a></dt>
<dd><p>Superposition of atomic potentials</p>
<p>S. Lehtola, Assessment of initial guesses for self-consistent
field calculations. Superposition of Atomic Potentials: simple yet
efficient, J. Chem. Theory Comput. 15, 1593 (2019). DOI:
10.1021/acs.jctc.8b01089. arXiv:1810.11659.</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, “Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals”, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, “Fully numerical Hartree-Fock and density functional
calculations. I. Atoms”, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vsap = Vnuc + J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.init_guess_by_vsap">
<span class="sig-name descname"><span class="pre">init_guess_by_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.init_guess_by_vsap" title="Link to this definition">#</a></dt>
<dd><p>Form SAP guess</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/roks.html#ROKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to RHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.roks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/roks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.roks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.roks.get_veff" title="pyscf.pbc.dft.roks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft.uks">
<span id="pyscf-pbc-dft-uks-module"></span><h2>pyscf.pbc.dft.uks module<a class="headerlink" href="#module-pyscf.pbc.dft.uks" title="Link to this heading">#</a></h2>
<p>Non-relativistic unrestricted Kohn-Sham for periodic systems at a single k-point</p>
<dl class="simple">
<dt>See Also:</dt><dd><dl class="simple">
<dt>pyscf.pbc.dft.krks.py<span class="classifier">Non-relativistic Restricted Kohn-Sham for periodic</span></dt><dd><p>systems with k-point sampling</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.uks.</span></span><span class="sig-name descname"><span class="pre">UKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/uks.html#UKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.uhf.UHF" title="pyscf.pbc.scf.uhf.UHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">UHF</span></code></a></p>
<p>UKS class adapted for PBCs.</p>
<p>This is a literal duplication of the molecular UKS class with some <cite>mol</cite>
variables replaced by <cite>cell</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/uks.html#UKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.energy_elec" title="Link to this definition">#</a></dt>
<dd><p>Electronic energy of Unrestricted Hartree-Fock</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>Hartree-Fock electronic energy and the 2-electron part contribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.get_rho" title="Link to this definition">#</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.uks.get_veff" title="pyscf.pbc.dft.uks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.get_vsap">
<span class="sig-name descname"><span class="pre">get_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.get_vsap" title="Link to this definition">#</a></dt>
<dd><p>Superposition of atomic potentials</p>
<p>S. Lehtola, Assessment of initial guesses for self-consistent
field calculations. Superposition of Atomic Potentials: simple yet
efficient, J. Chem. Theory Comput. 15, 1593 (2019). DOI:
10.1021/acs.jctc.8b01089. arXiv:1810.11659.</p>
<p>This function evaluates the effective charge of a neutral atom,
given by exchange-only LDA on top of spherically symmetric
unrestricted Hartree-Fock calculations as described in</p>
<p>S. Lehtola, L. Visscher, E. Engel, Efficient implementation of the
superposition of atomic potentials initial guess for electronic
structure calculations in Gaussian basis sets, J. Chem. Phys., in
press (2020).</p>
<p>The potentials have been calculated for the ground-states of
spherically symmetric atoms at the non-relativistic level of theory
as described in</p>
<p>S. Lehtola, “Fully numerical calculations on atoms with fractional
occupations and range-separated exchange functionals”, Phys. Rev. A
101, 012516 (2020). DOI: 10.1103/PhysRevA.101.012516</p>
<p>using accurate finite-element calculations as described in</p>
<p>S. Lehtola, “Fully numerical Hartree-Fock and density functional
calculations. I. Atoms”, Int. J. Quantum Chem. e25945 (2019).
DOI: 10.1002/qua.25945</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will modify the input ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vsap = Vnuc + J + Vxc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.init_guess_by_vsap">
<span class="sig-name descname"><span class="pre">init_guess_by_vsap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.init_guess_by_vsap" title="Link to this definition">#</a></dt>
<dd><p>Form SAP guess</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.to_hf">
<span class="sig-name descname"><span class="pre">to_hf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/uks.html#UKS.to_hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.to_hf" title="Link to this definition">#</a></dt>
<dd><p>Convert to UHF object.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.uks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/uks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.uks.get_veff" title="Link to this definition">#</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.uks.get_veff" title="pyscf.pbc.dft.uks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.dft">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyscf.pbc.dft" title="Link to this heading">#</a></h2>
<p>Kohn-Sham DFT for periodic systems</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.KKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.</span></span><span class="sig-name descname"><span class="pre">KKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft.html#KKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.KKS" title="Link to this definition">#</a></dt>
<dd><p>A wrap function to create DFT object with k-point sampling (KRKS or KUKS).</p>
<p>RKS class adapted for PBCs with k-point sampling.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.KRKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.</span></span><span class="sig-name descname"><span class="pre">KRKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft.html#KRKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.KRKS" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.KRKSpU">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.</span></span><span class="sig-name descname"><span class="pre">KRKSpU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft.html#KRKSpU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.KRKSpU" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.KS">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.</span></span><span class="sig-name descname"><span class="pre">KS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft.html#KS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.KS" title="Link to this definition">#</a></dt>
<dd><p>A wrap function to create DFT object (RKS or UKS) for PBC systems.</p>
<p>RKS class adapted for PBCs.</p>
<blockquote>
<div><p>This is a literal duplication of the molecular RKS class with some <cite>mol</cite>
variables replaced by <cite>cell</cite>.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.KUKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.</span></span><span class="sig-name descname"><span class="pre">KUKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft.html#KUKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.KUKS" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.KUKSpU">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.</span></span><span class="sig-name descname"><span class="pre">KUKSpU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft.html#KUKSpU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.KUKSpU" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.RKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.</span></span><span class="sig-name descname"><span class="pre">RKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft.html#RKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.RKS" title="Link to this definition">#</a></dt>
<dd><p>RKS class adapted for PBCs.</p>
<p>This is a literal duplication of the molecular RKS class with some <cite>mol</cite>
variables replaced by <cite>cell</cite>.</p>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subpackages">Subpackages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.cdft">pyscf.pbc.dft.cdft module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.cdft.cdft"><code class="docutils literal notranslate"><span class="pre">cdft()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.cdft.fast_iao_mullikan_pop"><code class="docutils literal notranslate"><span class="pre">fast_iao_mullikan_pop()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.gen_grid">pyscf.pbc.dft.gen_grid module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.AtomicGrids"><code class="docutils literal notranslate"><span class="pre">AtomicGrids</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.BeckeGrids"><code class="docutils literal notranslate"><span class="pre">BeckeGrids</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.BeckeGrids.build"><code class="docutils literal notranslate"><span class="pre">BeckeGrids.build()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.BeckeGrids.make_mask"><code class="docutils literal notranslate"><span class="pre">BeckeGrids.make_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.BeckeGrids.to_gpu"><code class="docutils literal notranslate"><span class="pre">BeckeGrids.to_gpu()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.UniformGrids"><code class="docutils literal notranslate"><span class="pre">UniformGrids</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.UniformGrids.build"><code class="docutils literal notranslate"><span class="pre">UniformGrids.build()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.UniformGrids.coords"><code class="docutils literal notranslate"><span class="pre">UniformGrids.coords</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.UniformGrids.cutoff"><code class="docutils literal notranslate"><span class="pre">UniformGrids.cutoff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.UniformGrids.dump_flags"><code class="docutils literal notranslate"><span class="pre">UniformGrids.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.UniformGrids.kernel"><code class="docutils literal notranslate"><span class="pre">UniformGrids.kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.UniformGrids.make_mask"><code class="docutils literal notranslate"><span class="pre">UniformGrids.make_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.UniformGrids.reset"><code class="docutils literal notranslate"><span class="pre">UniformGrids.reset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.UniformGrids.to_gpu"><code class="docutils literal notranslate"><span class="pre">UniformGrids.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.UniformGrids.weights"><code class="docutils literal notranslate"><span class="pre">UniformGrids.weights</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.gen_becke_grids"><code class="docutils literal notranslate"><span class="pre">gen_becke_grids()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.get_becke_grids"><code class="docutils literal notranslate"><span class="pre">get_becke_grids()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gen_grid.make_mask"><code class="docutils literal notranslate"><span class="pre">make_mask()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.gks">pyscf.pbc.dft.gks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS"><code class="docutils literal notranslate"><span class="pre">GKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS.collinear"><code class="docutils literal notranslate"><span class="pre">GKS.collinear</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">GKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">GKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS.get_veff"><code class="docutils literal notranslate"><span class="pre">GKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">GKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS.spin_samples"><code class="docutils literal notranslate"><span class="pre">GKS.spin_samples</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS.stability"><code class="docutils literal notranslate"><span class="pre">GKS.stability()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">GKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS.to_hf"><code class="docutils literal notranslate"><span class="pre">GKS.to_hf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS.x2c"><code class="docutils literal notranslate"><span class="pre">GKS.x2c()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.GKS.x2c1e"><code class="docutils literal notranslate"><span class="pre">GKS.x2c1e()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.gks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.kgks">pyscf.pbc.dft.kgks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS"><code class="docutils literal notranslate"><span class="pre">KGKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.collinear"><code class="docutils literal notranslate"><span class="pre">KGKS.collinear</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">KGKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">KGKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.get_rho"><code class="docutils literal notranslate"><span class="pre">KGKS.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.get_veff"><code class="docutils literal notranslate"><span class="pre">KGKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">KGKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.spin_samples"><code class="docutils literal notranslate"><span class="pre">KGKS.spin_samples</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.stability"><code class="docutils literal notranslate"><span class="pre">KGKS.stability()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">KGKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.to_hf"><code class="docutils literal notranslate"><span class="pre">KGKS.to_hf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.x2c"><code class="docutils literal notranslate"><span class="pre">KGKS.x2c()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.KGKS.x2c1e"><code class="docutils literal notranslate"><span class="pre">KGKS.x2c1e()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kgks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.krks">pyscf.pbc.dft.krks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks.KRKS"><code class="docutils literal notranslate"><span class="pre">KRKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks.KRKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">KRKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks.KRKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">KRKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks.KRKS.get_rho"><code class="docutils literal notranslate"><span class="pre">KRKS.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks.KRKS.get_veff"><code class="docutils literal notranslate"><span class="pre">KRKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks.KRKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">KRKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks.KRKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">KRKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks.KRKS.to_hf"><code class="docutils literal notranslate"><span class="pre">KRKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks.energy_elec"><code class="docutils literal notranslate"><span class="pre">energy_elec()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks.get_rho"><code class="docutils literal notranslate"><span class="pre">get_rho()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.krks_ksymm">pyscf.pbc.dft.krks_ksymm module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KRKS"><code class="docutils literal notranslate"><span class="pre">KRKS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.dump_chk"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.dump_chk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.eig"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.eig()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_hcore"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.get_hcore()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_init_guess"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.get_init_guess()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_jk"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.get_jk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_occ"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.get_occ()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_orbsym"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.get_orbsym()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_ovlp"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.get_ovlp()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_rho"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.get_veff"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.init_guess_by_chkfile"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.init_guess_by_chkfile()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.kpts"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.kpts</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.orbsym"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.orbsym</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.KsymAdaptedKRKS.to_hf"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.get_rho"><code class="docutils literal notranslate"><span class="pre">get_rho()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krks_ksymm.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.krkspu">pyscf.pbc.dft.krkspu module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.KRKSpU"><code class="docutils literal notranslate"><span class="pre">KRKSpU</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.KRKSpU.energy_elec"><code class="docutils literal notranslate"><span class="pre">KRKSpU.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.KRKSpU.get_veff"><code class="docutils literal notranslate"><span class="pre">KRKSpU.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.KRKSpU.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">KRKSpU.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.KRKSpU.to_hf"><code class="docutils literal notranslate"><span class="pre">KRKSpU.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.energy_elec"><code class="docutils literal notranslate"><span class="pre">energy_elec()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.format_idx"><code class="docutils literal notranslate"><span class="pre">format_idx()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.make_minao_lo"><code class="docutils literal notranslate"><span class="pre">make_minao_lo()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.mdot"><code class="docutils literal notranslate"><span class="pre">mdot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.proj_ref_ao"><code class="docutils literal notranslate"><span class="pre">proj_ref_ao()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu.set_U"><code class="docutils literal notranslate"><span class="pre">set_U()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.krkspu_ksymm">pyscf.pbc.dft.krkspu_ksymm module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu_ksymm.KRKSpU"><code class="docutils literal notranslate"><span class="pre">KRKSpU</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKSpU</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU.energy_elec"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKSpU.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU.get_veff"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKSpU.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.krkspu_ksymm.KsymAdaptedKRKSpU.to_hf"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKRKSpU.to_hf()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.kroks">pyscf.pbc.dft.kroks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kroks.KROKS"><code class="docutils literal notranslate"><span class="pre">KROKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kroks.KROKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">KROKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kroks.KROKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">KROKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kroks.KROKS.get_rho"><code class="docutils literal notranslate"><span class="pre">KROKS.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kroks.KROKS.get_veff"><code class="docutils literal notranslate"><span class="pre">KROKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kroks.KROKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">KROKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kroks.KROKS.to_hf"><code class="docutils literal notranslate"><span class="pre">KROKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kroks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.kuks">pyscf.pbc.dft.kuks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks.KUKS"><code class="docutils literal notranslate"><span class="pre">KUKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks.KUKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">KUKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks.KUKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">KUKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks.KUKS.get_rho"><code class="docutils literal notranslate"><span class="pre">KUKS.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks.KUKS.get_veff"><code class="docutils literal notranslate"><span class="pre">KUKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks.KUKS.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">KUKS.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks.KUKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">KUKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks.KUKS.to_hf"><code class="docutils literal notranslate"><span class="pre">KUKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks.energy_elec"><code class="docutils literal notranslate"><span class="pre">energy_elec()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.kuks_ksymm">pyscf.pbc.dft.kuks_ksymm module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KUKS"><code class="docutils literal notranslate"><span class="pre">KUKS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.dump_chk"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.dump_chk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.eig"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.eig()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_hcore"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.get_hcore()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_init_guess"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.get_init_guess()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_jk"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.get_jk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_occ"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.get_occ()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_orbsym"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.get_orbsym()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_ovlp"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.get_ovlp()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_rho"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.get_veff"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.init_guess_by_chkfile"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.init_guess_by_chkfile()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.kpts"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.kpts</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.nelec"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.nelec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.orbsym"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.orbsym</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.KsymAdaptedKUKS.to_hf"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.get_rho"><code class="docutils literal notranslate"><span class="pre">get_rho()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kuks_ksymm.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.kukspu">pyscf.pbc.dft.kukspu module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu.KUKSpU"><code class="docutils literal notranslate"><span class="pre">KUKSpU</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu.KUKSpU.energy_elec"><code class="docutils literal notranslate"><span class="pre">KUKSpU.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu.KUKSpU.get_veff"><code class="docutils literal notranslate"><span class="pre">KUKSpU.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu.KUKSpU.nuc_grad_method"><code class="docutils literal notranslate"><span class="pre">KUKSpU.nuc_grad_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu.KUKSpU.to_hf"><code class="docutils literal notranslate"><span class="pre">KUKSpU.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu.energy_elec"><code class="docutils literal notranslate"><span class="pre">energy_elec()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.kukspu_ksymm">pyscf.pbc.dft.kukspu_ksymm module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu_ksymm.KUKSpU"><code class="docutils literal notranslate"><span class="pre">KUKSpU</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKSpU</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU.energy_elec"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKSpU.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU.get_veff"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKSpU.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.kukspu_ksymm.KsymAdaptedKUKSpU.to_hf"><code class="docutils literal notranslate"><span class="pre">KsymAdaptedKUKSpU.to_hf()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.numint">pyscf.pbc.dft.numint module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt"><code class="docutils literal notranslate"><span class="pre">KNumInt</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.block_loop"><code class="docutils literal notranslate"><span class="pre">KNumInt.block_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.cache_xc_kernel"><code class="docutils literal notranslate"><span class="pre">KNumInt.cache_xc_kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.cache_xc_kernel1"><code class="docutils literal notranslate"><span class="pre">KNumInt.cache_xc_kernel1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.eval_ao"><code class="docutils literal notranslate"><span class="pre">KNumInt.eval_ao()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.eval_rho"><code class="docutils literal notranslate"><span class="pre">KNumInt.eval_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.eval_rho1"><code class="docutils literal notranslate"><span class="pre">KNumInt.eval_rho1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.eval_rho2"><code class="docutils literal notranslate"><span class="pre">KNumInt.eval_rho2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.get_rho"><code class="docutils literal notranslate"><span class="pre">KNumInt.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.get_vxc"><code class="docutils literal notranslate"><span class="pre">KNumInt.get_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.make_mask"><code class="docutils literal notranslate"><span class="pre">KNumInt.make_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.nr_rks"><code class="docutils literal notranslate"><span class="pre">KNumInt.nr_rks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.nr_rks_fxc"><code class="docutils literal notranslate"><span class="pre">KNumInt.nr_rks_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.nr_rks_fxc_st"><code class="docutils literal notranslate"><span class="pre">KNumInt.nr_rks_fxc_st()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.nr_uks"><code class="docutils literal notranslate"><span class="pre">KNumInt.nr_uks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.nr_uks_fxc"><code class="docutils literal notranslate"><span class="pre">KNumInt.nr_uks_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.nr_vxc"><code class="docutils literal notranslate"><span class="pre">KNumInt.nr_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.KNumInt.to_gpu"><code class="docutils literal notranslate"><span class="pre">KNumInt.to_gpu()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt"><code class="docutils literal notranslate"><span class="pre">NumInt</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.block_loop"><code class="docutils literal notranslate"><span class="pre">NumInt.block_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.cache_xc_kernel"><code class="docutils literal notranslate"><span class="pre">NumInt.cache_xc_kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.cache_xc_kernel1"><code class="docutils literal notranslate"><span class="pre">NumInt.cache_xc_kernel1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.cutoff"><code class="docutils literal notranslate"><span class="pre">NumInt.cutoff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.eval_ao"><code class="docutils literal notranslate"><span class="pre">NumInt.eval_ao()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.eval_rho"><code class="docutils literal notranslate"><span class="pre">NumInt.eval_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.eval_rho1"><code class="docutils literal notranslate"><span class="pre">NumInt.eval_rho1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.eval_rho2"><code class="docutils literal notranslate"><span class="pre">NumInt.eval_rho2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.get_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt.get_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.get_rho"><code class="docutils literal notranslate"><span class="pre">NumInt.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.get_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt.get_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.make_mask"><code class="docutils literal notranslate"><span class="pre">NumInt.make_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.nr_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.nr_nlc_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_nlc_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.nr_rks"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_rks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.nr_rks_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_rks_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.nr_rks_fxc_st"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_rks_fxc_st()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.nr_uks"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_uks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.nr_uks_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_uks_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.nr_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt.nr_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.NumInt.to_gpu"><code class="docutils literal notranslate"><span class="pre">NumInt.to_gpu()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.cache_xc_kernel"><code class="docutils literal notranslate"><span class="pre">cache_xc_kernel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.cache_xc_kernel1"><code class="docutils literal notranslate"><span class="pre">cache_xc_kernel1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.eval_ao"><code class="docutils literal notranslate"><span class="pre">eval_ao()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.eval_ao_kpts"><code class="docutils literal notranslate"><span class="pre">eval_ao_kpts()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.eval_rho"><code class="docutils literal notranslate"><span class="pre">eval_rho()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.eval_rho2"><code class="docutils literal notranslate"><span class="pre">eval_rho2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.get_rho"><code class="docutils literal notranslate"><span class="pre">get_rho()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.nr_nlc_vxc"><code class="docutils literal notranslate"><span class="pre">nr_nlc_vxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.nr_rks"><code class="docutils literal notranslate"><span class="pre">nr_rks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.nr_rks_fxc"><code class="docutils literal notranslate"><span class="pre">nr_rks_fxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.nr_rks_fxc_st"><code class="docutils literal notranslate"><span class="pre">nr_rks_fxc_st()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.nr_rks_vxc"><code class="docutils literal notranslate"><span class="pre">nr_rks_vxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.nr_uks"><code class="docutils literal notranslate"><span class="pre">nr_uks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.nr_uks_fxc"><code class="docutils literal notranslate"><span class="pre">nr_uks_fxc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint.nr_uks_vxc"><code class="docutils literal notranslate"><span class="pre">nr_uks_vxc()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.numint2c">pyscf.pbc.dft.numint2c module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C"><code class="docutils literal notranslate"><span class="pre">KNumInt2C</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.block_loop"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.block_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.cache_xc_kernel"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.cache_xc_kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.cache_xc_kernel1"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.cache_xc_kernel1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.collinear"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.collinear</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.collinear_samples"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.collinear_samples</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.collinear_thrd"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.collinear_thrd</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.eval_ao"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.eval_ao()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.eval_rho"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.eval_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.eval_rho1"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.eval_rho1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.eval_rho2"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.eval_rho2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.eval_xc_eff"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.eval_xc_eff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.get_fxc"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.get_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.get_rho"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.get_vxc"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.get_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.make_mask"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.make_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.mcfun_eval_xc_adapter"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.mcfun_eval_xc_adapter()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.nr_fxc"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.nr_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.nr_gks_fxc"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.nr_gks_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.nr_gks_vxc"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.nr_gks_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.nr_vxc"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.nr_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.KNumInt2C.spin_samples"><code class="docutils literal notranslate"><span class="pre">KNumInt2C.spin_samples</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C"><code class="docutils literal notranslate"><span class="pre">NumInt2C</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.block_loop"><code class="docutils literal notranslate"><span class="pre">NumInt2C.block_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.cache_xc_kernel"><code class="docutils literal notranslate"><span class="pre">NumInt2C.cache_xc_kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.cache_xc_kernel1"><code class="docutils literal notranslate"><span class="pre">NumInt2C.cache_xc_kernel1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.collinear"><code class="docutils literal notranslate"><span class="pre">NumInt2C.collinear</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.collinear_samples"><code class="docutils literal notranslate"><span class="pre">NumInt2C.collinear_samples</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.collinear_thrd"><code class="docutils literal notranslate"><span class="pre">NumInt2C.collinear_thrd</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.eval_ao"><code class="docutils literal notranslate"><span class="pre">NumInt2C.eval_ao()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.eval_rho"><code class="docutils literal notranslate"><span class="pre">NumInt2C.eval_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.eval_rho1"><code class="docutils literal notranslate"><span class="pre">NumInt2C.eval_rho1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.eval_rho2"><code class="docutils literal notranslate"><span class="pre">NumInt2C.eval_rho2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.eval_xc_eff"><code class="docutils literal notranslate"><span class="pre">NumInt2C.eval_xc_eff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.get_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.get_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.get_rho"><code class="docutils literal notranslate"><span class="pre">NumInt2C.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.get_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.get_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.make_mask"><code class="docutils literal notranslate"><span class="pre">NumInt2C.make_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.mcfun_eval_xc_adapter"><code class="docutils literal notranslate"><span class="pre">NumInt2C.mcfun_eval_xc_adapter()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.nr_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.nr_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.nr_gks_fxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.nr_gks_fxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.nr_gks_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.nr_gks_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.nr_vxc"><code class="docutils literal notranslate"><span class="pre">NumInt2C.nr_vxc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.numint2c.NumInt2C.spin_samples"><code class="docutils literal notranslate"><span class="pre">NumInt2C.spin_samples</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.rks">pyscf.pbc.dft.rks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.build"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.build()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.density_fit"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.density_fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.dump_flags"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.get_rho"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.initialize_grids"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.initialize_grids()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.jk_method"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.jk_method()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.mix_density_fit"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.mix_density_fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.reset"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.reset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.rs_density_fit"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.rs_density_fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.to_gks"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_gks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.to_gpu"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.to_hf"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_hf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.to_rks"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_rks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.KohnShamDFT.to_uks"><code class="docutils literal notranslate"><span class="pre">KohnShamDFT.to_uks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.RKS"><code class="docutils literal notranslate"><span class="pre">RKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.RKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">RKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.RKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">RKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.RKS.get_veff"><code class="docutils literal notranslate"><span class="pre">RKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.RKS.get_vsap"><code class="docutils literal notranslate"><span class="pre">RKS.get_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.RKS.init_guess_by_vsap"><code class="docutils literal notranslate"><span class="pre">RKS.init_guess_by_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.RKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">RKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.RKS.to_hf"><code class="docutils literal notranslate"><span class="pre">RKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.get_rho"><code class="docutils literal notranslate"><span class="pre">get_rho()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.rks.prune_small_rho_grids_"><code class="docutils literal notranslate"><span class="pre">prune_small_rho_grids_()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.roks">pyscf.pbc.dft.roks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.roks.ROKS"><code class="docutils literal notranslate"><span class="pre">ROKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.roks.ROKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">ROKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.roks.ROKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">ROKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.roks.ROKS.get_veff"><code class="docutils literal notranslate"><span class="pre">ROKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.roks.ROKS.get_vsap"><code class="docutils literal notranslate"><span class="pre">ROKS.get_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.roks.ROKS.init_guess_by_vsap"><code class="docutils literal notranslate"><span class="pre">ROKS.init_guess_by_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.roks.ROKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">ROKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.roks.ROKS.to_hf"><code class="docutils literal notranslate"><span class="pre">ROKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.roks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft.uks">pyscf.pbc.dft.uks module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.uks.UKS"><code class="docutils literal notranslate"><span class="pre">UKS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.uks.UKS.dump_flags"><code class="docutils literal notranslate"><span class="pre">UKS.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.uks.UKS.energy_elec"><code class="docutils literal notranslate"><span class="pre">UKS.energy_elec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.uks.UKS.get_rho"><code class="docutils literal notranslate"><span class="pre">UKS.get_rho()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.uks.UKS.get_veff"><code class="docutils literal notranslate"><span class="pre">UKS.get_veff()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.uks.UKS.get_vsap"><code class="docutils literal notranslate"><span class="pre">UKS.get_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.uks.UKS.init_guess_by_vsap"><code class="docutils literal notranslate"><span class="pre">UKS.init_guess_by_vsap()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.uks.UKS.to_gpu"><code class="docutils literal notranslate"><span class="pre">UKS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.uks.UKS.to_hf"><code class="docutils literal notranslate"><span class="pre">UKS.to_hf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.uks.get_veff"><code class="docutils literal notranslate"><span class="pre">get_veff()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.dft">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.KKS"><code class="docutils literal notranslate"><span class="pre">KKS()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.KRKS"><code class="docutils literal notranslate"><span class="pre">KRKS()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.KRKSpU"><code class="docutils literal notranslate"><span class="pre">KRKSpU()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.KS"><code class="docutils literal notranslate"><span class="pre">KS()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.KUKS"><code class="docutils literal notranslate"><span class="pre">KUKS()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.KUKSpU"><code class="docutils literal notranslate"><span class="pre">KUKSpU()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.dft.RKS"><code class="docutils literal notranslate"><span class="pre">RKS()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/pyscf/pyscf.github.io/edit/master/source/pyscf_api_docs/pyscf.pbc.dft.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, The PySCF Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>