<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>pyscf.pbc.gto package &#8212; PySCF</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pyscf.pbc.gto.basis package" href="pyscf.pbc.gto.basis.html" />
    <link rel="prev" title="pyscf.pbc.grad package" href="pyscf.pbc.grad.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=pyscf data-md-color-accent=pyscf>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#pyscf_api_docs/pyscf.pbc.gto" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="PySCF"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.3</span>
          <span class="md-header-nav__topic"> pyscf.pbc.gto package </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../quickstart.html" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../develop.html" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../about.html" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="pyscf.html" class="md-tabs__link">pyscf package</a></li>
          <li class="md-tabs__item"><a href="pyscf.pbc.html" class="md-tabs__link">pyscf.pbc package</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="PySCF" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="PySCF">PySCF 2.3</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../install.html" class="md-nav__link">Install PySCF</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#advanced-build-options" class="md-nav__link">Advanced build options</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#install-pyscf-extensions" class="md-nav__link">Install PySCF extensions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#troubleshooting" class="md-nav__link">Troubleshooting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickstart.html" class="md-nav__link">Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../user.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html" class="md-nav__link">API</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#subpackages" class="md-nav__link">Subpackages</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#submodules" class="md-nav__link">Submodules</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf.post_scf" class="md-nav__link">pyscf.post_scf module</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf" class="md-nav__link">Module contents</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about.html" class="md-nav__link">About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#pyscf-api-docs-pyscf-pbc-gto--page-root" class="md-nav__link">pyscf.pbc.gto package</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#subpackages" class="md-nav__link">Subpackages</a>
        </li>
        <li class="md-nav__item"><a href="#submodules" class="md-nav__link">Submodules</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.gto.cell" class="md-nav__link">pyscf.pbc.gto.cell module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.C" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">C()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.Gv" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.Gv</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.ao2mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.ao2mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.bas_rcut" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.bas_rcut()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.build" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.build()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.copy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.copy()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.cutoff_to_mesh" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.cutoff_to_mesh()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.drop_exponent" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.drop_exponent</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.dumps" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.dumps()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.energy_nuc" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.energy_nuc()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.eval_ao" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.eval_ao()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.eval_gto" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.eval_gto()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.ew_cut" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.ew_cut</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.ew_eta" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.ew_eta</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.ewald" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.ewald()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.exp_to_discard" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.exp_to_discard</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.format_basis" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.format_basis()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.format_pseudo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.format_pseudo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.from_ase" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.from_ase()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.gen_uniform_grids" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.gen_uniform_grids()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_Gv" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_Gv()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_Gv_weights" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_Gv_weights()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_SI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_SI()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_abs_kpts" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_abs_kpts()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_bounding_sphere" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_bounding_sphere()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_ewald_params" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_ewald_params()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_kpts" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_kpts()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_lattice_Ls" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_lattice_Ls()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_nimgs" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_nimgs()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_scaled_kpts" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_scaled_kpts()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_scaled_positions" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_scaled_positions()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.get_uniform_grids" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.get_uniform_grids()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.gs" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.gs</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.h" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.h</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.has_ecp" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.has_ecp()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.lattice_vectors" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.lattice_vectors()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.loads" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.loads()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.loads_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.loads_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.make_ecp_env" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.make_ecp_env()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.make_kpts" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.make_kpts()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.mesh" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.mesh</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.nelec" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.nelec</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.nimgs" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.nimgs</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.pack" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.pack()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.pbc_eval_ao" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.pbc_eval_ao()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.pbc_eval_gto" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.pbc_eval_gto()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.pbc_intor" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.pbc_intor()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.precision" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.precision</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.rcut" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.rcut</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.reciprocal_vectors" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.reciprocal_vectors()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.symmetrize_mesh" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.symmetrize_mesh()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.to_mol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.to_mol()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.tot_electrons" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.tot_electrons()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.unpack" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.unpack()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.unpack_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.unpack_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.Cell.vol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Cell.vol</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.M" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">M()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.bas_rcut" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">bas_rcut()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.classify_ecp_pseudo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">classify_ecp_pseudo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.conc_cell" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">conc_cell()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.copy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">copy()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.dumps" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">dumps()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.energy_nuc" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">energy_nuc()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.error_for_ke_cutoff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">error_for_ke_cutoff()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.estimate_ke_cutoff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">estimate_ke_cutoff()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.estimate_rcut" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">estimate_rcut()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.ewald" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">ewald()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.format_basis" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">format_basis()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.format_pseudo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">format_pseudo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.gen_uniform_grids" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_uniform_grids()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.get_Gv" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_Gv()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.get_Gv_weights" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_Gv_weights()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.get_SI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_SI()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.get_bounding_sphere" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_bounding_sphere()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.get_ewald_params" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_ewald_params()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.get_nimgs" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_nimgs()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.get_uniform_grids" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_uniform_grids()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.intor_cross" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">intor_cross()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.loads" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">loads()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.make_kpts" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_kpts()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.make_pseudo_env" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_pseudo_env()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.pack" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">pack()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.tot_electrons" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">tot_electrons()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.cell.unpack" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">unpack()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.gto.ecp" class="md-nav__link">pyscf.pbc.gto.ecp module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.ecp.ecp_int" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">ecp_int()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.gto.eval_gto" class="md-nav__link">pyscf.pbc.gto.eval_gto module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.eval_gto.eval_gto" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">eval_gto()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.eval_gto.get_lattice_Ls" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_lattice_Ls()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.pbc.gto.eval_gto.pbc_eval_gto" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">pbc_eval_gto()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.gto" class="md-nav__link">Module contents</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/pyscf_api_docs/pyscf.pbc.gto.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="pyscf-pbc-gto-package">
<h1 id="pyscf-api-docs-pyscf-pbc-gto--page-root">pyscf.pbc.gto package<a class="headerlink" href="#pyscf-api-docs-pyscf-pbc-gto--page-root" title="Permalink to this heading">¶</a></h1>
<section id="subpackages">
<h2 id="subpackages">Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyscf.pbc.gto.basis.html">pyscf.pbc.gto.basis package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.basis.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.basis.html#module-pyscf.pbc.gto.basis.parse_cp2k">pyscf.pbc.gto.basis.parse_cp2k module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html#pyscf.pbc.gto.basis.parse_cp2k.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html#pyscf.pbc.gto.basis.parse_cp2k.parse"><code class="docutils literal notranslate"><span class="pre">parse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html#pyscf.pbc.gto.basis.parse_cp2k.search_seg"><code class="docutils literal notranslate"><span class="pre">search_seg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.basis.html#module-pyscf.pbc.gto.basis.split_BASIS_MOLOPT">pyscf.pbc.gto.basis.split_BASIS_MOLOPT module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html#pyscf.pbc.gto.basis.split_BASIS_MOLOPT.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.basis.html#module-pyscf.pbc.gto.basis.split_GTH_BASIS_SETS">pyscf.pbc.gto.basis.split_GTH_BASIS_SETS module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html#pyscf.pbc.gto.basis.split_GTH_BASIS_SETS.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.basis.html#module-pyscf.pbc.gto.basis.split_HFX_BASIS">pyscf.pbc.gto.basis.split_HFX_BASIS module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html#pyscf.pbc.gto.basis.split_HFX_BASIS.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.basis.html#module-pyscf.pbc.gto.basis">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html#pyscf.pbc.gto.basis.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html#pyscf.pbc.gto.basis.parse"><code class="docutils literal notranslate"><span class="pre">parse()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html">pyscf.pbc.gto.pseudo package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#module-pyscf.pbc.gto.pseudo.parse_cp2k">pyscf.pbc.gto.pseudo.parse_cp2k module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.parse_cp2k.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.parse_cp2k.parse"><code class="docutils literal notranslate"><span class="pre">parse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.parse_cp2k.search_seg"><code class="docutils literal notranslate"><span class="pre">search_seg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#module-pyscf.pbc.gto.pseudo.pp">pyscf.pbc.gto.pseudo.pp module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.Ylm"><code class="docutils literal notranslate"><span class="pre">Ylm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.Ylm_real"><code class="docutils literal notranslate"><span class="pre">Ylm_real()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.cart2polar"><code class="docutils literal notranslate"><span class="pre">cart2polar()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.get_alphas"><code class="docutils literal notranslate"><span class="pre">get_alphas()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.get_alphas_gth"><code class="docutils literal notranslate"><span class="pre">get_alphas_gth()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.get_gth_projG"><code class="docutils literal notranslate"><span class="pre">get_gth_projG()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.get_gth_vlocG"><code class="docutils literal notranslate"><span class="pre">get_gth_vlocG()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.get_jvloc_G0"><code class="docutils literal notranslate"><span class="pre">get_jvloc_G0()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.get_pp"><code class="docutils literal notranslate"><span class="pre">get_pp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.get_projG"><code class="docutils literal notranslate"><span class="pre">get_projG()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.get_vlocG"><code class="docutils literal notranslate"><span class="pre">get_vlocG()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp.projG_li"><code class="docutils literal notranslate"><span class="pre">projG_li()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#module-pyscf.pbc.gto.pseudo.pp_int">pyscf.pbc.gto.pseudo.pp_int module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp_int.fake_cell_vloc"><code class="docutils literal notranslate"><span class="pre">fake_cell_vloc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp_int.fake_cell_vnl"><code class="docutils literal notranslate"><span class="pre">fake_cell_vnl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp_int.get_gth_vlocG_part1"><code class="docutils literal notranslate"><span class="pre">get_gth_vlocG_part1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp_int.get_pp_loc_part1"><code class="docutils literal notranslate"><span class="pre">get_pp_loc_part1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp_int.get_pp_loc_part2"><code class="docutils literal notranslate"><span class="pre">get_pp_loc_part2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.pp_int.get_pp_nl"><code class="docutils literal notranslate"><span class="pre">get_pp_nl()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#module-pyscf.pbc.gto.pseudo.split_GTH_POTENTIALS">pyscf.pbc.gto.pseudo.split_GTH_POTENTIALS module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.split_GTH_POTENTIALS.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#module-pyscf.pbc.gto.pseudo">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html#pyscf.pbc.gto.pseudo.parse"><code class="docutils literal notranslate"><span class="pre">parse()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2 id="submodules">Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-pyscf.pbc.gto.cell">
<span id="pyscf-pbc-gto-cell-module"></span><h2 id="module-pyscf.pbc.gto.cell">pyscf.pbc.gto.cell module<a class="headerlink" href="#module-pyscf.pbc.gto.cell" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.C">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.C" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a shortcut to build up Cell object.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.pbc</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">'He 1 1 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">Cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.gto.html#pyscf.gto.mole.Mole" title="pyscf.gto.mole.Mole"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></a></p>
<p>A Cell object holds the basic information of a crystal.</p>
<dl>
<dt>Attributes:</dt><dd><dl>
<dt>a<span class="classifier">(3,3) ndarray</span></dt><dd><p>Lattice primitive vectors. Each row represents a lattice vector
Reciprocal lattice vectors are given by  b1,b2,b3 = 2 pi inv(a).T</p>
</dd>
<dt>mesh<span class="classifier">(3,) list of ints</span></dt><dd><p>The number G-vectors along each direction.
The default value is estimated based on <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell.precision" title="pyscf.pbc.gto.cell.Cell.precision"><code class="xref py py-attr docutils literal notranslate"><span class="pre">precision</span></code></a></p>
</dd>
<dt>pseudo<span class="classifier">dict or str</span></dt><dd><p>To define pseudopotential.</p>
</dd>
<dt>precision<span class="classifier">float</span></dt><dd><p>To control Ewald sums and lattice sums accuracy</p>
</dd>
<dt>rcut<span class="classifier">float</span></dt><dd><p>Cutoff radius (unit Bohr) in lattice summation. The default value
is estimated based on the required <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell.precision" title="pyscf.pbc.gto.cell.Cell.precision"><code class="xref py py-attr docutils literal notranslate"><span class="pre">precision</span></code></a>.</p>
</dd>
<dt>ke_cutoff<span class="classifier">float</span></dt><dd><p>If set, defines a spherical cutoff of planewaves, with .5 * G**2 &lt; ke_cutoff
The default value is estimated based on <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell.precision" title="pyscf.pbc.gto.cell.Cell.precision"><code class="xref py py-attr docutils literal notranslate"><span class="pre">precision</span></code></a></p>
</dd>
<dt>dimension<span class="classifier">int</span></dt><dd><p>Periodic dimensions. Default is 3</p>
</dd>
<dt>low_dim_ft_type<span class="classifier">str</span></dt><dd><p>For semi-empirical periodic systems, whether to calculate
integrals at the non-PBC dimension using the sampled mesh grids in
infinity vacuum (inf_vacuum) or truncated Coulomb potential
(analytic_2d_1). Unless explicitly specified, analytic_2d_1 is
used for 2D system and inf_vacuum is assumed for 1D and 0D.</p>
</dd>
<dt>space_group_symmetry<span class="classifier">bool</span></dt><dd><p>Whether to consider space group symmetry. Default is False.</p>
</dd>
<dt>symmorphic<span class="classifier">bool</span></dt><dd><p>Whether the lattice is symmorphic. If set to True, even if the
lattice is non-symmorphic, only symmorphic space group symmetry
will be considered. Default is False, meaning the space group is
determined by the lattice symmetry to be symmorphic or non-symmorphic.</p>
</dd>
<dt>lattice_symmetry<span class="classifier">None or <code class="xref py py-class docutils literal notranslate"><span class="pre">pbc.symm.Symmetry</span></code> instance</span></dt><dd><p>The object containing the lattice symmetry information. Default is None.</p>
</dd>
</dl>
</dd>
</dl>
<p>(See other attributes in <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code>)</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Mole</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H^2 0 0 0; H 0 0 1.1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'sto3g'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cl</span> <span class="o">=</span> <span class="n">Cell</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cl</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="s1">'3 0 0; 0 3 0; 0 0 3'</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">'C 1 1 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'sto3g'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">atom_symbol</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">C</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.Gv">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Gv</span></span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.Gv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.ao2mo" title="Permalink to this definition">¶</a></dt>
<dd><p>Integral transformation for arbitrary orbitals and arbitrary
integrals.  See more detalied documentation in func:<cite>ao2mo.kernel</cite>.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>mo_coeffs (an np array or a list of arrays)<span class="classifier">A matrix of orbital</span></dt><dd><p>coefficients if it is a numpy ndarray, or four sets of orbital
coefficients, corresponding to the four indices of (ij|kl).</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>erifile (str or h5py File or h5py Group object)<span class="classifier">The file/object</span></dt><dd><p>to store the transformed integrals.  If not given, the return
value is an array (in memory) of the transformed integrals.</p>
</dd>
<dt>dataname<span class="classifier">str</span></dt><dd><p><em>Note</em> this argument is effective if erifile is given.
The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the specified dataname, the old integrals
will be replaced by the new one under the key dataname.</p>
</dd>
<dt>intor (str)<span class="classifier">integral name Name of the 2-electron integral.  Ref</span></dt><dd><p>to <code class="xref py py-func docutils literal notranslate"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>An array of transformed integrals if erifile is not given.
Otherwise, return the file/fileobject if erifile is assigned.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'O 0 0 0; H 0 1 0; H 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'sto3g'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">ao2mo</span><span class="p">(</span><span class="n">mo1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">ao2mo</span><span class="p">(</span><span class="n">mo1</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">ao2mo</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">ao2mo</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">),</span> <span class="n">erifile</span><span class="o">=</span><span class="s1">'water.h5'</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.bas_rcut">
<span class="sig-name descname"><span class="pre">bas_rcut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bas_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.bas_rcut" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the largest distance between the function and its image to
reach the precision in overlap</p>
<p>precision ~ int g(r-0) g(r-Rcut)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dump_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parse_arg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ke_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_dim_ft_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_group_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmorphic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup Mole molecule and Cell and initialize some control parameters.
Whenever you change the value of the attributes of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a>,
you need call this function to refresh the internal data of Cell.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>a<span class="classifier">(3,3) ndarray</span></dt><dd><p>The real-space cell lattice vectors. Each row represents
a lattice vector.</p>
</dd>
<dt>mesh<span class="classifier">(3,) ndarray of ints</span></dt><dd><p>The number of <em>positive</em> G-vectors along each direction.</p>
</dd>
<dt>ke_cutoff<span class="classifier">float</span></dt><dd><p>If set, defines a spherical cutoff of planewaves, with .5 * G**2 &lt; ke_cutoff
The default value is estimated based on <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell.precision" title="pyscf.pbc.gto.cell.Cell.precision"><code class="xref py py-attr docutils literal notranslate"><span class="pre">precision</span></code></a></p>
</dd>
<dt>precision<span class="classifier">float</span></dt><dd><p>To control Ewald sums and lattice sums accuracy</p>
</dd>
<dt>nimgs<span class="classifier">(3,) ndarray of ints</span></dt><dd><p>Number of repeated images in lattice summation to produce
periodicity. This value can be estimated based on the required
precision.  It’s recommended NOT making changes to this value.</p>
</dd>
<dt>rcut<span class="classifier">float</span></dt><dd><p>Cutoff radius (unit Bohr) in lattice summation to produce
periodicity. The value can be estimated based on the required
precision.  It’s recommended NOT making changes to this value.</p>
</dd>
<dt>pseudo<span class="classifier">dict or str</span></dt><dd><p>To define pseudopotential.</p>
</dd>
<dt>ecp<span class="classifier">dict or str</span></dt><dd><p>To define ECP type pseudopotential.</p>
</dd>
<dt>h<span class="classifier">(3,3) ndarray</span></dt><dd><p>a.T. Deprecated</p>
</dd>
<dt>dimension<span class="classifier">int</span></dt><dd><p>Default is 3</p>
</dd>
<dt>low_dim_ft_type<span class="classifier">str</span></dt><dd><p>For semi-empirical periodic systems, whether to calculate
integrals at the non-PBC dimension using the sampled mesh grids in
infinity vacuum (inf_vacuum) or truncated Coulomb potential
(analytic_2d_1). Unless explicitly specified, analytic_2d_1 is
used for 2D system and inf_vacuum is assumed for 1D and 0D.</p>
</dd>
<dt>space_group_symmetry<span class="classifier">bool</span></dt><dd><p>Whether to consider space group symmetry. Default is False.</p>
</dd>
<dt>symmorphic<span class="classifier">bool</span></dt><dd><p>Whether the lattice is symmorphic. If set to True, even if the
lattice is non-symmorphic, only symmorphic space group symmetry
will be considered. Default is False, meaning the space group is
determined by the lattice symmetry to be symmorphic or non-symmorphic.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Deepcopy of the given <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.cutoff_to_mesh">
<span class="sig-name descname"><span class="pre">cutoff_to_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ke_cutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.cutoff_to_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.cutoff_to_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert KE cutoff to FFT-mesh</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>ke_cutoff<span class="classifier">float</span></dt><dd><p>KE energy cutoff in a.u.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>mesh : (3,) array</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.drop_exponent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">drop_exponent</span></span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.drop_exponent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.dumps">
<span class="sig-name descname"><span class="pre">dumps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.dumps" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialize Cell object to a JSON formatted str.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.energy_nuc">
<span class="sig-name descname"><span class="pre">energy_nuc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ew_eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ew_cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.energy_nuc" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform real (R) and reciprocal (G) space Ewald sum for the energy.</p>
<p>Formulation of Martin, App. F2.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>float</dt><dd><p>The Ewald energy consisting of overlap, self, and G-space sum.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.pbc.gto.get_ewald_params</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.eval_ao">
<span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.eval_ao" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate PBC-AO function value on the given grids,</p>
<dl>
<dt>Args:</dt><dd><p>eval_name : str</p>
<blockquote>
<div><table>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Expression</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>“GTOval_sph”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id1"><span class="problematic" id="id2">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_sph”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id3"><span class="problematic" id="id4">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-even"><td><p>“GTOval_cart”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id5"><span class="problematic" id="id6">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_cart”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id7"><span class="problematic" id="id8">|</span></a>AO&gt;</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="simple">
<dt>atm<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>bas<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>env<span class="classifier">float64 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of the grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in cell will be evaluated.</p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">dft.gen_grid.make_mask()</span></code></p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>AO values smaller than cutoff will be set to zero. The default
cutoff threshold is ~1e-22 (defined in gto/grid_ao_drv.h)</p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>If provided, results are written into this array.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list of 2D (or 3D) arrays to hold the AO values on grids.  Each
element of the list corresponds to a k-point and it has the shape
(N,nao) Or shape (*,N,nao).</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">'He 1 1 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_uniform_grids</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1000, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_ig_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 1000, 2)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.eval_gto">
<span class="sig-name descname"><span class="pre">eval_gto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.eval_gto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.eval_gto" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate PBC-AO function value on the given grids,</p>
<dl>
<dt>Args:</dt><dd><p>eval_name : str</p>
<blockquote>
<div><table>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Expression</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>“GTOval_sph”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id9"><span class="problematic" id="id10">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_sph”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id11"><span class="problematic" id="id12">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-even"><td><p>“GTOval_cart”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id13"><span class="problematic" id="id14">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_cart”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id15"><span class="problematic" id="id16">|</span></a>AO&gt;</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="simple">
<dt>atm<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>bas<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>env<span class="classifier">float64 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of the grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in cell will be evaluated.</p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">dft.gen_grid.make_mask()</span></code></p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>AO values smaller than cutoff will be set to zero. The default
cutoff threshold is ~1e-22 (defined in gto/grid_ao_drv.h)</p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>If provided, results are written into this array.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list of 2D (or 3D) arrays to hold the AO values on grids.  Each
element of the list corresponds to a k-point and it has the shape
(N,nao) Or shape (*,N,nao).</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">'He 1 1 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_uniform_grids</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1000, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_ig_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 1000, 2)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.ew_cut">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ew_cut</span></span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.ew_cut" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.ew_eta">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ew_eta</span></span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.ew_eta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.ewald">
<span class="sig-name descname"><span class="pre">ewald</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ew_eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ew_cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.ewald" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform real (R) and reciprocal (G) space Ewald sum for the energy.</p>
<p>Formulation of Martin, App. F2.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>float</dt><dd><p>The Ewald energy consisting of overlap, self, and G-space sum.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.pbc.gto.get_ewald_params</p>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.exp_to_discard">
<span class="sig-name descname"><span class="pre">exp_to_discard</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.exp_to_discard" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.format_basis">
<span class="sig-name descname"><span class="pre">format_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_tab</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.format_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.format_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the input <code class="xref py py-attr docutils literal notranslate"><span class="pre">Cell.basis</span></code> to the internal data format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="n">atom</span><span class="p">:</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="p">((</span><span class="o">-</span><span class="n">exp</span><span class="p">,</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">c_2</span><span class="p">,</span> <span class="o">..</span><span class="p">),</span> <span class="n">nprim</span><span class="p">,</span> <span class="n">nctr</span><span class="p">,</span> <span class="n">ptr</span><span class="o">-</span><span class="n">exps</span><span class="p">,</span> <span class="n">ptr</span><span class="o">-</span><span class="n">contraction</span><span class="o">-</span><span class="n">coeff</span><span class="p">)),</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>basis_tab<span class="classifier">dict</span></dt><dd><p>Similar to <code class="xref py py-attr docutils literal notranslate"><span class="pre">Cell.basis</span></code>, it <strong>cannot</strong> be a str</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Formated <code class="xref py py-attr docutils literal notranslate"><span class="pre">basis</span></code></p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pbc</span><span class="o">.</span><span class="n">format_basis</span><span class="p">({</span><span class="s1">'H'</span><span class="p">:</span><span class="s1">'gth-szv'</span><span class="p">})</span>
<span class="go">{'H': [[0,</span>
<span class="go">    (8.3744350009, -0.0283380461),</span>
<span class="go">    (1.8058681460, -0.1333810052),</span>
<span class="go">    (0.4852528328, -0.3995676063),</span>
<span class="go">    (0.1658236932, -0.5531027541)]]}</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.format_pseudo">
<span class="sig-name descname"><span class="pre">format_pseudo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pseudo_tab</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.format_pseudo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.format_pseudo" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the input <code class="xref py py-attr docutils literal notranslate"><span class="pre">Cell.pseudo</span></code> (dict) to the internal data format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="n">atom</span><span class="p">:</span> <span class="p">(</span> <span class="p">(</span><span class="n">nelec_s</span><span class="p">,</span> <span class="n">nele_p</span><span class="p">,</span> <span class="n">nelec_d</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
         <span class="n">rloc</span><span class="p">,</span> <span class="n">nexp</span><span class="p">,</span> <span class="p">(</span><span class="n">cexp_1</span><span class="p">,</span> <span class="n">cexp_2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">cexp_nexp</span><span class="p">),</span>
         <span class="n">nproj_types</span><span class="p">,</span>
         <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">nproj1</span><span class="p">,</span> <span class="p">(</span> <span class="p">(</span><span class="n">hproj1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">hproj1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="o">...</span><span class="p">,</span> <span class="n">hproj1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">nproj1</span><span class="p">]),</span>
                        <span class="p">(</span><span class="n">hproj1</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">hproj1</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="o">...</span><span class="p">,</span> <span class="n">hproj1</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">nproj1</span><span class="p">]),</span>
                        <span class="o">...</span>
                        <span class="p">(</span><span class="n">hproj1</span><span class="p">[</span><span class="n">nproj1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">hproj1</span><span class="p">[</span><span class="n">nproj1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="o">...</span>        <span class="p">)</span> <span class="p">)),</span>
         <span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">nproj2</span><span class="p">,</span> <span class="p">(</span> <span class="p">(</span><span class="n">hproj2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">hproj2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="o">...</span><span class="p">,</span> <span class="n">hproj2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">nproj1</span><span class="p">]),</span>
         <span class="o">...</span> <span class="p">)</span> <span class="p">)</span>
         <span class="p">)</span>
 <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>pseudo_tab<span class="classifier">dict</span></dt><dd><p>Similar to <code class="xref py py-attr docutils literal notranslate"><span class="pre">Cell.pseudo</span></code> (a dict), it <strong>cannot</strong> be a str</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Formatted <code class="xref py py-attr docutils literal notranslate"><span class="pre">pseudo</span></code></p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pbc</span><span class="o">.</span><span class="n">format_pseudo</span><span class="p">({</span><span class="s1">'H'</span><span class="p">:</span><span class="s1">'gth-blyp'</span><span class="p">,</span> <span class="s1">'He'</span><span class="p">:</span> <span class="s1">'gth-pade'</span><span class="p">})</span>
<span class="go">{'H': [[1],</span>
<span class="go">    0.2, 2, [-4.19596147, 0.73049821], 0],</span>
<span class="go"> 'He': [[2],</span>
<span class="go">    0.2, 2, [-9.1120234, 1.69836797], 0]}</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.from_ase">
<span class="sig-name descname"><span class="pre">from_ase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ase_atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.from_ase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.from_ase" title="Permalink to this definition">¶</a></dt>
<dd><p>Update cell based on given ase atom object</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ase.lattice</span> <span class="kn">import</span> <span class="n">bulk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span><span class="o">.</span><span class="n">from_ase</span><span class="p">(</span><span class="n">bulk</span><span class="p">(</span><span class="s1">'C'</span><span class="p">,</span> <span class="s1">'diamond'</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">LATTICE_CONST</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.gen_uniform_grids">
<span class="sig-name descname"><span class="pre">gen_uniform_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.gen_uniform_grids" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a uniform real-space grid consistent w/ samp thm; see MH (3.19).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>cell : instance of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>coords<span class="classifier">(ngx*ngy*ngz, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_Gv">
<span class="sig-name descname"><span class="pre">get_Gv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_Gv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate three-dimensional G-vectors for the cell; see MH (3.8).</p>
<p>Indices along each direction go as [0…N-1, -N…-1] to follow FFT convention.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>cell : instance of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>Gv<span class="classifier">(ngrids, 3) ndarray of floats</span></dt><dd><p>The array of G-vectors.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_Gv_weights">
<span class="sig-name descname"><span class="pre">get_Gv_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_Gv_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate G-vectors and weights.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>Gv<span class="classifier">(ngris, 3) ndarray of floats</span></dt><dd><p>The array of G-vectors.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_SI">
<span class="sig-name descname"><span class="pre">get_SI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Gv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_SI" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the structure factor (0D, 1D, 2D, 3D) for all atoms; see MH (3.34).</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a></p>
<dl class="simple">
<dt>Gv<span class="classifier">(N,3) array</span></dt><dd><p>G vectors</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>SI<span class="classifier">(natm, ngrids) ndarray, dtype=np.complex128</span></dt><dd><p>The structure factor for each atom at each G-vector.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_abs_kpts">
<span class="sig-name descname"><span class="pre">get_abs_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scaled_kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.get_abs_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_abs_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get absolute k-points (in 1/Bohr), given “scaled” k-points in
fractions of lattice vectors.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>scaled_kpts : (nkpts, 3) ndarray of floats</p>
</dd>
<dt>Returns:</dt><dd><p>abs_kpts : (nkpts, 3) ndarray of floats</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_bounding_sphere">
<span class="sig-name descname"><span class="pre">get_bounding_sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rcut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_bounding_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all the lattice points within a sphere of radius rcut.</p>
<p>Defines a parallelipiped given by -N_x &lt;= n_x &lt;= N_x, with x in [1,3]
See Martin p. 85</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>rcut<span class="classifier">number</span></dt><dd><p>real space cut-off for interaction</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>cut : ndarray of 3 ints defining N_x</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_ewald_params">
<span class="sig-name descname"><span class="pre">get_ewald_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_ewald_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose a reasonable value of Ewald ‘eta’ and ‘cut’ parameters.
eta^2 is the exponent coefficient of the model Gaussian charge for nucleus
at R:  frac{eta^3}{pi^1.5} e^{-eta^2 (r-R)^2}</p>
<p>Choice is based on largest G vector and desired relative precision.</p>
<p>The relative error in the G-space sum is given by</p>
<blockquote>
<div><p>precision ~ 4pi Gmax^2 e^{(-Gmax^2)/(4 eta^2)}</p>
</div></blockquote>
<p>which determines eta. Then, real-space cutoff is determined by (exp.
factors only)</p>
<blockquote>
<div><p>precision ~ erfc(eta*rcut) / rcut ~ e^{(-eta**2 rcut*2)}</p>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>ew_eta, ew_cut<span class="classifier">float</span></dt><dd><p>The Ewald ‘eta’ and ‘cut’ parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_kpts">
<span class="sig-name descname"><span class="pre">get_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_gamma_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_group_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_reversal_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Given number of kpoints along x,y,z , generate kpoints</p>
<dl class="simple">
<dt>Args:</dt><dd><p>nks : (3,) ndarray</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>wrap_around<span class="classifier">bool</span></dt><dd><p>To ensure all kpts are in first Brillouin zone.</p>
</dd>
<dt>with_gamma_point<span class="classifier">bool</span></dt><dd><p>Whether to shift Monkhorst-pack grid to include gamma-point.</p>
</dd>
<dt>scaled_center<span class="classifier">(3,) array</span></dt><dd><p>Shift all points in the Monkhorst-pack grid to be centered on
scaled_center, given as the zeroth index of the returned kpts.
Scaled meaning that the k-points are scaled to a grid from
[-1,1] x [-1,1] x [-1,1]</p>
</dd>
<dt>space_group_symmetry<span class="classifier">bool</span></dt><dd><p>Whether to consider space group symmetry</p>
</dd>
<dt>time_reversal_symmetry<span class="classifier">bool</span></dt><dd><p>Whether to consider time reversal symmetry</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>kpts in absolute value (unit 1/Bohr).  Gamma point is placed at the
first place in the k-points list;
instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">KPoints</span></code> if k-point symmetry is considered</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_lattice_Ls">
<span class="sig-name descname"><span class="pre">get_lattice_Ls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nimgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_lattice_Ls" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the (Cartesian, unitful) lattice translation vectors for nearby images.
The translation vectors can be used for the lattice summation.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>discard:</dt><dd><p>Drop less important Ls based on AO values on grid</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_nimgs">
<span class="sig-name descname"><span class="pre">get_nimgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_nimgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose number of basis function images in lattice sums
to include for given precision in overlap, using</p>
<p>precision ~ int r^l e^{-alpha r^2} (r-rcut)^l e^{-alpha (r-rcut)^2}
~ (rcut^2/(2alpha))^l e^{alpha/2 rcut^2}</p>
<p>where alpha is the smallest exponent in the basis. Note
that assumes an isolated exponent in the middle of the box, so
it adds one additional lattice vector to be safe.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_scaled_kpts">
<span class="sig-name descname"><span class="pre">get_scaled_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abs_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_in_ibz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.get_scaled_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_scaled_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get scaled k-points, given absolute k-points in 1/Bohr.</p>
<dl>
<dt>Args:</dt><dd><p>abs_kpts : (nkpts, 3) ndarray of floats or <code class="xref py py-class docutils literal notranslate"><span class="pre">KPoints</span></code> object
kpts_in_ibz : bool</p>
<blockquote>
<div><p>If True, return k-points in IBZ; otherwise, return k-points in BZ.
Default value is True. This has effects only if abs_kpts is a
<code class="xref py py-class docutils literal notranslate"><span class="pre">KPoints</span></code> object</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>scaled_kpts : (nkpts, 3) ndarray of floats</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_scaled_positions">
<span class="sig-name descname"><span class="pre">get_scaled_positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.get_scaled_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_scaled_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get scaled atom positions.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.get_uniform_grids">
<span class="sig-name descname"><span class="pre">get_uniform_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.get_uniform_grids" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a uniform real-space grid consistent w/ samp thm; see MH (3.19).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>cell : instance of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>coords<span class="classifier">(ngx*ngy*ngz, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.gs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gs</span></span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.gs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.h">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">h</span></span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.h" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.has_ecp">
<span class="sig-name descname"><span class="pre">has_ecp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.has_ecp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.has_ecp" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether pseudo potential is used in the system.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dump_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parse_arg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ke_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_dim_ft_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_group_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmorphic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup Mole molecule and Cell and initialize some control parameters.
Whenever you change the value of the attributes of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a>,
you need call this function to refresh the internal data of Cell.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>a<span class="classifier">(3,3) ndarray</span></dt><dd><p>The real-space cell lattice vectors. Each row represents
a lattice vector.</p>
</dd>
<dt>mesh<span class="classifier">(3,) ndarray of ints</span></dt><dd><p>The number of <em>positive</em> G-vectors along each direction.</p>
</dd>
<dt>ke_cutoff<span class="classifier">float</span></dt><dd><p>If set, defines a spherical cutoff of planewaves, with .5 * G**2 &lt; ke_cutoff
The default value is estimated based on <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell.precision" title="pyscf.pbc.gto.cell.Cell.precision"><code class="xref py py-attr docutils literal notranslate"><span class="pre">precision</span></code></a></p>
</dd>
<dt>precision<span class="classifier">float</span></dt><dd><p>To control Ewald sums and lattice sums accuracy</p>
</dd>
<dt>nimgs<span class="classifier">(3,) ndarray of ints</span></dt><dd><p>Number of repeated images in lattice summation to produce
periodicity. This value can be estimated based on the required
precision.  It’s recommended NOT making changes to this value.</p>
</dd>
<dt>rcut<span class="classifier">float</span></dt><dd><p>Cutoff radius (unit Bohr) in lattice summation to produce
periodicity. The value can be estimated based on the required
precision.  It’s recommended NOT making changes to this value.</p>
</dd>
<dt>pseudo<span class="classifier">dict or str</span></dt><dd><p>To define pseudopotential.</p>
</dd>
<dt>ecp<span class="classifier">dict or str</span></dt><dd><p>To define ECP type pseudopotential.</p>
</dd>
<dt>h<span class="classifier">(3,3) ndarray</span></dt><dd><p>a.T. Deprecated</p>
</dd>
<dt>dimension<span class="classifier">int</span></dt><dd><p>Default is 3</p>
</dd>
<dt>low_dim_ft_type<span class="classifier">str</span></dt><dd><p>For semi-empirical periodic systems, whether to calculate
integrals at the non-PBC dimension using the sampled mesh grids in
infinity vacuum (inf_vacuum) or truncated Coulomb potential
(analytic_2d_1). Unless explicitly specified, analytic_2d_1 is
used for 2D system and inf_vacuum is assumed for 1D and 0D.</p>
</dd>
<dt>space_group_symmetry<span class="classifier">bool</span></dt><dd><p>Whether to consider space group symmetry. Default is False.</p>
</dd>
<dt>symmorphic<span class="classifier">bool</span></dt><dd><p>Whether the lattice is symmorphic. If set to True, even if the
lattice is non-symmorphic, only symmorphic space group symmetry
will be considered. Default is False, meaning the space group is
determined by the lattice symmetry to be symmorphic or non-symmorphic.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.lattice_vectors">
<span class="sig-name descname"><span class="pre">lattice_vectors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.lattice_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.lattice_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the primitive lattice vectors.</p>
<p>Return 3x3 array in which each row represents one direction of the
lattice vectors (unit in Bohr)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.loads">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molstr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.loads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.loads" title="Permalink to this definition">¶</a></dt>
<dd><p>Deserialize a str containing a JSON document to a Cell object.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.loads_">
<span class="sig-name descname"><span class="pre">loads_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molstr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.loads_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.loads_" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the packed dict to a <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a> object, to generate the
input arguments for <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a> object.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.make_ecp_env">
<span class="sig-name descname"><span class="pre">make_ecp_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_atm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_ecp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.make_ecp_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.make_ecp_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the input arguments _ecpbas for ECP integrals</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.make_kpts">
<span class="sig-name descname"><span class="pre">make_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_gamma_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_group_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_reversal_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.make_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Given number of kpoints along x,y,z , generate kpoints</p>
<dl class="simple">
<dt>Args:</dt><dd><p>nks : (3,) ndarray</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>wrap_around<span class="classifier">bool</span></dt><dd><p>To ensure all kpts are in first Brillouin zone.</p>
</dd>
<dt>with_gamma_point<span class="classifier">bool</span></dt><dd><p>Whether to shift Monkhorst-pack grid to include gamma-point.</p>
</dd>
<dt>scaled_center<span class="classifier">(3,) array</span></dt><dd><p>Shift all points in the Monkhorst-pack grid to be centered on
scaled_center, given as the zeroth index of the returned kpts.
Scaled meaning that the k-points are scaled to a grid from
[-1,1] x [-1,1] x [-1,1]</p>
</dd>
<dt>space_group_symmetry<span class="classifier">bool</span></dt><dd><p>Whether to consider space group symmetry</p>
</dd>
<dt>time_reversal_symmetry<span class="classifier">bool</span></dt><dd><p>Whether to consider time reversal symmetry</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>kpts in absolute value (unit 1/Bohr).  Gamma point is placed at the
first place in the k-points list;
instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">KPoints</span></code> if k-point symmetry is considered</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.mesh">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mesh</span></span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.mesh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.nelec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nelec</span></span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.nelec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.nimgs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nimgs</span></span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.nimgs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.pack">
<span class="sig-name descname"><span class="pre">pack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Pack the input args of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a> to a dict, which can be serialized
with <code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.pbc_eval_ao">
<span class="sig-name descname"><span class="pre">pbc_eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.pbc_eval_ao" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate PBC-AO function value on the given grids,</p>
<dl>
<dt>Args:</dt><dd><p>eval_name : str</p>
<blockquote>
<div><table>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Expression</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>“GTOval_sph”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id17"><span class="problematic" id="id18">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_sph”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id19"><span class="problematic" id="id20">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-even"><td><p>“GTOval_cart”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id21"><span class="problematic" id="id22">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_cart”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id23"><span class="problematic" id="id24">|</span></a>AO&gt;</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="simple">
<dt>atm<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>bas<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>env<span class="classifier">float64 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of the grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in cell will be evaluated.</p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">dft.gen_grid.make_mask()</span></code></p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>AO values smaller than cutoff will be set to zero. The default
cutoff threshold is ~1e-22 (defined in gto/grid_ao_drv.h)</p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>If provided, results are written into this array.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list of 2D (or 3D) arrays to hold the AO values on grids.  Each
element of the list corresponds to a k-point and it has the shape
(N,nao) Or shape (*,N,nao).</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">'He 1 1 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_uniform_grids</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1000, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_ig_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 1000, 2)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.pbc_eval_gto">
<span class="sig-name descname"><span class="pre">pbc_eval_gto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.pbc_eval_gto" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate PBC-AO function value on the given grids,</p>
<dl>
<dt>Args:</dt><dd><p>eval_name : str</p>
<blockquote>
<div><table>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Expression</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>“GTOval_sph”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id25"><span class="problematic" id="id26">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_sph”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id27"><span class="problematic" id="id28">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-even"><td><p>“GTOval_cart”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id29"><span class="problematic" id="id30">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_cart”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id31"><span class="problematic" id="id32">|</span></a>AO&gt;</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="simple">
<dt>atm<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>bas<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>env<span class="classifier">float64 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of the grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in cell will be evaluated.</p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">dft.gen_grid.make_mask()</span></code></p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>AO values smaller than cutoff will be set to zero. The default
cutoff threshold is ~1e-22 (defined in gto/grid_ao_drv.h)</p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>If provided, results are written into this array.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list of 2D (or 3D) arrays to hold the AO values on grids.  Each
element of the list corresponds to a k-point and it has the shape
(N,nao) Or shape (*,N,nao).</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">'He 1 1 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_uniform_grids</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1000, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_ig_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 1000, 2)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.pbc_intor">
<span class="sig-name descname"><span class="pre">pbc_intor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.pbc_intor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.pbc_intor" title="Permalink to this definition">¶</a></dt>
<dd><p>One-electron integrals with PBC.</p>
<div class="math notranslate nohighlight">
\[\sum_T \int \mu(r) * [intor] * \nu (r-T) dr\]</div>
<p>See also Mole.intor</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.precision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.rcut">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rcut</span></span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.rcut" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.reciprocal_vectors">
<span class="sig-name descname"><span class="pre">reciprocal_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.reciprocal_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.reciprocal_vectors" title="Permalink to this definition">¶</a></dt>
<dd><div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{b_1} &amp;= 2\pi \frac{\mathbf{a_2} \times \mathbf{a_3}}{\mathbf{a_1} \cdot (\mathbf{a_2} \times \mathbf{a_3})} \\
\mathbf{b_2} &amp;= 2\pi \frac{\mathbf{a_3} \times \mathbf{a_1}}{\mathbf{a_2} \cdot (\mathbf{a_3} \times \mathbf{a_1})} \\
\mathbf{b_3} &amp;= 2\pi \frac{\mathbf{a_1} \times \mathbf{a_2}}{\mathbf{a_3} \cdot (\mathbf{a_1} \times \mathbf{a_2})}
\end{align}\end{split}\]</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.symmetrize_mesh">
<span class="sig-name descname"><span class="pre">symmetrize_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.symmetrize_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.symmetrize_mesh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.to_mol">
<span class="sig-name descname"><span class="pre">to_mol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.to_mol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.to_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Mole object using the same atoms and basis functions as
the Cell object.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.tot_electrons">
<span class="sig-name descname"><span class="pre">tot_electrons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nkpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.tot_electrons" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of electrons</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.unpack">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unpack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moldic</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.unpack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the packed dict to a <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a> object, to generate the
input arguments for <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a> object.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.unpack_">
<span class="sig-name descname"><span class="pre">unpack_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moldic</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#Cell.unpack_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.unpack_" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the packed dict to a <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a> object, to generate the
input arguments for <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a> object.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.Cell.vol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vol</span></span><a class="headerlink" href="#pyscf.pbc.gto.cell.Cell.vol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.M">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">M</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#M"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.M" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a shortcut to build up Cell object.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.pbc</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">'He 1 1 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.bas_rcut">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">bas_rcut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bas_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#bas_rcut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.bas_rcut" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the largest distance between the function and its image to
reach the precision in overlap</p>
<p>precision ~ int g(r-0) g(r-Rcut)</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.classify_ecp_pseudo">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">classify_ecp_pseudo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#classify_ecp_pseudo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.classify_ecp_pseudo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.conc_cell">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">conc_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#conc_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.conc_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate two Cell objects.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.copy">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Deepcopy of the given <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a> object</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.dumps">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">dumps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#dumps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.dumps" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialize Cell object to a JSON formatted str.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.energy_nuc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">energy_nuc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ew_eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ew_cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.energy_nuc" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform real (R) and reciprocal (G) space Ewald sum for the energy.</p>
<p>Formulation of Martin, App. F2.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>float</dt><dd><p>The Ewald energy consisting of overlap, self, and G-space sum.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.pbc.gto.get_ewald_params</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.error_for_ke_cutoff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">error_for_ke_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ke_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#error_for_ke_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.error_for_ke_cutoff" title="Permalink to this definition">¶</a></dt>
<dd><p>Error estimation based on nuclear attraction integrals</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.estimate_ke_cutoff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">estimate_ke_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#estimate_ke_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.estimate_ke_cutoff" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy cutoff estimation for nuclear attraction integrals</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.estimate_rcut">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">estimate_rcut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#estimate_rcut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.estimate_rcut" title="Permalink to this definition">¶</a></dt>
<dd><p>Lattice-sum cutoff for the entire system</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.ewald">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">ewald</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ew_eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ew_cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#ewald"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.ewald" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform real (R) and reciprocal (G) space Ewald sum for the energy.</p>
<p>Formulation of Martin, App. F2.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>float</dt><dd><p>The Ewald energy consisting of overlap, self, and G-space sum.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.pbc.gto.get_ewald_params</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.format_basis">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">format_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_tab</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#format_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.format_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the input <code class="xref py py-attr docutils literal notranslate"><span class="pre">Cell.basis</span></code> to the internal data format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="n">atom</span><span class="p">:</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="p">((</span><span class="o">-</span><span class="n">exp</span><span class="p">,</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">c_2</span><span class="p">,</span> <span class="o">..</span><span class="p">),</span> <span class="n">nprim</span><span class="p">,</span> <span class="n">nctr</span><span class="p">,</span> <span class="n">ptr</span><span class="o">-</span><span class="n">exps</span><span class="p">,</span> <span class="n">ptr</span><span class="o">-</span><span class="n">contraction</span><span class="o">-</span><span class="n">coeff</span><span class="p">)),</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>basis_tab<span class="classifier">dict</span></dt><dd><p>Similar to <code class="xref py py-attr docutils literal notranslate"><span class="pre">Cell.basis</span></code>, it <strong>cannot</strong> be a str</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Formated <code class="xref py py-attr docutils literal notranslate"><span class="pre">basis</span></code></p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pbc</span><span class="o">.</span><span class="n">format_basis</span><span class="p">({</span><span class="s1">'H'</span><span class="p">:</span><span class="s1">'gth-szv'</span><span class="p">})</span>
<span class="go">{'H': [[0,</span>
<span class="go">    (8.3744350009, -0.0283380461),</span>
<span class="go">    (1.8058681460, -0.1333810052),</span>
<span class="go">    (0.4852528328, -0.3995676063),</span>
<span class="go">    (0.1658236932, -0.5531027541)]]}</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.format_pseudo">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">format_pseudo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pseudo_tab</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#format_pseudo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.format_pseudo" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the input <code class="xref py py-attr docutils literal notranslate"><span class="pre">Cell.pseudo</span></code> (dict) to the internal data format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="n">atom</span><span class="p">:</span> <span class="p">(</span> <span class="p">(</span><span class="n">nelec_s</span><span class="p">,</span> <span class="n">nele_p</span><span class="p">,</span> <span class="n">nelec_d</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
         <span class="n">rloc</span><span class="p">,</span> <span class="n">nexp</span><span class="p">,</span> <span class="p">(</span><span class="n">cexp_1</span><span class="p">,</span> <span class="n">cexp_2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">cexp_nexp</span><span class="p">),</span>
         <span class="n">nproj_types</span><span class="p">,</span>
         <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">nproj1</span><span class="p">,</span> <span class="p">(</span> <span class="p">(</span><span class="n">hproj1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">hproj1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="o">...</span><span class="p">,</span> <span class="n">hproj1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">nproj1</span><span class="p">]),</span>
                        <span class="p">(</span><span class="n">hproj1</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">hproj1</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="o">...</span><span class="p">,</span> <span class="n">hproj1</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">nproj1</span><span class="p">]),</span>
                        <span class="o">...</span>
                        <span class="p">(</span><span class="n">hproj1</span><span class="p">[</span><span class="n">nproj1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">hproj1</span><span class="p">[</span><span class="n">nproj1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="o">...</span>        <span class="p">)</span> <span class="p">)),</span>
         <span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">nproj2</span><span class="p">,</span> <span class="p">(</span> <span class="p">(</span><span class="n">hproj2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">hproj2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="o">...</span><span class="p">,</span> <span class="n">hproj2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">nproj1</span><span class="p">]),</span>
         <span class="o">...</span> <span class="p">)</span> <span class="p">)</span>
         <span class="p">)</span>
 <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>pseudo_tab<span class="classifier">dict</span></dt><dd><p>Similar to <code class="xref py py-attr docutils literal notranslate"><span class="pre">Cell.pseudo</span></code> (a dict), it <strong>cannot</strong> be a str</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Formatted <code class="xref py py-attr docutils literal notranslate"><span class="pre">pseudo</span></code></p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pbc</span><span class="o">.</span><span class="n">format_pseudo</span><span class="p">({</span><span class="s1">'H'</span><span class="p">:</span><span class="s1">'gth-blyp'</span><span class="p">,</span> <span class="s1">'He'</span><span class="p">:</span> <span class="s1">'gth-pade'</span><span class="p">})</span>
<span class="go">{'H': [[1],</span>
<span class="go">    0.2, 2, [-4.19596147, 0.73049821], 0],</span>
<span class="go"> 'He': [[2],</span>
<span class="go">    0.2, 2, [-9.1120234, 1.69836797], 0]}</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.gen_uniform_grids">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">gen_uniform_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.cell.gen_uniform_grids" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a uniform real-space grid consistent w/ samp thm; see MH (3.19).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>cell : instance of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>coords<span class="classifier">(ngx*ngy*ngz, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.get_Gv">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">get_Gv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#get_Gv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.get_Gv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate three-dimensional G-vectors for the cell; see MH (3.8).</p>
<p>Indices along each direction go as [0…N-1, -N…-1] to follow FFT convention.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>cell : instance of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>Gv<span class="classifier">(ngrids, 3) ndarray of floats</span></dt><dd><p>The array of G-vectors.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.get_Gv_weights">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">get_Gv_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#get_Gv_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.get_Gv_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate G-vectors and weights.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>Gv<span class="classifier">(ngris, 3) ndarray of floats</span></dt><dd><p>The array of G-vectors.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.get_SI">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">get_SI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#get_SI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.get_SI" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the structure factor (0D, 1D, 2D, 3D) for all atoms; see MH (3.34).</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a></p>
<dl class="simple">
<dt>Gv<span class="classifier">(N,3) array</span></dt><dd><p>G vectors</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>SI<span class="classifier">(natm, ngrids) ndarray, dtype=np.complex128</span></dt><dd><p>The structure factor for each atom at each G-vector.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.get_bounding_sphere">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">get_bounding_sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#get_bounding_sphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.get_bounding_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all the lattice points within a sphere of radius rcut.</p>
<p>Defines a parallelipiped given by -N_x &lt;= n_x &lt;= N_x, with x in [1,3]
See Martin p. 85</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>rcut<span class="classifier">number</span></dt><dd><p>real space cut-off for interaction</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>cut : ndarray of 3 ints defining N_x</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.get_ewald_params">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">get_ewald_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#get_ewald_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.get_ewald_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose a reasonable value of Ewald ‘eta’ and ‘cut’ parameters.
eta^2 is the exponent coefficient of the model Gaussian charge for nucleus
at R:  frac{eta^3}{pi^1.5} e^{-eta^2 (r-R)^2}</p>
<p>Choice is based on largest G vector and desired relative precision.</p>
<p>The relative error in the G-space sum is given by</p>
<blockquote>
<div><p>precision ~ 4pi Gmax^2 e^{(-Gmax^2)/(4 eta^2)}</p>
</div></blockquote>
<p>which determines eta. Then, real-space cutoff is determined by (exp.
factors only)</p>
<blockquote>
<div><p>precision ~ erfc(eta*rcut) / rcut ~ e^{(-eta**2 rcut*2)}</p>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>ew_eta, ew_cut<span class="classifier">float</span></dt><dd><p>The Ewald ‘eta’ and ‘cut’ parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.get_nimgs">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">get_nimgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#get_nimgs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.get_nimgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose number of basis function images in lattice sums
to include for given precision in overlap, using</p>
<p>precision ~ int r^l e^{-alpha r^2} (r-rcut)^l e^{-alpha (r-rcut)^2}
~ (rcut^2/(2alpha))^l e^{alpha/2 rcut^2}</p>
<p>where alpha is the smallest exponent in the basis. Note
that assumes an isolated exponent in the middle of the box, so
it adds one additional lattice vector to be safe.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.get_uniform_grids">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">get_uniform_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#get_uniform_grids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.get_uniform_grids" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a uniform real-space grid consistent w/ samp thm; see MH (3.19).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>cell : instance of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>coords<span class="classifier">(ngx*ngy*ngz, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.intor_cross">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">intor_cross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#intor_cross"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.intor_cross" title="Permalink to this definition">¶</a></dt>
<dd><p>1-electron integrals from two cells like</p>
<div class="math notranslate nohighlight">
\[\langle \mu | intor | \nu \rangle, \mu \in cell1, \nu \in cell2\]</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.loads">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">loads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cellstr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#loads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.loads" title="Permalink to this definition">¶</a></dt>
<dd><p>Deserialize a str containing a JSON document to a Cell object.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.make_kpts">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">make_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_gamma_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_group_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_reversal_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#make_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.make_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Given number of kpoints along x,y,z , generate kpoints</p>
<dl class="simple">
<dt>Args:</dt><dd><p>nks : (3,) ndarray</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>wrap_around<span class="classifier">bool</span></dt><dd><p>To ensure all kpts are in first Brillouin zone.</p>
</dd>
<dt>with_gamma_point<span class="classifier">bool</span></dt><dd><p>Whether to shift Monkhorst-pack grid to include gamma-point.</p>
</dd>
<dt>scaled_center<span class="classifier">(3,) array</span></dt><dd><p>Shift all points in the Monkhorst-pack grid to be centered on
scaled_center, given as the zeroth index of the returned kpts.
Scaled meaning that the k-points are scaled to a grid from
[-1,1] x [-1,1] x [-1,1]</p>
</dd>
<dt>space_group_symmetry<span class="classifier">bool</span></dt><dd><p>Whether to consider space group symmetry</p>
</dd>
<dt>time_reversal_symmetry<span class="classifier">bool</span></dt><dd><p>Whether to consider time reversal symmetry</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>kpts in absolute value (unit 1/Bohr).  Gamma point is placed at the
first place in the k-points list;
instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">KPoints</span></code> if k-point symmetry is considered</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.make_pseudo_env">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">make_pseudo_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_atm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_pseudo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#make_pseudo_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.make_pseudo_env" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.pack">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">pack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#pack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Pack the input args of <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a> to a dict, which can be serialized
with <code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.tot_electrons">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">tot_electrons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#tot_electrons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.tot_electrons" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of electrons</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.cell.unpack">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.cell.</span></span><span class="sig-name descname"><span class="pre">unpack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">celldic</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/cell.html#unpack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.cell.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the packed dict to a <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a> object, to generate the
input arguments for <a class="reference internal" href="#pyscf.pbc.gto.cell.Cell" title="pyscf.pbc.gto.cell.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></a> object.</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.gto.ecp">
<span id="pyscf-pbc-gto-ecp-module"></span><h2 id="module-pyscf.pbc.gto.ecp">pyscf.pbc.gto.ecp module<a class="headerlink" href="#module-pyscf.pbc.gto.ecp" title="Permalink to this heading">¶</a></h2>
<p>Short range part of ECP under PBC</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.ecp.ecp_int">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.ecp.</span></span><span class="sig-name descname"><span class="pre">ecp_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/ecp.html#ecp_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.ecp.ecp_int" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.pbc.gto.eval_gto">
<span id="pyscf-pbc-gto-eval-gto-module"></span><h2 id="module-pyscf.pbc.gto.eval_gto">pyscf.pbc.gto.eval_gto module<a class="headerlink" href="#module-pyscf.pbc.gto.eval_gto" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.eval_gto.eval_gto">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.eval_gto.</span></span><span class="sig-name descname"><span class="pre">eval_gto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/eval_gto.html#eval_gto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.eval_gto.eval_gto" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate PBC-AO function value on the given grids,</p>
<dl>
<dt>Args:</dt><dd><p>eval_name : str</p>
<blockquote>
<div><table>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Expression</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>“GTOval_sph”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id33"><span class="problematic" id="id34">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_sph”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id35"><span class="problematic" id="id36">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-even"><td><p>“GTOval_cart”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id37"><span class="problematic" id="id38">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_cart”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id39"><span class="problematic" id="id40">|</span></a>AO&gt;</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="simple">
<dt>atm<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>bas<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>env<span class="classifier">float64 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of the grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in cell will be evaluated.</p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">dft.gen_grid.make_mask()</span></code></p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>AO values smaller than cutoff will be set to zero. The default
cutoff threshold is ~1e-22 (defined in gto/grid_ao_drv.h)</p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>If provided, results are written into this array.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list of 2D (or 3D) arrays to hold the AO values on grids.  Each
element of the list corresponds to a k-point and it has the shape
(N,nao) Or shape (*,N,nao).</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">'He 1 1 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_uniform_grids</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1000, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_ig_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 1000, 2)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.eval_gto.get_lattice_Ls">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.eval_gto.</span></span><span class="sig-name descname"><span class="pre">get_lattice_Ls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/gto/eval_gto.html#get_lattice_Ls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.gto.eval_gto.get_lattice_Ls" title="Permalink to this definition">¶</a></dt>
<dd><p>Get lattice-sum vectors for eval_gto</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.gto.eval_gto.pbc_eval_gto">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.gto.eval_gto.</span></span><span class="sig-name descname"><span class="pre">pbc_eval_gto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.gto.eval_gto.pbc_eval_gto" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate PBC-AO function value on the given grids,</p>
<dl>
<dt>Args:</dt><dd><p>eval_name : str</p>
<blockquote>
<div><table>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Expression</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>“GTOval_sph”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id41"><span class="problematic" id="id42">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_sph”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id43"><span class="problematic" id="id44">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-even"><td><p>“GTOval_cart”</p></td>
<td><p>sum_T exp(ik*T) <a href="#id45"><span class="problematic" id="id46">|</span></a>AO&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>“GTOval_ip_cart”</p></td>
<td><p>nabla sum_T exp(ik*T) <a href="#id47"><span class="problematic" id="id48">|</span></a>AO&gt;</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="simple">
<dt>atm<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>bas<span class="classifier">int32 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>env<span class="classifier">float64 ndarray</span></dt><dd><p>libcint integral function argument</p>
</dd>
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of the grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in cell will be evaluated.</p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">dft.gen_grid.make_mask()</span></code></p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>AO values smaller than cutoff will be set to zero. The default
cutoff threshold is ~1e-22 (defined in gto/grid_ao_drv.h)</p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>If provided, results are written into this array.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list of 2D (or 3D) arrays to hold the AO values on grids.  Each
element of the list corresponds to a k-point and it has the shape
(N,nao) Or shape (*,N,nao).</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">'He 1 1 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_uniform_grids</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1000, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">pbc_eval_gto</span><span class="p">(</span><span class="s2">"GTOval_ig_sph"</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ao_value</span><span class="p">)</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 1000, 2)</span>
</pre></div>
</div>
</dd></dl>
</section>
<section id="module-pyscf.pbc.gto">
<span id="module-contents"></span><h2 id="module-pyscf.pbc.gto">Module contents<a class="headerlink" href="#module-pyscf.pbc.gto" title="Permalink to this heading">¶</a></h2>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="pyscf.pbc.grad.html" title="pyscf.pbc.grad package"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> pyscf.pbc.grad package </span>
              </div>
            </a>
          
          
            <a href="pyscf.pbc.gto.basis.html" title="pyscf.pbc.gto.basis package"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> pyscf.pbc.gto.basis package </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>