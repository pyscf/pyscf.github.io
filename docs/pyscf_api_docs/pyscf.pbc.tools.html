
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pyscf.pbc.tools package &#8212; PySCF</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf-pst.css?v=ed6b5f64" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=67920a36"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pyscf_api_docs/pyscf.pbc.tools';</script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.10" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-64x64.png" class="logo__image only-light" alt=""/>
    <img src="../_static/logo-64x64.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">PySCF</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pyscf.adc.html">pyscf.adc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.agf2.html">pyscf.agf2 package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.ao2mo.html">pyscf.ao2mo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.cc.html">pyscf.cc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.ci.html">pyscf.ci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.data.html">pyscf.data package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.df.html">pyscf.df package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.grad.html">pyscf.df.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.hessian.html">pyscf.df.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.dft.html">pyscf.dft package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.dft.xc.html">pyscf.dft.xc package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.eph.html">pyscf.eph package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.fci.html">pyscf.fci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.geomopt.html">pyscf.geomopt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.grad.html">pyscf.grad package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.gto.html">pyscf.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.gto.basis.html">pyscf.gto.basis package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.gto.basis.dyall-basis.html">pyscf.gto.basis.dyall-basis package</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.gw.html">pyscf.gw package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.hessian.html">pyscf.hessian package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.lib.html">pyscf.lib package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.lo.html">pyscf.lo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mcpdft.html">pyscf.mcpdft package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mcscf.html">pyscf.mcscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mp.html">pyscf.mp package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mrpt.html">pyscf.mrpt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.nac.html">pyscf.nac package</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="pyscf.pbc.html">pyscf.pbc package</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.adc.html">pyscf.pbc.adc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ao2mo.html">pyscf.pbc.ao2mo package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.cc.html">pyscf.pbc.cc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ci.html">pyscf.pbc.ci package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.df.html">pyscf.pbc.df package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.pbc.dft.html">pyscf.pbc.dft package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html">pyscf.pbc.dft.multigrid package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.eph.html">pyscf.pbc.eph package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.geomopt.html">pyscf.pbc.geomopt package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.grad.html">pyscf.pbc.grad package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.pbc.gto.html">pyscf.pbc.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html">pyscf.pbc.gto.basis package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html">pyscf.pbc.gto.pseudo package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gw.html">pyscf.pbc.gw package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.lib.html">pyscf.pbc.lib package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mp.html">pyscf.pbc.mp package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpicc.html">pyscf.pbc.mpicc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpitools.html">pyscf.pbc.mpitools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.scf.html">pyscf.pbc.scf package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.symm.html">pyscf.pbc.symm package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tddft.html">pyscf.pbc.tddft package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tdscf.html">pyscf.pbc.tdscf package</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">pyscf.pbc.tools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.x2c.html">pyscf.pbc.x2c package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.qmmm.html">pyscf.qmmm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.scf.html">pyscf.scf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.sgx.html">pyscf.sgx package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.solvent.html">pyscf.solvent package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.grad.html">pyscf.solvent.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.hessian.html">pyscf.solvent.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.soscf.html">pyscf.soscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.symm.html">pyscf.symm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tddft.html">pyscf.tddft package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tdscf.html">pyscf.tdscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tools.html">pyscf.tools package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.x2c.html">pyscf.x2c package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">pyscf.pbc.tools package</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pyscf-pbc-tools-package">
<h1>pyscf.pbc.tools package<a class="headerlink" href="#pyscf-pbc-tools-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-pyscf.pbc.tools.k2gamma">
<span id="pyscf-pbc-tools-k2gamma-module"></span><h2>pyscf.pbc.tools.k2gamma module<a class="headerlink" href="#module-pyscf.pbc.tools.k2gamma" title="Link to this heading">#</a></h2>
<p>Convert the k-sampled MO/integrals to corresponding Gamma-point supercell
MO/integrals.</p>
<p>Zhihao Cui &lt;<a class="reference external" href="mailto:zcui&#37;&#52;&#48;caltech&#46;edu">zcui<span>&#64;</span>caltech<span>&#46;</span>edu</a>&gt;
Qiming Sun &lt;<a class="reference external" href="mailto:osirpt&#46;sun&#37;&#52;&#48;gmail&#46;com">osirpt<span>&#46;</span>sun<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<p>See also the original implementation at
<a class="github reference external" href="https://github.com/zhcui/local-orbital-and-cdft/blob/master/k2gamma.py">zhcui/local-orbital-and-cdft</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.double_translation_indices">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">double_translation_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kmesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#double_translation_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.double_translation_indices" title="Link to this definition">#</a></dt>
<dd><p>Indices to utilize the translation symmetry in the 2D matrix.</p>
<p>D[M,N] = D[N-M]</p>
<p>The return index maps the 2D subscripts to 1D subscripts.</p>
<p>D2 = D1[double_translation_indices()]</p>
<p>D1 holds all the symmetry unique elements in D2</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.get_phase">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">get_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#get_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.get_phase" title="Link to this definition">#</a></dt>
<dd><p>The unitary transformation that transforms the supercell basis k-mesh
adapted basis.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.k2gamma">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">k2gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kmf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#k2gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.k2gamma" title="Link to this definition">#</a></dt>
<dd><p>convert the k-sampled mean-field object to the corresponding supercell
gamma-point mean-field object.</p>
<dl class="simple">
<dt>math:</dt><dd><p>C_{nu ‘ n’} = C_{vecRmu, veck m} = frac{1}{sqrt{N_{UC}}}
e^{ii veckcdotvecR} C^{veck}_{mu  m}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.kpts_to_kmesh">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">kpts_to_kmesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#kpts_to_kmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.kpts_to_kmesh" title="Link to this definition">#</a></dt>
<dd><p>Find the minimal k-points mesh to include all input kpts</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.mo_k2gamma">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">mo_k2gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#mo_k2gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.mo_k2gamma" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.to_supercell_ao_integrals">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">to_supercell_ao_integrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_ints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#to_supercell_ao_integrals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.to_supercell_ao_integrals" title="Link to this definition">#</a></dt>
<dd><p>Transform from the unitcell k-point AO integrals to the supercell
gamma-point AO integrals.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.to_supercell_mo_integrals">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">to_supercell_mo_integrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kmf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_ints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#to_supercell_mo_integrals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.to_supercell_mo_integrals" title="Link to this definition">#</a></dt>
<dd><p>Transform from the unitcell k-point MO integrals to the supercell
gamma-point MO integrals.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.translation_map">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">translation_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#translation_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.translation_map" title="Link to this definition">#</a></dt>
<dd><p>Generate
[0    1 .. n  ]
[n    0 .. n-1]
[n-1  n .. n-2]
[…  …  …]
[1    2 .. 0  ]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.translation_vectors_for_kmesh">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">translation_vectors_for_kmesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#translation_vectors_for_kmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.translation_vectors_for_kmesh" title="Link to this definition">#</a></dt>
<dd><p>Translation vectors to construct super-cell of which the gamma point is
identical to the k-point mesh of primitive cell</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.tools.lattice">
<span id="pyscf-pbc-tools-lattice-module"></span><h2>pyscf.pbc.tools.lattice module<a class="headerlink" href="#module-pyscf.pbc.tools.lattice" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_alkali_halide">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_alkali_halide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Li'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Cl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_alkali_halide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_alkali_halide" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_atom">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_atom" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_diamond_cubic">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_diamond_cubic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_diamond_cubic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_diamond_cubic" title="Link to this definition">#</a></dt>
<dd><p>Get the ASE atoms for cubic (8-atom) diamond unit cell.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_diamond_primitive">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_diamond_primitive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_diamond_primitive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_diamond_primitive" title="Link to this definition">#</a></dt>
<dd><p>Get the ASE atoms for primitive (2-atom) diamond unit cell.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_graphene">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_graphene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_graphene"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_graphene" title="Link to this definition">#</a></dt>
<dd><p>Get the ASE atoms for primitive (2-atom) graphene unit cell.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_graphene_xxx">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_graphene_xxx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_graphene_xxx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_graphene_xxx" title="Link to this definition">#</a></dt>
<dd><p>Get the ASE atoms for primitive (2-atom) graphene unit cell.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_rocksalt">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_rocksalt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Li'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Cl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_rocksalt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_rocksalt" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_wurtzite">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_wurtzite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Zn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'O'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_wurtzite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_wurtzite" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_zincblende">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_zincblende</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ga'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'As'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_zincblende"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_zincblende" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_bandpath_fcc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_bandpath_fcc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ase_atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_bandpath_fcc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_bandpath_fcc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.pbc.tools.make_test_cell">
<span id="pyscf-pbc-tools-make-test-cell-module"></span><h2>pyscf.pbc.tools.make_test_cell module<a class="headerlink" href="#module-pyscf.pbc.tools.make_test_cell" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.make_cell">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">make_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#make_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.make_cell" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_cu_metallic">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_cu_metallic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[9,</span> <span class="pre">9,</span> <span class="pre">9]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_cu_metallic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_cu_metallic" title="Link to this definition">#</a></dt>
<dd><p>Copper unit cell w/ special basis giving non-equal number of occupied orbitals per k-point</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_n0">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_n0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[9,</span> <span class="pre">9,</span> <span class="pre">9]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_n0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_n0" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_n1">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_n1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[9,</span> <span class="pre">9,</span> <span class="pre">9]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_n1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_n1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_n2">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_n2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[9,</span> <span class="pre">9,</span> <span class="pre">9]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_n2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_n2" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_n3">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_n3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[9,</span> <span class="pre">9,</span> <span class="pre">9]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_n3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_n3" title="Link to this definition">#</a></dt>
<dd><p>Take ASE Diamond structure, input into PySCF and run</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_n3_diffuse">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_n3_diffuse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_n3_diffuse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_n3_diffuse" title="Link to this definition">#</a></dt>
<dd><p>Take ASE Diamond structure, input into PySCF and run</p>
</dd></dl>

</section>
<section id="module-pyscf.pbc.tools.pbc">
<span id="pyscf-pbc-tools-pbc-module"></span><h2>pyscf.pbc.tools.pbc module<a class="headerlink" href="#module-pyscf.pbc.tools.pbc" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.cell_plus_imgs">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">cell_plus_imgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimgs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#cell_plus_imgs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.cell_plus_imgs" title="Link to this definition">#</a></dt>
<dd><p>Create a supercell via nimgs[i] in each +/- direction, as in get_lattice_Ls().
Note this function differs from <a class="reference internal" href="#pyscf.pbc.tools.pbc.super_cell" title="pyscf.pbc.tools.pbc.super_cell"><code class="xref py py-func docutils literal notranslate"><span class="pre">super_cell()</span></code></a> that super_cell only
stacks the images in + direction.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code>
nimgs : (3,) array</p>
</dd>
<dt>Returns:</dt><dd><p>supcell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.check_lattice_sum_range">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">check_lattice_sum_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#check_lattice_sum_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.check_lattice_sum_range" title="Link to this definition">#</a></dt>
<dd><p>Evaluates whether the lattice summation range is sufficient.</p>
<p>This function calculates the minimum distance between atoms in the primary
unit cell and atoms in lattice images <em>not</em> included in the specified
lattice sum vectors (Ls).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.cutoff_to_gs">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">cutoff_to_gs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#cutoff_to_gs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.cutoff_to_gs" title="Link to this definition">#</a></dt>
<dd><p>Deprecated.  Replaced by function cutoff_to_mesh.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.cutoff_to_mesh">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">cutoff_to_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#cutoff_to_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.cutoff_to_mesh" title="Link to this definition">#</a></dt>
<dd><p>Convert KE cutoff to FFT-mesh</p>
<blockquote>
<div><p>uses KE = k^2 / 2, where k_max ~ pi / grid_spacing</p>
</div></blockquote>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>a<span class="classifier">(3,3) ndarray</span></dt><dd><p>The real-space cell lattice vectors. Each row represents a
lattice vector.</p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>KE energy cutoff in a.u.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>mesh : (3,) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.fft">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.fft" title="Link to this definition">#</a></dt>
<dd><p>Perform the 3D FFT from real (R) to reciprocal (G) space.</p>
<p>After FFT, (u, v, w) -&gt; (j, k, l).
(jkl) is in the index order of Gv.</p>
<p>FFT normalization factor is 1., as in MH and in <cite>numpy.fft</cite>.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>f<span class="classifier">(nx*ny*nz,) ndarray</span></dt><dd><p>The function to be FFT’d, flattened to a 1D array corresponding
to the index order of <code class="xref py py-func docutils literal notranslate"><span class="pre">cartesian_prod()</span></code>.</p>
</dd>
<dt>mesh<span class="classifier">(3,) ndarray of ints (= nx,ny,nz)</span></dt><dd><p>The number G-vectors along each direction.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>(nx*ny*nz,) ndarray</dt><dd><p>The FFT 1D array in same index order as Gv (natural order of
numpy.fft).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.fftk">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">fftk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expmikr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#fftk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.fftk" title="Link to this definition">#</a></dt>
<dd><p>Perform the 3D FFT of a real-space function which is (periodic*e^{ikr}).</p>
<p>fk(k+G) = sum_r fk(r) e^{-i(k+G)r} = sum_r [f(k)e^{-ikr}] e^{-iGr}</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.get_coulG">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">get_coulG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#get_coulG"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.get_coulG" title="Link to this definition">#</a></dt>
<dd><p>Calculate the Coulomb kernel for all G-vectors, handling G=0 and exchange.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>k<span class="classifier">(3,) ndarray</span></dt><dd><p>k-point</p>
</dd>
<dt>exx<span class="classifier">bool or str</span></dt><dd><p>Whether this is an exchange matrix element</p>
</dd>
</dl>
<p>mf : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>coulG<span class="classifier">(ngrids,) ndarray</span></dt><dd><p>The Coulomb kernel.</p>
</dd>
<dt>mesh<span class="classifier">(3,) ndarray of ints (= nx,ny,nz)</span></dt><dd><p>The number G-vectors along each direction.</p>
</dd>
<dt>omega<span class="classifier">float</span></dt><dd><p>Enable Coulomb kernel <code class="docutils literal notranslate"><span class="pre">erf(|omega|*r12)/r12</span></code> if omega &gt; 0
and <code class="docutils literal notranslate"><span class="pre">erfc(|omega|*r12)/r12</span></code> if omega &lt; 0.
Note this parameter is slightly different to setting cell.omega for
exxdiv=’ewald’ at G0. When cell.omega is configured, the Ewald probe
charge correction will be computed using the LR or SR Coulomb
interactions. However, when this kwarg is explicitly specified, the
exxdiv correction is computed with the full-range Coulomb
interaction (1/r12). This parameter should only be specified in the
range-separated JK builder and range-separated DF (and other
range-separated integral methods if any).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.get_lattice_Ls">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">get_lattice_Ls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#get_lattice_Ls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.get_lattice_Ls" title="Link to this definition">#</a></dt>
<dd><p>Get the (Cartesian, unitful) lattice translation vectors for nearby images.
The translation vectors can be used for the lattice summation.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>discard:</dt><dd><p>Drop less important Ls based on AO values on grid</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.get_monkhorst_pack_size">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">get_monkhorst_pack_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#get_monkhorst_pack_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.get_monkhorst_pack_size" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.gs_to_cutoff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">gs_to_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#gs_to_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.gs_to_cutoff" title="Link to this definition">#</a></dt>
<dd><p>Deprecated.  Replaced by function mesh_to_cutoff.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.ifft">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">ifft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#ifft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.ifft" title="Link to this definition">#</a></dt>
<dd><p>Perform the 3D inverse FFT from reciprocal (G) space to real (R) space.</p>
<p>Inverse FFT normalization factor is 1./N, same as in <cite>numpy.fft</cite> but
<strong>different</strong> from MH (they use 1.).</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>g<span class="classifier">(nx*ny*nz,) ndarray</span></dt><dd><p>The function to be inverse FFT’d, flattened to a 1D array
corresponding to the index order of <cite>span3</cite>.</p>
</dd>
<dt>mesh<span class="classifier">(3,) ndarray of ints (= nx,ny,nz)</span></dt><dd><p>The number G-vectors along each direction.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>(nx*ny*nz,) ndarray</dt><dd><p>The inverse FFT 1D array in same index order as Gv (natural order
of numpy.fft).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.ifftk">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">ifftk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expikr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#ifftk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.ifftk" title="Link to this definition">#</a></dt>
<dd><p>Perform the 3D inverse FFT of f(k+G) into a function which is (periodic*e^{ikr}).</p>
<p>fk(r) = (1/Ng) sum_G fk(k+G) e^{i(k+G)r} = (1/Ng) sum_G [fk(k+G)e^{iGr}] e^{ikr}</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.madelung">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">madelung</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#madelung"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.madelung" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.mesh_to_cutoff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">mesh_to_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#mesh_to_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.mesh_to_cutoff" title="Link to this definition">#</a></dt>
<dd><p>Convert #grid points to KE cutoff</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.precompute_exx">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">precompute_exx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#precompute_exx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.precompute_exx" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.round_to_cell0">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">round_to_cell0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#round_to_cell0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.round_to_cell0" title="Link to this definition">#</a></dt>
<dd><p>Round scaled coordinates to reference unit cell</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.super_cell">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">super_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncopy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#super_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.super_cell" title="Link to this definition">#</a></dt>
<dd><p>Create an ncopy[0] x ncopy[1] x ncopy[2] supercell of the input cell
Note this function differs from <a class="reference internal" href="#pyscf.pbc.tools.pbc.cell_plus_imgs" title="pyscf.pbc.tools.pbc.cell_plus_imgs"><code class="xref py py-func docutils literal notranslate"><span class="pre">cell_plus_imgs()</span></code></a> that cell_plus_imgs
creates images in both +/- direction.</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<p>ncopy : (3,) array</p>
<dl class="simple">
<dt>wrap_around<span class="classifier">bool</span></dt><dd><p>Put the original cell centered on the super cell. It has the
effects corresponding to the parameter wrap_around of
cell.make_kpts.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>supcell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.pbc.tools.print_funcs">
<span id="pyscf-pbc-tools-print-funcs-module"></span><h2>pyscf.pbc.tools.print_funcs module<a class="headerlink" href="#module-pyscf.pbc.tools.print_funcs" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.print_funcs.print_mo_energy_occ">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.print_funcs.</span></span><span class="sig-name descname"><span class="pre">print_mo_energy_occ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_uhf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/print_funcs.html#print_mo_energy_occ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.print_funcs.print_mo_energy_occ" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.print_funcs.print_mo_energy_occ_kpts">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.print_funcs.</span></span><span class="sig-name descname"><span class="pre">print_mo_energy_occ_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_uhf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/print_funcs.html#print_mo_energy_occ_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.print_funcs.print_mo_energy_occ_kpts" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="pyscf-pbc-tools-pyscf-ase-module">
<h2>pyscf.pbc.tools.pyscf_ase module<a class="headerlink" href="#pyscf-pbc-tools-pyscf-ase-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-pbc-tools-pywannier90-module">
<h2>pyscf.pbc.tools.pywannier90 module<a class="headerlink" href="#pyscf-pbc-tools-pywannier90-module" title="Link to this heading">#</a></h2>
</section>
<section id="module-pyscf.pbc.tools.tril">
<span id="pyscf-pbc-tools-tril-module"></span><h2>pyscf.pbc.tools.tril module<a class="headerlink" href="#module-pyscf.pbc.tools.tril" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.tril.tril_index">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.tril.</span></span><span class="sig-name descname"><span class="pre">tril_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ki</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/tril.html#tril_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.tril.tril_index" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.tril.unpack_tril">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.tril.</span></span><span class="sig-name descname"><span class="pre">unpack_tril</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/tril.html#unpack_tril"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.tril.unpack_tril" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.pbc.tools">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyscf.pbc.tools" title="Link to this heading">#</a></h2>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.tools.k2gamma">pyscf.pbc.tools.k2gamma module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.k2gamma.double_translation_indices"><code class="docutils literal notranslate"><span class="pre">double_translation_indices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.k2gamma.get_phase"><code class="docutils literal notranslate"><span class="pre">get_phase()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.k2gamma.k2gamma"><code class="docutils literal notranslate"><span class="pre">k2gamma()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.k2gamma.kpts_to_kmesh"><code class="docutils literal notranslate"><span class="pre">kpts_to_kmesh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.k2gamma.mo_k2gamma"><code class="docutils literal notranslate"><span class="pre">mo_k2gamma()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.k2gamma.to_supercell_ao_integrals"><code class="docutils literal notranslate"><span class="pre">to_supercell_ao_integrals()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.k2gamma.to_supercell_mo_integrals"><code class="docutils literal notranslate"><span class="pre">to_supercell_mo_integrals()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.k2gamma.translation_map"><code class="docutils literal notranslate"><span class="pre">translation_map()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.k2gamma.translation_vectors_for_kmesh"><code class="docutils literal notranslate"><span class="pre">translation_vectors_for_kmesh()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.tools.lattice">pyscf.pbc.tools.lattice module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.lattice.get_ase_alkali_halide"><code class="docutils literal notranslate"><span class="pre">get_ase_alkali_halide()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.lattice.get_ase_atom"><code class="docutils literal notranslate"><span class="pre">get_ase_atom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.lattice.get_ase_diamond_cubic"><code class="docutils literal notranslate"><span class="pre">get_ase_diamond_cubic()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.lattice.get_ase_diamond_primitive"><code class="docutils literal notranslate"><span class="pre">get_ase_diamond_primitive()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.lattice.get_ase_graphene"><code class="docutils literal notranslate"><span class="pre">get_ase_graphene()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.lattice.get_ase_graphene_xxx"><code class="docutils literal notranslate"><span class="pre">get_ase_graphene_xxx()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.lattice.get_ase_rocksalt"><code class="docutils literal notranslate"><span class="pre">get_ase_rocksalt()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.lattice.get_ase_wurtzite"><code class="docutils literal notranslate"><span class="pre">get_ase_wurtzite()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.lattice.get_ase_zincblende"><code class="docutils literal notranslate"><span class="pre">get_ase_zincblende()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.lattice.get_bandpath_fcc"><code class="docutils literal notranslate"><span class="pre">get_bandpath_fcc()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.tools.make_test_cell">pyscf.pbc.tools.make_test_cell module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.make_test_cell.make_cell"><code class="docutils literal notranslate"><span class="pre">make_cell()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.make_test_cell.test_cell_cu_metallic"><code class="docutils literal notranslate"><span class="pre">test_cell_cu_metallic()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.make_test_cell.test_cell_n0"><code class="docutils literal notranslate"><span class="pre">test_cell_n0()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.make_test_cell.test_cell_n1"><code class="docutils literal notranslate"><span class="pre">test_cell_n1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.make_test_cell.test_cell_n2"><code class="docutils literal notranslate"><span class="pre">test_cell_n2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.make_test_cell.test_cell_n3"><code class="docutils literal notranslate"><span class="pre">test_cell_n3()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.make_test_cell.test_cell_n3_diffuse"><code class="docutils literal notranslate"><span class="pre">test_cell_n3_diffuse()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.tools.pbc">pyscf.pbc.tools.pbc module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.cell_plus_imgs"><code class="docutils literal notranslate"><span class="pre">cell_plus_imgs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.check_lattice_sum_range"><code class="docutils literal notranslate"><span class="pre">check_lattice_sum_range()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.cutoff_to_gs"><code class="docutils literal notranslate"><span class="pre">cutoff_to_gs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.cutoff_to_mesh"><code class="docutils literal notranslate"><span class="pre">cutoff_to_mesh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.fft"><code class="docutils literal notranslate"><span class="pre">fft()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.fftk"><code class="docutils literal notranslate"><span class="pre">fftk()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.get_coulG"><code class="docutils literal notranslate"><span class="pre">get_coulG()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.get_lattice_Ls"><code class="docutils literal notranslate"><span class="pre">get_lattice_Ls()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.get_monkhorst_pack_size"><code class="docutils literal notranslate"><span class="pre">get_monkhorst_pack_size()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.gs_to_cutoff"><code class="docutils literal notranslate"><span class="pre">gs_to_cutoff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.ifft"><code class="docutils literal notranslate"><span class="pre">ifft()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.ifftk"><code class="docutils literal notranslate"><span class="pre">ifftk()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.madelung"><code class="docutils literal notranslate"><span class="pre">madelung()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.mesh_to_cutoff"><code class="docutils literal notranslate"><span class="pre">mesh_to_cutoff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.precompute_exx"><code class="docutils literal notranslate"><span class="pre">precompute_exx()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.round_to_cell0"><code class="docutils literal notranslate"><span class="pre">round_to_cell0()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.pbc.super_cell"><code class="docutils literal notranslate"><span class="pre">super_cell()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.tools.print_funcs">pyscf.pbc.tools.print_funcs module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.print_funcs.print_mo_energy_occ"><code class="docutils literal notranslate"><span class="pre">print_mo_energy_occ()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.print_funcs.print_mo_energy_occ_kpts"><code class="docutils literal notranslate"><span class="pre">print_mo_energy_occ_kpts()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-pbc-tools-pyscf-ase-module">pyscf.pbc.tools.pyscf_ase module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-pbc-tools-pywannier90-module">pyscf.pbc.tools.pywannier90 module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.tools.tril">pyscf.pbc.tools.tril module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.tril.tril_index"><code class="docutils literal notranslate"><span class="pre">tril_index()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.pbc.tools.tril.unpack_tril"><code class="docutils literal notranslate"><span class="pre">unpack_tril()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.pbc.tools">Module contents</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/pyscf/pyscf.github.io/edit/master/source/pyscf_api_docs/pyscf.pbc.tools.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, The PySCF Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>