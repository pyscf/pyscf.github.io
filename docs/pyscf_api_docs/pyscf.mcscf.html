<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>pyscf.mcscf package &#8212; PySCF</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf.css?v=9b431c29" />
    <script src="../_static/documentation_options.js?v=3c4615cf"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pyscf.md package" href="pyscf.md.html" />
    <link rel="prev" title="pyscf.lo package" href="pyscf.lo.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=pyscf data-md-color-accent=pyscf>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#pyscf_api_docs/pyscf.mcscf" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="PySCF"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.5</span>
          <span class="md-header-nav__topic"> pyscf.mcscf package </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../quickstart.html" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../develop.html" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../about.html" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="pyscf.html" class="md-tabs__link">pyscf package</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="PySCF" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="PySCF">PySCF 2.5</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../install.html" class="md-nav__link">Install PySCF</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#advanced-build-options" class="md-nav__link">Advanced build options</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#install-pyscf-extensions" class="md-nav__link">Install PySCF extensions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#troubleshooting" class="md-nav__link">Troubleshooting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickstart.html" class="md-nav__link">Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../user.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html" class="md-nav__link">API</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#subpackages" class="md-nav__link">Subpackages</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#submodules" class="md-nav__link">Submodules</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf.post_scf" class="md-nav__link">pyscf.post_scf module</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf" class="md-nav__link">Module contents</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about.html" class="md-nav__link">About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#pyscf-api-docs-pyscf-mcscf--page-root" class="md-nav__link">pyscf.mcscf package</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#submodules" class="md-nav__link">Submodules</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.PiOS" class="md-nav__link">pyscf.mcscf.PiOS module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.Atoms_w_Coords" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Atoms_w_Coords()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.FindValenceAoIndices" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">FindValenceAoIndices()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.GetCovalentRadius" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">GetCovalentRadius()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.GetNumPiElec" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">GetNumPiElec()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.GetPzOrientation" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">GetPzOrientation()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.MakeIaosRaw" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">MakeIaosRaw()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.MakeOverlappingOrbSubspace" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">MakeOverlappingOrbSubspace()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.MakePiOS" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">MakePiOS()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.MakePiSystemOrbitals" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">MakePiSystemOrbitals()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.MakePzMinaoVectors" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">MakePzMinaoVectors()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.MakeShells" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">MakeShells()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.MakeShellsForElement" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">MakeShellsForElement()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.MakeSmh" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">MakeSmh()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.SemiCanonicalize" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SemiCanonicalize()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.mdot" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">mdot()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.PiOS.rmsd" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">rmsd()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.addons" class="md-nav__link">pyscf.mcscf.addons module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.approx_kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.approx_kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.make_rdm12s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.make_rdm12s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.states_make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.states_make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm12s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.states_make_rdm12s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.states_make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.states_trans_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.states_trans_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.trans_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.trans_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageFCISolver.undo_state_average" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageFCISolver.undo_state_average()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMCSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMCSCF</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMCSCF.Gradients" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMCSCF.Gradients()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMCSCF.NACs" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMCSCF.NACs()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMCSCF.e_average" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMCSCF.e_average</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMCSCF.e_states" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMCSCF.e_states</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMCSCF.nac_method" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMCSCF.nac_method()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMCSCF.nuc_grad_method" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMCSCF.nuc_grad_method()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMCSCF.undo_state_average" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMCSCF.undo_state_average()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMCSCF.weights" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMCSCF.weights</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMCSCFSolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMCSCFSolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMCSCFSolver.Gradients" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMCSCFSolver.Gradients()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.approx_kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.approx_kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.large_ci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.large_ci</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm12s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.make_rdm12s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.spin_square" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.spin_square</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.states_make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.states_make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm12s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.states_make_rdm12s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.states_make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.states_trans_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.states_trans_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.trans_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.trans_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.transform_ci_for_orbital_rotation" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.transform_ci_for_orbital_rotation</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver.undo_state_average" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver.undo_state_average()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver_solver_args" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver_solver_args</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateAverageMixFCISolver_state_args" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateAverageMixFCISolver_state_args</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateSpecificFCISolver" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateSpecificFCISolver</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateSpecificFCISolver.approx_kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateSpecificFCISolver.approx_kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateSpecificFCISolver.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateSpecificFCISolver.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.StateSpecificFCISolver.undo_state_specific" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">StateSpecificFCISolver.undo_state_specific()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.cas_natorb" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cas_natorb()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.caslst_by_irrep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">caslst_by_irrep()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.get_fock" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_fock()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.get_spin_square" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_spin_square()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.make_natural_orbitals" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_natural_orbitals()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.make_rdm12" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm12()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.make_spin_casdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">make_spin_casdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.map2hf" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">map2hf()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.project_init_guess" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">project_init_guess()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.project_init_guess_old" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">project_init_guess_old()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.select_mo_by_irrep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">select_mo_by_irrep()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.sort_mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">sort_mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.sort_mo_by_irrep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">sort_mo_by_irrep()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.spin_square" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">spin_square()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.state_average" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">state_average()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.state_average_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">state_average_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.state_average_mix" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">state_average_mix()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.state_average_mix_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">state_average_mix_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.state_specific" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">state_specific()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.addons.state_specific_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">state_specific_()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.apc" class="md-nav__link">pyscf.mcscf.apc module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.apc.APC" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">APC</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.apc.APC.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">APC.kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.apc.Chooser" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Chooser</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.apc.Chooser.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Chooser.kernel()</span></code></a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.avas" class="md-nav__link">pyscf.mcscf.avas module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.avas.AVAS" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AVAS</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.avas.AVAS.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AVAS.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.avas.AVAS.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AVAS.kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.avas.avas" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">avas()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.avas.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.casci" class="md-nav__link">pyscf.mcscf.casci module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.analyze" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.analyze()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.ao2mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.ao2mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.canonicalization" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.canonicalization</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.canonicalize" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.canonicalize()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.canonicalize_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.canonicalize_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.cas_natorb" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.cas_natorb()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.cas_natorb_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.cas_natorb_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.casci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.casci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.check_sanity" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.check_sanity()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.density_fit" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.density_fit()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.energy_nuc" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.energy_nuc()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.fix_spin" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.fix_spin()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.fix_spin_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.fix_spin_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.get_fock" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.get_fock()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.get_h1cas" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.get_h1cas()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.get_h1eff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.get_h1eff()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.get_h2cas" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.get_h2cas()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.get_h2eff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.get_h2eff()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.get_hcore" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.get_hcore()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.get_jk" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.get_jk()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.get_veff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.get_veff()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.h1e_for_cas" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.h1e_for_cas()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.natorb" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.natorb</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.ncore" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.ncore</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.nuc_grad_method" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.nuc_grad_method()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.reset" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.reset()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.sfx2c1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.sfx2c1e()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.sort_mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.sort_mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.sorting_mo_energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.sorting_mo_energy</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.state_average" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.state_average()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.state_average_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.state_average_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.state_specific_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.state_specific_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.x2c" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.x2c()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASBase.x2c1e" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASBase.x2c1e()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASCI</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASCI.Gradients" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASCI.Gradients()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASCI.as_scanner" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASCI.as_scanner()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASCI.casci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASCI.casci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASCI.get_h2eff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASCI.get_h2eff()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASCI.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASCI.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASCI.nuc_grad_method" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASCI.nuc_grad_method()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.CASCI_Scanner" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASCI_Scanner</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.analyze" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">analyze()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.as_scanner" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">as_scanner()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.canonicalize" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">canonicalize()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.cas_natorb" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cas_natorb()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.get_fock" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_fock()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.h1e_for_cas" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">h1e_for_cas()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.casci_symm" class="md-nav__link">pyscf.mcscf.casci_symm module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci_symm.CASCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci_symm.SymAdaptedCASCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASCI</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci_symm.SymAdaptedCASCI.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASCI.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci_symm.SymAdaptedCASCI.sort_mo_by_irrep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASCI.sort_mo_by_irrep()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci_symm.SymAdaptedCASCI.wfnsym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASCI.wfnsym</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci_symm.eig" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">eig()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.casci_symm.label_symmetry_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">label_symmetry_()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.chkfile" class="md-nav__link">pyscf.mcscf.chkfile module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.chkfile.dump_mcscf" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">dump_mcscf()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.chkfile.load_mcscf" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">load_mcscf()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.df" class="md-nav__link">pyscf.mcscf.df module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.df.approx_hessian" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">approx_hessian()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.df.density_fit" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">density_fit()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.df.prange" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">prange()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.dmet_cas" class="md-nav__link">pyscf.mcscf.dmet_cas module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.dmet_cas.dmet_cas" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">dmet_cas()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.dmet_cas.guess_cas" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">guess_cas()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.dmet_cas.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.dmet_cas.search_for_degeneracy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">search_for_degeneracy()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.dmet_cas.symmetrize" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">symmetrize()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.mc1step" class="md-nav__link">pyscf.mcscf.mc1step module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.Gradients" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.Gradients()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ah_conv_tol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ah_conv_tol</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ah_grad_trust_region" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ah_grad_trust_region</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ah_level_shift" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ah_level_shift</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ah_lindep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ah_lindep</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ah_max_cycle" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ah_max_cycle</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ah_scheduler" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ah_scheduler()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ah_start_cycle" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ah_start_cycle</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ah_start_tol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ah_start_tol</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ao2mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ao2mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ao2mo_level" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ao2mo_level</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.approx_hessian" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.approx_hessian()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.as_scanner" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.as_scanner()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.callback" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.callback</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.canonicalization" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.canonicalization</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.casci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.casci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.chk_ci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.chk_ci</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ci_grad_trust_region" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ci_grad_trust_region</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ci_response_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ci_response_space</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.ci_update_dep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.ci_update_dep</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.conv_tol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.conv_tol</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.conv_tol_grad" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.conv_tol_grad</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.dump_chk" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.dump_chk()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.extrasym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.extrasym</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.gen_g_hop" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.gen_g_hop()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.get_grad" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.get_grad()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.get_h2eff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.get_h2eff()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.grad_update_dep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.grad_update_dep</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.internal_rotation" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.internal_rotation</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.kf_interval" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.kf_interval</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.kf_trust_region" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.kf_trust_region</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.max_cycle" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.max_cycle</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.max_cycle_macro" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.max_cycle_macro</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.max_cycle_micro" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.max_cycle_micro</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.max_orb_stepsize" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.max_orb_stepsize</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.max_stepsize" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.max_stepsize</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.max_stepsize_scheduler" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.max_stepsize_scheduler()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.mc1step" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.mc1step()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.mc2step" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.mc2step()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.micro_cycle_scheduler" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.micro_cycle_scheduler()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.natorb" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.natorb</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.newton" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.newton()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.nuc_grad_method" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.nuc_grad_method()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.pack_uniq_var" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.pack_uniq_var()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.reset" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.reset()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.rotate_mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.rotate_mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.rotate_orb_cc" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.rotate_orb_cc()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.scale_restoration" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.scale_restoration</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.small_rot_tol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.small_rot_tol</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.solve_approx_ci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.solve_approx_ci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.sorting_mo_energy" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.sorting_mo_energy</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.uniq_var_indices" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.uniq_var_indices()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.unpack_uniq_var" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.unpack_uniq_var()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.update" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.update()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.update_ao2mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.update_ao2mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.update_casdm" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.update_casdm()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.update_from_chk" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.update_from_chk()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.update_jk_in_ah" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.update_jk_in_ah()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.update_rotate_matrix" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.update_rotate_matrix()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF.with_dep4" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.with_dep4</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.CASSCF_Scanner" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF_Scanner</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.as_scanner" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">as_scanner()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.expmat" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">expmat()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.gen_g_hop" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_g_hop()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.max_stepsize_scheduler" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">max_stepsize_scheduler()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step.rotate_orb_cc" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">rotate_orb_cc()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.mc1step_symm" class="md-nav__link">pyscf.mcscf.mc1step_symm module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step_symm.CASSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASSCF</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASSCF.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.mc1step" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASSCF.mc1step()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.mc2step" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASSCF.mc2step()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.newton" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASSCF.newton()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.rotate_mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASSCF.rotate_mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.sort_mo_by_irrep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASSCF.sort_mo_by_irrep()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.uniq_var_indices" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASSCF.uniq_var_indices()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.wfnsym" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SymAdaptedCASSCF.wfnsym</span></code></a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.mc2step" class="md-nav__link">pyscf.mcscf.mc2step module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc2step.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.mc_ao2mo" class="md-nav__link">pyscf.mcscf.mc_ao2mo module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc_ao2mo.prange" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">prange()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc_ao2mo.trans_e1_incore" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_e1_incore()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.mc_ao2mo.trans_e1_outcore" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_e1_outcore()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.newton_casscf" class="md-nav__link">pyscf.mcscf.newton_casscf module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf.CASSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf.CASSCF.casci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.casci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf.CASSCF.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf.CASSCF.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf.CASSCF.update_ao2mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.update_ao2mo()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf.extract_rotation" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">extract_rotation()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf.gen_g_hop" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_g_hop()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf.update_orb_ci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">update_orb_ci()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.newton_casscf_symm" class="md-nav__link">pyscf.mcscf.newton_casscf_symm module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf_symm.CASSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf_symm.CASSCF.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf_symm.CASSCF.rotate_mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.rotate_mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton_casscf_symm.CASSCF.uniq_var_indices" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF.uniq_var_indices()</span></code></a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.ucasci" class="md-nav__link">pyscf.mcscf.ucasci module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.CASCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASCI</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.analyze" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.analyze()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.cas_natorb" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.cas_natorb()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.cas_natorb_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.cas_natorb_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.check_sanity" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.check_sanity()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.fix_spin" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.fix_spin()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.fix_spin_" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.fix_spin_()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.get_h1eff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.get_h1eff()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.get_hcore" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.get_hcore()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.get_veff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.get_veff()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.make_rdm1" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.make_rdm1()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.make_rdm1s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.make_rdm1s()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.ncore" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.ncore</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.sort_mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.sort_mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASBase.spin_square" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASBase.spin_square()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASCI</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASCI.as_scanner" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASCI.as_scanner()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASCI.casci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASCI.casci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASCI.get_h2eff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASCI.get_h2eff()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.UCASCI.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASCI.kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.extract_orbs" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">extract_orbs()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.h1e_for_cas" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">h1e_for_cas()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.ucasci.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.umc1step" class="md-nav__link">pyscf.mcscf.umc1step module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.CASSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.ah_conv_tol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.ah_conv_tol</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.ah_grad_trust_region" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.ah_grad_trust_region</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.ah_level_shift" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.ah_level_shift</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.ah_lindep" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.ah_lindep</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.ah_max_cycle" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.ah_max_cycle</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.ah_start_cycle" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.ah_start_cycle</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.ah_start_tol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.ah_start_tol</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.ao2mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.ao2mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.approx_cas_integral" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.approx_cas_integral()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.as_scanner" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.as_scanner()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.callback" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.callback</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.casci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.casci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.chk_ci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.chk_ci</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.ci_response_space" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.ci_response_space</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.conv_tol" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.conv_tol</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.conv_tol_grad" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.conv_tol_grad</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.dump_chk" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.dump_chk()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.dump_flags" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.dump_flags()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.gen_g_hop" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.gen_g_hop()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.get_h2eff" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.get_h2eff()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.internal_rotation" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.internal_rotation</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.kernel()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.kf_interval" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.kf_interval</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.kf_trust_region" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.kf_trust_region</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.max_cycle_macro" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.max_cycle_macro</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.max_cycle_micro" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.max_cycle_micro</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.max_orb_stepsize" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.max_orb_stepsize</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.max_stepsize" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.max_stepsize</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.max_stepsize_scheduler" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.max_stepsize_scheduler()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.mc1step" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.mc1step()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.mc2step" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.mc2step()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.micro_cycle_scheduler" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.micro_cycle_scheduler()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.natorb" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.natorb</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.pack_uniq_var" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.pack_uniq_var()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.reset" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.reset()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.rotate_mo" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.rotate_mo()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.rotate_orb_cc" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.rotate_orb_cc()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.solve_approx_ci" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.solve_approx_ci()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.uniq_var_indices" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.uniq_var_indices()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.unpack_uniq_var" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.unpack_uniq_var()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.update_casdm" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.update_casdm()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.update_jk_in_ah" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.update_jk_in_ah()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.update_rotate_matrix" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.update_rotate_matrix()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.UCASSCF.with_dep4" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF.with_dep4</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.gen_g_hop" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">gen_g_hop()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc1step.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.umc2step" class="md-nav__link">pyscf.mcscf.umc2step module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc2step.kernel" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf.umc_ao2mo" class="md-nav__link">pyscf.mcscf.umc_ao2mo module</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc_ao2mo.trans_e1_incore" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_e1_incore()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.umc_ao2mo.trans_e1_outcore" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">trans_e1_outcore()</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.mcscf" class="md-nav__link">Module contents</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pyscf.mcscf.CASCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASCI()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.CASSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">CASSCF()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.DFCASCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFCASCI()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.DFCASSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DFCASSCF()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.RCASCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RCASCI()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.RCASSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">RCASSCF()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.UCASCI" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASCI()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.UCASSCF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">UCASSCF()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.density_fit" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">density_fit()</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#pyscf.mcscf.newton" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">newton()</span></code></a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/pyscf_api_docs/pyscf.mcscf.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="pyscf-mcscf-package">
<h1 id="pyscf-api-docs-pyscf-mcscf--page-root">pyscf.mcscf package<a class="headerlink" href="#pyscf-api-docs-pyscf-mcscf--page-root" title="Link to this heading"></a></h1>
<section id="submodules">
<h2 id="submodules">Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-pyscf.mcscf.PiOS">
<span id="pyscf-mcscf-pios-module"></span><h2 id="module-pyscf.mcscf.PiOS">pyscf.mcscf.PiOS module<a class="headerlink" href="#module-pyscf.mcscf.PiOS" title="Link to this heading"></a></h2>
<p>When using results of this code for publications, please cite the following paper:
Constructing molecular pi-orbital active spaces for multireference calculations of conjugated systems</p>
<blockquote>
<div><ol class="upperalpha simple" start="5">
<li><ol class="upperalpha simple" start="18">
<li><p>Sayfutyarova and S. Hammes-Schiffer, J. Chem. Theory Comput., 15, 1679 (2019).</p></li>
</ol>
</li>
</ol>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.Atoms_w_Coords">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">Atoms_w_Coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#Atoms_w_Coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.Atoms_w_Coords" title="Link to this definition"></a></dt>
<dd><p>collect info about atoms positions</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.FindValenceAoIndices">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">FindValenceAoIndices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iAt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Shells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TargetL</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#FindValenceAoIndices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.FindValenceAoIndices" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.GetCovalentRadius">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">GetCovalentRadius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">At</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#GetCovalentRadius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.GetCovalentRadius" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.GetNumPiElec">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">GetNumPiElec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iAt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#GetNumPiElec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.GetNumPiElec" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.GetPzOrientation">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">GetPzOrientation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iTargetAtoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Coords_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Elements_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#GetPzOrientation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.GetPzOrientation" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.MakeIaosRaw">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">MakeIaosRaw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">COcc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#MakeIaosRaw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.MakeIaosRaw" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.MakeOverlappingOrbSubspace">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">MakeOverlappingOrbSubspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">COrb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nOrbExpected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CTargetIb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fock</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#MakeOverlappingOrbSubspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.MakeOverlappingOrbSubspace" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.MakePiOS">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">MakePiOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PiAtomsList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nPiOcc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nPiVirt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#MakePiOS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.MakePiOS" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.MakePiSystemOrbitals">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">MakePiSystemOrbitals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TargetName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iTargetAtomsForPlane_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iTargetAtomsForBasis_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CIb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Shells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">COcc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CVir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#MakePiSystemOrbitals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.MakePiSystemOrbitals" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.MakePzMinaoVectors">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">MakePzMinaoVectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iTargetAtoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vPz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Shells</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#MakePzMinaoVectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.MakePzMinaoVectors" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.MakeShells">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">MakeShells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Elements</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#MakeShells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.MakeShells" title="Link to this definition"></a></dt>
<dd><p>collect MINAO basis set data for all elements</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.MakeShellsForElement">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">MakeShellsForElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#MakeShellsForElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.MakeShellsForElement" title="Link to this definition"></a></dt>
<dd><p>make a list with MINAO basis set data for a given element in the mol object</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.MakeSmh">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">MakeSmh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#MakeSmh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.MakeSmh" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.SemiCanonicalize">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">SemiCanonicalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">COut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#SemiCanonicalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.SemiCanonicalize" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.mdot">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">mdot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#mdot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.mdot" title="Link to this definition"></a></dt>
<dd><p>chained matrix product: mdot(A,B,C,..) = A*B*C*
No attempt is made to optimize the contraction order.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.PiOS.rmsd">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.PiOS.</span></span><span class="sig-name descname"><span class="pre">rmsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/PiOS.html#rmsd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.PiOS.rmsd" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf.addons">
<span id="pyscf-mcscf-addons-module"></span><h2 id="module-pyscf.mcscf.addons">pyscf.mcscf.addons module<a class="headerlink" href="#module-pyscf.mcscf.addons" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">StateAverageFCISolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcibase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.approx_kernel">
<span class="sig-name descname"><span class="pre">approx_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.approx_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.approx_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.dump_flags" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.make_rdm1" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.make_rdm12">
<span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.make_rdm12" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.make_rdm12s">
<span class="sig-name descname"><span class="pre">make_rdm12s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.make_rdm12s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.make_rdm12s" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.make_rdm1s">
<span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.make_rdm1s" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm1">
<span class="sig-name descname"><span class="pre">states_make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.states_make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm1" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm12">
<span class="sig-name descname"><span class="pre">states_make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.states_make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm12" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm12s">
<span class="sig-name descname"><span class="pre">states_make_rdm12s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.states_make_rdm12s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm12s" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm1s">
<span class="sig-name descname"><span class="pre">states_make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.states_make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.states_make_rdm1s" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.states_trans_rdm12">
<span class="sig-name descname"><span class="pre">states_trans_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.states_trans_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.states_trans_rdm12" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.trans_rdm12">
<span class="sig-name descname"><span class="pre">trans_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.trans_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.trans_rdm12" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageFCISolver.undo_state_average">
<span class="sig-name descname"><span class="pre">undo_state_average</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageFCISolver.undo_state_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageFCISolver.undo_state_average" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMCSCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">StateAverageMCSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">my_mc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcisolver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMCSCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMCSCF" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.addons.StateAverageMCSCFSolver" title="pyscf.mcscf.addons.StateAverageMCSCFSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateAverageMCSCFSolver</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMCSCF.Gradients">
<span class="sig-name descname"><span class="pre">Gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMCSCF.Gradients" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMCSCF.NACs">
<span class="sig-name descname"><span class="pre">NACs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMCSCF.NACs" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMCSCF.e_average">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_average</span></span><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMCSCF.e_average" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMCSCF.e_states">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_states</span></span><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMCSCF.e_states" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMCSCF.nac_method">
<span class="sig-name descname"><span class="pre">nac_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMCSCF.nac_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMCSCF.nac_method" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMCSCF.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMCSCF.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMCSCF.nuc_grad_method" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMCSCF.undo_state_average">
<span class="sig-name descname"><span class="pre">undo_state_average</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMCSCF.undo_state_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMCSCF.undo_state_average" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMCSCF.weights">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weights</span></span><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMCSCF.weights" title="Link to this definition"></a></dt>
<dd><p>I want these to be accessible but not separable from fcisolver.weights</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMCSCFSolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">StateAverageMCSCFSolver</span></span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMCSCFSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMCSCFSolver" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMCSCFSolver.Gradients">
<span class="sig-name descname"><span class="pre">Gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMCSCFSolver.Gradients" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">StateAverageMixFCISolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcisolvers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.addons.StateAverageFCISolver" title="pyscf.mcscf.addons.StateAverageFCISolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateAverageFCISolver</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.approx_kernel">
<span class="sig-name descname"><span class="pre">approx_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.approx_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.approx_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.large_ci">
<span class="sig-name descname"><span class="pre">large_ci</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.large_ci" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm1" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm12">
<span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm12" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm12s">
<span class="sig-name descname"><span class="pre">make_rdm12s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.make_rdm12s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm12s" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm1s">
<span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.make_rdm1s" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.spin_square">
<span class="sig-name descname"><span class="pre">spin_square</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.spin_square" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm1">
<span class="sig-name descname"><span class="pre">states_make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.states_make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm1" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm12">
<span class="sig-name descname"><span class="pre">states_make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.states_make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm12" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm12s">
<span class="sig-name descname"><span class="pre">states_make_rdm12s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.states_make_rdm12s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm12s" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm1s">
<span class="sig-name descname"><span class="pre">states_make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.states_make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.states_make_rdm1s" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.states_trans_rdm12">
<span class="sig-name descname"><span class="pre">states_trans_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.states_trans_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.states_trans_rdm12" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.trans_rdm12">
<span class="sig-name descname"><span class="pre">trans_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.trans_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.trans_rdm12" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.transform_ci_for_orbital_rotation">
<span class="sig-name descname"><span class="pre">transform_ci_for_orbital_rotation</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.transform_ci_for_orbital_rotation" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver.undo_state_average">
<span class="sig-name descname"><span class="pre">undo_state_average</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver.undo_state_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver.undo_state_average" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver_solver_args">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">StateAverageMixFCISolver_solver_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver_solver_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver_solver_args" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateAverageMixFCISolver_state_args">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">StateAverageMixFCISolver_state_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateAverageMixFCISolver_state_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateAverageMixFCISolver_state_args" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.addons.StateAverageMixFCISolver_solver_args" title="pyscf.mcscf.addons.StateAverageMixFCISolver_solver_args"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateAverageMixFCISolver_solver_args</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateSpecificFCISolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">StateSpecificFCISolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcibase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateSpecificFCISolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateSpecificFCISolver" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateSpecificFCISolver.approx_kernel">
<span class="sig-name descname"><span class="pre">approx_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateSpecificFCISolver.approx_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateSpecificFCISolver.approx_kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateSpecificFCISolver.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateSpecificFCISolver.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateSpecificFCISolver.kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.StateSpecificFCISolver.undo_state_specific">
<span class="sig-name descname"><span class="pre">undo_state_specific</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#StateSpecificFCISolver.undo_state_specific"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.StateSpecificFCISolver.undo_state_specific" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.cas_natorb">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">cas_natorb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#cas_natorb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.cas_natorb" title="Link to this definition"></a></dt>
<dd><p>Natural orbitals in CAS space</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.caslst_by_irrep">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">caslst_by_irrep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cas_irrep_nocc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cas_irrep_ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#caslst_by_irrep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.caslst_by_irrep" title="Link to this definition"></a></dt>
<dd><p>Given number of active orbitals for each irrep, return the orbital
indices of active space</p>
<dl>
<dt>Args:</dt><dd><p>casscf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">CASSCF</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">CASCI</span></code> object</p>
<dl class="simple">
<dt>cas_irrep_nocc<span class="classifier">list or dict</span></dt><dd><p>Number of active orbitals for each irrep.  It can be a dict, eg
{A1: 2, B2: 4} to indicate the active space size based on
irrep names, or {0: 2, 3: 4} for irrep Id,  or a list [2, 0, 0, 4]
(identical to {0: 2, 3: 4}) in which the list index is served as
the irrep Id.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>cas_irrep_ncore<span class="classifier">list or dict</span></dt><dd><p>Number of closed shells for each irrep.  It can be a dict, eg
{A1: 6, B2: 4} to indicate the closed shells based on
irrep names, or {0: 6, 3: 4} for irrep Id,  or a list [6, 0, 0, 4]
(identical to {0: 6, 3: 4}) in which the list index is served as
the irrep Id.  If cas_irrep_ncore is not given, the program
will generate a guess based on the lowest <code class="xref py py-attr docutils literal notranslate"><span class="pre">CASCI.ncore</span></code>
orbitals.</p>
</dd>
<dt>s<span class="classifier">ndarray</span></dt><dd><p>overlap matrix</p>
</dd>
<dt>base<span class="classifier">int</span></dt><dd><p>0-based (C-like) or 1-based (Fortran-like) caslst</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A list of orbital indices</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvtz'</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcscf</span><span class="o">.</span><span class="n">caslst_by_irrep</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="p">{</span><span class="s1">'E1gx'</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">'E1gy'</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">'E1ux'</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">'E1uy'</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="go">[5, 7, 8, 10, 11, 14, 15, 20, 25, 26, 31, 32]</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.get_fock">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.get_fock" title="Link to this definition"></a></dt>
<dd><p>Generalized Fock matrix in AO representation</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.get_spin_square">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">get_spin_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#get_spin_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.get_spin_square" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.make_natural_orbitals">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">make_natural_orbitals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method_obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#make_natural_orbitals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.make_natural_orbitals" title="Link to this definition"></a></dt>
<dd><p>Make natural orbitals from a general PySCF method object.
See Eqn. (1) in Keller et al. [DOI:10.1063/1.4922352] for details.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>method_obj<span class="classifier">Any PySCF method that has the function <cite>make_rdm1</cite> with kwarg</span></dt><dd><p><cite>ao_repr</cite>. This object can be a restricted OR unrestricted method.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>noons : A 1-D array of the natural orbital occupations (NOONs).</p>
<p>natorbs : A set of natural orbitals made from method_obj.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.make_rdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.make_rdm1" title="Link to this definition"></a></dt>
<dd><p>One-particle densit matrix in AO representation</p>
<dl class="simple">
<dt>Args:</dt><dd><p>casscf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">CASSCF</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">CASCI</span></code> object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ci<span class="classifier">ndarray</span></dt><dd><p>CAS space FCI coefficients. If not given, take casscf.ci.</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Orbital coefficients. If not given, take casscf.mo_coeff.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.linalg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'sto-3g'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">natocc</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">mcscf</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">(</span><span class="n">mc</span><span class="p">),</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_ovlp</span><span class="p">(),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">natocc</span><span class="p">)</span>
<span class="go">[ 0.0121563   0.0494735   0.0494735   1.95040395  1.95040395  1.98808879</span>
<span class="go">  2.          2.          2.          2.        ]</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.make_rdm12">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">make_rdm12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#make_rdm12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.make_rdm12" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.make_rdm1s">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.make_rdm1s" title="Link to this definition"></a></dt>
<dd><p>Alpha and beta one-particle densit matrices in AO representation</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.make_spin_casdm1">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">make_spin_casdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#make_spin_casdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.make_spin_casdm1" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.map2hf">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">map2hf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mf_mo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#map2hf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.map2hf" title="Link to this definition"></a></dt>
<dd><p>The overlap between the CASSCF optimized orbitals and the canonical HF orbitals.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.project_init_guess">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">project_init_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_hf_core</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#project_init_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.project_init_guess" title="Link to this definition"></a></dt>
<dd><p>Project the given initial guess to the current CASSCF problem
giving using a sequence of SVDs on orthogonal orbital subspaces.</p>
<dl>
<dt>Args:</dt><dd><p>casscf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">CASSCF</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">CASCI</span></code> object</p>
<dl class="simple">
<dt>mo_init<span class="classifier">ndarray or list of ndarray</span></dt><dd><p>Initial guess orbitals which are not orthonormal for the
current molecule.  When the casscf is UHF-CASSCF, mo_init
needs to be a list of two ndarrays, for alpha and beta
orbitals. Cannot have linear dependencies (i.e., you cannot
give more orbitals than the basis of casscf.mol has). Must
have at least ncore+ncas columns with active orbitals last,
even if use_hf_core=True. If incomplete, additional virtual
orbitals will be constructed and appended automatically.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>prev_mol<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></span></dt><dd><p>If given, the initial guess orbitals are associated to the
basis of prev_mol. Otherwise, the orbitals are presumed to
be in the basis of casscf.mol. Beware linear dependencies if
you are projecting from a LARGER basis to a SMALLER one.</p>
</dd>
<dt>priority<span class="classifier">active, core, nested idx arrays, or mask array</span></dt><dd><p>If arrays are 3d, UHF-CASSCF must be used; arrays can always
be 2d. Specifies the order in which groups of orbitals are
projected. Orbitals orthogonalized earlier are deformed less
than those orthogonalized later. core means core, then
active, then virtual; active means active, then core, then
virtual, and the Gram-Schmidt process is generated by
[[0],[1],[2],] or numpy.eye (nmo). Missing orbitals are
presumed virtual. Defaults to active if you are projecting
from the same basis set (prev_mol is None or has the same
basis functions) and core otherwise.</p>
</dd>
<dt>use_hf_core<span class="classifier">logical</span></dt><dd><p>If True, the core orbitals of mo_init are swapped out with
HF orbitals chosen by maximum overlap. Defaults to True
if you are projecting from a different basis and False if
you are projecting from a different geometry.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>New orthonormal initial guess orbitals</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.project_init_guess_old">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">project_init_guess_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#project_init_guess_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.project_init_guess_old" title="Link to this definition"></a></dt>
<dd><p>Project the given initial guess to the current CASSCF problem.  The
projected initial guess has two parts.  The core orbitals are directly
taken from the Hartree-Fock orbitals, and the active orbitals are
projected from the given initial guess.</p>
<dl>
<dt>Args:</dt><dd><p>casscf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">CASSCF</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">CASCI</span></code> object</p>
<dl class="simple">
<dt>init_mo<span class="classifier">ndarray or list of ndarray</span></dt><dd><p>Initial guess orbitals which are not orth-normal for the current
molecule.  When the casscf is UHF-CASSCF, the init_mo needs to be
a list of two ndarrays, for alpha and beta orbitals</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>prev_mol<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></span></dt><dd><p>If given, the initial guess orbitals are associated to the geometry
and basis of prev_mol.  Otherwise, the orbitals are based of
the geometry and basis of casscf.mol</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>New orthogonal initial guess orbitals with the core taken from
Hartree-Fock orbitals and projected active space from original initial
guess orbitals</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; F 0 0 0.8'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">mo</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">sort_mo</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'E(0.8) = </span><span class="si">%.12f</span><span class="s1">'</span> <span class="o">%</span> <span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">init_mo</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mo_coeff</span>
<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">.2</span><span class="p">):</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">'H'</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">[</span><span class="s1">'F'</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">)]]</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
    <span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">mo</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">project_init_guess</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">init_mo</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'E(</span><span class="si">%2.1f</span><span class="s1">) = </span><span class="si">%.12f</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">init_mo</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mo_coeff</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.select_mo_by_irrep">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">select_mo_by_irrep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cas_occ_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#select_mo_by_irrep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.select_mo_by_irrep" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.sort_mo">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">sort_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caslst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#sort_mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.sort_mo" title="Link to this definition"></a></dt>
<dd><p>Pick orbitals for CAS space</p>
<dl>
<dt>Args:</dt><dd><p>casscf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">CASSCF</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">CASCI</span></code> object</p>
<dl class="simple">
<dt>mo_coeff<span class="classifier">ndarray or a list of ndarray</span></dt><dd><p>Orbitals for CASSCF initial guess.  In the UHF-CASSCF, its a list
of two orbitals, for alpha and beta spin.</p>
</dd>
<dt>caslst<span class="classifier">list of int or nested list of int</span></dt><dd><p>A list of orbital indices to represent the CAS space.  In the UHF-CASSCF,
its consist of two lists, for alpha and beta spin.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>base<span class="classifier">int</span></dt><dd><p>0-based (C-style) or 1-based (Fortran-style) caslst</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>An reoreded mo_coeff, which put the orbitals given by caslst in the CAS space</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cas_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="c1"># pi orbitals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">sort_mo</span><span class="p">(</span><span class="n">cas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.007378939813691</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.sort_mo_by_irrep">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">sort_mo_by_irrep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cas_irrep_nocc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cas_irrep_ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#sort_mo_by_irrep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.sort_mo_by_irrep" title="Link to this definition"></a></dt>
<dd><p>Given number of active orbitals for each irrep, construct the mo initial
guess for CASSCF</p>
<dl>
<dt>Args:</dt><dd><p>casscf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">CASSCF</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">CASCI</span></code> object</p>
<dl class="simple">
<dt>cas_irrep_nocc<span class="classifier">list or dict</span></dt><dd><p>Number of active orbitals for each irrep.  It can be a dict, eg
{A1: 2, B2: 4} to indicate the active space size based on
irrep names, or {0: 2, 3: 4} for irrep Id,  or a list [2, 0, 0, 4]
(identical to {0: 2, 3: 4}) in which the list index is served as
the irrep Id.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>cas_irrep_ncore<span class="classifier">list or dict</span></dt><dd><p>Number of closed shells for each irrep.  It can be a dict, eg
{A1: 6, B2: 4} to indicate the closed shells based on
irrep names, or {0: 6, 3: 4} for irrep Id,  or a list [6, 0, 0, 4]
(identical to {0: 6, 3: 4}) in which the list index is served as
the irrep Id.  If cas_irrep_ncore is not given, the program
will generate a guess based on the lowest <code class="xref py py-attr docutils literal notranslate"><span class="pre">CASCI.ncore</span></code>
orbitals.</p>
</dd>
<dt>s<span class="classifier">ndarray</span></dt><dd><p>overlap matrix</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>sorted orbitals, ordered as [c,..,c,a,..,a,v,..,v]</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvtz'</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">sort_mo_by_irrep</span><span class="p">({</span><span class="s1">'E1gx'</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">'E1gy'</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">'E1ux'</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">'E1uy'</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Same to mo = sort_mo_by_irrep(mc, mf.mo_coeff, {2: 4, 3: 4, 6: 2, 7: 2})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Same to mo = sort_mo_by_irrep(mc, mf.mo_coeff, [0, 0, 4, 4, 0, 0, 2, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.162863845084</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.spin_square">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">spin_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ovlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#spin_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.spin_square" title="Link to this definition"></a></dt>
<dd><p>Spin square of the UHF-CASSCF wavefunction</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>A list of two floats.  The first is the expectation value of S^2.
The second is the corresponding 2S+1</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'O 0 0 0; O 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'sto-3g'</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">'S^2 = </span><span class="si">%.7f</span><span class="s1">, 2S+1 = </span><span class="si">%.7f</span><span class="s1">'</span> <span class="o">%</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">spin_square</span><span class="p">(</span><span class="n">mc</span><span class="p">))</span>
<span class="go">S^2 = 3.9831589, 2S+1 = 4.1149284</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.state_average">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">state_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#state_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.state_average" title="Link to this definition"></a></dt>
<dd><p>State average over the energy.  The energy functional is
E = w1&lt;psi1|H|psi1&gt; + w2&lt;psi2|H|psi2&gt; + </p>
<p>Note we may need change the FCI solver to</p>
<p>mc.fcisolver = fci.solver(mol, False)</p>
<p>before calling state_average_(mc), to mix the singlet and triplet states</p>
<p>MRH, 04/08/2019: Instead of turning casscf._finalize into an instance attribute
that points to the previous casscf object, Im going to make a whole new child class.
This will have the added benefit of making state_average and <a href="#id1"><span class="problematic" id="id2">state_average_</span></a>
actually behave differently for the first time (until now they <em>both</em> modified the
casscf object inplace). Im also going to assign the weights argument as a member
of the mc child class because an accurate second-order CASSCF algorithm for state-averaged
calculations requires that the gradient and Hessian be computed for CI vectors of each root
individually and then multiplied by that roots weight. The second derivatives computed
by newton_casscf.py need to be extended to state-averaged calculations in order to be
used as intermediates for calculations of the gradient of a single root in the context
of the SA-CASSCF method; see: Mol. Phys. 99, 103 (2001).</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.state_average_">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">state_average_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#state_average_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.state_average_" title="Link to this definition"></a></dt>
<dd><p>Inplace version of state_average</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.state_average_mix">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">state_average_mix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcisolvers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#state_average_mix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.state_average_mix" title="Link to this definition"></a></dt>
<dd><p>State-average CASSCF over multiple FCI solvers.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.state_average_mix_">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">state_average_mix_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcisolvers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#state_average_mix_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.state_average_mix_" title="Link to this definition"></a></dt>
<dd><p>Inplace version of state_average</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.state_specific">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">state_specific</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.addons.state_specific" title="Link to this definition"></a></dt>
<dd><p>For excited state</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>state : int
0 for ground state; 1 for first excited state.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.addons.state_specific_">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.addons.</span></span><span class="sig-name descname"><span class="pre">state_specific_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/addons.html#state_specific_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.addons.state_specific_" title="Link to this definition"></a></dt>
<dd><p>For excited state</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>state : int
0 for ground state; 1 for first excited state.</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-pyscf.mcscf.apc">
<span id="pyscf-mcscf-apc-module"></span><h2 id="module-pyscf.mcscf.apc">pyscf.mcscf.apc module<a class="headerlink" href="#module-pyscf.mcscf.apc" title="Link to this heading"></a></h2>
<p>APC Ranked-Orbital Active Space Selection
If you find this module useful for your work, please consider citing the following:</p>
<p>A Ranked-Orbital Approach to Select Active Spaces for High-Throughput Multireference Computation
<a class="reference external" href="https://doi.org/10.1021/acs.jctc.1c00037">https://doi.org/10.1021/acs.jctc.1c00037</a></p>
<p>Large-Scale Benchmarking of Multireference Vertical-Excitation Calculations via Automated Active-Space Selection
<a class="reference external" href="https://doi.org/10.1021/acs.jctc.2c00630">https://doi.org/10.1021/acs.jctc.2c00630</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.apc.APC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.apc.</span></span><span class="sig-name descname"><span class="pre">APC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/apc.html#APC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.apc.APC" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>APC Class
Implements APC orbital entropy estimation from <a class="reference external" href="https://doi.org/10.1021/acs.jctc.1c00037">https://doi.org/10.1021/acs.jctc.1c00037</a>
APC-N implemented from <a class="reference external" href="https://doi.org/10.1021/acs.jctc.2c00630">https://doi.org/10.1021/acs.jctc.2c00630</a></p>
<p>.kernel() combines this with the ranked-orbital scheme implemented in Chooser() to select
an active space of size max_size from the orbitals in mf.mo_coeff with occupancy mf.mo_occ</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>mf: an <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code> object</dt><dd><p>Must expose mf.mo_coeff, mf.mo_occ, mf.get_fock(), and mf.get_k()</p>
</dd>
<dt>max_size: Int or Tuple</dt><dd><p>Active space size constraint.
If tuple, interpreted as (nelecas,ncas)
If int interpreted as max # of orbitals</p>
</dd>
<dt>n: Int</dt><dd><p>Number of times to remove highest-entropy virtual orbitals in entropy calculation.
A higher value will tend to select active spaces with less doubly occupied orbitals.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>eps: Float</dt><dd><p>Small offset added to singly occupied and removed virtual orbital entropies (can generally be ignored)</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>active-space-size, #-active-electrons, orbital-initial-guess (following AVAS convention)</p>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from pyscf import gto, scf, mcscf
&gt;&gt;&gt; from pyscf.mcscf import apc
&gt;&gt;&gt; mol = gto.M(atom=H 0 0 0; H 0 0 1, basis=ccpvtz)
&gt;&gt;&gt; mf = scf.RHF(mol).run()
&gt;&gt;&gt; myapc = apc.APC(mf,max_size=2)
&gt;&gt;&gt; ncas,nelecas,casorbs = myapc.kernel()
&gt;&gt;&gt; mc = mcscf.CASSCF(mf, ncas, nelecas).run(casorbs)</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.apc.APC.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/apc.html#APC.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.apc.APC.kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.apc.Chooser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.apc.</span></span><span class="sig-name descname"><span class="pre">Chooser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entropies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/apc.html#Chooser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.apc.Chooser" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Chooser Class
Implements the ranked-orbital selection scheme outlined in <a class="reference external" href="https://doi.org/10.1021/acs.jctc.1c00037">https://doi.org/10.1021/acs.jctc.1c00037</a>
Given a set of entropies, will select all orbitals for the active space and then drop the lowest-entropy orbitals
until the size constraint max_size is met.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>orbs: 2D Numpy Array</dt><dd><p>Orbitals to choose from, spanning the entire basis (must be square matrix of coefficients)</p>
</dd>
<dt>occ: 1D Numpy Array</dt><dd><p>Orbital occupations for orbs (2,1,0); nactel will be set to the number of electrons in the selected orbitals</p>
</dd>
<dt>entropies: 1D Numpy Array</dt><dd><p>Importance measurment used to rank the orbitals</p>
</dd>
<dt>max_size: Int or Tuple</dt><dd><p>Active space size constraint.
If tuple, interpreted as (nelecas,ncas)
If int, interpreted as max # of orbitals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>active-space-size, #-active-electrons, orbital-initial-guess, chosen-active-orbital-indeces</p>
</dd>
</dl>
<p>Example:</p>
<p>#Randomly ranked orbitals
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from pyscf import gto, scf, mcscf
&gt;&gt;&gt; from pyscf.mcscf import apc
&gt;&gt;&gt; mol = gto.M(atom=H 0 0 0; H 0 0 1, basis=ccpvtz)
&gt;&gt;&gt; mf = scf.RHF(mol).run()
&gt;&gt;&gt; entropies = np.random.choice(np.arange(len(mf.mo_occ)),len(mf.mo_occ),replace=False)
&gt;&gt;&gt; chooser = apc.Chooser(mf.mo_coeff,mf.mo_occ,entropies,max_size=(2,2))
&gt;&gt;&gt; ncas, nelecas, casorbs, active_idx = chooser.kernel()
&gt;&gt;&gt; mc = mcscf.CASSCF(mf, ncas, nelecas).run(casorbs)</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.apc.Chooser.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/apc.html#Chooser.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.apc.Chooser.kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
</section>
<section id="module-pyscf.mcscf.avas">
<span id="pyscf-mcscf-avas-module"></span><h2 id="module-pyscf.mcscf.avas">pyscf.mcscf.avas module<a class="headerlink" href="#module-pyscf.mcscf.avas" title="Link to this heading"></a></h2>
<p>Automated construction of molecular active spaces from atomic valence orbitals.
Ref. arXiv:1701.07862 [physics.chem-ph]</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.avas.AVAS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.avas.</span></span><span class="sig-name descname"><span class="pre">AVAS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aolabels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_iao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">openshell_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonicalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/avas.html#AVAS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.avas.AVAS" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a></p>
<p>AVAS method to construct mcscf active space.
Ref. arXiv:1701.07862 [physics.chem-ph]</p>
<dl>
<dt>Args:</dt><dd><p>mf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code> object</p>
<dl class="simple">
<dt>aolabels<span class="classifier">string or a list of strings</span></dt><dd><p>AO labels for AO active space</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>threshold<span class="classifier">float</span></dt><dd><p>Tructing threshold of the AO-projector above which AOs are kept in
the active space.</p>
</dd>
<dt>minao<span class="classifier">str</span></dt><dd><p>A reference AOs for AVAS.</p>
</dd>
<dt>with_iao<span class="classifier">bool</span></dt><dd><p>Whether to use IAO localization to construct the reference active AOs.</p>
</dd>
<dt>openshell_option<span class="classifier">int</span></dt><dd><p>How to handle singly-occupied orbitals in the active space. The
singly-occupied orbitals are projected as part of alpha orbitals
if openshell_option=2, or completely kept in active space if
openshell_option=3.  See Section III.E option 2 or 3 of the
reference paper for more details.</p>
</dd>
<dt>canonicalize<span class="classifier">bool</span></dt><dd><p>Orbitals defined in AVAS method are local orbitals.  Symmetrizing
the core, active and virtual space.</p>
</dd>
<dt>ncore<span class="classifier">integer</span></dt><dd><p>Number of core orbitals to be excluded from the AVAS method.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>active-space-size, #-active-electrons, orbital-initial-guess-for-CASCI/CASSCF</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.mcscf</span> <span class="kn">import</span> <span class="n">avas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'Cr 0 0 0; Cr 0 0 1.6'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvtz'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">,</span> <span class="n">mo</span> <span class="o">=</span> <span class="n">avas</span><span class="o">.</span><span class="n">avas</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="p">[</span><span class="s1">'Cr 3d'</span><span class="p">,</span> <span class="s1">'Cr 4s'</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.avas.AVAS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/avas.html#AVAS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.avas.AVAS.dump_flags" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.avas.AVAS.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/avas.html#AVAS.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.avas.AVAS.kernel" title="Link to this definition"></a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.avas.avas">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.avas.</span></span><span class="sig-name descname"><span class="pre">avas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aolabels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_iao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">openshell_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonicalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.avas.avas" title="Link to this definition"></a></dt>
<dd><p>AVAS method to construct mcscf active space.
Ref. arXiv:1701.07862 [physics.chem-ph]</p>
<dl>
<dt>Args:</dt><dd><p>mf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code> object</p>
<dl class="simple">
<dt>aolabels<span class="classifier">string or a list of strings</span></dt><dd><p>AO labels for AO active space</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>threshold<span class="classifier">float</span></dt><dd><p>Tructing threshold of the AO-projector above which AOs are kept in
the active space.</p>
</dd>
<dt>minao<span class="classifier">str</span></dt><dd><p>A reference AOs for AVAS.</p>
</dd>
<dt>with_iao<span class="classifier">bool</span></dt><dd><p>Whether to use IAO localization to construct the reference active AOs.</p>
</dd>
<dt>openshell_option<span class="classifier">int</span></dt><dd><p>How to handle singly-occupied orbitals in the active space. The
singly-occupied orbitals are projected as part of alpha orbitals
if openshell_option=2, or completely kept in active space if
openshell_option=3.  See Section III.E option 2 or 3 of the
reference paper for more details.</p>
</dd>
<dt>canonicalize<span class="classifier">bool</span></dt><dd><p>Orbitals defined in AVAS method are local orbitals.  Symmetrizing
the core, active and virtual space.</p>
</dd>
<dt>ncore<span class="classifier">integer</span></dt><dd><p>Number of core orbitals to be excluded from the AVAS method.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>active-space-size, #-active-electrons, orbital-initial-guess-for-CASCI/CASSCF</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.mcscf</span> <span class="kn">import</span> <span class="n">avas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'Cr 0 0 0; Cr 0 0 1.6'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvtz'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">,</span> <span class="n">mo</span> <span class="o">=</span> <span class="n">avas</span><span class="o">.</span><span class="n">avas</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="p">[</span><span class="s1">'Cr 3d'</span><span class="p">,</span> <span class="s1">'Cr 4s'</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.avas.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.avas.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aolabels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_iao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">openshell_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonicalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/avas.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.avas.kernel" title="Link to this definition"></a></dt>
<dd><p>AVAS method to construct mcscf active space.
Ref. arXiv:1701.07862 [physics.chem-ph]</p>
<dl>
<dt>Args:</dt><dd><p>mf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code> object</p>
<dl class="simple">
<dt>aolabels<span class="classifier">string or a list of strings</span></dt><dd><p>AO labels for AO active space</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>threshold<span class="classifier">float</span></dt><dd><p>Tructing threshold of the AO-projector above which AOs are kept in
the active space.</p>
</dd>
<dt>minao<span class="classifier">str</span></dt><dd><p>A reference AOs for AVAS.</p>
</dd>
<dt>with_iao<span class="classifier">bool</span></dt><dd><p>Whether to use IAO localization to construct the reference active AOs.</p>
</dd>
<dt>openshell_option<span class="classifier">int</span></dt><dd><p>How to handle singly-occupied orbitals in the active space. The
singly-occupied orbitals are projected as part of alpha orbitals
if openshell_option=2, or completely kept in active space if
openshell_option=3.  See Section III.E option 2 or 3 of the
reference paper for more details.</p>
</dd>
<dt>canonicalize<span class="classifier">bool</span></dt><dd><p>Orbitals defined in AVAS method are local orbitals.  Symmetrizing
the core, active and virtual space.</p>
</dd>
<dt>ncore<span class="classifier">integer</span></dt><dd><p>Number of core orbitals to be excluded from the AVAS method.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>active-space-size, #-active-electrons, orbital-initial-guess-for-CASCI/CASSCF</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.mcscf</span> <span class="kn">import</span> <span class="n">avas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'Cr 0 0 0; Cr 0 0 1.6'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvtz'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">,</span> <span class="n">mo</span> <span class="o">=</span> <span class="n">avas</span><span class="o">.</span><span class="n">avas</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="p">[</span><span class="s1">'Cr 3d'</span><span class="p">,</span> <span class="s1">'Cr 4s'</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
</section>
<section id="module-pyscf.mcscf.casci">
<span id="pyscf-mcscf-casci-module"></span><h2 id="module-pyscf.mcscf.casci">pyscf.mcscf.casci module<a class="headerlink" href="#module-pyscf.mcscf.casci" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci.</span></span><span class="sig-name descname"><span class="pre">CASBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a></p>
<p>CASCI/CASSCF</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>mf_or_mol<span class="classifier">SCF object or Mole object</span></dt><dd><p>SCF or Mole to define the problem size.</p>
</dd>
<dt>ncas<span class="classifier">int</span></dt><dd><p>Number of active orbitals.</p>
</dd>
<dt>nelecas<span class="classifier">int or a pair of int</span></dt><dd><p>Number of electrons in active space.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ncore<span class="classifier">int</span></dt><dd><p>Number of doubly occupied core orbitals. If not presented, this
parameter can be automatically determined.</p>
</dd>
</dl>
</dd>
<dt>Attributes:</dt><dd><dl>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code>.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code>.</p>
</dd>
<dt>ncas<span class="classifier">int</span></dt><dd><p>Active space size.</p>
</dd>
<dt>nelecas<span class="classifier">tuple of int</span></dt><dd><p>Active (nelec_alpha, nelec_beta)</p>
</dd>
<dt>ncore<span class="classifier">int or tuple of int</span></dt><dd><p>Core electron number.  In UHF-CASSCF, its a tuple to indicate the different core eletron numbers.</p>
</dd>
<dt>natorb<span class="classifier">bool</span></dt><dd><p>Whether to transform natural orbitals in active space.
Note: when CASCI/CASSCF are combined with DMRG solver or selected
CI solver, enabling this parameter may slightly change the total energy.
False by default.</p>
</dd>
<dt>canonicalization<span class="classifier">bool</span></dt><dd><p>Whether to canonicalize orbitals in core and external space
against the general Fock matrix.
The orbitals in active space are NOT transformed by default. To
get the natural orbitals in active space, the attribute .natorb
needs to be enabled.
True by default.</p>
</dd>
<dt>sorting_mo_energy<span class="classifier">bool</span></dt><dd><p>Whether to sort the orbitals based on the diagonal elements of the
general Fock matrix.  Default is False.</p>
</dd>
<dt>fcisolver<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></span></dt><dd><p>The pyscf.fci module provides several FCISolver for different scenario.  Generally,
fci.direct_spin1.FCISolver can be used for all RHF-CASSCF.  However, a proper FCISolver
can provide better performance and better numerical stability.  One can either use
<code class="xref py py-func docutils literal notranslate"><span class="pre">fci.solver()</span></code> function to pick the FCISolver by the program or manually assigen
the FCISolver to this attribute, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCISolver</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>You can control FCISolver by setting e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">max_cycle</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mf">1e-7</span>
</pre></div>
</div>
<p>For more details of the parameter for FCISolver, See <code class="xref py py-mod docutils literal notranslate"><span class="pre">fci</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total MCSCF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>e_cas<span class="classifier">float</span></dt><dd><p>CAS space FCI energy</p>
</dd>
<dt>ci<span class="classifier">ndarray</span></dt><dd><p>CAS space FCI coefficients</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>When canonicalization is specified, the orbitals are canonical
orbitals which make the general Fock matrix (Fock operator on top
of MCSCF 1-particle density matrix) diagonalized within each
subspace (core, active, external).  If natorb (natural orbitals in
active space) is specified, the active segment of the mo_coeff is
natural orbitls.</p>
</dd>
<dt>mo_energy<span class="classifier">ndarray</span></dt><dd><p>Diagonal elements of general Fock matrix (in mo_coeff
representation).</p>
</dd>
<dt>mo_occ<span class="classifier">ndarray</span></dt><dd><p>Occupation numbers of natural orbitals if natorb is specified.</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.980200816243354</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.analyze">
<span class="sig-name descname"><span class="pre">analyze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">large_ci_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta_lowdin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.analyze" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.ao2mo" title="Link to this definition"></a></dt>
<dd><p>Compute the active space two-particle Hamiltonian.</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.canonicalization">
<span class="sig-name descname"><span class="pre">canonicalization</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.canonicalization" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.canonicalize">
<span class="sig-name descname"><span class="pre">canonicalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cas_natorb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta_lowdin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stav_dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.canonicalize" title="Link to this definition"></a></dt>
<dd><p>Canonicalized CASCI/CASSCF orbitals of effecitive Fock matrix and
update CI coefficients accordingly.</p>
<p>Effective Fock matrix is built with one-particle density matrix (see
also <code class="xref py py-func docutils literal notranslate"><span class="pre">mcscf.casci.get_fock()</span></code>). For state-average CASCI/CASSCF object,
the canonicalized orbitals are based on the state-average density matrix.
To obtain canonicalized orbitals for an individual state, you need to pass
casdm1 of the specific state to this function.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mc: a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>mo_coeff (ndarray): orbitals that span the core, active and external</dt><dd><p>space.</p>
</dd>
<dt>ci (ndarray): CI coefficients (or objects to represent the CI</dt><dd><p>wavefunctions in DMRG/QMC-MCSCF calculations).</p>
</dd>
<dt>eris: Integrals for the MCSCF object. Input this object to reduce the</dt><dd><p>overhead of computing integrals. It can be generated by
<code class="xref py py-func docutils literal notranslate"><span class="pre">mc.ao2mo()</span></code> method.</p>
</dd>
<dt>sort (bool): Whether the canonicalized orbitals are sorted based on</dt><dd><p>the orbital energy (diagonal part of the effective Fock matrix)
within each subspace (core, active, external). If point group
symmetry is not available in the system, orbitals are always
sorted. When point group symmetry is available, sort=False will
preserve the symmetry label of input orbitals and only sort the
orbitals in each symmetry sector. sort=True will reorder all
orbitals over all symmetry sectors in each subspace and the
symmetry labels may be changed.</p>
</dd>
<dt>cas_natorb (bool): Whether to transform active orbitals to natual</dt><dd><p>orbitals. If enabled, the output orbitals in active space are
transformed to natural orbitals and CI coefficients are updated
accordingly.</p>
</dd>
<dt>casdm1 (ndarray): 1-particle density matrix in active space. This</dt><dd><p>density matrix is used to build effective fock matrix. Without
input casdm1, the density matrix is computed with the input ci
coefficients/object. If neither ci nor casdm1 were given, density
matrix is computed by <code class="xref py py-func docutils literal notranslate"><span class="pre">mc.fcisolver.make_rdm1()</span></code> method. For
state-average CASCI/CASCF calculation, this results in a set of
canonicalized orbitals of state-average effective Fock matrix.
To canonicalize the orbitals for one particular state, you can
assign the density matrix of that state to the kwarg casdm1.</p>
</dd>
<dt>stav_dm1 (bool): Use state-average 1-particle density matrix for</dt><dd><p>computing Fock matrices and natural orbitals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tuple, (natural orbitals, CI coefficients, orbital energies)
The orbital energies are the diagonal terms of effective Fock matrix.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.canonicalize_">
<span class="sig-name descname"><span class="pre">canonicalize_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cas_natorb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta_lowdin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.canonicalize_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.canonicalize_" title="Link to this definition"></a></dt>
<dd><p>Canonicalized CASCI/CASSCF orbitals of effecitive Fock matrix and
update CI coefficients accordingly.</p>
<p>Effective Fock matrix is built with one-particle density matrix (see
also <code class="xref py py-func docutils literal notranslate"><span class="pre">mcscf.casci.get_fock()</span></code>). For state-average CASCI/CASSCF object,
the canonicalized orbitals are based on the state-average density matrix.
To obtain canonicalized orbitals for an individual state, you need to pass
casdm1 of the specific state to this function.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mc: a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>mo_coeff (ndarray): orbitals that span the core, active and external</dt><dd><p>space.</p>
</dd>
<dt>ci (ndarray): CI coefficients (or objects to represent the CI</dt><dd><p>wavefunctions in DMRG/QMC-MCSCF calculations).</p>
</dd>
<dt>eris: Integrals for the MCSCF object. Input this object to reduce the</dt><dd><p>overhead of computing integrals. It can be generated by
<code class="xref py py-func docutils literal notranslate"><span class="pre">mc.ao2mo()</span></code> method.</p>
</dd>
<dt>sort (bool): Whether the canonicalized orbitals are sorted based on</dt><dd><p>the orbital energy (diagonal part of the effective Fock matrix)
within each subspace (core, active, external). If point group
symmetry is not available in the system, orbitals are always
sorted. When point group symmetry is available, sort=False will
preserve the symmetry label of input orbitals and only sort the
orbitals in each symmetry sector. sort=True will reorder all
orbitals over all symmetry sectors in each subspace and the
symmetry labels may be changed.</p>
</dd>
<dt>cas_natorb (bool): Whether to transform active orbitals to natual</dt><dd><p>orbitals. If enabled, the output orbitals in active space are
transformed to natural orbitals and CI coefficients are updated
accordingly.</p>
</dd>
<dt>casdm1 (ndarray): 1-particle density matrix in active space. This</dt><dd><p>density matrix is used to build effective fock matrix. Without
input casdm1, the density matrix is computed with the input ci
coefficients/object. If neither ci nor casdm1 were given, density
matrix is computed by <code class="xref py py-func docutils literal notranslate"><span class="pre">mc.fcisolver.make_rdm1()</span></code> method. For
state-average CASCI/CASCF calculation, this results in a set of
canonicalized orbitals of state-average effective Fock matrix.
To canonicalize the orbitals for one particular state, you can
assign the density matrix of that state to the kwarg casdm1.</p>
</dd>
<dt>stav_dm1 (bool): Use state-average 1-particle density matrix for</dt><dd><p>computing Fock matrices and natural orbitals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tuple, (natural orbitals, CI coefficients, orbital energies)
The orbital energies are the diagonal terms of effective Fock matrix.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.cas_natorb">
<span class="sig-name descname"><span class="pre">cas_natorb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta_lowdin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.cas_natorb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.cas_natorb" title="Link to this definition"></a></dt>
<dd><p>Transform active orbitals to natural orbitals, and update the CI wfn
accordingly</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mc : a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>sort<span class="classifier">bool</span></dt><dd><p>Sort natural orbitals wrt the occupancy.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tuple, the first item is natural orbitals, the second is updated CI
coefficients, the third is the natural occupancy associated to the
natural orbitals.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.cas_natorb_">
<span class="sig-name descname"><span class="pre">cas_natorb_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta_lowdin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.cas_natorb_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.cas_natorb_" title="Link to this definition"></a></dt>
<dd><p>Transform active orbitals to natural orbitals, and update the CI wfn
accordingly</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mc : a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>sort<span class="classifier">bool</span></dt><dd><p>Sort natural orbitals wrt the occupancy.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tuple, the first item is natural orbitals, the second is updated CI
coefficients, the third is the natural occupancy associated to the
natural orbitals.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.casci">
<span class="sig-name descname"><span class="pre">casci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.casci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.casci" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.check_sanity">
<span class="sig-name descname"><span class="pre">check_sanity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.check_sanity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.check_sanity" title="Link to this definition"></a></dt>
<dd><p>Check input of class/object attributes, check whether a class method is
overwritten.  It does not check the attributes which are prefixed with
_.  The
return value of method set is the object itself.  This allows a series
of functions/methods to be executed in pipe.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.density_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.density_fit" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.dump_flags" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.energy_nuc">
<span class="sig-name descname"><span class="pre">energy_nuc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.energy_nuc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.energy_nuc" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.fix_spin">
<span class="sig-name descname"><span class="pre">fix_spin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.fix_spin" title="Link to this definition"></a></dt>
<dd><p>Use level shift to control FCI solver spin.</p>
<div class="math notranslate nohighlight">
\[(H + shift*S^2) |\Psi\rangle = E |\Psi\rangle\]</div>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shift<span class="classifier">float</span></dt><dd><p>Energy penalty for states which have wrong spin</p>
</dd>
<dt>ss<span class="classifier">number</span></dt><dd><p>S^2 expection value == s*(s+1)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.fix_spin_">
<span class="sig-name descname"><span class="pre">fix_spin_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.fix_spin_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.fix_spin_" title="Link to this definition"></a></dt>
<dd><p>Use level shift to control FCI solver spin.</p>
<div class="math notranslate nohighlight">
\[(H + shift*S^2) |\Psi\rangle = E |\Psi\rangle\]</div>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shift<span class="classifier">float</span></dt><dd><p>Energy penalty for states which have wrong spin</p>
</dd>
<dt>ss<span class="classifier">number</span></dt><dd><p>S^2 expection value == s*(s+1)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.get_fock" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.get_h1cas">
<span class="sig-name descname"><span class="pre">get_h1cas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.get_h1cas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.get_h1cas" title="Link to this definition"></a></dt>
<dd><p>An alias of get_h1eff method</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.get_h1eff">
<span class="sig-name descname"><span class="pre">get_h1eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.get_h1eff" title="Link to this definition"></a></dt>
<dd><p>CAS sapce one-electron hamiltonian</p>
<dl class="simple">
<dt>Args:</dt><dd><p>casci : a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Returns:</dt><dd><p>A tuple, the first is the effective one-electron hamiltonian defined in CAS space,
the second is the electronic energy from core.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.get_h2cas">
<span class="sig-name descname"><span class="pre">get_h2cas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.get_h2cas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.get_h2cas" title="Link to this definition"></a></dt>
<dd><p>An alias of get_h2eff method</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.get_h2eff">
<span class="sig-name descname"><span class="pre">get_h2eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.get_h2eff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.get_h2eff" title="Link to this definition"></a></dt>
<dd><p>Compute the active space two-particle Hamiltonian.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.get_hcore">
<span class="sig-name descname"><span class="pre">get_hcore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.get_hcore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.get_hcore" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.get_jk">
<span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.get_jk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.get_jk" title="Link to this definition"></a></dt>
<dd><p>Compute J, K matrices for all input density matrices</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether J, K matrix is hermitian</p>
<div class="line-block">
<div class="line">0 : not hermitian and not symmetric</div>
<div class="line">1 : hermitian or symmetric</div>
<div class="line">2 : anti-hermitian</div>
</div>
</dd>
<dt>vhfopt :</dt><dd><p>A class which holds precomputed quantities to optimize the
computation of J, K matrices</p>
</dd>
<dt>with_j<span class="classifier">boolean</span></dt><dd><p>Whether to compute J matrices</p>
</dd>
<dt>with_k<span class="classifier">boolean</span></dt><dd><p>Whether to compute K matrices</p>
</dd>
<dt>omega<span class="classifier">float</span></dt><dd><p>Parameter of range-seperated Coulomb operator: erf( omega * r12 ) / r12.
If specified, integration are evaluated based on the long-range
part of the range-seperated Coulomb operator.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Depending on the given dm, the function returns one J and one K matrix,
or a list of J matrices and a list of K matrices, corresponding to the
input density matrices.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.scf</span> <span class="kn">import</span> <span class="n">_vhf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; H 0 0 1.1'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dms</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">get_jk</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dms</span><span class="p">,</span> <span class="n">hermi</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 2, 2)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.get_veff" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock potential matrix for the given density matrix</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dm_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The density matrix baseline.  If not 0, this function computes the
increment of HF potential w.r.t. the reference HF potential matrix.</p>
</dd>
<dt>vhf_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The reference HF potential matrix.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether J, K matrix is hermitian</p>
<div class="line-block">
<div class="line">0 : no hermitian or symmetric</div>
<div class="line">1 : hermitian</div>
<div class="line">2 : anti-hermitian</div>
</div>
</dd>
<dt>vhfopt :</dt><dd><p>A class which holds precomputed quantities to optimize the
computation of J, K matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vhf = 2*J - K.  Vhf can be a list matrices, corresponding to the
input density matrices.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.scf</span> <span class="kn">import</span> <span class="n">_vhf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; H 0 0 1.1'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm0</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vhf0</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">get_veff</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm0</span><span class="p">,</span> <span class="n">hermi</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vhf1</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">get_veff</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm1</span><span class="p">,</span> <span class="n">hermi</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vhf2</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">get_veff</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm1</span><span class="p">,</span> <span class="n">dm_last</span><span class="o">=</span><span class="n">dm0</span><span class="p">,</span> <span class="n">vhf_last</span><span class="o">=</span><span class="n">vhf0</span><span class="p">,</span> <span class="n">hermi</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">vhf1</span><span class="p">,</span> <span class="n">vhf2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.h1e_for_cas">
<span class="sig-name descname"><span class="pre">h1e_for_cas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.h1e_for_cas" title="Link to this definition"></a></dt>
<dd><p>CAS sapce one-electron hamiltonian</p>
<dl class="simple">
<dt>Args:</dt><dd><p>casci : a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Returns:</dt><dd><p>A tuple, the first is the effective one-electron hamiltonian defined in CAS space,
the second is the electronic energy from core.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.kernel" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><p>Five elements, they are
total energy,
active space CI energy,
the active space FCI wavefunction coefficients or DMRG wavefunction ID,
the MCSCF canonical orbital coefficients,
the MCSCF canonical orbital coefficients.</p>
</dd>
</dl>
<p>They are attributes of mcscf object, which can be accessed by
.e_tot, .e_cas, .ci, .mo_coeff, .mo_energy</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.make_rdm1" title="Link to this definition"></a></dt>
<dd><p>One-particle density matrix in AO representation</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.make_rdm1s">
<span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.make_rdm1s" title="Link to this definition"></a></dt>
<dd><p>One-particle density matrices for alpha and beta spin on AO basis</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.natorb">
<span class="sig-name descname"><span class="pre">natorb</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.natorb" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.ncore">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ncore</span></span><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.ncore" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.nuc_grad_method" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.sfx2c1e">
<span class="sig-name descname"><span class="pre">sfx2c1e</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.sfx2c1e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.sfx2c1e" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.sort_mo">
<span class="sig-name descname"><span class="pre">sort_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">caslst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.sort_mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.sort_mo" title="Link to this definition"></a></dt>
<dd><p>Pick orbitals for CAS space</p>
<dl>
<dt>Args:</dt><dd><p>casscf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">CASSCF</span></code> or <a class="reference internal" href="#pyscf.mcscf.casci.CASCI" title="pyscf.mcscf.casci.CASCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">CASCI</span></code></a> object</p>
<dl class="simple">
<dt>mo_coeff<span class="classifier">ndarray or a list of ndarray</span></dt><dd><p>Orbitals for CASSCF initial guess.  In the UHF-CASSCF, its a list
of two orbitals, for alpha and beta spin.</p>
</dd>
<dt>caslst<span class="classifier">list of int or nested list of int</span></dt><dd><p>A list of orbital indices to represent the CAS space.  In the UHF-CASSCF,
its consist of two lists, for alpha and beta spin.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>base<span class="classifier">int</span></dt><dd><p>0-based (C-style) or 1-based (Fortran-style) caslst</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>An reoreded mo_coeff, which put the orbitals given by caslst in the CAS space</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cas_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="c1"># pi orbitals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">sort_mo</span><span class="p">(</span><span class="n">cas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.007378939813691</span>
</pre></div>
</div>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.sorting_mo_energy">
<span class="sig-name descname"><span class="pre">sorting_mo_energy</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.sorting_mo_energy" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.state_average">
<span class="sig-name descname"><span class="pre">state_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.state_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.state_average" title="Link to this definition"></a></dt>
<dd><p>State average over the energy.  The energy functional is
E = w1&lt;psi1|H|psi1&gt; + w2&lt;psi2|H|psi2&gt; + </p>
<p>Note we may need change the FCI solver to</p>
<p>mc.fcisolver = fci.solver(mol, False)</p>
<p>before calling state_average_(mc), to mix the singlet and triplet states</p>
<p>MRH, 04/08/2019: Instead of turning casscf._finalize into an instance attribute
that points to the previous casscf object, Im going to make a whole new child class.
This will have the added benefit of making state_average and <a href="#id3"><span class="problematic" id="id4">state_average_</span></a>
actually behave differently for the first time (until now they <em>both</em> modified the
casscf object inplace). Im also going to assign the weights argument as a member
of the mc child class because an accurate second-order CASSCF algorithm for state-averaged
calculations requires that the gradient and Hessian be computed for CI vectors of each root
individually and then multiplied by that roots weight. The second derivatives computed
by newton_casscf.py need to be extended to state-averaged calculations in order to be
used as intermediates for calculations of the gradient of a single root in the context
of the SA-CASSCF method; see: Mol. Phys. 99, 103 (2001).</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.state_average_">
<span class="sig-name descname"><span class="pre">state_average_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfnsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.state_average_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.state_average_" title="Link to this definition"></a></dt>
<dd><p>State average over the energy.  The energy functional is
E = w1&lt;psi1|H|psi1&gt; + w2&lt;psi2|H|psi2&gt; + </p>
<p>Note we may need change the FCI solver to</p>
<p>mc.fcisolver = fci.solver(mol, False)</p>
<p>before calling state_average_(mc), to mix the singlet and triplet states</p>
<p>MRH, 04/08/2019: Instead of turning casscf._finalize into an instance attribute
that points to the previous casscf object, Im going to make a whole new child class.
This will have the added benefit of making state_average and <a href="#id5"><span class="problematic" id="id6">state_average_</span></a>
actually behave differently for the first time (until now they <em>both</em> modified the
casscf object inplace). Im also going to assign the weights argument as a member
of the mc child class because an accurate second-order CASSCF algorithm for state-averaged
calculations requires that the gradient and Hessian be computed for CI vectors of each root
individually and then multiplied by that roots weight. The second derivatives computed
by newton_casscf.py need to be extended to state-averaged calculations in order to be
used as intermediates for calculations of the gradient of a single root in the context
of the SA-CASSCF method; see: Mol. Phys. 99, 103 (2001).</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.state_specific_">
<span class="sig-name descname"><span class="pre">state_specific_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASBase.state_specific_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.state_specific_" title="Link to this definition"></a></dt>
<dd><p>For excited state</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>state : int
0 for ground state; 1 for first excited state.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.x2c">
<span class="sig-name descname"><span class="pre">x2c</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.x2c" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASBase.x2c1e">
<span class="sig-name descname"><span class="pre">x2c1e</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.casci.CASBase.x2c1e" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASCI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci.</span></span><span class="sig-name descname"><span class="pre">CASCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.casci.CASBase" title="pyscf.mcscf.casci.CASBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">CASBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASCI.Gradients">
<span class="sig-name descname"><span class="pre">Gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.Gradients" title="Link to this definition"></a></dt>
<dd><p>Non-relativistic restricted Hartree-Fock gradients</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASCI.as_scanner">
<span class="sig-name descname"><span class="pre">as_scanner</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.as_scanner" title="Link to this definition"></a></dt>
<dd><p>Generating a scanner for CASCI PES.</p>
<p>The returned solver is a function. This function requires one argument
mol as input and returns total CASCI energy.</p>
<p>The solver will automatically use the results of last calculation as the
initial guess of the new calculation.  All parameters of MCSCF object
are automatically applied in the solver.</p>
<p>Note scanner has side effects.  It may change many underlying objects
(_scf, with_df, with_x2c, ) during calculation.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.1'</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.5'</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASCI.casci">
<span class="sig-name descname"><span class="pre">casci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASCI.casci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.casci" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASCI.get_h2eff">
<span class="sig-name descname"><span class="pre">get_h2eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASCI.get_h2eff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.get_h2eff" title="Link to this definition"></a></dt>
<dd><p>Compute the active space two-particle Hamiltonian.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASCI.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASCI.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.kernel" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><p>Five elements, they are
total energy,
active space CI energy,
the active space FCI wavefunction coefficients or DMRG wavefunction ID,
the MCSCF canonical orbital coefficients,
the MCSCF canonical orbital coefficients.</p>
</dd>
</dl>
<p>They are attributes of mcscf object, which can be accessed by
.e_tot, .e_cas, .ci, .mo_coeff, .mo_energy</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASCI.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASCI.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.nuc_grad_method" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.CASCI_Scanner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci.</span></span><span class="sig-name descname"><span class="pre">CASCI_Scanner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#CASCI_Scanner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI_Scanner" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.SinglePointScanner" title="pyscf.lib.misc.SinglePointScanner"><code class="xref py py-class docutils literal notranslate"><span class="pre">SinglePointScanner</span></code></a></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.analyze">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci.</span></span><span class="sig-name descname"><span class="pre">analyze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">large_ci_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta_lowdin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#analyze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.analyze" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.as_scanner">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci.</span></span><span class="sig-name descname"><span class="pre">as_scanner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#as_scanner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.as_scanner" title="Link to this definition"></a></dt>
<dd><p>Generating a scanner for CASCI PES.</p>
<p>The returned solver is a function. This function requires one argument
mol as input and returns total CASCI energy.</p>
<p>The solver will automatically use the results of last calculation as the
initial guess of the new calculation.  All parameters of MCSCF object
are automatically applied in the solver.</p>
<p>Note scanner has side effects.  It may change many underlying objects
(_scf, with_df, with_x2c, ) during calculation.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.1'</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.5'</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.canonicalize">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci.</span></span><span class="sig-name descname"><span class="pre">canonicalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cas_natorb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta_lowdin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stav_dm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#canonicalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.canonicalize" title="Link to this definition"></a></dt>
<dd><p>Canonicalized CASCI/CASSCF orbitals of effecitive Fock matrix and
update CI coefficients accordingly.</p>
<p>Effective Fock matrix is built with one-particle density matrix (see
also <code class="xref py py-func docutils literal notranslate"><span class="pre">mcscf.casci.get_fock()</span></code>). For state-average CASCI/CASSCF object,
the canonicalized orbitals are based on the state-average density matrix.
To obtain canonicalized orbitals for an individual state, you need to pass
casdm1 of the specific state to this function.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mc: a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>mo_coeff (ndarray): orbitals that span the core, active and external</dt><dd><p>space.</p>
</dd>
<dt>ci (ndarray): CI coefficients (or objects to represent the CI</dt><dd><p>wavefunctions in DMRG/QMC-MCSCF calculations).</p>
</dd>
<dt>eris: Integrals for the MCSCF object. Input this object to reduce the</dt><dd><p>overhead of computing integrals. It can be generated by
<code class="xref py py-func docutils literal notranslate"><span class="pre">mc.ao2mo()</span></code> method.</p>
</dd>
<dt>sort (bool): Whether the canonicalized orbitals are sorted based on</dt><dd><p>the orbital energy (diagonal part of the effective Fock matrix)
within each subspace (core, active, external). If point group
symmetry is not available in the system, orbitals are always
sorted. When point group symmetry is available, sort=False will
preserve the symmetry label of input orbitals and only sort the
orbitals in each symmetry sector. sort=True will reorder all
orbitals over all symmetry sectors in each subspace and the
symmetry labels may be changed.</p>
</dd>
<dt>cas_natorb (bool): Whether to transform active orbitals to natual</dt><dd><p>orbitals. If enabled, the output orbitals in active space are
transformed to natural orbitals and CI coefficients are updated
accordingly.</p>
</dd>
<dt>casdm1 (ndarray): 1-particle density matrix in active space. This</dt><dd><p>density matrix is used to build effective fock matrix. Without
input casdm1, the density matrix is computed with the input ci
coefficients/object. If neither ci nor casdm1 were given, density
matrix is computed by <code class="xref py py-func docutils literal notranslate"><span class="pre">mc.fcisolver.make_rdm1()</span></code> method. For
state-average CASCI/CASCF calculation, this results in a set of
canonicalized orbitals of state-average effective Fock matrix.
To canonicalize the orbitals for one particular state, you can
assign the density matrix of that state to the kwarg casdm1.</p>
</dd>
<dt>stav_dm1 (bool): Use state-average 1-particle density matrix for</dt><dd><p>computing Fock matrices and natural orbitals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tuple, (natural orbitals, CI coefficients, orbital energies)
The orbital energies are the diagonal terms of effective Fock matrix.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.cas_natorb">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci.</span></span><span class="sig-name descname"><span class="pre">cas_natorb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta_lowdin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#cas_natorb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.cas_natorb" title="Link to this definition"></a></dt>
<dd><p>Transform active orbitals to natural orbitals, and update the CI wfn
accordingly</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mc : a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>sort<span class="classifier">bool</span></dt><dd><p>Sort natural orbitals wrt the occupancy.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tuple, the first item is natural orbitals, the second is updated CI
coefficients, the third is the natural occupancy associated to the
natural orbitals.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.get_fock">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci.</span></span><span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.get_fock" title="Link to this definition"></a></dt>
<dd><p>Effective one-electron Fock matrix in AO representation
f = sum_{pq} E_{pq} F_{pq}
F_{pq} = h_{pq} + sum_{rs} [(pq|rs)-(ps|rq)] DM_{sr}</p>
<p>Ref.
Theor. Chim. Acta., 91, 31
Chem. Phys. 48, 157</p>
<p>For state-average CASCI/CASSCF object, the effective fock matrix is based
on the state-average density matrix.  To obtain Fock matrix of a specific
state in the state-average calculations, you can pass casdm1 of the
specific state to this function.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mc: a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>mo_coeff (ndarray): orbitals that span the core, active and external</dt><dd><p>space.</p>
</dd>
<dt>ci (ndarray): CI coefficients (or objects to represent the CI</dt><dd><p>wavefunctions in DMRG/QMC-MCSCF calculations).</p>
</dd>
<dt>eris: Integrals for the MCSCF object. Input this object to reduce the</dt><dd><p>overhead of computing integrals. It can be generated by
<code class="xref py py-func docutils literal notranslate"><span class="pre">mc.ao2mo()</span></code> method.</p>
</dd>
<dt>casdm1 (ndarray): 1-particle density matrix in active space. Without</dt><dd><p>input casdm1, the density matrix is computed with the input ci
coefficients/object. If neither ci nor casdm1 were given, density
matrix is computed by <code class="xref py py-func docutils literal notranslate"><span class="pre">mc.fcisolver.make_rdm1()</span></code> method. For
state-average CASCI/CASCF calculation, this results in the
effective Fock matrix based on the state-average density matrix.
To obtain the effective Fock matrix for one particular state, you
can assign the density matrix of that state to the kwarg casdm1.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Fock matrix</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.h1e_for_cas">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci.</span></span><span class="sig-name descname"><span class="pre">h1e_for_cas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#h1e_for_cas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.h1e_for_cas" title="Link to this definition"></a></dt>
<dd><p>CAS sapce one-electron hamiltonian</p>
<dl class="simple">
<dt>Args:</dt><dd><p>casci : a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Returns:</dt><dd><p>A tuple, the first is the effective one-electron hamiltonian defined in CAS space,
the second is the electronic energy from core.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.casci.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci.kernel" title="Link to this definition"></a></dt>
<dd><p>CASCI solver</p>
<dl>
<dt>Args:</dt><dd><p>casci: CASCI or CASSCF object</p>
<dl class="simple">
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>orbitals to construct active space Hamiltonian</p>
</dd>
<dt>ci0<span class="classifier">ndarray or custom types</span></dt><dd><p>FCI sovler initial guess. For external FCI-like solvers, it can be
overloaded different data type. For example, in the state-average
FCI solver, ci0 is a list of ndarray. In other solvers such as
DMRGCI solver, SHCI solver, ci0 are custom types.</p>
</dd>
</dl>
</dd>
<dt>kwargs:</dt><dd><dl class="simple">
<dt>envs: dict</dt><dd><p>The variable envs is created (for PR 807) to passes MCSCF runtime
environment variables to SHCI solver. For solvers which do not
need this parameter, a kwargs should be created in kernel method
and envs pop in kernel function</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-pyscf.mcscf.casci_symm">
<span id="pyscf-mcscf-casci-symm-module"></span><h2 id="module-pyscf.mcscf.casci_symm">pyscf.mcscf.casci_symm module<a class="headerlink" href="#module-pyscf.mcscf.casci_symm" title="Link to this heading"></a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.casci_symm.CASCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci_symm.</span></span><span class="sig-name descname"><span class="pre">CASCI</span></span><a class="headerlink" href="#pyscf.mcscf.casci_symm.CASCI" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.mcscf.casci_symm.SymAdaptedCASCI" title="pyscf.mcscf.casci_symm.SymAdaptedCASCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymAdaptedCASCI</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.casci_symm.SymAdaptedCASCI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci_symm.</span></span><span class="sig-name descname"><span class="pre">SymAdaptedCASCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci_symm.html#SymAdaptedCASCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci_symm.SymAdaptedCASCI" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.casci.CASCI" title="pyscf.mcscf.casci.CASCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">CASCI</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci_symm.SymAdaptedCASCI.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci_symm.html#SymAdaptedCASCI.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci_symm.SymAdaptedCASCI.kernel" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><p>Five elements, they are
total energy,
active space CI energy,
the active space FCI wavefunction coefficients or DMRG wavefunction ID,
the MCSCF canonical orbital coefficients,
the MCSCF canonical orbital coefficients.</p>
</dd>
</dl>
<p>They are attributes of mcscf object, which can be accessed by
.e_tot, .e_cas, .ci, .mo_coeff, .mo_energy</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.casci_symm.SymAdaptedCASCI.sort_mo_by_irrep">
<span class="sig-name descname"><span class="pre">sort_mo_by_irrep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cas_irrep_nocc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cas_irrep_ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci_symm.html#SymAdaptedCASCI.sort_mo_by_irrep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci_symm.SymAdaptedCASCI.sort_mo_by_irrep" title="Link to this definition"></a></dt>
<dd><p>Select active space based on symmetry information.
See also <a class="reference internal" href="#pyscf.mcscf.addons.sort_mo_by_irrep" title="pyscf.mcscf.addons.sort_mo_by_irrep"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyscf.mcscf.addons.sort_mo_by_irrep()</span></code></a></p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.casci_symm.SymAdaptedCASCI.wfnsym">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wfnsym</span></span><a class="headerlink" href="#pyscf.mcscf.casci_symm.SymAdaptedCASCI.wfnsym" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.casci_symm.eig">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci_symm.</span></span><span class="sig-name descname"><span class="pre">eig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbsym</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci_symm.html#eig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci_symm.eig" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.casci_symm.label_symmetry_">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.casci_symm.</span></span><span class="sig-name descname"><span class="pre">label_symmetry_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/casci_symm.html#label_symmetry_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.casci_symm.label_symmetry_" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf.chkfile">
<span id="pyscf-mcscf-chkfile-module"></span><h2 id="module-pyscf.mcscf.chkfile">pyscf.mcscf.chkfile module<a class="headerlink" href="#module-pyscf.mcscf.chkfile" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.chkfile.dump_mcscf">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.chkfile.</span></span><span class="sig-name descname"><span class="pre">dump_mcscf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mcscf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_tot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_cas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/chkfile.html#dump_mcscf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.chkfile.dump_mcscf" title="Link to this definition"></a></dt>
<dd><p>Save CASCI/CASSCF calculation results or intermediates in chkfile.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.chkfile.load_mcscf">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.chkfile.</span></span><span class="sig-name descname"><span class="pre">load_mcscf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/chkfile.html#load_mcscf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.chkfile.load_mcscf" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf.df">
<span id="pyscf-mcscf-df-module"></span><h2 id="module-pyscf.mcscf.df">pyscf.mcscf.df module<a class="headerlink" href="#module-pyscf.mcscf.df" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.df.approx_hessian">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.df.</span></span><span class="sig-name descname"><span class="pre">approx_hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/df.html#approx_hessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.df.approx_hessian" title="Link to this definition"></a></dt>
<dd><p>Approximate the orbital hessian with density fitting integrals</p>
<p>Note this function has no effects if the input casscf object is DF-CASSCF.
It only modifies the orbital hessian of normal CASSCF object.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>casscf : an CASSCF object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>auxbasis<span class="classifier">str or basis dict</span></dt><dd><p>Same format to the input attribute mol.basis.
The default basis weigend+etb means weigend-coulomb-fit basis
for light elements and even-tempered basis for heavy elements.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A CASSCF object with approximated JK contraction for orbital hessian</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; F 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">approx_hessian</span><span class="p">(</span><span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">-100.06458716530391</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.df.density_fit">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.df.</span></span><span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/df.html#density_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.df.density_fit" title="Link to this definition"></a></dt>
<dd><p>Generate DF-CASSCF for given CASSCF object.  It is done by overwriting
three CASSCF member functions:</p>
<blockquote>
<div><ul class="simple">
<li><p>casscf.ao2mo which generates MO integrals</p></li>
<li><p>casscf.get_veff which generate JK from core density matrix</p></li>
<li><p>casscf.get_jk which</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Args:</dt><dd><p>casscf : an CASSCF object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>auxbasis<span class="classifier">str or basis dict</span></dt><dd><p>Same format to the input attribute mol.basis.  If auxbasis is
None, auxiliary basis based on AO basis (if possible) or
even-tempered Gaussian basis will be used.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>An CASSCF object with a modified J, K matrix constructor which uses density
fitting integrals to compute J and K</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; F 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">DFCASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">-100.05994191570504</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.df.prange">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.df.</span></span><span class="sig-name descname"><span class="pre">prange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/df.html#prange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.df.prange" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf.dmet_cas">
<span id="pyscf-mcscf-dmet-cas-module"></span><h2 id="module-pyscf.mcscf.dmet_cas">pyscf.mcscf.dmet_cas module<a class="headerlink" href="#module-pyscf.mcscf.dmet_cas" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.dmet_cas.dmet_cas">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.dmet_cas.</span></span><span class="sig-name descname"><span class="pre">dmet_cas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aolabels_or_baslst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occ_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orth_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'meta_lowdin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonicalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freeze_imp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.dmet_cas.dmet_cas" title="Link to this definition"></a></dt>
<dd><p>DMET method to generate CASSCF initial guess.
Ref. arXiv:1701.07862 [physics.chem-ph]</p>
<dl>
<dt>Args:</dt><dd><p>mf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code> object</p>
<dl class="simple">
<dt>dm<span class="classifier">2D np.array or a list of 2D array</span></dt><dd><p>Density matrix</p>
</dd>
<dt>aolabels_or_baslst<span class="classifier">string or a list of strings or a list of index</span></dt><dd><p>AO labels or indices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>threshold<span class="classifier">float</span></dt><dd><p>Entanglement threshold of DMET bath.  If the occupancy of an
orbital is less than threshold, the orbital is considered as bath
orbtial.  If occ is greater than (1-threshold), the orbitals are
taken for core determinant.</p>
</dd>
<dt>base<span class="classifier">int</span></dt><dd><p>0-based (C-style) or 1-based (Fortran-style) for baslst if baslst
is index list</p>
</dd>
<dt>orth_method<span class="classifier">str</span></dt><dd><p>It can be one of lowdin and meta_lowdin</p>
</dd>
<dt>s<span class="classifier">2D array</span></dt><dd><p>AO overlap matrix.  This option is mainly used for custom Hamilatonian.</p>
</dd>
<dt>canonicalize<span class="classifier">bool</span></dt><dd><p>Orbitals defined in AVAS method are local orbitals.  Symmetrizing
the core, active and virtual space.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>active-space-size, #-active-electrons, orbital-initial-guess-for-CASCI/CASSCF</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.mcscf</span> <span class="kn">import</span> <span class="n">dmet_cas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'Cr 0 0 0; Cr 0 0 1.6'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvtz'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">,</span> <span class="n">mo</span> <span class="o">=</span> <span class="n">dmet_cas</span><span class="o">.</span><span class="n">dmet_cas</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="p">[</span><span class="s1">'Cr 3d'</span><span class="p">,</span> <span class="s1">'Cr 4s'</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.dmet_cas.guess_cas">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.dmet_cas.</span></span><span class="sig-name descname"><span class="pre">guess_cas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aolabels_or_baslst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occ_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orth_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'meta_lowdin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonicalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freeze_imp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.dmet_cas.guess_cas" title="Link to this definition"></a></dt>
<dd><p>DMET method to generate CASSCF initial guess.
Ref. arXiv:1701.07862 [physics.chem-ph]</p>
<dl>
<dt>Args:</dt><dd><p>mf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code> object</p>
<dl class="simple">
<dt>dm<span class="classifier">2D np.array or a list of 2D array</span></dt><dd><p>Density matrix</p>
</dd>
<dt>aolabels_or_baslst<span class="classifier">string or a list of strings or a list of index</span></dt><dd><p>AO labels or indices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>threshold<span class="classifier">float</span></dt><dd><p>Entanglement threshold of DMET bath.  If the occupancy of an
orbital is less than threshold, the orbital is considered as bath
orbtial.  If occ is greater than (1-threshold), the orbitals are
taken for core determinant.</p>
</dd>
<dt>base<span class="classifier">int</span></dt><dd><p>0-based (C-style) or 1-based (Fortran-style) for baslst if baslst
is index list</p>
</dd>
<dt>orth_method<span class="classifier">str</span></dt><dd><p>It can be one of lowdin and meta_lowdin</p>
</dd>
<dt>s<span class="classifier">2D array</span></dt><dd><p>AO overlap matrix.  This option is mainly used for custom Hamilatonian.</p>
</dd>
<dt>canonicalize<span class="classifier">bool</span></dt><dd><p>Orbitals defined in AVAS method are local orbitals.  Symmetrizing
the core, active and virtual space.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>active-space-size, #-active-electrons, orbital-initial-guess-for-CASCI/CASSCF</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.mcscf</span> <span class="kn">import</span> <span class="n">dmet_cas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'Cr 0 0 0; Cr 0 0 1.6'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvtz'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">,</span> <span class="n">mo</span> <span class="o">=</span> <span class="n">dmet_cas</span><span class="o">.</span><span class="n">dmet_cas</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="p">[</span><span class="s1">'Cr 3d'</span><span class="p">,</span> <span class="s1">'Cr 4s'</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.dmet_cas.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.dmet_cas.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aolabels_or_baslst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occ_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orth_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'meta_lowdin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonicalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freeze_imp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/dmet_cas.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.dmet_cas.kernel" title="Link to this definition"></a></dt>
<dd><p>DMET method to generate CASSCF initial guess.
Ref. arXiv:1701.07862 [physics.chem-ph]</p>
<dl>
<dt>Args:</dt><dd><p>mf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code> object</p>
<dl class="simple">
<dt>dm<span class="classifier">2D np.array or a list of 2D array</span></dt><dd><p>Density matrix</p>
</dd>
<dt>aolabels_or_baslst<span class="classifier">string or a list of strings or a list of index</span></dt><dd><p>AO labels or indices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>threshold<span class="classifier">float</span></dt><dd><p>Entanglement threshold of DMET bath.  If the occupancy of an
orbital is less than threshold, the orbital is considered as bath
orbtial.  If occ is greater than (1-threshold), the orbitals are
taken for core determinant.</p>
</dd>
<dt>base<span class="classifier">int</span></dt><dd><p>0-based (C-style) or 1-based (Fortran-style) for baslst if baslst
is index list</p>
</dd>
<dt>orth_method<span class="classifier">str</span></dt><dd><p>It can be one of lowdin and meta_lowdin</p>
</dd>
<dt>s<span class="classifier">2D array</span></dt><dd><p>AO overlap matrix.  This option is mainly used for custom Hamilatonian.</p>
</dd>
<dt>canonicalize<span class="classifier">bool</span></dt><dd><p>Orbitals defined in AVAS method are local orbitals.  Symmetrizing
the core, active and virtual space.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>active-space-size, #-active-electrons, orbital-initial-guess-for-CASCI/CASSCF</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.mcscf</span> <span class="kn">import</span> <span class="n">dmet_cas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'Cr 0 0 0; Cr 0 0 1.6'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvtz'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">,</span> <span class="n">mo</span> <span class="o">=</span> <span class="n">dmet_cas</span><span class="o">.</span><span class="n">dmet_cas</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="p">[</span><span class="s1">'Cr 3d'</span><span class="p">,</span> <span class="s1">'Cr 4s'</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">ncas</span><span class="p">,</span> <span class="n">nelecas</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.dmet_cas.search_for_degeneracy">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.dmet_cas.</span></span><span class="sig-name descname"><span class="pre">search_for_degeneracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/dmet_cas.html#search_for_degeneracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.dmet_cas.search_for_degeneracy" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.dmet_cas.symmetrize">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.dmet_cas.</span></span><span class="sig-name descname"><span class="pre">symmetrize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/dmet_cas.html#symmetrize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.dmet_cas.symmetrize" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf.mc1step">
<span id="pyscf-mcscf-mc1step-module"></span><h2 id="module-pyscf.mcscf.mc1step">pyscf.mcscf.mc1step module<a class="headerlink" href="#module-pyscf.mcscf.mc1step" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc1step.</span></span><span class="sig-name descname"><span class="pre">CASSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.casci.CASBase" title="pyscf.mcscf.casci.CASBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">CASBase</span></code></a></p>
<p>CASCI/CASSCF</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>mf_or_mol<span class="classifier">SCF object or Mole object</span></dt><dd><p>SCF or Mole to define the problem size.</p>
</dd>
<dt>ncas<span class="classifier">int</span></dt><dd><p>Number of active orbitals.</p>
</dd>
<dt>nelecas<span class="classifier">int or a pair of int</span></dt><dd><p>Number of electrons in active space.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ncore<span class="classifier">int</span></dt><dd><p>Number of doubly occupied core orbitals. If not presented, this
parameter can be automatically determined.</p>
</dd>
</dl>
</dd>
<dt>Attributes:</dt><dd><dl>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code>.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code>.</p>
</dd>
<dt>ncas<span class="classifier">int</span></dt><dd><p>Active space size.</p>
</dd>
<dt>nelecas<span class="classifier">tuple of int</span></dt><dd><p>Active (nelec_alpha, nelec_beta)</p>
</dd>
<dt>ncore<span class="classifier">int or tuple of int</span></dt><dd><p>Core electron number.  In UHF-CASSCF, its a tuple to indicate the different core eletron numbers.</p>
</dd>
<dt>natorb<span class="classifier">bool</span></dt><dd><p>Whether to transform natural orbitals in active space.
Note: when CASCI/CASSCF are combined with DMRG solver or selected
CI solver, enabling this parameter may slightly change the total energy.
False by default.</p>
</dd>
<dt>canonicalization<span class="classifier">bool</span></dt><dd><p>Whether to canonicalize orbitals in core and external space
against the general Fock matrix.
The orbitals in active space are NOT transformed by default. To
get the natural orbitals in active space, the attribute .natorb
needs to be enabled.
True by default.</p>
</dd>
<dt>sorting_mo_energy<span class="classifier">bool</span></dt><dd><p>Whether to sort the orbitals based on the diagonal elements of the
general Fock matrix.  Default is False.</p>
</dd>
<dt>fcisolver<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></span></dt><dd><p>The pyscf.fci module provides several FCISolver for different scenario.  Generally,
fci.direct_spin1.FCISolver can be used for all RHF-CASSCF.  However, a proper FCISolver
can provide better performance and better numerical stability.  One can either use
<code class="xref py py-func docutils literal notranslate"><span class="pre">fci.solver()</span></code> function to pick the FCISolver by the program or manually assigen
the FCISolver to this attribute, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCISolver</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>You can control FCISolver by setting e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">max_cycle</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mf">1e-7</span>
</pre></div>
</div>
<p>For more details of the parameter for FCISolver, See <code class="xref py py-mod docutils literal notranslate"><span class="pre">fci</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total MCSCF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>e_cas<span class="classifier">float</span></dt><dd><p>CAS space FCI energy</p>
</dd>
<dt>ci<span class="classifier">ndarray</span></dt><dd><p>CAS space FCI coefficients</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>When canonicalization is specified, the orbitals are canonical
orbitals which make the general Fock matrix (Fock operator on top
of MCSCF 1-particle density matrix) diagonalized within each
subspace (core, active, external).  If natorb (natural orbitals in
active space) is specified, the active segment of the mo_coeff is
natural orbitls.</p>
</dd>
<dt>mo_energy<span class="classifier">ndarray</span></dt><dd><p>Diagonal elements of general Fock matrix (in mo_coeff
representation).</p>
</dd>
<dt>mo_occ<span class="classifier">ndarray</span></dt><dd><p>Occupation numbers of natural orbitals if natorb is specified.</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.980200816243354</span>
</pre></div>
</div>
<p>Extra attributes for CASSCF:</p>
<blockquote>
<div><dl>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Converge threshold.  Default is 1e-7</p>
</dd>
<dt>conv_tol_grad<span class="classifier">float</span></dt><dd><p>Converge threshold for CI gradients and orbital rotation gradients.
Default is 1e-4</p>
</dd>
<dt>max_stepsize<span class="classifier">float</span></dt><dd><p>The step size for orbital rotation.  Small step (0.005 - 0.05) is prefered.
Default is 0.03.</p>
</dd>
<dt>max_cycle_macro<span class="classifier">int</span></dt><dd><p>Max number of macro iterations.  Default is 50.</p>
</dd>
<dt>max_cycle_micro<span class="classifier">int</span></dt><dd><p>Max number of micro iterations in each macro iteration.  Depending on
systems, increasing this value might reduce the total macro
iterations.  Generally, 2 - 5 steps should be enough.  Default is 3.</p>
</dd>
<dt>small_rot_tol<span class="classifier">float</span></dt><dd><p>Threshold for orbital rotation to be considered small. If the largest orbital
rotation is smaller than this value, the CI solver will restart from the
previous iteration if supported.
Default is 0.01</p>
</dd>
<dt>ah_level_shift<span class="classifier">float, for AH solver.</span></dt><dd><p>Level shift for the Davidson diagonalization in AH solver.  Default is 1e-8.</p>
</dd>
<dt>ah_conv_tol<span class="classifier">float, for AH solver.</span></dt><dd><p>converge threshold for AH solver.  Default is 1e-12.</p>
</dd>
<dt>ah_max_cycle<span class="classifier">float, for AH solver.</span></dt><dd><p>Max number of iterations allowd in AH solver.  Default is 30.</p>
</dd>
<dt>ah_lindep<span class="classifier">float, for AH solver.</span></dt><dd><p>Linear dependence threshold for AH solver.  Default is 1e-14.</p>
</dd>
<dt>ah_start_tol<span class="classifier">flat, for AH solver.</span></dt><dd><p>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 0.2.</p>
</dd>
<dt>ah_start_cycle<span class="classifier">int, for AH solver.</span></dt><dd><p>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 2.</p>
<p><code class="docutils literal notranslate"><span class="pre">ah_conv_tol</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_max_cycle</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_lindep</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_start_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">ah_start_cycle</span></code>
can affect the accuracy and performance of CASSCF solver.  Lower
<code class="docutils literal notranslate"><span class="pre">ah_conv_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">ah_lindep</span></code> might improve the accuracy of CASSCF
optimization, but decrease the performance.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401898486001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401887945668</span>
</pre></div>
</div>
</dd>
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Checkpoint file to save the intermediate orbitals during the CASSCF optimization.
Default is the checkpoint file of mean field object.</p>
</dd>
<dt>ci_response_space<span class="classifier">int</span></dt><dd><p>subspace size to solve the CI vector response.  Default is 3.</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
envrionment.</p>
</dd>
<dt>scale_restoration<span class="classifier">float</span></dt><dd><p>When a step of orbital rotation moves out of trust region, the
orbital optimization will be restored to previous state and the
step size of the orbital rotation needs to be reduced.
scale_restoration controls how much to scale down the step size.</p>
</dd>
</dl>
</div></blockquote>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total MCSCF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>e_cas<span class="classifier">float</span></dt><dd><p>CAS space FCI energy</p>
</dd>
<dt>ci<span class="classifier">ndarray</span></dt><dd><p>CAS space FCI coefficients</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Optimized CASSCF orbitals coefficients. When canonicalization is
specified, the returned orbitals make the general Fock matrix
(Fock operator on top of MCSCF 1-particle density matrix)
diagonalized within each subspace (core, active, external). If
natorb (natural orbitals in active space) is enabled, the active
segment of mo_coeff is transformed to natural orbitals.</p>
</dd>
<dt>mo_energy<span class="classifier">ndarray</span></dt><dd><p>Diagonal elements of general Fock matrix (in mo_coeff
representation).</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401882238134</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.Gradients">
<span class="sig-name descname"><span class="pre">Gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.Gradients" title="Link to this definition"></a></dt>
<dd><p>Non-relativistic restricted Hartree-Fock gradients</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ah_conv_tol">
<span class="sig-name descname"><span class="pre">ah_conv_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-12</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ah_conv_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ah_grad_trust_region">
<span class="sig-name descname"><span class="pre">ah_grad_trust_region</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3.0</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ah_grad_trust_region" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ah_level_shift">
<span class="sig-name descname"><span class="pre">ah_level_shift</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ah_level_shift" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ah_lindep">
<span class="sig-name descname"><span class="pre">ah_lindep</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-14</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ah_lindep" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ah_max_cycle">
<span class="sig-name descname"><span class="pre">ah_max_cycle</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">30</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ah_max_cycle" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ah_scheduler">
<span class="sig-name descname"><span class="pre">ah_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.ah_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ah_scheduler" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ah_start_cycle">
<span class="sig-name descname"><span class="pre">ah_start_cycle</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ah_start_cycle" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ah_start_tol">
<span class="sig-name descname"><span class="pre">ah_start_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2.5</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ah_start_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ao2mo" title="Link to this definition"></a></dt>
<dd><p>Compute the active space two-particle Hamiltonian.</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ao2mo_level">
<span class="sig-name descname"><span class="pre">ao2mo_level</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ao2mo_level" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.approx_hessian">
<span class="sig-name descname"><span class="pre">approx_hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.approx_hessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.approx_hessian" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.as_scanner">
<span class="sig-name descname"><span class="pre">as_scanner</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.as_scanner" title="Link to this definition"></a></dt>
<dd><p>Generating a scanner for CASSCF PES.</p>
<p>The returned solver is a function. This function requires one argument
mol as input and returns total CASSCF energy.</p>
<p>The solver will automatically use the results of last calculation as the
initial guess of the new calculation.  All parameters of MCSCF object
(conv_tol, max_memory etc) are automatically applied in the solver.</p>
<p>Note scanner has side effects.  It may change many underlying objects
(_scf, with_df, with_x2c, ) during calculation.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.2'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.1'</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.5'</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.callback" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.canonicalization">
<span class="sig-name descname"><span class="pre">canonicalization</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.canonicalization" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.casci">
<span class="sig-name descname"><span class="pre">casci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.casci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.casci" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.chk_ci">
<span class="sig-name descname"><span class="pre">chk_ci</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.chk_ci" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ci_grad_trust_region">
<span class="sig-name descname"><span class="pre">ci_grad_trust_region</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3.0</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ci_grad_trust_region" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ci_response_space">
<span class="sig-name descname"><span class="pre">ci_response_space</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ci_response_space" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.ci_update_dep">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ci_update_dep</span></span><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.ci_update_dep" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.conv_tol">
<span class="sig-name descname"><span class="pre">conv_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-07</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.conv_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.conv_tol_grad">
<span class="sig-name descname"><span class="pre">conv_tol_grad</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.conv_tol_grad" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.dump_chk">
<span class="sig-name descname"><span class="pre">dump_chk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.dump_chk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.dump_chk" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.dump_flags" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.extrasym">
<span class="sig-name descname"><span class="pre">extrasym</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.extrasym" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.gen_g_hop">
<span class="sig-name descname"><span class="pre">gen_g_hop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.gen_g_hop" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.get_grad">
<span class="sig-name descname"><span class="pre">get_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1_casdm2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.get_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.get_grad" title="Link to this definition"></a></dt>
<dd><p>Orbital gradients</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.get_h2eff">
<span class="sig-name descname"><span class="pre">get_h2eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.get_h2eff" title="Link to this definition"></a></dt>
<dd><p>Compute the active space two-particle Hamiltonian.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.grad_update_dep">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grad_update_dep</span></span><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.grad_update_dep" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.internal_rotation">
<span class="sig-name descname"><span class="pre">internal_rotation</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.internal_rotation" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_kern=&lt;function</span> <span class="pre">kernel&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.kernel" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><p>Five elements, they are
total energy,
active space CI energy,
the active space FCI wavefunction coefficients or DMRG wavefunction ID,
the MCSCF canonical orbital coefficients,
the MCSCF canonical orbital coefficients.</p>
</dd>
</dl>
<p>They are attributes of mcscf object, which can be accessed by
.e_tot, .e_cas, .ci, .mo_coeff, .mo_energy</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.kf_interval">
<span class="sig-name descname"><span class="pre">kf_interval</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.kf_interval" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.kf_trust_region">
<span class="sig-name descname"><span class="pre">kf_trust_region</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3.0</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.kf_trust_region" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.max_cycle">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_cycle</span></span><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.max_cycle" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.max_cycle_macro">
<span class="sig-name descname"><span class="pre">max_cycle_macro</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">50</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.max_cycle_macro" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.max_cycle_micro">
<span class="sig-name descname"><span class="pre">max_cycle_micro</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.max_cycle_micro" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.max_orb_stepsize">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_orb_stepsize</span></span><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.max_orb_stepsize" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.max_stepsize">
<span class="sig-name descname"><span class="pre">max_stepsize</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.02</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.max_stepsize" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.max_stepsize_scheduler">
<span class="sig-name descname"><span class="pre">max_stepsize_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.max_stepsize_scheduler" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.mc1step">
<span class="sig-name descname"><span class="pre">mc1step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.mc1step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.mc1step" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.mc2step">
<span class="sig-name descname"><span class="pre">mc2step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.mc2step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.mc2step" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.micro_cycle_scheduler">
<span class="sig-name descname"><span class="pre">micro_cycle_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.micro_cycle_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.micro_cycle_scheduler" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.natorb">
<span class="sig-name descname"><span class="pre">natorb</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.natorb" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.newton">
<span class="sig-name descname"><span class="pre">newton</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.newton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.newton" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.nuc_grad_method" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.pack_uniq_var">
<span class="sig-name descname"><span class="pre">pack_uniq_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.pack_uniq_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.pack_uniq_var" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.rotate_mo">
<span class="sig-name descname"><span class="pre">rotate_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.rotate_mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.rotate_mo" title="Link to this definition"></a></dt>
<dd><p>Rotate orbitals with the given unitary matrix</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.rotate_orb_cc">
<span class="sig-name descname"><span class="pre">rotate_orb_cc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcasdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcasdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.rotate_orb_cc" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.scale_restoration">
<span class="sig-name descname"><span class="pre">scale_restoration</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.scale_restoration" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.small_rot_tol">
<span class="sig-name descname"><span class="pre">small_rot_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.01</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.small_rot_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.solve_approx_ci">
<span class="sig-name descname"><span class="pre">solve_approx_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_cas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.solve_approx_ci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.solve_approx_ci" title="Link to this definition"></a></dt>
<dd><p>Solve CI eigenvalue/response problem approximately</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.sorting_mo_energy">
<span class="sig-name descname"><span class="pre">sorting_mo_energy</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.sorting_mo_energy" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.uniq_var_indices">
<span class="sig-name descname"><span class="pre">uniq_var_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.uniq_var_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.uniq_var_indices" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.unpack_uniq_var">
<span class="sig-name descname"><span class="pre">unpack_uniq_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.unpack_uniq_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.unpack_uniq_var" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.update" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.update_ao2mo">
<span class="sig-name descname"><span class="pre">update_ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.update_ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.update_ao2mo" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.update_casdm">
<span class="sig-name descname"><span class="pre">update_casdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_cas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.update_casdm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.update_casdm" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.update_from_chk">
<span class="sig-name descname"><span class="pre">update_from_chk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.update_from_chk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.update_from_chk" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.update_jk_in_ah">
<span class="sig-name descname"><span class="pre">update_jk_in_ah</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.update_jk_in_ah"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.update_jk_in_ah" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.update_rotate_matrix">
<span class="sig-name descname"><span class="pre">update_rotate_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF.update_rotate_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.update_rotate_matrix" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF.with_dep4">
<span class="sig-name descname"><span class="pre">with_dep4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.with_dep4" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.CASSCF_Scanner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc1step.</span></span><span class="sig-name descname"><span class="pre">CASSCF_Scanner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#CASSCF_Scanner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF_Scanner" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.SinglePointScanner" title="pyscf.lib.misc.SinglePointScanner"><code class="xref py py-class docutils literal notranslate"><span class="pre">SinglePointScanner</span></code></a></p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.as_scanner">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc1step.</span></span><span class="sig-name descname"><span class="pre">as_scanner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#as_scanner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.as_scanner" title="Link to this definition"></a></dt>
<dd><p>Generating a scanner for CASSCF PES.</p>
<p>The returned solver is a function. This function requires one argument
mol as input and returns total CASSCF energy.</p>
<p>The solver will automatically use the results of last calculation as the
initial guess of the new calculation.  All parameters of MCSCF object
(conv_tol, max_memory etc) are automatically applied in the solver.</p>
<p>Note scanner has side effects.  It may change many underlying objects
(_scf, with_df, with_x2c, ) during calculation.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.2'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.1'</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.5'</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.expmat">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc1step.</span></span><span class="sig-name descname"><span class="pre">expmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#expmat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.expmat" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.gen_g_hop">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc1step.</span></span><span class="sig-name descname"><span class="pre">gen_g_hop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#gen_g_hop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.gen_g_hop" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc1step.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.kernel" title="Link to this definition"></a></dt>
<dd><p>quasi-newton CASSCF optimization driver</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.max_stepsize_scheduler">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc1step.</span></span><span class="sig-name descname"><span class="pre">max_stepsize_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#max_stepsize_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.max_stepsize_scheduler" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step.rotate_orb_cc">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc1step.</span></span><span class="sig-name descname"><span class="pre">rotate_orb_cc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcasdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcasdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step.html#rotate_orb_cc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.rotate_orb_cc" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf.mc1step_symm">
<span id="pyscf-mcscf-mc1step-symm-module"></span><h2 id="module-pyscf.mcscf.mc1step_symm">pyscf.mcscf.mc1step_symm module<a class="headerlink" href="#module-pyscf.mcscf.mc1step_symm" title="Link to this heading"></a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step_symm.CASSCF">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc1step_symm.</span></span><span class="sig-name descname"><span class="pre">CASSCF</span></span><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.CASSCF" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF" title="pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymAdaptedCASSCF</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc1step_symm.</span></span><span class="sig-name descname"><span class="pre">SymAdaptedCASSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step_symm.html#SymAdaptedCASSCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.mc1step.CASSCF" title="pyscf.mcscf.mc1step.CASSCF"><code class="xref py py-class docutils literal notranslate"><span class="pre">CASSCF</span></code></a></p>
<p>CASCI/CASSCF</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>mf_or_mol<span class="classifier">SCF object or Mole object</span></dt><dd><p>SCF or Mole to define the problem size.</p>
</dd>
<dt>ncas<span class="classifier">int</span></dt><dd><p>Number of active orbitals.</p>
</dd>
<dt>nelecas<span class="classifier">int or a pair of int</span></dt><dd><p>Number of electrons in active space.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ncore<span class="classifier">int</span></dt><dd><p>Number of doubly occupied core orbitals. If not presented, this
parameter can be automatically determined.</p>
</dd>
</dl>
</dd>
<dt>Attributes:</dt><dd><dl>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code>.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code>.</p>
</dd>
<dt>ncas<span class="classifier">int</span></dt><dd><p>Active space size.</p>
</dd>
<dt>nelecas<span class="classifier">tuple of int</span></dt><dd><p>Active (nelec_alpha, nelec_beta)</p>
</dd>
<dt>ncore<span class="classifier">int or tuple of int</span></dt><dd><p>Core electron number.  In UHF-CASSCF, its a tuple to indicate the different core eletron numbers.</p>
</dd>
<dt>natorb<span class="classifier">bool</span></dt><dd><p>Whether to transform natural orbitals in active space.
Note: when CASCI/CASSCF are combined with DMRG solver or selected
CI solver, enabling this parameter may slightly change the total energy.
False by default.</p>
</dd>
<dt>canonicalization<span class="classifier">bool</span></dt><dd><p>Whether to canonicalize orbitals in core and external space
against the general Fock matrix.
The orbitals in active space are NOT transformed by default. To
get the natural orbitals in active space, the attribute .natorb
needs to be enabled.
True by default.</p>
</dd>
<dt>sorting_mo_energy<span class="classifier">bool</span></dt><dd><p>Whether to sort the orbitals based on the diagonal elements of the
general Fock matrix.  Default is False.</p>
</dd>
<dt>fcisolver<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></span></dt><dd><p>The pyscf.fci module provides several FCISolver for different scenario.  Generally,
fci.direct_spin1.FCISolver can be used for all RHF-CASSCF.  However, a proper FCISolver
can provide better performance and better numerical stability.  One can either use
<code class="xref py py-func docutils literal notranslate"><span class="pre">fci.solver()</span></code> function to pick the FCISolver by the program or manually assigen
the FCISolver to this attribute, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCISolver</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>You can control FCISolver by setting e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">max_cycle</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mf">1e-7</span>
</pre></div>
</div>
<p>For more details of the parameter for FCISolver, See <code class="xref py py-mod docutils literal notranslate"><span class="pre">fci</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total MCSCF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>e_cas<span class="classifier">float</span></dt><dd><p>CAS space FCI energy</p>
</dd>
<dt>ci<span class="classifier">ndarray</span></dt><dd><p>CAS space FCI coefficients</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>When canonicalization is specified, the orbitals are canonical
orbitals which make the general Fock matrix (Fock operator on top
of MCSCF 1-particle density matrix) diagonalized within each
subspace (core, active, external).  If natorb (natural orbitals in
active space) is specified, the active segment of the mo_coeff is
natural orbitls.</p>
</dd>
<dt>mo_energy<span class="classifier">ndarray</span></dt><dd><p>Diagonal elements of general Fock matrix (in mo_coeff
representation).</p>
</dd>
<dt>mo_occ<span class="classifier">ndarray</span></dt><dd><p>Occupation numbers of natural orbitals if natorb is specified.</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.980200816243354</span>
</pre></div>
</div>
<p>Extra attributes for CASSCF:</p>
<blockquote>
<div><dl>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Converge threshold.  Default is 1e-7</p>
</dd>
<dt>conv_tol_grad<span class="classifier">float</span></dt><dd><p>Converge threshold for CI gradients and orbital rotation gradients.
Default is 1e-4</p>
</dd>
<dt>max_stepsize<span class="classifier">float</span></dt><dd><p>The step size for orbital rotation.  Small step (0.005 - 0.05) is prefered.
Default is 0.03.</p>
</dd>
<dt>max_cycle_macro<span class="classifier">int</span></dt><dd><p>Max number of macro iterations.  Default is 50.</p>
</dd>
<dt>max_cycle_micro<span class="classifier">int</span></dt><dd><p>Max number of micro iterations in each macro iteration.  Depending on
systems, increasing this value might reduce the total macro
iterations.  Generally, 2 - 5 steps should be enough.  Default is 3.</p>
</dd>
<dt>small_rot_tol<span class="classifier">float</span></dt><dd><p>Threshold for orbital rotation to be considered small. If the largest orbital
rotation is smaller than this value, the CI solver will restart from the
previous iteration if supported.
Default is 0.01</p>
</dd>
<dt>ah_level_shift<span class="classifier">float, for AH solver.</span></dt><dd><p>Level shift for the Davidson diagonalization in AH solver.  Default is 1e-8.</p>
</dd>
<dt>ah_conv_tol<span class="classifier">float, for AH solver.</span></dt><dd><p>converge threshold for AH solver.  Default is 1e-12.</p>
</dd>
<dt>ah_max_cycle<span class="classifier">float, for AH solver.</span></dt><dd><p>Max number of iterations allowd in AH solver.  Default is 30.</p>
</dd>
<dt>ah_lindep<span class="classifier">float, for AH solver.</span></dt><dd><p>Linear dependence threshold for AH solver.  Default is 1e-14.</p>
</dd>
<dt>ah_start_tol<span class="classifier">flat, for AH solver.</span></dt><dd><p>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 0.2.</p>
</dd>
<dt>ah_start_cycle<span class="classifier">int, for AH solver.</span></dt><dd><p>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 2.</p>
<p><code class="docutils literal notranslate"><span class="pre">ah_conv_tol</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_max_cycle</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_lindep</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_start_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">ah_start_cycle</span></code>
can affect the accuracy and performance of CASSCF solver.  Lower
<code class="docutils literal notranslate"><span class="pre">ah_conv_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">ah_lindep</span></code> might improve the accuracy of CASSCF
optimization, but decrease the performance.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401898486001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401887945668</span>
</pre></div>
</div>
</dd>
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Checkpoint file to save the intermediate orbitals during the CASSCF optimization.
Default is the checkpoint file of mean field object.</p>
</dd>
<dt>ci_response_space<span class="classifier">int</span></dt><dd><p>subspace size to solve the CI vector response.  Default is 3.</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
envrionment.</p>
</dd>
<dt>scale_restoration<span class="classifier">float</span></dt><dd><p>When a step of orbital rotation moves out of trust region, the
orbital optimization will be restored to previous state and the
step size of the orbital rotation needs to be reduced.
scale_restoration controls how much to scale down the step size.</p>
</dd>
</dl>
</div></blockquote>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total MCSCF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>e_cas<span class="classifier">float</span></dt><dd><p>CAS space FCI energy</p>
</dd>
<dt>ci<span class="classifier">ndarray</span></dt><dd><p>CAS space FCI coefficients</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Optimized CASSCF orbitals coefficients. When canonicalization is
specified, the returned orbitals make the general Fock matrix
(Fock operator on top of MCSCF 1-particle density matrix)
diagonalized within each subspace (core, active, external). If
natorb (natural orbitals in active space) is enabled, the active
segment of mo_coeff is transformed to natural orbitals.</p>
</dd>
<dt>mo_energy<span class="classifier">ndarray</span></dt><dd><p>Diagonal elements of general Fock matrix (in mo_coeff
representation).</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401882238134</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_kern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step_symm.html#SymAdaptedCASSCF.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.kernel" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><p>Five elements, they are
total energy,
active space CI energy,
the active space FCI wavefunction coefficients or DMRG wavefunction ID,
the MCSCF canonical orbital coefficients,
the MCSCF canonical orbital coefficients.</p>
</dd>
</dl>
<p>They are attributes of mcscf object, which can be accessed by
.e_tot, .e_cas, .ci, .mo_coeff, .mo_energy</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.mc1step">
<span class="sig-name descname"><span class="pre">mc1step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step_symm.html#SymAdaptedCASSCF.mc1step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.mc1step" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.mc2step">
<span class="sig-name descname"><span class="pre">mc2step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step_symm.html#SymAdaptedCASSCF.mc2step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.mc2step" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.newton">
<span class="sig-name descname"><span class="pre">newton</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step_symm.html#SymAdaptedCASSCF.newton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.newton" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.rotate_mo">
<span class="sig-name descname"><span class="pre">rotate_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step_symm.html#SymAdaptedCASSCF.rotate_mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.rotate_mo" title="Link to this definition"></a></dt>
<dd><p>Rotate orbitals with the given unitary matrix</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.sort_mo_by_irrep">
<span class="sig-name descname"><span class="pre">sort_mo_by_irrep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cas_irrep_nocc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cas_irrep_ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step_symm.html#SymAdaptedCASSCF.sort_mo_by_irrep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.sort_mo_by_irrep" title="Link to this definition"></a></dt>
<dd><p>Select active space based on symmetry information.
See also <a class="reference internal" href="#pyscf.mcscf.addons.sort_mo_by_irrep" title="pyscf.mcscf.addons.sort_mo_by_irrep"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyscf.mcscf.addons.sort_mo_by_irrep()</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.uniq_var_indices">
<span class="sig-name descname"><span class="pre">uniq_var_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc1step_symm.html#SymAdaptedCASSCF.uniq_var_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.uniq_var_indices" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.wfnsym">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wfnsym</span></span><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF.wfnsym" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
</section>
<section id="module-pyscf.mcscf.mc2step">
<span id="pyscf-mcscf-mc2step-module"></span><h2 id="module-pyscf.mcscf.mc2step">pyscf.mcscf.mc2step module<a class="headerlink" href="#module-pyscf.mcscf.mc2step" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.mc2step.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc2step.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc2step.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc2step.kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf.mc_ao2mo">
<span id="pyscf-mcscf-mc-ao2mo-module"></span><h2 id="module-pyscf.mcscf.mc_ao2mo">pyscf.mcscf.mc_ao2mo module<a class="headerlink" href="#module-pyscf.mcscf.mc_ao2mo" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.mc_ao2mo.prange">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc_ao2mo.</span></span><span class="sig-name descname"><span class="pre">prange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc_ao2mo.html#prange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc_ao2mo.prange" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.mc_ao2mo.trans_e1_incore">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc_ao2mo.</span></span><span class="sig-name descname"><span class="pre">trans_e1_incore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri_ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc_ao2mo.html#trans_e1_incore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc_ao2mo.trans_e1_incore" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.mc_ao2mo.trans_e1_outcore">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.mc_ao2mo.</span></span><span class="sig-name descname"><span class="pre">trans_e1_outcore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/mc_ao2mo.html#trans_e1_outcore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.mc_ao2mo.trans_e1_outcore" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf.newton_casscf">
<span id="pyscf-mcscf-newton-casscf-module"></span><h2 id="module-pyscf.mcscf.newton_casscf">pyscf.mcscf.newton_casscf module<a class="headerlink" href="#module-pyscf.mcscf.newton_casscf" title="Link to this heading"></a></h2>
<p>Second order CASSCF</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf.CASSCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.newton_casscf.</span></span><span class="sig-name descname"><span class="pre">CASSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf.html#CASSCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf.CASSCF" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.mc1step.CASSCF" title="pyscf.mcscf.mc1step.CASSCF"><code class="xref py py-class docutils literal notranslate"><span class="pre">CASSCF</span></code></a></p>
<p>CASCI/CASSCF</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>mf_or_mol<span class="classifier">SCF object or Mole object</span></dt><dd><p>SCF or Mole to define the problem size.</p>
</dd>
<dt>ncas<span class="classifier">int</span></dt><dd><p>Number of active orbitals.</p>
</dd>
<dt>nelecas<span class="classifier">int or a pair of int</span></dt><dd><p>Number of electrons in active space.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ncore<span class="classifier">int</span></dt><dd><p>Number of doubly occupied core orbitals. If not presented, this
parameter can be automatically determined.</p>
</dd>
</dl>
</dd>
<dt>Attributes:</dt><dd><dl>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code>.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code>.</p>
</dd>
<dt>ncas<span class="classifier">int</span></dt><dd><p>Active space size.</p>
</dd>
<dt>nelecas<span class="classifier">tuple of int</span></dt><dd><p>Active (nelec_alpha, nelec_beta)</p>
</dd>
<dt>ncore<span class="classifier">int or tuple of int</span></dt><dd><p>Core electron number.  In UHF-CASSCF, its a tuple to indicate the different core eletron numbers.</p>
</dd>
<dt>natorb<span class="classifier">bool</span></dt><dd><p>Whether to transform natural orbitals in active space.
Note: when CASCI/CASSCF are combined with DMRG solver or selected
CI solver, enabling this parameter may slightly change the total energy.
False by default.</p>
</dd>
<dt>canonicalization<span class="classifier">bool</span></dt><dd><p>Whether to canonicalize orbitals in core and external space
against the general Fock matrix.
The orbitals in active space are NOT transformed by default. To
get the natural orbitals in active space, the attribute .natorb
needs to be enabled.
True by default.</p>
</dd>
<dt>sorting_mo_energy<span class="classifier">bool</span></dt><dd><p>Whether to sort the orbitals based on the diagonal elements of the
general Fock matrix.  Default is False.</p>
</dd>
<dt>fcisolver<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></span></dt><dd><p>The pyscf.fci module provides several FCISolver for different scenario.  Generally,
fci.direct_spin1.FCISolver can be used for all RHF-CASSCF.  However, a proper FCISolver
can provide better performance and better numerical stability.  One can either use
<code class="xref py py-func docutils literal notranslate"><span class="pre">fci.solver()</span></code> function to pick the FCISolver by the program or manually assigen
the FCISolver to this attribute, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCISolver</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>You can control FCISolver by setting e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">max_cycle</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mf">1e-7</span>
</pre></div>
</div>
<p>For more details of the parameter for FCISolver, See <code class="xref py py-mod docutils literal notranslate"><span class="pre">fci</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total MCSCF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>e_cas<span class="classifier">float</span></dt><dd><p>CAS space FCI energy</p>
</dd>
<dt>ci<span class="classifier">ndarray</span></dt><dd><p>CAS space FCI coefficients</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>When canonicalization is specified, the orbitals are canonical
orbitals which make the general Fock matrix (Fock operator on top
of MCSCF 1-particle density matrix) diagonalized within each
subspace (core, active, external).  If natorb (natural orbitals in
active space) is specified, the active segment of the mo_coeff is
natural orbitls.</p>
</dd>
<dt>mo_energy<span class="classifier">ndarray</span></dt><dd><p>Diagonal elements of general Fock matrix (in mo_coeff
representation).</p>
</dd>
<dt>mo_occ<span class="classifier">ndarray</span></dt><dd><p>Occupation numbers of natural orbitals if natorb is specified.</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.980200816243354</span>
<span class="go">CASSCF</span>
</pre></div>
</div>
<p>Extra attributes for CASSCF:</p>
<blockquote>
<div><dl>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Converge threshold.  Default is 1e-7</p>
</dd>
<dt>conv_tol_grad<span class="classifier">float</span></dt><dd><p>Converge threshold for CI gradients and orbital rotation gradients.
Default is 1e-4</p>
</dd>
<dt>max_stepsize<span class="classifier">float</span></dt><dd><p>The step size for orbital rotation.  Small step (0.005 - 0.05) is prefered.
(see notes in max_cycle_micro_inner attribute)
Default is 0.03.</p>
</dd>
<dt>max_cycle_macro<span class="classifier">int</span></dt><dd><p>Max number of macro iterations.  Default is 50.</p>
</dd>
<dt>max_cycle_micro<span class="classifier">int</span></dt><dd><p>Max number of micro (CIAH) iterations in each macro iteration.</p>
</dd>
<dt>ah_level_shift<span class="classifier">float, for AH solver.</span></dt><dd><p>Level shift for the Davidson diagonalization in AH solver.  Default is 1e-8.</p>
</dd>
<dt>ah_conv_tol<span class="classifier">float, for AH solver.</span></dt><dd><p>converge threshold for AH solver.  Default is 1e-12.</p>
</dd>
<dt>ah_max_cycle<span class="classifier">float, for AH solver.</span></dt><dd><p>Max number of iterations allowd in AH solver.  Default is 30.</p>
</dd>
<dt>ah_lindep<span class="classifier">float, for AH solver.</span></dt><dd><p>Linear dependence threshold for AH solver.  Default is 1e-14.</p>
</dd>
<dt>ah_start_tol<span class="classifier">flat, for AH solver.</span></dt><dd><p>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 0.2.</p>
</dd>
<dt>ah_start_cycle<span class="classifier">int, for AH solver.</span></dt><dd><p>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 2.</p>
<p><code class="docutils literal notranslate"><span class="pre">ah_conv_tol</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_max_cycle</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_lindep</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_start_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">ah_start_cycle</span></code>
can affect the accuracy and performance of CASSCF solver.  Lower
<code class="docutils literal notranslate"><span class="pre">ah_conv_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">ah_lindep</span></code> might improve the accuracy of CASSCF
optimization, but decrease the performance.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401898486001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401887945668</span>
</pre></div>
</div>
</dd>
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Checkpoint file to save the intermediate orbitals during the CASSCF optimization.
Default is the checkpoint file of mean field object.</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
envrionment.</p>
</dd>
</dl>
</div></blockquote>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total MCSCF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>ci<span class="classifier">ndarray</span></dt><dd><p>CAS space FCI coefficients</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>It indicates CASSCF optimization converged or not.</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Optimized CASSCF orbitals coefficients</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401882238134</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf.CASSCF.casci">
<span class="sig-name descname"><span class="pre">casci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf.html#CASSCF.casci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf.CASSCF.casci" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf.CASSCF.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf.html#CASSCF.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf.CASSCF.dump_flags" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf.CASSCF.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf.html#CASSCF.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf.CASSCF.kernel" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><p>Five elements, they are
total energy,
active space CI energy,
the active space FCI wavefunction coefficients or DMRG wavefunction ID,
the MCSCF canonical orbital coefficients,
the MCSCF canonical orbital coefficients.</p>
</dd>
</dl>
<p>They are attributes of mcscf object, which can be accessed by
.e_tot, .e_cas, .ci, .mo_coeff, .mo_energy</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf.CASSCF.update_ao2mo">
<span class="sig-name descname"><span class="pre">update_ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf.html#CASSCF.update_ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf.CASSCF.update_ao2mo" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf.extract_rotation">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.newton_casscf.</span></span><span class="sig-name descname"><span class="pre">extract_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf.html#extract_rotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf.extract_rotation" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf.gen_g_hop">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.newton_casscf.</span></span><span class="sig-name descname"><span class="pre">gen_g_hop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf.html#gen_g_hop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf.gen_g_hop" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.newton_casscf.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf.kernel" title="Link to this definition"></a></dt>
<dd><p>Second order CASSCF driver</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf.update_orb_ci">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.newton_casscf.</span></span><span class="sig-name descname"><span class="pre">update_orb_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf.html#update_orb_ci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf.update_orb_ci" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf.newton_casscf_symm">
<span id="pyscf-mcscf-newton-casscf-symm-module"></span><h2 id="module-pyscf.mcscf.newton_casscf_symm">pyscf.mcscf.newton_casscf_symm module<a class="headerlink" href="#module-pyscf.mcscf.newton_casscf_symm" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf_symm.CASSCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.newton_casscf_symm.</span></span><span class="sig-name descname"><span class="pre">CASSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf_symm.html#CASSCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf_symm.CASSCF" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.newton_casscf.CASSCF" title="pyscf.mcscf.newton_casscf.CASSCF"><code class="xref py py-class docutils literal notranslate"><span class="pre">CASSCF</span></code></a></p>
<p>CASCI/CASSCF</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>mf_or_mol<span class="classifier">SCF object or Mole object</span></dt><dd><p>SCF or Mole to define the problem size.</p>
</dd>
<dt>ncas<span class="classifier">int</span></dt><dd><p>Number of active orbitals.</p>
</dd>
<dt>nelecas<span class="classifier">int or a pair of int</span></dt><dd><p>Number of electrons in active space.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>ncore<span class="classifier">int</span></dt><dd><p>Number of doubly occupied core orbitals. If not presented, this
parameter can be automatically determined.</p>
</dd>
</dl>
</dd>
<dt>Attributes:</dt><dd><dl>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code>.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code>.</p>
</dd>
<dt>ncas<span class="classifier">int</span></dt><dd><p>Active space size.</p>
</dd>
<dt>nelecas<span class="classifier">tuple of int</span></dt><dd><p>Active (nelec_alpha, nelec_beta)</p>
</dd>
<dt>ncore<span class="classifier">int or tuple of int</span></dt><dd><p>Core electron number.  In UHF-CASSCF, its a tuple to indicate the different core eletron numbers.</p>
</dd>
<dt>natorb<span class="classifier">bool</span></dt><dd><p>Whether to transform natural orbitals in active space.
Note: when CASCI/CASSCF are combined with DMRG solver or selected
CI solver, enabling this parameter may slightly change the total energy.
False by default.</p>
</dd>
<dt>canonicalization<span class="classifier">bool</span></dt><dd><p>Whether to canonicalize orbitals in core and external space
against the general Fock matrix.
The orbitals in active space are NOT transformed by default. To
get the natural orbitals in active space, the attribute .natorb
needs to be enabled.
True by default.</p>
</dd>
<dt>sorting_mo_energy<span class="classifier">bool</span></dt><dd><p>Whether to sort the orbitals based on the diagonal elements of the
general Fock matrix.  Default is False.</p>
</dd>
<dt>fcisolver<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></span></dt><dd><p>The pyscf.fci module provides several FCISolver for different scenario.  Generally,
fci.direct_spin1.FCISolver can be used for all RHF-CASSCF.  However, a proper FCISolver
can provide better performance and better numerical stability.  One can either use
<code class="xref py py-func docutils literal notranslate"><span class="pre">fci.solver()</span></code> function to pick the FCISolver by the program or manually assigen
the FCISolver to this attribute, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCISolver</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>You can control FCISolver by setting e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">max_cycle</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mf">1e-7</span>
</pre></div>
</div>
<p>For more details of the parameter for FCISolver, See <code class="xref py py-mod docutils literal notranslate"><span class="pre">fci</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total MCSCF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>e_cas<span class="classifier">float</span></dt><dd><p>CAS space FCI energy</p>
</dd>
<dt>ci<span class="classifier">ndarray</span></dt><dd><p>CAS space FCI coefficients</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>When canonicalization is specified, the orbitals are canonical
orbitals which make the general Fock matrix (Fock operator on top
of MCSCF 1-particle density matrix) diagonalized within each
subspace (core, active, external).  If natorb (natural orbitals in
active space) is specified, the active segment of the mo_coeff is
natural orbitls.</p>
</dd>
<dt>mo_energy<span class="classifier">ndarray</span></dt><dd><p>Diagonal elements of general Fock matrix (in mo_coeff
representation).</p>
</dd>
<dt>mo_occ<span class="classifier">ndarray</span></dt><dd><p>Occupation numbers of natural orbitals if natorb is specified.</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.980200816243354</span>
<span class="go">CASSCF</span>
</pre></div>
</div>
<p>Extra attributes for CASSCF:</p>
<blockquote>
<div><dl>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Converge threshold.  Default is 1e-7</p>
</dd>
<dt>conv_tol_grad<span class="classifier">float</span></dt><dd><p>Converge threshold for CI gradients and orbital rotation gradients.
Default is 1e-4</p>
</dd>
<dt>max_stepsize<span class="classifier">float</span></dt><dd><p>The step size for orbital rotation.  Small step (0.005 - 0.05) is prefered.
(see notes in max_cycle_micro_inner attribute)
Default is 0.03.</p>
</dd>
<dt>max_cycle_macro<span class="classifier">int</span></dt><dd><p>Max number of macro iterations.  Default is 50.</p>
</dd>
<dt>max_cycle_micro<span class="classifier">int</span></dt><dd><p>Max number of micro (CIAH) iterations in each macro iteration.</p>
</dd>
<dt>ah_level_shift<span class="classifier">float, for AH solver.</span></dt><dd><p>Level shift for the Davidson diagonalization in AH solver.  Default is 1e-8.</p>
</dd>
<dt>ah_conv_tol<span class="classifier">float, for AH solver.</span></dt><dd><p>converge threshold for AH solver.  Default is 1e-12.</p>
</dd>
<dt>ah_max_cycle<span class="classifier">float, for AH solver.</span></dt><dd><p>Max number of iterations allowd in AH solver.  Default is 30.</p>
</dd>
<dt>ah_lindep<span class="classifier">float, for AH solver.</span></dt><dd><p>Linear dependence threshold for AH solver.  Default is 1e-14.</p>
</dd>
<dt>ah_start_tol<span class="classifier">flat, for AH solver.</span></dt><dd><p>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 0.2.</p>
</dd>
<dt>ah_start_cycle<span class="classifier">int, for AH solver.</span></dt><dd><p>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 2.</p>
<p><code class="docutils literal notranslate"><span class="pre">ah_conv_tol</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_max_cycle</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_lindep</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_start_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">ah_start_cycle</span></code>
can affect the accuracy and performance of CASSCF solver.  Lower
<code class="docutils literal notranslate"><span class="pre">ah_conv_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">ah_lindep</span></code> might improve the accuracy of CASSCF
optimization, but decrease the performance.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401898486001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401887945668</span>
</pre></div>
</div>
</dd>
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Checkpoint file to save the intermediate orbitals during the CASSCF optimization.
Default is the checkpoint file of mean field object.</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
envrionment.</p>
</dd>
</dl>
</div></blockquote>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total MCSCF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>ci<span class="classifier">ndarray</span></dt><dd><p>CAS space FCI coefficients</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>It indicates CASSCF optimization converged or not.</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Optimized CASSCF orbitals coefficients</p>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401882238134</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf_symm.CASSCF.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_kern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf_symm.html#CASSCF.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf_symm.CASSCF.kernel" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><p>Five elements, they are
total energy,
active space CI energy,
the active space FCI wavefunction coefficients or DMRG wavefunction ID,
the MCSCF canonical orbital coefficients,
the MCSCF canonical orbital coefficients.</p>
</dd>
</dl>
<p>They are attributes of mcscf object, which can be accessed by
.e_tot, .e_cas, .ci, .mo_coeff, .mo_energy</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf_symm.CASSCF.rotate_mo">
<span class="sig-name descname"><span class="pre">rotate_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf_symm.html#CASSCF.rotate_mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf_symm.CASSCF.rotate_mo" title="Link to this definition"></a></dt>
<dd><p>Rotate orbitals with the given unitary matrix</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.newton_casscf_symm.CASSCF.uniq_var_indices">
<span class="sig-name descname"><span class="pre">uniq_var_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/newton_casscf_symm.html#CASSCF.uniq_var_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton_casscf_symm.CASSCF.uniq_var_indices" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
</section>
<section id="module-pyscf.mcscf.ucasci">
<span id="pyscf-mcscf-ucasci-module"></span><h2 id="module-pyscf.mcscf.ucasci">pyscf.mcscf.ucasci module<a class="headerlink" href="#module-pyscf.mcscf.ucasci" title="Link to this heading"></a></h2>
<p>UCASCI (CASCI with non-degenerated alpha and beta orbitals, typically UHF
orbitals)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.CASCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.ucasci.</span></span><span class="sig-name descname"><span class="pre">CASCI</span></span><a class="headerlink" href="#pyscf.mcscf.ucasci.CASCI" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.mcscf.ucasci.UCASCI" title="pyscf.mcscf.ucasci.UCASCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">UCASCI</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.ucasci.</span></span><span class="sig-name descname"><span class="pre">UCASBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.casci.CASBase" title="pyscf.mcscf.casci.CASBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">CASBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.analyze">
<span class="sig-name descname"><span class="pre">analyze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">large_ci_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta_lowdin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase.analyze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.analyze" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.cas_natorb">
<span class="sig-name descname"><span class="pre">cas_natorb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase.cas_natorb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.cas_natorb" title="Link to this definition"></a></dt>
<dd><p>Transform active orbitals to natural orbitals, and update the CI wfn
accordingly</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mc : a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>sort<span class="classifier">bool</span></dt><dd><p>Sort natural orbitals wrt the occupancy.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tuple, the first item is natural orbitals, the second is updated CI
coefficients, the third is the natural occupancy associated to the
natural orbitals.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.cas_natorb_">
<span class="sig-name descname"><span class="pre">cas_natorb_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase.cas_natorb_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.cas_natorb_" title="Link to this definition"></a></dt>
<dd><p>Transform active orbitals to natural orbitals, and update the CI wfn
accordingly</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mc : a CASSCF/CASCI object or RHF object</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>sort<span class="classifier">bool</span></dt><dd><p>Sort natural orbitals wrt the occupancy.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tuple, the first item is natural orbitals, the second is updated CI
coefficients, the third is the natural occupancy associated to the
natural orbitals.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.check_sanity">
<span class="sig-name descname"><span class="pre">check_sanity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase.check_sanity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.check_sanity" title="Link to this definition"></a></dt>
<dd><p>Check input of class/object attributes, check whether a class method is
overwritten.  It does not check the attributes which are prefixed with
_.  The
return value of method set is the object itself.  This allows a series
of functions/methods to be executed in pipe.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.dump_flags" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.fix_spin">
<span class="sig-name descname"><span class="pre">fix_spin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.fix_spin" title="Link to this definition"></a></dt>
<dd><p>Use level shift to control FCI solver spin.</p>
<div class="math notranslate nohighlight">
\[(H + shift*S^2) |\Psi\rangle = E |\Psi\rangle\]</div>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shift<span class="classifier">float</span></dt><dd><p>Energy penalty for states which have wrong spin</p>
</dd>
<dt>ss<span class="classifier">number</span></dt><dd><p>S^2 expection value == s*(s+1)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.fix_spin_">
<span class="sig-name descname"><span class="pre">fix_spin_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.fix_spin_" title="Link to this definition"></a></dt>
<dd><p>Use level shift to control FCI solver spin.</p>
<div class="math notranslate nohighlight">
\[(H + shift*S^2) |\Psi\rangle = E |\Psi\rangle\]</div>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>shift<span class="classifier">float</span></dt><dd><p>Energy penalty for states which have wrong spin</p>
</dd>
<dt>ss<span class="classifier">number</span></dt><dd><p>S^2 expection value == s*(s+1)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.get_h1eff">
<span class="sig-name descname"><span class="pre">get_h1eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.get_h1eff" title="Link to this definition"></a></dt>
<dd><p>CAS sapce one-electron hamiltonian for UHF-CASCI or UHF-CASSCF</p>
<dl class="simple">
<dt>Args:</dt><dd><p>casci : a U-CASSCF/U-CASCI object or UHF object</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.get_hcore">
<span class="sig-name descname"><span class="pre">get_hcore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase.get_hcore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.get_hcore" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase.get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.get_veff" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock potential matrix for the given density matrix</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dm_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The density matrix baseline.  If not 0, this function computes the
increment of HF potential w.r.t. the reference HF potential matrix.</p>
</dd>
<dt>vhf_last<span class="classifier">ndarray or a list of ndarrays or 0</span></dt><dd><p>The reference HF potential matrix.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Whether J, K matrix is hermitian</p>
<div class="line-block">
<div class="line">0 : no hermitian or symmetric</div>
<div class="line">1 : hermitian</div>
<div class="line">2 : anti-hermitian</div>
</div>
</dd>
<dt>vhfopt :</dt><dd><p>A class which holds precomputed quantities to optimize the
computation of J, K matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Vhf = 2*J - K.  Vhf can be a list matrices, corresponding to the
input density matrices.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.scf</span> <span class="kn">import</span> <span class="n">_vhf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; H 0 0 1.1'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm0</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vhf0</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">get_veff</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm0</span><span class="p">,</span> <span class="n">hermi</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vhf1</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">get_veff</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm1</span><span class="p">,</span> <span class="n">hermi</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vhf2</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">get_veff</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm1</span><span class="p">,</span> <span class="n">dm_last</span><span class="o">=</span><span class="n">dm0</span><span class="p">,</span> <span class="n">vhf_last</span><span class="o">=</span><span class="n">vhf0</span><span class="p">,</span> <span class="n">hermi</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">vhf1</span><span class="p">,</span> <span class="n">vhf2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.make_rdm1" title="Link to this definition"></a></dt>
<dd><p>One-particle density matrix in AO representation</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.make_rdm1s">
<span class="sig-name descname"><span class="pre">make_rdm1s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase.make_rdm1s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.make_rdm1s" title="Link to this definition"></a></dt>
<dd><p>One-particle density matrices for alpha and beta spin on AO basis</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.ncore">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ncore</span></span><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.ncore" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.sort_mo">
<span class="sig-name descname"><span class="pre">sort_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">caslst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase.sort_mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.sort_mo" title="Link to this definition"></a></dt>
<dd><p>Pick orbitals for CAS space</p>
<dl>
<dt>Args:</dt><dd><p>casscf : an <code class="xref py py-class docutils literal notranslate"><span class="pre">CASSCF</span></code> or <a class="reference internal" href="#pyscf.mcscf.ucasci.CASCI" title="pyscf.mcscf.ucasci.CASCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">CASCI</span></code></a> object</p>
<dl class="simple">
<dt>mo_coeff<span class="classifier">ndarray or a list of ndarray</span></dt><dd><p>Orbitals for CASSCF initial guess.  In the UHF-CASSCF, its a list
of two orbitals, for alpha and beta spin.</p>
</dd>
<dt>caslst<span class="classifier">list of int or nested list of int</span></dt><dd><p>A list of orbital indices to represent the CAS space.  In the UHF-CASSCF,
its consist of two lists, for alpha and beta spin.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>base<span class="classifier">int</span></dt><dd><p>0-based (C-style) or 1-based (Fortran-style) caslst</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>An reoreded mo_coeff, which put the orbitals given by caslst in the CAS space</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cas_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="c1"># pi orbitals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">sort_mo</span><span class="p">(</span><span class="n">cas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.007378939813691</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASBase.spin_square">
<span class="sig-name descname"><span class="pre">spin_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcivec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ovlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASBase.spin_square"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASBase.spin_square" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASCI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.ucasci.</span></span><span class="sig-name descname"><span class="pre">UCASCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASCI" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.ucasci.UCASBase" title="pyscf.mcscf.ucasci.UCASBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">UCASBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASCI.as_scanner">
<span class="sig-name descname"><span class="pre">as_scanner</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASCI.as_scanner" title="Link to this definition"></a></dt>
<dd><p>Generating a scanner for CASCI PES.</p>
<p>The returned solver is a function. This function requires one argument
mol as input and returns total CASCI energy.</p>
<p>The solver will automatically use the results of last calculation as the
initial guess of the new calculation.  All parameters of MCSCF object
are automatically applied in the solver.</p>
<p>Note scanner has side effects.  It may change many underlying objects
(_scf, with_df, with_x2c, ) during calculation.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.1'</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.5'</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASCI.casci">
<span class="sig-name descname"><span class="pre">casci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASCI.casci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASCI.casci" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASCI.get_h2eff">
<span class="sig-name descname"><span class="pre">get_h2eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASCI.get_h2eff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASCI.get_h2eff" title="Link to this definition"></a></dt>
<dd><p>Compute the active space two-particle Hamiltonian.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.UCASCI.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#UCASCI.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.UCASCI.kernel" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><p>Five elements, they are
total energy,
active space CI energy,
the active space FCI wavefunction coefficients or DMRG wavefunction ID,
the MCSCF canonical orbital coefficients,
the MCSCF canonical orbital coefficients.</p>
</dd>
</dl>
<p>They are attributes of mcscf object, which can be accessed by
.e_tot, .e_cas, .ci, .mo_coeff, .mo_energy</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.extract_orbs">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.ucasci.</span></span><span class="sig-name descname"><span class="pre">extract_orbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#extract_orbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.extract_orbs" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.h1e_for_cas">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.ucasci.</span></span><span class="sig-name descname"><span class="pre">h1e_for_cas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#h1e_for_cas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.h1e_for_cas" title="Link to this definition"></a></dt>
<dd><p>CAS sapce one-electron hamiltonian for UHF-CASCI or UHF-CASSCF</p>
<dl class="simple">
<dt>Args:</dt><dd><p>casci : a U-CASSCF/U-CASCI object or UHF object</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.ucasci.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.ucasci.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/ucasci.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.ucasci.kernel" title="Link to this definition"></a></dt>
<dd><p>UHF-CASCI solver</p>
</dd></dl>
</section>
<section id="module-pyscf.mcscf.umc1step">
<span id="pyscf-mcscf-umc1step-module"></span><h2 id="module-pyscf.mcscf.umc1step">pyscf.mcscf.umc1step module<a class="headerlink" href="#module-pyscf.mcscf.umc1step" title="Link to this heading"></a></h2>
<p>UCASSCF (CASSCF without spin-degeneracy between alpha and beta orbitals)
1-step optimization algorithm</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.CASSCF">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.umc1step.</span></span><span class="sig-name descname"><span class="pre">CASSCF</span></span><a class="headerlink" href="#pyscf.mcscf.umc1step.CASSCF" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.mcscf.umc1step.UCASSCF" title="pyscf.mcscf.umc1step.UCASSCF"><code class="xref py py-class docutils literal notranslate"><span class="pre">UCASSCF</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.umc1step.</span></span><span class="sig-name descname"><span class="pre">UCASSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.mcscf.ucasci.UCASBase" title="pyscf.mcscf.ucasci.UCASBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">UCASBase</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.ah_conv_tol">
<span class="sig-name descname"><span class="pre">ah_conv_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-12</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.ah_conv_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.ah_grad_trust_region">
<span class="sig-name descname"><span class="pre">ah_grad_trust_region</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3.0</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.ah_grad_trust_region" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.ah_level_shift">
<span class="sig-name descname"><span class="pre">ah_level_shift</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.ah_level_shift" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.ah_lindep">
<span class="sig-name descname"><span class="pre">ah_lindep</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-14</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.ah_lindep" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.ah_max_cycle">
<span class="sig-name descname"><span class="pre">ah_max_cycle</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">30</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.ah_max_cycle" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.ah_start_cycle">
<span class="sig-name descname"><span class="pre">ah_start_cycle</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.ah_start_cycle" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.ah_start_tol">
<span class="sig-name descname"><span class="pre">ah_start_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2.5</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.ah_start_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.ao2mo" title="Link to this definition"></a></dt>
<dd><p>Compute the active space two-particle Hamiltonian.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.approx_cas_integral">
<span class="sig-name descname"><span class="pre">approx_cas_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.approx_cas_integral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.approx_cas_integral" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.as_scanner">
<span class="sig-name descname"><span class="pre">as_scanner</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.as_scanner" title="Link to this definition"></a></dt>
<dd><p>Generating a scanner for CASSCF PES.</p>
<p>The returned solver is a function. This function requires one argument
mol as input and returns total CASSCF energy.</p>
<p>The solver will automatically use the results of last calculation as the
initial guess of the new calculation.  All parameters of MCSCF object
(conv_tol, max_memory etc) are automatically applied in the solver.</p>
<p>Note scanner has side effects.  It may change many underlying objects
(_scf, with_df, with_x2c, ) during calculation.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.2'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc_scanner</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.1'</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">mc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1.5'</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.callback" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.casci">
<span class="sig-name descname"><span class="pre">casci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.casci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.casci" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.chk_ci">
<span class="sig-name descname"><span class="pre">chk_ci</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.chk_ci" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.ci_response_space">
<span class="sig-name descname"><span class="pre">ci_response_space</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.ci_response_space" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.conv_tol">
<span class="sig-name descname"><span class="pre">conv_tol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-07</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.conv_tol" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.conv_tol_grad">
<span class="sig-name descname"><span class="pre">conv_tol_grad</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.conv_tol_grad" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.dump_chk">
<span class="sig-name descname"><span class="pre">dump_chk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.dump_chk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.dump_chk" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.dump_flags" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.gen_g_hop">
<span class="sig-name descname"><span class="pre">gen_g_hop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.gen_g_hop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.gen_g_hop" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.get_h2eff">
<span class="sig-name descname"><span class="pre">get_h2eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.get_h2eff" title="Link to this definition"></a></dt>
<dd><p>Compute the active space two-particle Hamiltonian.</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.internal_rotation">
<span class="sig-name descname"><span class="pre">internal_rotation</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.internal_rotation" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_kern=&lt;function</span> <span class="pre">kernel&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.kernel" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><p>Five elements, they are
total energy,
active space CI energy,
the active space FCI wavefunction coefficients or DMRG wavefunction ID,
the MCSCF canonical orbital coefficients,
the MCSCF canonical orbital coefficients.</p>
</dd>
</dl>
<p>They are attributes of mcscf object, which can be accessed by
.e_tot, .e_cas, .ci, .mo_coeff, .mo_energy</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.kf_interval">
<span class="sig-name descname"><span class="pre">kf_interval</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.kf_interval" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.kf_trust_region">
<span class="sig-name descname"><span class="pre">kf_trust_region</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3.0</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.kf_trust_region" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.max_cycle_macro">
<span class="sig-name descname"><span class="pre">max_cycle_macro</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">50</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.max_cycle_macro" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.max_cycle_micro">
<span class="sig-name descname"><span class="pre">max_cycle_micro</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.max_cycle_micro" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.max_orb_stepsize">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_orb_stepsize</span></span><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.max_orb_stepsize" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.max_stepsize">
<span class="sig-name descname"><span class="pre">max_stepsize</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.02</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.max_stepsize" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.max_stepsize_scheduler">
<span class="sig-name descname"><span class="pre">max_stepsize_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.max_stepsize_scheduler" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.mc1step">
<span class="sig-name descname"><span class="pre">mc1step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.mc1step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.mc1step" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.mc2step">
<span class="sig-name descname"><span class="pre">mc2step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.mc2step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.mc2step" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.micro_cycle_scheduler">
<span class="sig-name descname"><span class="pre">micro_cycle_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.micro_cycle_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.micro_cycle_scheduler" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.natorb">
<span class="sig-name descname"><span class="pre">natorb</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.natorb" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.pack_uniq_var">
<span class="sig-name descname"><span class="pre">pack_uniq_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.pack_uniq_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.pack_uniq_var" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.rotate_mo">
<span class="sig-name descname"><span class="pre">rotate_mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.rotate_mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.rotate_mo" title="Link to this definition"></a></dt>
<dd><p>Rotate orbitals with the given unitary matrix</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.rotate_orb_cc">
<span class="sig-name descname"><span class="pre">rotate_orb_cc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcasdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcasdm2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.rotate_orb_cc" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.solve_approx_ci">
<span class="sig-name descname"><span class="pre">solve_approx_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecore</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_cas</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.solve_approx_ci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.solve_approx_ci" title="Link to this definition"></a></dt>
<dd><p>Solve CI eigenvalue/response problem approximately</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.uniq_var_indices">
<span class="sig-name descname"><span class="pre">uniq_var_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.uniq_var_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.uniq_var_indices" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.unpack_uniq_var">
<span class="sig-name descname"><span class="pre">unpack_uniq_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.unpack_uniq_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.unpack_uniq_var" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.update_casdm">
<span class="sig-name descname"><span class="pre">update_casdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcivec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_cas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.update_casdm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.update_casdm" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.update_jk_in_ah">
<span class="sig-name descname"><span class="pre">update_jk_in_ah</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.update_jk_in_ah"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.update_jk_in_ah" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.update_rotate_matrix">
<span class="sig-name descname"><span class="pre">update_rotate_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#UCASSCF.update_rotate_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.update_rotate_matrix" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.UCASSCF.with_dep4">
<span class="sig-name descname"><span class="pre">with_dep4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.mcscf.umc1step.UCASSCF.with_dep4" title="Link to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.gen_g_hop">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.umc1step.</span></span><span class="sig-name descname"><span class="pre">gen_g_hop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm1s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">casdm2s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eris</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#gen_g_hop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.gen_g_hop" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.umc1step.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.umc1step.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc1step.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc1step.kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf.umc2step">
<span id="pyscf-mcscf-umc2step-module"></span><h2 id="module-pyscf.mcscf.umc2step">pyscf.mcscf.umc2step module<a class="headerlink" href="#module-pyscf.mcscf.umc2step" title="Link to this heading"></a></h2>
<p>UCASSCF (CASSCF without spin-degeneracy between alpha and beta orbitals)
2-step optimization algorithm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.umc2step.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.umc2step.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">casscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_tol_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc2step.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc2step.kernel" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf.umc_ao2mo">
<span id="pyscf-mcscf-umc-ao2mo-module"></span><h2 id="module-pyscf.mcscf.umc_ao2mo">pyscf.mcscf.umc_ao2mo module<a class="headerlink" href="#module-pyscf.mcscf.umc_ao2mo" title="Link to this heading"></a></h2>
<p>MO integrals for UCASSCF methods</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.umc_ao2mo.trans_e1_incore">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.umc_ao2mo.</span></span><span class="sig-name descname"><span class="pre">trans_e1_incore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri_ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc_ao2mo.html#trans_e1_incore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc_ao2mo.trans_e1_incore" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.umc_ao2mo.trans_e1_outcore">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.umc_ao2mo.</span></span><span class="sig-name descname"><span class="pre">trans_e1_outcore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf/umc_ao2mo.html#trans_e1_outcore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.umc_ao2mo.trans_e1_outcore" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.mcscf">
<span id="module-contents"></span><h2 id="module-pyscf.mcscf">Module contents<a class="headerlink" href="#module-pyscf.mcscf" title="Link to this heading"></a></h2>
<p>CASCI and CASSCF</p>
<p>When using results of this code for publications, please cite the following paper:
A general second order complete active space self-consistent-field solver for large-scale systems, Q. Sun, J. Yang, and G. K.-L. Chan, Chem. Phys. Lett. 683, 291 (2017).</p>
<p>Simple usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.980200816243354</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401882238134</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cas_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="c1"># pick orbitals for CAS space, 1-based indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">sort_mo</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="n">cas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.007378939813691</span>
</pre></div>
</div>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">mcscf.CASSCF()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">mcscf.CASCI()</span></code> returns a proper instance of CASSCF/CASCI class.
There are some parameters to control the CASSCF/CASCI method.</p>
<blockquote>
<div><dl>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code>.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code>.</p>
</dd>
<dt>ncas<span class="classifier">int</span></dt><dd><p>Active space size.</p>
</dd>
<dt>nelecas<span class="classifier">tuple of int</span></dt><dd><p>Active (nelec_alpha, nelec_beta)</p>
</dd>
<dt>ncore<span class="classifier">int or tuple of int</span></dt><dd><p>Core electron number.  In UHF-CASSCF, its a tuple to indicate the different core eletron numbers.</p>
</dd>
<dt>natorb<span class="classifier">bool</span></dt><dd><p>Whether to restore the natural orbital during CASSCF optimization. Default is not.</p>
</dd>
<dt>canonicalization<span class="classifier">bool</span></dt><dd><p>Whether to canonicalize orbitals.  Default is True.</p>
</dd>
<dt>fcisolver<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FCISolver</span></code></span></dt><dd><p>The pyscf.fci module provides several FCISolver for different scenario.  Generally,
fci.direct_spin1.FCISolver can be used for all RHF-CASSCF.  However, a proper FCISolver
can provide better performance and better numerical stability.  One can either use
<code class="xref py py-func docutils literal notranslate"><span class="pre">fci.solver()</span></code> function to pick the FCISolver by the program or manually assigen
the FCISolver to this attribute, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCISolver</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>You can control FCISolver by setting e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">max_cycle</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mf">1e-7</span>
</pre></div>
</div>
<p>For more details of the parameter for FCISolver, See <code class="xref py py-mod docutils literal notranslate"><span class="pre">fci</span></code>.</p>
<p>By replacing this fcisolver, you can easily use the CASCI/CASSCF solver
with other FCI replacements,  such as DMRG, QMC.  See <code class="xref py py-mod docutils literal notranslate"><span class="pre">dmrgscf</span></code> and
<code class="xref py py-mod docutils literal notranslate"><span class="pre">fciqmcscf</span></code>.</p>
</dd>
</dl>
</div></blockquote>
<p>The Following attributes are used for CASSCF</p>
<blockquote>
<div><dl>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Converge threshold.  Default is 1e-7</p>
</dd>
<dt>conv_tol_grad<span class="classifier">float</span></dt><dd><p>Converge threshold for CI gradients and orbital rotation gradients.
Default is 1e-4</p>
</dd>
<dt>max_stepsize<span class="classifier">float</span></dt><dd><p>The step size for orbital rotation.  Small step size is prefered.
Default is 0.03.  
(NOTE although the default step size is small enough for many systems,
it happens that the orbital optimizor crosses the barriar of local
minimum and converge to the neighbour solution, e.g. the CAS(4,4) for
C2H4 in the test files.  In these systems, adjusting max_stepsize,
max_ci_stepsize and max_cycle_micro, max_cycle_micro_inner and
ah_start_tol may be helpful)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">max_stepsize</span> <span class="o">=</span> <span class="mf">.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">max_cycle_micro</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">max_cycle_macro</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">max_cycle_micro_inner</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_start_tol</span> <span class="o">=</span> <span class="mf">1e-6</span>
</pre></div>
</div>
</dd>
<dt>max_ci_stepsize<span class="classifier">float</span></dt><dd><p>The max size for approximate CI updates.  The approximate updates are
used in 1-step algorithm, to estimate the change of CI wavefunction wrt
the orbital rotation.  Small step size is prefered.  Default is 0.01.</p>
</dd>
<dt>max_cycle_macro<span class="classifier">int</span></dt><dd><p>Max number of macro iterations.  Default is 50.</p>
</dd>
<dt>max_cycle_micro<span class="classifier">int</span></dt><dd><p>Max number of micro iterations in each macro iteration.  Depending on
systems, increasing this value might reduce the total macro
iterations.  Generally, 2 - 3 steps should be enough.  Default is 2.</p>
</dd>
<dt>max_cycle_micro_inner<span class="classifier">int</span></dt><dd><p>Max number of steps for the orbital rotations allowed for the augmented
hessian solver.  It can affect the actual size of orbital rotation.
Even with a small max_stepsize, a few max_cycle_micro_inner can
accumulate the rotation and leads to a significant change of the CAS
space.  Depending on systems, increasing this value migh reduce the
total number of macro iterations.  The value between 2 - 8 is preferred.
Default is 4.</p>
</dd>
<dt>frozen<span class="classifier">int or list</span></dt><dd><p>If integer is given, the inner-most orbitals are excluded from optimization.
Given the orbital indices (0-based) in a list, any doubly occupied core
orbitals, active orbitals and external orbitals can be frozen.</p>
</dd>
<dt>ah_level_shift<span class="classifier">float, for AH solver.</span></dt><dd><p>Level shift for the Davidson diagonalization in AH solver.  Default is 0.</p>
</dd>
<dt>ah_conv_tol<span class="classifier">float, for AH solver.</span></dt><dd><p>converge threshold for Davidson diagonalization in AH solver.  Default is 1e-8.</p>
</dd>
<dt>ah_max_cycle<span class="classifier">float, for AH solver.</span></dt><dd><p>Max number of iterations allowd in AH solver.  Default is 20.</p>
</dd>
<dt>ah_lindep<span class="classifier">float, for AH solver.</span></dt><dd><p>Linear dependence threshold for AH solver.  Default is 1e-16.</p>
</dd>
<dt>ah_start_tol<span class="classifier">flat, for AH solver.</span></dt><dd><p>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 1e-4.</p>
</dd>
<dt>ah_start_cycle<span class="classifier">int, for AH solver.</span></dt><dd><p>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 3.</p>
<p><code class="docutils literal notranslate"><span class="pre">ah_conv_tol</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_max_cycle</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_lindep</span></code>, <code class="docutils literal notranslate"><span class="pre">ah_start_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">ah_start_cycle</span></code>
can affect the accuracy and performance of CASSCF solver.  Lower
<code class="docutils literal notranslate"><span class="pre">ah_conv_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">ah_lindep</span></code> can improve the accuracy of CASSCF
optimization, but slow down the performance.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'N 0 0 0; N 0 0 1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401898486001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401887945668</span>
</pre></div>
</div>
</dd>
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Checkpoint file to save the intermediate orbitals during the CASSCF optimization.
Default is the checkpoint file of mean field object.</p>
</dd>
</dl>
</div></blockquote>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total MCSCF energy (electronic energy plus nuclear repulsion)</p>
</dd>
<dt>ci<span class="classifier">ndarray</span></dt><dd><p>CAS space FCI coefficients</p>
</dd>
<dt>converged<span class="classifier">bool, for CASSCF only</span></dt><dd><p>It indicates CASSCF optimization converged or not.</p>
</dd>
<dt>mo_energy: ndarray,</dt><dd><p>Diagonal elements of general Fock matrix</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray, for CASSCF only</span></dt><dd><p>Optimized CASSCF orbitals coefficients
Note the orbitals are NOT natural orbitals by default.  There are two
inbuilt methods to convert the mo_coeff to natural orbitals.
1. Set .natorb attribute.  It can be used before calculation.
2. call .cas_natorb_ method after the calculation to in-place convert the orbitals</p>
</dd>
</dl>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.CASCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.</span></span><span class="sig-name descname"><span class="pre">CASCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf.html#CASCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.CASCI" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.CASSCF">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.</span></span><span class="sig-name descname"><span class="pre">CASSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf.html#CASSCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.CASSCF" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.DFCASCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.</span></span><span class="sig-name descname"><span class="pre">DFCASCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf.html#DFCASCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.DFCASCI" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.DFCASSCF">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.</span></span><span class="sig-name descname"><span class="pre">DFCASSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf.html#DFCASSCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.DFCASSCF" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.RCASCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.</span></span><span class="sig-name descname"><span class="pre">RCASCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.RCASCI" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.RCASSCF">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.</span></span><span class="sig-name descname"><span class="pre">RCASSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.RCASSCF" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.UCASCI">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.</span></span><span class="sig-name descname"><span class="pre">UCASCI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf.html#UCASCI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.UCASCI" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.UCASSCF">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.</span></span><span class="sig-name descname"><span class="pre">UCASSCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelecas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf.html#UCASSCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.UCASSCF" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.density_fit">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.</span></span><span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf.html#density_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.density_fit" title="Link to this definition"></a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.mcscf.newton">
<span class="sig-prename descclassname"><span class="pre">pyscf.mcscf.</span></span><span class="sig-name descname"><span class="pre">newton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/mcscf.html#newton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.mcscf.newton" title="Link to this definition"></a></dt>
<dd></dd></dl>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="pyscf.lo.html" title="pyscf.lo package"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> pyscf.lo package </span>
              </div>
            </a>
          
          
            <a href="pyscf.md.html" title="pyscf.md package"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> pyscf.md package </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>