
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pyscf.ao2mo package &#8212; PySCF</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf-pst.css?v=ed6b5f64" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=1647406f"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pyscf_api_docs/pyscf.ao2mo';</script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.11" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-64x64.png" class="logo__image only-light" alt=""/>
    <img src="../_static/logo-64x64.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">PySCF</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pyscf.adc.html">pyscf.adc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.agf2.html">pyscf.agf2 package</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">pyscf.ao2mo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.cc.html">pyscf.cc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.ci.html">pyscf.ci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.data.html">pyscf.data package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.df.html">pyscf.df package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.grad.html">pyscf.df.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.hessian.html">pyscf.df.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.dft.html">pyscf.dft package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.dft.xc.html">pyscf.dft.xc package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.eph.html">pyscf.eph package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.fci.html">pyscf.fci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.geomopt.html">pyscf.geomopt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.grad.html">pyscf.grad package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.gto.html">pyscf.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.gto.basis.html">pyscf.gto.basis package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.gto.basis.dyall-basis.html">pyscf.gto.basis.dyall-basis package</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.gw.html">pyscf.gw package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.hessian.html">pyscf.hessian package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.lib.html">pyscf.lib package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.lo.html">pyscf.lo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mcpdft.html">pyscf.mcpdft package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mcscf.html">pyscf.mcscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mp.html">pyscf.mp package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mrpt.html">pyscf.mrpt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.nac.html">pyscf.nac package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.pbc.html">pyscf.pbc package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.adc.html">pyscf.pbc.adc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ao2mo.html">pyscf.pbc.ao2mo package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.cc.html">pyscf.pbc.cc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ci.html">pyscf.pbc.ci package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.df.html">pyscf.pbc.df package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.pbc.dft.html">pyscf.pbc.dft package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html">pyscf.pbc.dft.multigrid package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.eph.html">pyscf.pbc.eph package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.geomopt.html">pyscf.pbc.geomopt package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.grad.html">pyscf.pbc.grad package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.pbc.gto.html">pyscf.pbc.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html">pyscf.pbc.gto.basis package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html">pyscf.pbc.gto.pseudo package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gw.html">pyscf.pbc.gw package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.lib.html">pyscf.pbc.lib package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mp.html">pyscf.pbc.mp package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpicc.html">pyscf.pbc.mpicc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpitools.html">pyscf.pbc.mpitools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.scf.html">pyscf.pbc.scf package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.symm.html">pyscf.pbc.symm package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tddft.html">pyscf.pbc.tddft package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tdscf.html">pyscf.pbc.tdscf package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tools.html">pyscf.pbc.tools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.x2c.html">pyscf.pbc.x2c package</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.qmmm.html">pyscf.qmmm package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.qmmm.pbc.html">pyscf.qmmm.pbc package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.scf.html">pyscf.scf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.sgx.html">pyscf.sgx package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.solvent.html">pyscf.solvent package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.grad.html">pyscf.solvent.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.hessian.html">pyscf.solvent.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.soscf.html">pyscf.soscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.symm.html">pyscf.symm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tddft.html">pyscf.tddft package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tdscf.html">pyscf.tdscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tools.html">pyscf.tools package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.x2c.html">pyscf.x2c package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">pyscf.ao2mo package</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pyscf-ao2mo-package">
<h1>pyscf.ao2mo package<a class="headerlink" href="#pyscf-ao2mo-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-pyscf.ao2mo.addons">
<span id="pyscf-ao2mo-addons-module"></span><h2>pyscf.ao2mo.addons module<a class="headerlink" href="#module-pyscf.ao2mo.addons" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.ao2mo.addons.load">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.addons.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/addons.html#load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.addons.load" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>load 2e integrals from hdf5 file</p>
<dl class="simple">
<dt>Usage:</dt><dd><dl class="simple">
<dt>with load(erifile) as eri:</dt><dd><p>print(eri.shape)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.addons.restore">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.addons.</span></span><span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symmetry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/addons.html#restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.addons.restore" title="Link to this definition">#</a></dt>
<dd><p>Convert the 2e integrals (in Chemist’s notation) between different
level of permutation symmetry (8-fold, 4-fold, or no symmetry)</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>symmetry<span class="classifier">int or str</span></dt><dd><p>code to present the target symmetry of 2e integrals</p>
<div class="line-block">
<div class="line">‘s8’ or ‘8’ or 8 : 8-fold symmetry</div>
<div class="line">‘s4’ or ‘4’ or 4 : 4-fold symmetry</div>
<div class="line">‘s1’ or ‘1’ or 1 : no symmetry</div>
<div class="line">‘s2ij’ or ‘2ij’ : symmetric ij pair for (ij|kl) (TODO)</div>
<div class="line">‘s2ij’ or ‘2kl’ : symmetric kl pair for (ij|kl) (TODO)</div>
</div>
<p>Note the 4-fold symmetry requires (ij|kl) == (ij|lk) == (ij|lk)
while (ij|kl) != (kl|ij) is not required.</p>
</dd>
<dt>eri<span class="classifier">ndarray</span></dt><dd><p>The symmetry of eri is determined by the size of eri and norb</p>
</dd>
<dt>norb<span class="classifier">int</span></dt><dd><p>The symmetry of eri is determined by the size of eri and norb</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray.  The shape depends on the target symmetry.</p>
<blockquote>
<div><div class="line-block">
<div class="line">8 : (norb*(norb+1)/2)*(norb*(norb+1)/2+1)/2</div>
<div class="line">4 : (norb*(norb+1)/2, norb*(norb+1)/2)</div>
<div class="line">1 : (norb, norb, norb, norb)</div>
</div>
</div></blockquote>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.scf</span> <span class="kn">import</span> <span class="n">_vhf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eri</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri4</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">eri</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri8</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">eri</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(7, 7, 7, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(28, 28)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(406,)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyscf.ao2mo.incore">
<span id="pyscf-ao2mo-incore-module"></span><h2>pyscf.ao2mo.incore module<a class="headerlink" href="#module-pyscf.ao2mo.incore" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.incore.full">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.incore.</span></span><span class="sig-name descname"><span class="pre">full</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri_ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/incore.html#full"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.incore.full" title="Link to this definition">#</a></dt>
<dd><p>MO integral transformation for the given orbital.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri_ao<span class="classifier">ndarray</span></dt><dd><p>AO integrals, can be either 8-fold or 4-fold symmetry.</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Transform (ij|kl) with the same set of orbitals.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, the returned MO integrals have 4-fold
symmetry.  Otherwise, return the “plain” MO integrals.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array of transformed MO integrals.  The MO integrals may or may not
have the permutation symmetry (controlled by the kwargs compact)</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.scf</span> <span class="kn">import</span> <span class="n">_vhf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="n">mo1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 55)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 100)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.incore.general">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.incore.</span></span><span class="sig-name descname"><span class="pre">general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri_ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/incore.html#general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.incore.general" title="Link to this definition">#</a></dt>
<dd><p>For the given four sets of orbitals, transfer the 8-fold or 4-fold 2e
AO integrals to MO integrals.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri_ao<span class="classifier">ndarray</span></dt><dd><p>AO integrals, can be either 8-fold or 4-fold symmetry.</p>
</dd>
<dt>mo_coeffs<span class="classifier">4-item list of ndarray</span></dt><dd><p>Four sets of orbital coefficients, corresponding to the four
indices of (ij|kl)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, depending on the four orbital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it’s False, the function will abandon any permutation symmetry,
and return the “plain” MO integrals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array of transformed MO integrals.  The MO integrals may or may not
have the permutation symmetry, depending on the given orbitals, and
the kwargs compact.  If the four sets of orbitals are identical, the
MO integrals will at most have 4-fold symmetry.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.scf</span> <span class="kn">import</span> <span class="n">_vhf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 24)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 21)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 36)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 36)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 80)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.incore.half_e1">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.incore.</span></span><span class="sig-name descname"><span class="pre">half_e1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri_ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/incore.html#half_e1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.incore.half_e1" title="Link to this definition">#</a></dt>
<dd><p>Given two set of orbitals, half transform the (ij| pair of 8-fold or
4-fold AO integrals (ij|kl)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri_ao<span class="classifier">ndarray</span></dt><dd><p>AO integrals, can be either 8-fold or 4-fold symmetry.</p>
</dd>
<dt>mo_coeffs<span class="classifier">list of ndarray</span></dt><dd><p>Two sets of orbital coefficients, corresponding to the i, j
indices of (ij|kl)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, the returned MO integrals uses the highest
possible permutation symmetry.  If it’s False, the function will
abandon any permutation symmetry, and return the “plain” MO
integrals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray of transformed MO integrals.  The MO integrals may or may not
have the permutation symmetry, depending on the given orbitals, and
the kwargs compact.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">half_e1</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">half_e1</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 28)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">half_e1</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">),</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 28)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">half_e1</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 28)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.incore.iden_coeffs">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.incore.</span></span><span class="sig-name descname"><span class="pre">iden_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/incore.html#iden_coeffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.incore.iden_coeffs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.ao2mo.nrr_outcore">
<span id="pyscf-ao2mo-nrr-outcore-module"></span><h2>pyscf.ao2mo.nrr_outcore module<a class="headerlink" href="#module-pyscf.ao2mo.nrr_outcore" title="Link to this heading">#</a></h2>
<p>ao2mo of scalar integrals to complex MO integrals for GHF orbitals</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.nrr_outcore.full">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.nrr_outcore.</span></span><span class="sig-name descname"><span class="pre">full</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e_sph'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">motype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ghf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/nrr_outcore.html#full"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.nrr_outcore.full" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.nrr_outcore.full_iofree">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.nrr_outcore.</span></span><span class="sig-name descname"><span class="pre">full_iofree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname='eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor='int2e_sph'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">motype='ghf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym='s1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=&lt;function</span> <span class="pre">debug&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/nrr_outcore.html#full_iofree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.nrr_outcore.full_iofree" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.nrr_outcore.general">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.nrr_outcore.</span></span><span class="sig-name descname"><span class="pre">general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname='eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor='int2e_sph'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">motype='ghf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym='s1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory=4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size=256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=&lt;function</span> <span class="pre">debug&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/nrr_outcore.html#general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.nrr_outcore.general" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.nrr_outcore.general_iofree">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.nrr_outcore.</span></span><span class="sig-name descname"><span class="pre">general_iofree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname='eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor='int2e_sph'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">motype='ghf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym='s1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=&lt;function</span> <span class="pre">debug&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/nrr_outcore.html#general_iofree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.nrr_outcore.general_iofree" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.nrr_outcore.guess_e1bufsize">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.nrr_outcore.</span></span><span class="sig-name descname"><span class="pre">guess_e1bufsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nij_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/nrr_outcore.html#guess_e1bufsize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.nrr_outcore.guess_e1bufsize" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.nrr_outcore.guess_e2bufsize">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.nrr_outcore.</span></span><span class="sig-name descname"><span class="pre">guess_e2bufsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/nrr_outcore.html#guess_e2bufsize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.nrr_outcore.guess_e2bufsize" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.nrr_outcore.half_e1">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.nrr_outcore.</span></span><span class="sig-name descname"><span class="pre">half_e1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swapfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e_sph'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao2mopt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/nrr_outcore.html#half_e1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.nrr_outcore.half_e1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.nrr_outcore.iden_coeffs">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.nrr_outcore.</span></span><span class="sig-name descname"><span class="pre">iden_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/nrr_outcore.html#iden_coeffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.nrr_outcore.iden_coeffs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.nrr_outcore.prange">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.nrr_outcore.</span></span><span class="sig-name descname"><span class="pre">prange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/nrr_outcore.html#prange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.nrr_outcore.prange" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.nrr_outcore.r_e1">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.nrr_outcore.</span></span><span class="sig-name descname"><span class="pre">r_e1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbs_slice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao2mopt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/nrr_outcore.html#r_e1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.nrr_outcore.r_e1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.ao2mo.outcore">
<span id="pyscf-ao2mo-outcore-module"></span><h2>pyscf.ao2mo.outcore module<a class="headerlink" href="#module-pyscf.ao2mo.outcore" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.balance_partition">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">balance_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ao_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#balance_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.balance_partition" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.balance_segs">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">balance_segs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">segs_lst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#balance_segs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.balance_segs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.full">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">full</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#full"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.full" title="Link to this definition">#</a></dt>
<dd><p>Transfer arbitrary spherical AO integrals to MO integrals for given orbitals</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>mol<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object</span></dt><dd><p>AO integrals will be generated in terms of mol._atm, mol._bas, mol._env</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Transform (ij|kl) with the same set of orbitals.</p>
</dd>
<dt>erifile<span class="classifier">str or h5py File or h5py Group object</span></dt><dd><p>To store the transformed integrals, in HDF5 format.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dataname<span class="classifier">str</span></dt><dd><p>The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the dataname, the new integrals data will
overwrite the old one.</p>
</dd>
<dt>intor<span class="classifier">str</span></dt><dd><p>Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal notranslate"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</p>
</dd>
<dt>aosym<span class="classifier">int or str</span></dt><dd><p>Permutation symmetry for the AO integrals</p>
<div class="line-block">
<div class="line">4 or ‘4’ or ‘s4’: 4-fold symmetry (default)</div>
<div class="line">‘2ij’ or ‘s2ij’ : symmetry between i, j in (ij|kl)</div>
<div class="line">‘2kl’ or ‘s2kl’ : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or ‘1’ or ‘s1’: no symmetry</div>
<div class="line">‘a4ij’ : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a4kl’ : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">‘a2ij’ : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a2kl’ : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp<span class="classifier">int</span></dt><dd><p>Components of the integrals, e.g. int2e_ip_sph has 3 components.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</p>
</dd>
<dt>ioblk_size<span class="classifier">float or int</span></dt><dd><p>The block size for IO, large block size may <strong>not</strong> improve performance</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, depending on the four orbital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it’s False, the function will abandon any permutation symmetry,
and return the “plain” MO integrals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;eri_mo&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">f5</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset </span><span class="si">%s</span><span class="s1">, shape </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="p">[</span><span class="n">dataname</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="n">f5</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (55, 55)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.full_iofree">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">full_iofree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#full_iofree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.full_iofree" title="Link to this definition">#</a></dt>
<dd><p>Transfer arbitrary spherical AO integrals to MO integrals for given orbitals
This function is a wrap for <code class="xref py py-func docutils literal notranslate"><span class="pre">ao2mo.outcore.general()</span></code>.  It’s not really
IO free.  The returned MO integrals are held in memory.  For backward compatibility,
it is used to replace the non-existed function direct.full_iofree.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>mol<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object</span></dt><dd><p>AO integrals will be generated in terms of mol._atm, mol._bas, mol._env</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Transform (ij|kl) with the same set of orbitals.</p>
</dd>
<dt>erifile<span class="classifier">str</span></dt><dd><p>To store the transformed integrals, in HDF5 format.</p>
</dd>
</dl>
</dd>
<dt>Kwargs</dt><dd><dl>
<dt>dataname<span class="classifier">str</span></dt><dd><p>The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the dataname, the new integrals data will
overwrite the old one.</p>
</dd>
<dt>intor<span class="classifier">str</span></dt><dd><p>Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal notranslate"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</p>
</dd>
<dt>aosym<span class="classifier">int or str</span></dt><dd><p>Permutation symmetry for the AO integrals</p>
<div class="line-block">
<div class="line">4 or ‘4’ or ‘s4’: 4-fold symmetry (default)</div>
<div class="line">‘2ij’ or ‘s2ij’ : symmetry between i, j in (ij|kl)</div>
<div class="line">‘2kl’ or ‘s2kl’ : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or ‘1’ or ‘s1’: no symmetry</div>
<div class="line">‘a4ij’ : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a4kl’ : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">‘a2ij’ : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a2kl’ : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp<span class="classifier">int</span></dt><dd><p>Components of the integrals, e.g. int2e_ip_sph has 3 components.</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</p>
</dd>
<dt>ioblk_size<span class="classifier">float or int</span></dt><dd><p>The block size for IO, large block size may <strong>not</strong> improve performance</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, depending on the four orbital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it’s False, the function will abandon any permutation symmetry,
and return the “plain” MO integrals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D/3D MO-integral array.  They may or may not have the permutation
symmetry, depending on the given orbitals, and the kwargs compact.  If
the four sets of orbitals are identical, the MO integrals will at most
have 4-fold symmetry.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 55)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.general">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.general" title="Link to this definition">#</a></dt>
<dd><p>For the given four sets of orbitals, transfer arbitrary spherical AO
integrals to MO integrals on the fly.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>mol<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object</span></dt><dd><p>AO integrals will be generated in terms of mol._atm, mol._bas, mol._env</p>
</dd>
<dt>mo_coeffs<span class="classifier">4-item list of ndarray</span></dt><dd><p>Four sets of orbital coefficients, corresponding to the four
indices of (ij|kl)</p>
</dd>
<dt>erifile<span class="classifier">str or h5py File or h5py Group object</span></dt><dd><p>To store the transformed integrals, in HDF5 format.</p>
</dd>
</dl>
</dd>
<dt>Kwargs</dt><dd><dl>
<dt>dataname<span class="classifier">str</span></dt><dd><p>The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the dataname, the new integrals data will
overwrite the old one.</p>
</dd>
<dt>intor<span class="classifier">str</span></dt><dd><p>Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal notranslate"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</p>
</dd>
<dt>aosym<span class="classifier">int or str</span></dt><dd><p>Permutation symmetry for the AO integrals</p>
<div class="line-block">
<div class="line">4 or ‘4’ or ‘s4’: 4-fold symmetry (default)</div>
<div class="line">‘2ij’ or ‘s2ij’ : symmetry between i, j in (ij|kl)</div>
<div class="line">‘2kl’ or ‘s2kl’ : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or ‘1’ or ‘s1’: no symmetry</div>
<div class="line">‘a4ij’ : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a4kl’ : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">‘a2ij’ : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a2kl’ : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp<span class="classifier">int</span></dt><dd><p>Components of the integrals, e.g. int2e_ip_sph has 3 components.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</p>
</dd>
<dt>ioblk_size<span class="classifier">float or int</span></dt><dd><p>The block size for IO, large block size may <strong>not</strong> improve performance</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, depending on the four orbital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it’s False, the function will abandon any permutation symmetry,
and return the “plain” MO integrals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;eri_mo&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">f5</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset </span><span class="si">%s</span><span class="s1">, shape </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="p">[</span><span class="n">dataname</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="n">f5</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 24)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 21)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 36)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (55, 36)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (55, 55)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.general_iofree">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">general_iofree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#general_iofree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.general_iofree" title="Link to this definition">#</a></dt>
<dd><p>For the given four sets of orbitals, transfer arbitrary spherical AO
integrals to MO integrals on the fly.  This function is a wrap for
<code class="xref py py-func docutils literal notranslate"><span class="pre">ao2mo.outcore.general()</span></code>.  It’s not really IO free.  The returned MO
integrals are held in memory.  For backward compatibility, it is used to
replace the non-existed function direct.general_iofree.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>mol<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object</span></dt><dd><p>AO integrals will be generated in terms of mol._atm, mol._bas, mol._env</p>
</dd>
<dt>mo_coeffs<span class="classifier">4-item list of ndarray</span></dt><dd><p>Four sets of orbital coefficients, corresponding to the four
indices of (ij|kl)</p>
</dd>
</dl>
</dd>
<dt>Kwargs</dt><dd><dl>
<dt>intor<span class="classifier">str</span></dt><dd><p>Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal notranslate"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</p>
</dd>
<dt>aosym<span class="classifier">int or str</span></dt><dd><p>Permutation symmetry for the AO integrals</p>
<div class="line-block">
<div class="line">4 or ‘4’ or ‘s4’: 4-fold symmetry (default)</div>
<div class="line">‘2ij’ or ‘s2ij’ : symmetry between i, j in (ij|kl)</div>
<div class="line">‘2kl’ or ‘s2kl’ : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or ‘1’ or ‘s1’: no symmetry</div>
<div class="line">‘a4ij’ : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a4kl’ : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">‘a2ij’ : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a2kl’ : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp<span class="classifier">int</span></dt><dd><p>Components of the integrals, e.g. int2e_ip_sph has 3 components.</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, depending on the four orbital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it’s False, the function will abandon any permutation symmetry,
and return the “plain” MO integrals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D/3D MO-integral array.  They may or may not have the permutation
symmetry, depending on the given orbitals, and the kwargs compact.  If
the four sets of orbitals are identical, the MO integrals will at most
have 4-fold symmetry.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;eri_mo&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">f5</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset </span><span class="si">%s</span><span class="s1">, shape </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="p">[</span><span class="n">dataname</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="n">f5</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 24)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 21)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 36)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.guess_e1bufsize">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">guess_e1bufsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nij_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#guess_e1bufsize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.guess_e1bufsize" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.guess_e2bufsize">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">guess_e2bufsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#guess_e2bufsize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.guess_e2bufsize" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.guess_shell_ranges">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">guess_shell_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iobuf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_aobuf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#guess_shell_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.guess_shell_ranges" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.half_e1">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">half_e1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swapfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao2mopt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#half_e1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.half_e1" title="Link to this definition">#</a></dt>
<dd><p>Half transform arbitrary spherical AO integrals to MO integrals
for the given two sets of orbitals</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>mol<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object</span></dt><dd><p>AO integrals will be generated in terms of mol._atm, mol._bas, mol._env</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Transform (ij|kl) with the same set of orbitals.</p>
</dd>
<dt>swapfile<span class="classifier">str or h5py File or h5py Group object</span></dt><dd><p>To store the transformed integrals, in HDF5 format.  The transformed
integrals are saved in blocks.</p>
</dd>
</dl>
</dd>
<dt>Kwargs</dt><dd><dl>
<dt>intor<span class="classifier">str</span></dt><dd><p>Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal notranslate"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</p>
</dd>
<dt>aosym<span class="classifier">int or str</span></dt><dd><p>Permutation symmetry for the AO integrals</p>
<div class="line-block">
<div class="line">4 or ‘4’ or ‘s4’: 4-fold symmetry (default)</div>
<div class="line">‘2ij’ or ‘s2ij’ : symmetry between i, j in (ij|kl)</div>
<div class="line">‘2kl’ or ‘s2kl’ : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or ‘1’ or ‘s1’: no symmetry</div>
<div class="line">‘a4ij’ : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a4kl’ : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">‘a2ij’ : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a2kl’ : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp<span class="classifier">int</span></dt><dd><p>Components of the integrals, e.g. int2e_ip_sph has 3 components.</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</p>
</dd>
<dt>ioblk_size<span class="classifier">float or int</span></dt><dd><p>The block size for IO, large block size may <strong>not</strong> improve performance</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, depending on the four orbital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it’s False, the function will abandon any permutation symmetry,
and return the “plain” MO integrals</p>
</dd>
<dt>ao2mopt<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">AO2MOpt</span></code> object</span></dt><dd><p>Precomputed data to improve performance</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.iden_coeffs">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">iden_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#iden_coeffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.iden_coeffs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.outcore.prange">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.outcore.</span></span><span class="sig-name descname"><span class="pre">prange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/outcore.html#prange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.prange" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.ao2mo.r_outcore">
<span id="pyscf-ao2mo-r-outcore-module"></span><h2>pyscf.ao2mo.r_outcore module<a class="headerlink" href="#module-pyscf.ao2mo.r_outcore" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.r_outcore.full">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.r_outcore.</span></span><span class="sig-name descname"><span class="pre">full</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e_spinor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/r_outcore.html#full"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.r_outcore.full" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.r_outcore.full_iofree">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.r_outcore.</span></span><span class="sig-name descname"><span class="pre">full_iofree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e_spinor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/r_outcore.html#full_iofree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.r_outcore.full_iofree" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.r_outcore.general">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.r_outcore.</span></span><span class="sig-name descname"><span class="pre">general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e_spinor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/r_outcore.html#general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.r_outcore.general" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.r_outcore.general_iofree">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.r_outcore.</span></span><span class="sig-name descname"><span class="pre">general_iofree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e_spinor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/r_outcore.html#general_iofree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.r_outcore.general_iofree" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.r_outcore.guess_e1bufsize">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.r_outcore.</span></span><span class="sig-name descname"><span class="pre">guess_e1bufsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nij_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/r_outcore.html#guess_e1bufsize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.r_outcore.guess_e1bufsize" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.r_outcore.guess_e2bufsize">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.r_outcore.</span></span><span class="sig-name descname"><span class="pre">guess_e2bufsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/r_outcore.html#guess_e2bufsize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.r_outcore.guess_e2bufsize" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.r_outcore.half_e1">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.r_outcore.</span></span><span class="sig-name descname"><span class="pre">half_e1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swapfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e_spinor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aosym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao2mopt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/r_outcore.html#half_e1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.r_outcore.half_e1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.r_outcore.iden_coeffs">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.r_outcore.</span></span><span class="sig-name descname"><span class="pre">iden_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/r_outcore.html#iden_coeffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.r_outcore.iden_coeffs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.r_outcore.prange">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.r_outcore.</span></span><span class="sig-name descname"><span class="pre">prange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/r_outcore.html#prange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.r_outcore.prange" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.ao2mo.semi_incore">
<span id="pyscf-ao2mo-semi-incore-module"></span><h2>pyscf.ao2mo.semi_incore module<a class="headerlink" href="#module-pyscf.ao2mo.semi_incore" title="Link to this heading">#</a></h2>
<p>Created on Thu May 17 11:05:22 2018</p>
<p>&#64;author: Bryan Lau</p>
<p>A module that will do on-disk transformation of two electron integrals, and
also return specific slices of (o)ccupied and (v)irtual ones needed for post HF</p>
<p>Comparing to the full in-memory transformation (see incore.py) which holds all
intermediates in memory, this version uses less memory but performs slow due
to IO overhead.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.semi_incore.general">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.semi_incore.</span></span><span class="sig-name descname"><span class="pre">general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioblk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo/semi_incore.html#general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.semi_incore.general" title="Link to this definition">#</a></dt>
<dd><p>For the given four sets of orbitals, transfer arbitrary spherical AO
integrals to MO integrals on disk.
Args:</p>
<blockquote>
<div><p>eri : 8-fold reduced eri vector
mo_coeffs : 4-item list of ndarray</p>
<blockquote>
<div><p>Four sets of orbital coefficients, corresponding to the four
indices of (ij|kl)</p>
</div></blockquote>
<dl class="simple">
<dt>erifile<span class="classifier">str or h5py File or h5py Group object</span></dt><dd><p>To store the transformed integrals, in HDF5 format.</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>Kwargs</dt><dd><dl class="simple">
<dt>dataname<span class="classifier">str</span></dt><dd><p>The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the dataname, the new integrals data will
overwrite the old one.</p>
</dd>
<dt>ioblk_size<span class="classifier">float or int</span></dt><dd><p>The block size for IO, large block size may <strong>not</strong> improve performance</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, depending on the four orbital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it’s False, the function will abandon any permutation symmetry,
and return the “plain” MO integrals</p>
</dd>
</dl>
</dd>
<dt>Pseudocode / algorithm:</dt><dd><p>u = mu
v = nu
l = lambda
o = sigma</p>
<p>Assume eri’s are 8-fold reduced.
nij/nkl_pair = npair or i*j/k*l if only transforming a subset</p>
<dl class="simple">
<dt>First half transform:</dt><dd><dl class="simple">
<dt>Initialize half_eri of size (nij_pair,npair)</dt><dd><dl class="simple">
<dt>For lo = 1 -&gt; npair</dt><dd><p>Unpack row lo
Unpack row lo to matrix E_{uv}^{lo}
Transform C_ui^+*E*C_nj -&gt; E_{ij}^{lo}
Ravel or pack E_{ij}^{lo}
Save E_{ij}^{lo} -&gt; half_eri[:,lo]</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Second half transform:</dt><dd><dl class="simple">
<dt>Initialize h5d_eri of size (nij_pair,nkl_pair)</dt><dd><dl class="simple">
<dt>For ij = 1 -&gt; nij_pair</dt><dd><p>Load and unpack half_eri[ij,:] -&gt; E_{lo}^{ij}
Transform C_{lk}E_{lo}^{ij}C_{ol} -&gt; E_{kl}^{ij}
Repack E_{kl}^{ij}
Save E_{kl}^{ij} -&gt; h5d_eri[ij,:]</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>Each matrix is indexed by the composite index ij x kl, where ij/kl is
either npair or ixj/kxl, if only a subset of MOs are being transformed.
Since entire rows or columns need to be read in, the arrays are chunked
such that IOBLK_SIZE = row/col x chunking col/row. For example, for the
first half transform, we would save in nij_pair x IOBLK_SIZE/nij_pair,
then load in IOBLK_SIZE/nkl_pair x npair for the second half transform.</p>
<p>—— kl —–&gt;
<a href="#id1"><span class="problematic" id="id2">|</span></a>jxl
|
ij
|
|
v</p>
<p>As a first guess, the chunking size is jxl. If the super-rows/cols are
larger than IOBLK_SIZE, then the chunk rectangle jxl is trimmed
accordingly. The pathological limiting case is where the dimensions
nao_pair, nij_pair, or nkl_pair are so large that the arrays are
chunked 1x1, in which case IOBLK_SIZE needs to be increased.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.ao2mo">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyscf.ao2mo" title="Link to this heading">#</a></h2>
<section id="general-integral-transformation-module">
<h3>General Integral transformation module<a class="headerlink" href="#general-integral-transformation-module" title="Link to this heading">#</a></h3>
<p>Simple usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo_ints</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
</pre></div>
</div>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.full">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.</span></span><span class="sig-name descname"><span class="pre">full</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo.html#full"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.full" title="Link to this definition">#</a></dt>
<dd><p>MO integral transformation. The four indices (ij|kl) are transformed
with the same set of orbitals.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri_or_mol<span class="classifier">ndarray or Mole object</span></dt><dd><p>If AO integrals are given as ndarray, it can be either 8-fold or
4-fold symmetry.  The integral transformation are computed incore
(ie all intermediate are held in memory).
If Mole object is given, AO integrals are generated on the fly and
outcore algorithm is used (ie intermediate data are held on disk).</p>
</dd>
<dt>mo_coeff<span class="classifier">ndarray</span></dt><dd><p>Orbital coefficients in 2D array</p>
</dd>
<dt>erifile<span class="classifier">str or h5py File or h5py Group object</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The file to store the transformed integrals.  If not given, the
transformed integrals are held in memory.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dataname<span class="classifier">str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the dataname, the new integrals data will
overwrite the old one.</p>
</dd>
<dt>intor<span class="classifier">str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal notranslate"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</p>
</dd>
<dt>aosym<span class="classifier">int or str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Permutation symmetry for the AO integrals</p>
<div class="line-block">
<div class="line">4 or ‘4’ or ‘s4’: 4-fold symmetry (default)</div>
<div class="line">‘2ij’ or ‘s2ij’ : symmetry between i, j in (ij|kl)</div>
<div class="line">‘2kl’ or ‘s2kl’ : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or ‘1’ or ‘s1’: no symmetry</div>
<div class="line">‘a4ij’ : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a4kl’ : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">‘a2ij’ : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a2kl’ : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp<span class="classifier">int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Components of the integrals, e.g. int2e_ip_sph has 3 components.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</p>
</dd>
<dt>ioblk_size<span class="classifier">float or int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The block size for IO, large block size may <strong>not</strong> improve performance</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, depending on the four orbital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it’s False, the function will abandon any permutation symmetry,
and return the “plain” MO integrals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>If eri_or_mol is array or erifile is not give,  the function returns 2D
array (or 3D array if comp &gt; 1) of transformed MO integrals.  The MO
integrals may or may not have the permutation symmetry (controlled by
the kwargs compact).
Otherwise, return the file/fileobject where the MO integrals are saved.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;eri_mo&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f5</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset </span><span class="si">%s</span><span class="s1">, shape </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="p">[</span><span class="n">dataname</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (55, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.general">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.</span></span><span class="sig-name descname"><span class="pre">general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo.html#general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.general" title="Link to this definition">#</a></dt>
<dd><p>Given four sets of orbitals corresponding to the four MO indices,
transfer arbitrary spherical AO integrals to MO integrals.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri_or_mol<span class="classifier">ndarray or Mole object</span></dt><dd><p>If AO integrals are given as ndarray, it can be either 8-fold or
4-fold symmetry.  The integral transformation are computed incore
(ie all intermediate are held in memory).
If Mole object is given, AO integrals are generated on the fly and
outcore algorithm is used (ie intermediate data are held on disk).</p>
</dd>
<dt>mo_coeffs<span class="classifier">4-item list of ndarray</span></dt><dd><p>Four sets of orbital coefficients, corresponding to the four
indices of (ij|kl)</p>
</dd>
<dt>erifile<span class="classifier">str or h5py File or h5py Group object</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The file to store the transformed integrals.  If not given, the
transformed integrals are held in memory.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>dataname<span class="classifier">str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the dataname, the new integrals data will
overwrite the old one.</p>
</dd>
<dt>intor<span class="classifier">str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal notranslate"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</p>
</dd>
<dt>aosym<span class="classifier">int or str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Permutation symmetry for the AO integrals</p>
<div class="line-block">
<div class="line">4 or ‘4’ or ‘s4’: 4-fold symmetry (default)</div>
<div class="line">‘2ij’ or ‘s2ij’ : symmetry between i, j in (ij|kl)</div>
<div class="line">‘2kl’ or ‘s2kl’ : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or ‘1’ or ‘s1’: no symmetry</div>
<div class="line">‘a4ij’ : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a4kl’ : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">‘a2ij’ : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a2kl’ : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp<span class="classifier">int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Components of the integrals, e.g. int2e_ip_sph has 3 components.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</p>
</dd>
<dt>ioblk_size<span class="classifier">float or int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The block size for IO, large block size may <strong>not</strong> improve performance</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, depending on the four orbital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it’s False, the function will abandon any permutation symmetry,
and return the “plain” MO integrals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>If eri_or_mol is array or erifile is not give,  the function returns 2D
array (or 3D array, if comp &gt; 1) of transformed MO integrals.  The MO
integrals may at most have 4-fold symmetry (if the four sets of orbitals
are identical) or may not have the permutation symmetry (controlled by
the kwargs compact).
Otherwise, return the file/fileobject where the MO integrals are saved.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;eri_mo&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f5</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset </span><span class="si">%s</span><span class="s1">, shape </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="p">[</span><span class="n">dataname</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 24)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 21)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 80)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 24)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 21)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (55, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (55, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.get_ao_eri">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.</span></span><span class="sig-name descname"><span class="pre">get_ao_eri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo.html#get_ao_eri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.get_ao_eri" title="Link to this definition">#</a></dt>
<dd><p>2-electron integrals in AO basis</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.get_mo_eri">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.</span></span><span class="sig-name descname"><span class="pre">get_mo_eri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.ao2mo.get_mo_eri" title="Link to this definition">#</a></dt>
<dd><p>Transfer arbitrary spherical AO integrals to MO integrals, for given
orbitals or four sets of orbitals.  See also <code class="xref py py-func docutils literal notranslate"><span class="pre">ao2mo.full()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">ao2mo.general()</span></code>.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri_or_mol<span class="classifier">ndarray or Mole object</span></dt><dd><p>If AO integrals are given as ndarray, it can be either 8-fold or
4-fold symmetry.  The integral transformation are computed incore
(ie all intermediate are held in memory).
If Mole object is given, AO integrals are generated on the fly and
outcore algorithm is used (ie intermediate data are held on disk).</p>
</dd>
<dt>mo_coeffs<span class="classifier">an np array or a list of arrays</span></dt><dd><p>A matrix of orbital coefficients if it is a numpy ndarray; Or four
sets of orbital coefficients if it is a list of arrays,
corresponding to the four indices of (ij|kl).</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>erifile<span class="classifier">str or h5py File or h5py Group object</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The file to store the transformed integrals.  If not given, the
return value is an array (in memory) of the transformed integrals.</p>
</dd>
<dt>dataname<span class="classifier">str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the dataname, the new integrals data will
overwrite the old one.</p>
</dd>
<dt>intor<span class="classifier">str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal notranslate"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</p>
</dd>
<dt>aosym<span class="classifier">int or str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Permutation symmetry for the AO integrals</p>
<div class="line-block">
<div class="line">4 or ‘4’ or ‘s4’: 4-fold symmetry (default)</div>
<div class="line">‘2ij’ or ‘s2ij’ : symmetry between i, j in (ij|kl)</div>
<div class="line">‘2kl’ or ‘s2kl’ : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or ‘1’ or ‘s1’: no symmetry</div>
<div class="line">‘a4ij’ : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a4kl’ : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">‘a2ij’ : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a2kl’ : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp<span class="classifier">int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Components of the integrals, e.g. int2e_ip_sph has 3 components.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</p>
</dd>
<dt>ioblk_size<span class="classifier">float or int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The block size for IO, large block size may <strong>not</strong> improve performance</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, depending on the four orbital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it’s False, the function will abandon any permutation symmetry,
and return the “plain” MO integrals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>If eri_or_mol is array or erifile is not give,  the function returns 2D
array (or 3D array, if comp &gt; 1) of transformed MO integrals.  The MO
integrals may at most have 4-fold symmetry (if the four sets of orbitals
are identical) or may not have the permutation symmetry (controlled by
the kwargs compact).
Otherwise, return the file/fileobject where the MO integrals are saved.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;eri_mo&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f5</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset </span><span class="si">%s</span><span class="s1">, shape </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="p">[</span><span class="n">dataname</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">erifile</span><span class="o">=</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (55, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 24)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 21)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 80)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 24)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 21)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (55, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (55, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.ao2mo.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.ao2mo.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erifile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eri_mo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int2e'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/ao2mo.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.ao2mo.kernel" title="Link to this definition">#</a></dt>
<dd><p>Transfer arbitrary spherical AO integrals to MO integrals, for given
orbitals or four sets of orbitals.  See also <code class="xref py py-func docutils literal notranslate"><span class="pre">ao2mo.full()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">ao2mo.general()</span></code>.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri_or_mol<span class="classifier">ndarray or Mole object</span></dt><dd><p>If AO integrals are given as ndarray, it can be either 8-fold or
4-fold symmetry.  The integral transformation are computed incore
(ie all intermediate are held in memory).
If Mole object is given, AO integrals are generated on the fly and
outcore algorithm is used (ie intermediate data are held on disk).</p>
</dd>
<dt>mo_coeffs<span class="classifier">an np array or a list of arrays</span></dt><dd><p>A matrix of orbital coefficients if it is a numpy ndarray; Or four
sets of orbital coefficients if it is a list of arrays,
corresponding to the four indices of (ij|kl).</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>erifile<span class="classifier">str or h5py File or h5py Group object</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The file to store the transformed integrals.  If not given, the
return value is an array (in memory) of the transformed integrals.</p>
</dd>
<dt>dataname<span class="classifier">str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the dataname, the new integrals data will
overwrite the old one.</p>
</dd>
<dt>intor<span class="classifier">str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal notranslate"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</p>
</dd>
<dt>aosym<span class="classifier">int or str</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Permutation symmetry for the AO integrals</p>
<div class="line-block">
<div class="line">4 or ‘4’ or ‘s4’: 4-fold symmetry (default)</div>
<div class="line">‘2ij’ or ‘s2ij’ : symmetry between i, j in (ij|kl)</div>
<div class="line">‘2kl’ or ‘s2kl’ : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or ‘1’ or ‘s1’: no symmetry</div>
<div class="line">‘a4ij’ : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a4kl’ : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">‘a2ij’ : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">‘a2kl’ : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp<span class="classifier">int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
Components of the integrals, e.g. int2e_ip_sph has 3 components.</p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</p>
</dd>
<dt>ioblk_size<span class="classifier">float or int</span></dt><dd><p><em>Note</em> this argument is effective when eri_or_mol is Mole object.
The block size for IO, large block size may <strong>not</strong> improve performance</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level</p>
</dd>
<dt>compact<span class="classifier">bool</span></dt><dd><p>When compact is True, depending on the four orbital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it’s False, the function will abandon any permutation symmetry,
and return the “plain” MO integrals</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>If eri_or_mol is array or erifile is not give,  the function returns 2D
array (or 3D array, if comp &gt; 1) of transformed MO integrals.  The MO
integrals may at most have 4-fold symmetry (if the four sets of orbitals
are identical) or may not have the permutation symmetry (controlled by
the kwargs compact).
Otherwise, return the file/fileobject where the MO integrals are saved.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;eri_mo&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f5</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset </span><span class="si">%s</span><span class="s1">, shape </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="p">[</span><span class="n">dataname</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">erifile</span><span class="o">=</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (55, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 24)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 21)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 80)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 24)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 21)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (55, 36)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (55, 55)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 100)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.ao2mo.addons">pyscf.ao2mo.addons module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.addons.load"><code class="docutils literal notranslate"><span class="pre">load</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.addons.restore"><code class="docutils literal notranslate"><span class="pre">restore()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.ao2mo.incore">pyscf.ao2mo.incore module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.incore.full"><code class="docutils literal notranslate"><span class="pre">full()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.incore.general"><code class="docutils literal notranslate"><span class="pre">general()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.incore.half_e1"><code class="docutils literal notranslate"><span class="pre">half_e1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.incore.iden_coeffs"><code class="docutils literal notranslate"><span class="pre">iden_coeffs()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.ao2mo.nrr_outcore">pyscf.ao2mo.nrr_outcore module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.nrr_outcore.full"><code class="docutils literal notranslate"><span class="pre">full()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.nrr_outcore.full_iofree"><code class="docutils literal notranslate"><span class="pre">full_iofree()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.nrr_outcore.general"><code class="docutils literal notranslate"><span class="pre">general()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.nrr_outcore.general_iofree"><code class="docutils literal notranslate"><span class="pre">general_iofree()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.nrr_outcore.guess_e1bufsize"><code class="docutils literal notranslate"><span class="pre">guess_e1bufsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.nrr_outcore.guess_e2bufsize"><code class="docutils literal notranslate"><span class="pre">guess_e2bufsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.nrr_outcore.half_e1"><code class="docutils literal notranslate"><span class="pre">half_e1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.nrr_outcore.iden_coeffs"><code class="docutils literal notranslate"><span class="pre">iden_coeffs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.nrr_outcore.prange"><code class="docutils literal notranslate"><span class="pre">prange()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.nrr_outcore.r_e1"><code class="docutils literal notranslate"><span class="pre">r_e1()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.ao2mo.outcore">pyscf.ao2mo.outcore module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.balance_partition"><code class="docutils literal notranslate"><span class="pre">balance_partition()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.balance_segs"><code class="docutils literal notranslate"><span class="pre">balance_segs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.full"><code class="docutils literal notranslate"><span class="pre">full()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.full_iofree"><code class="docutils literal notranslate"><span class="pre">full_iofree()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.general"><code class="docutils literal notranslate"><span class="pre">general()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.general_iofree"><code class="docutils literal notranslate"><span class="pre">general_iofree()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.guess_e1bufsize"><code class="docutils literal notranslate"><span class="pre">guess_e1bufsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.guess_e2bufsize"><code class="docutils literal notranslate"><span class="pre">guess_e2bufsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.guess_shell_ranges"><code class="docutils literal notranslate"><span class="pre">guess_shell_ranges()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.half_e1"><code class="docutils literal notranslate"><span class="pre">half_e1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.iden_coeffs"><code class="docutils literal notranslate"><span class="pre">iden_coeffs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.outcore.prange"><code class="docutils literal notranslate"><span class="pre">prange()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.ao2mo.r_outcore">pyscf.ao2mo.r_outcore module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.r_outcore.full"><code class="docutils literal notranslate"><span class="pre">full()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.r_outcore.full_iofree"><code class="docutils literal notranslate"><span class="pre">full_iofree()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.r_outcore.general"><code class="docutils literal notranslate"><span class="pre">general()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.r_outcore.general_iofree"><code class="docutils literal notranslate"><span class="pre">general_iofree()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.r_outcore.guess_e1bufsize"><code class="docutils literal notranslate"><span class="pre">guess_e1bufsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.r_outcore.guess_e2bufsize"><code class="docutils literal notranslate"><span class="pre">guess_e2bufsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.r_outcore.half_e1"><code class="docutils literal notranslate"><span class="pre">half_e1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.r_outcore.iden_coeffs"><code class="docutils literal notranslate"><span class="pre">iden_coeffs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.r_outcore.prange"><code class="docutils literal notranslate"><span class="pre">prange()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.ao2mo.semi_incore">pyscf.ao2mo.semi_incore module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.semi_incore.general"><code class="docutils literal notranslate"><span class="pre">general()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.ao2mo">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-integral-transformation-module">General Integral transformation module</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.full"><code class="docutils literal notranslate"><span class="pre">full()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.general"><code class="docutils literal notranslate"><span class="pre">general()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.get_ao_eri"><code class="docutils literal notranslate"><span class="pre">get_ao_eri()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.get_mo_eri"><code class="docutils literal notranslate"><span class="pre">get_mo_eri()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.ao2mo.kernel"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/pyscf/pyscf.github.io/edit/master/source/pyscf_api_docs/pyscf.ao2mo.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, The PySCF Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>