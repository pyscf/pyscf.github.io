
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pyscf.agf2 package &#8212; PySCF</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf-pst.css?v=ed6b5f64" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=182a64a0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pyscf_api_docs/pyscf.agf2';</script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.9" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-64x64.png" class="logo__image only-light" alt=""/>
    <img src="../_static/logo-64x64.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">PySCF</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pyscf.adc.html">pyscf.adc package</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">pyscf.agf2 package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.ao2mo.html">pyscf.ao2mo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.cc.html">pyscf.cc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.ci.html">pyscf.ci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.data.html">pyscf.data package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.df.html">pyscf.df package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.grad.html">pyscf.df.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.hessian.html">pyscf.df.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.dft.html">pyscf.dft package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.dft.xc.html">pyscf.dft.xc package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.eph.html">pyscf.eph package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.fci.html">pyscf.fci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.geomopt.html">pyscf.geomopt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.grad.html">pyscf.grad package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.gto.html">pyscf.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.gto.basis.html">pyscf.gto.basis package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.gto.basis.dyall-basis.html">pyscf.gto.basis.dyall-basis package</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.gw.html">pyscf.gw package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.hessian.html">pyscf.hessian package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.lib.html">pyscf.lib package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.lo.html">pyscf.lo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mcscf.html">pyscf.mcscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mp.html">pyscf.mp package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mrpt.html">pyscf.mrpt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.nac.html">pyscf.nac package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.pbc.html">pyscf.pbc package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.adc.html">pyscf.pbc.adc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ao2mo.html">pyscf.pbc.ao2mo package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.cc.html">pyscf.pbc.cc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ci.html">pyscf.pbc.ci package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.df.html">pyscf.pbc.df package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.pbc.dft.html">pyscf.pbc.dft package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html">pyscf.pbc.dft.multigrid package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.eph.html">pyscf.pbc.eph package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.geomopt.html">pyscf.pbc.geomopt package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.grad.html">pyscf.pbc.grad package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.pbc.gto.html">pyscf.pbc.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html">pyscf.pbc.gto.basis package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html">pyscf.pbc.gto.pseudo package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gw.html">pyscf.pbc.gw package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.lib.html">pyscf.pbc.lib package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mp.html">pyscf.pbc.mp package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpicc.html">pyscf.pbc.mpicc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpitools.html">pyscf.pbc.mpitools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.scf.html">pyscf.pbc.scf package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.symm.html">pyscf.pbc.symm package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tddft.html">pyscf.pbc.tddft package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tdscf.html">pyscf.pbc.tdscf package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tools.html">pyscf.pbc.tools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.x2c.html">pyscf.pbc.x2c package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.qmmm.html">pyscf.qmmm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.scf.html">pyscf.scf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.sgx.html">pyscf.sgx package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.solvent.html">pyscf.solvent package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.grad.html">pyscf.solvent.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.hessian.html">pyscf.solvent.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.soscf.html">pyscf.soscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.symm.html">pyscf.symm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tddft.html">pyscf.tddft package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tdscf.html">pyscf.tdscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tools.html">pyscf.tools package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.x2c.html">pyscf.x2c package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">pyscf.agf2 package</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pyscf-agf2-package">
<h1>pyscf.agf2 package<a class="headerlink" href="#pyscf-agf2-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-pyscf.agf2.aux_space">
<span id="pyscf-agf2-aux-space-module"></span><h2>pyscf.agf2.aux_space module<a class="headerlink" href="#module-pyscf.agf2.aux_space" title="Link to this heading">#</a></h2>
<p>Auxiliary space class and helper functions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">AuxiliarySpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>Simple container to hold the energies, couplings and chemical</dt><dd><p>potential associated with an auxiliary space.</p>
</dd>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>energy<span class="classifier">1D array</span></dt><dd><p>Energies of the poles</p>
</dd>
<dt>coupling<span class="classifier">2D array</span></dt><dd><p>Coupling vector of the poles to each physical state</p>
</dd>
<dt>chempot<span class="classifier">float</span></dt><dd><p>Chemical potential associated with the energies</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.compress">
<span class="sig-name descname"><span class="pre">compress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.compress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.compress" title="Link to this definition">#</a></dt>
<dd><p>See subclasses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.copy" title="Link to this definition">#</a></dt>
<dd><p>Returns a copy of the current object.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>AuxiliarySpace</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.dot">
<span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.dot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.dot" title="Link to this definition">#</a></dt>
<dd><p>Returns the dot product of <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_array" title="pyscf.agf2.aux_space.AuxiliarySpace.get_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_array()</span></code></a> with a vector.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical (1p + 1h) part of the matrix</p>
</dd>
<dt>vec<span class="classifier">ndarray</span></dt><dd><p>Vector to compute dot product with</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>out<span class="classifier">2D array</span></dt><dd><p>If provided, use to store output</p>
</dd>
<dt>chempot<span class="classifier">float</span></dt><dd><p>Scale energies (by default, <code class="xref py py-attr docutils literal notranslate"><span class="pre">chempot</span></code> is not used
and energies retain their values). Default 0.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray with shape of <code class="xref py py-attr docutils literal notranslate"><span class="pre">vec</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.eig">
<span class="sig-name descname"><span class="pre">eig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.eig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.eig" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Computes the eigenvalues and eigenvectors of the array</dt><dd><p>returned by <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_array" title="pyscf.agf2.aux_space.AuxiliarySpace.get_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_array()</span></code></a>.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical (1p + 1h) part of the matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>out<span class="classifier">2D array</span></dt><dd><p>If provided, use to store output</p>
</dd>
<dt>chempot<span class="classifier">float</span></dt><dd><p>Scale energies (by default, <code class="xref py py-attr docutils literal notranslate"><span class="pre">chempot</span></code> is not used
and energies retain their values). Default 0.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays (eigenvalues, eigenvectors)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.get_array">
<span class="sig-name descname"><span class="pre">get_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.get_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_array" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Expresses the auxiliaries as an array, i.e. the extended</dt><dd><p>Fock matrix in AGF2 or Hamiltonian of ADC(2).</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical (1p + 1h) part of the matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>out<span class="classifier">2D array</span></dt><dd><p>If provided, use to store output</p>
</dd>
<dt>chempot<span class="classifier">float</span></dt><dd><p>Scale energies (by default, <code class="xref py py-attr docutils literal notranslate"><span class="pre">chempot</span></code> is not used
and energies retain their values). Default 0.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Array representing the coupling of the auxiliary space to
the physical space</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.get_occupied">
<span class="sig-name descname"><span class="pre">get_occupied</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.get_occupied"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_occupied" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Returns a copy of the current AuxiliarySpace object</dt><dd><p>containing only the poles with energy less than the
chemical potential. The object should already be sorted.</p>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a> with only the occupied auxiliaries</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.get_virtual">
<span class="sig-name descname"><span class="pre">get_virtual</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.get_virtual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_virtual" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Returns a copy of the current AuxiliarySpace object</dt><dd><p>containing only the poles with energy greater than the
chemical potential. The object should already be sorted.</p>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a> with only the virtual auxiliaries</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.load" title="Link to this definition">#</a></dt>
<dd><p>Loads the auxiliaries from a chkfile</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Name of chkfile</p>
</dd>
<dt>key<span class="classifier">str</span></dt><dd><p>Key to be used in h5py object. It can contain “/” to
represent the path in the HDF5 storage structure.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.moment">
<span class="sig-name descname"><span class="pre">moment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.moment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.moment" title="Link to this definition">#</a></dt>
<dd><p>Builds the nth moment of the spectral distribution.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>n<span class="classifier">int or list of int</span></dt><dd><p>Moment(s) to compute</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>squeeze<span class="classifier">bool</span></dt><dd><p>If True, use <code class="xref py py-func docutils literal notranslate"><span class="pre">np.squeeze()</span></code> on output so that in
the case of <code class="xref py py-attr docutils literal notranslate"><span class="pre">n</span></code> being an int, a 2D array is
returned. If False, output is always 3D. Default True.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray of moments</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.naux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">naux</span></span><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.naux" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.nphys">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nphys</span></span><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.nphys" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.real_freq_spectrum">
<span class="sig-name descname"><span class="pre">real_freq_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.real_freq_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.real_freq_spectrum" title="Link to this definition">#</a></dt>
<dd><p>See subclasses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.remove_uncoupled">
<span class="sig-name descname"><span class="pre">remove_uncoupled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.remove_uncoupled"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.remove_uncoupled" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Removes poles with very low spectral weight (uncoupled</dt><dd><p>to the physical space) in-place.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>tol<span class="classifier">float</span></dt><dd><p>Threshold for the spectral weight (squared norm)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.save" title="Link to this definition">#</a></dt>
<dd><p>Saves the auxiliaries in chkfile</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Name of chkfile</p>
</dd>
<dt>key<span class="classifier">str</span></dt><dd><p>Key to be used in h5py object. It can contain “/” to
represent the path in the HDF5 storage structure.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.AuxiliarySpace.sort">
<span class="sig-name descname"><span class="pre">sort</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#AuxiliarySpace.sort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.AuxiliarySpace.sort" title="Link to this definition">#</a></dt>
<dd><p>Sort in-place via the energies to make slicing easier.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.GreensFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">GreensFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#GreensFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.GreensFunction" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a></p>
<p>Defines a Green’s function represented as a
<a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a> object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.GreensFunction.compress">
<span class="sig-name descname"><span class="pre">compress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#GreensFunction.compress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.GreensFunction.compress" title="Link to this definition">#</a></dt>
<dd><p>See subclasses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.GreensFunction.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#GreensFunction.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.GreensFunction.make_rdm1" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Returns the first-order reduced density matrix associated</dt><dd><p>with the Green’s function.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>chempot<span class="classifier">float</span></dt><dd><p>If provided, use instead of <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.chempot</span></code></p>
</dd>
<dt>occupancy<span class="classifier">int</span></dt><dd><p>Occupancy of the states, i.e. 2 for RHF and 1 for UHF</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.GreensFunction.real_freq_spectrum">
<span class="sig-name descname"><span class="pre">real_freq_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#GreensFunction.real_freq_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.GreensFunction.real_freq_spectrum" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Express the auxiliaries as a spectral function on the real</dt><dd><p>frequency axis.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>grid<span class="classifier">1D array</span></dt><dd><p>Real frequency grid</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>eta<span class="classifier">float</span></dt><dd><p>Peak broadening factor in Hartrees. Default is 0.02.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray of the spectrum, with the first index being the
frequency</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.SelfEnergy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">SelfEnergy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#SelfEnergy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.SelfEnergy" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a></p>
<p>Defines a self-energy represented as a <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a>
object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.SelfEnergy.compress">
<span class="sig-name descname"><span class="pre">compress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#SelfEnergy.compress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.SelfEnergy.compress" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Compress the auxiliaries via moments of the particle and</dt><dd><p>hole Green’s function and self-energy. Resulting <code class="xref py py-attr docutils literal notranslate"><span class="pre">naux</span></code>
depends on the chosen <code class="xref py py-attr docutils literal notranslate"><span class="pre">n</span></code>.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array or None</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix.
Only required if <code class="xref py py-attr docutils literal notranslate"><span class="pre">n[0]</span></code> is not None.</p>
</dd>
<dt>n<span class="classifier">tuple of int</span></dt><dd><p>Compression level of the Green’s function and
self-energy, respectively.</p>
</dd>
<dt>tol<span class="classifier">float</span></dt><dd><p>Linear dependency tolerance. Default value is 1e-12</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.SelfEnergy" title="pyscf.agf2.aux_space.SelfEnergy"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></a> with reduced auxiliary dimension.</p>
</dd>
<dt>Raises:</dt><dd><p>MemoryError if the compression according to Green’s
function moments will exceed the maximum allowed memory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.SelfEnergy.get_greens_function">
<span class="sig-name descname"><span class="pre">get_greens_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#SelfEnergy.get_greens_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.SelfEnergy.get_greens_function" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Returns a <a class="reference internal" href="#pyscf.agf2.aux_space.GreensFunction" title="pyscf.agf2.aux_space.GreensFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code></a> by solving the Dyson</dt><dd><p>equation.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.GreensFunction" title="pyscf.agf2.aux_space.GreensFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.SelfEnergy.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#SelfEnergy.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.SelfEnergy.make_rdm1" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Returns the first-order reduced density matrix associated</dt><dd><p>with the self-energy via the <a class="reference internal" href="#pyscf.agf2.aux_space.GreensFunction" title="pyscf.agf2.aux_space.GreensFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code></a>.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>chempot<span class="classifier">float</span></dt><dd><p>If provided, use instead of <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.chempot</span></code></p>
</dd>
<dt>occupancy<span class="classifier">int</span></dt><dd><p>Occupancy of the states, i.e. 2 for RHF and 1 for UHF</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.SelfEnergy.real_freq_spectrum">
<span class="sig-name descname"><span class="pre">real_freq_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#SelfEnergy.real_freq_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.SelfEnergy.real_freq_spectrum" title="Link to this definition">#</a></dt>
<dd><p>See subclasses.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.combine">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">combine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">auxspcs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#combine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.combine" title="Link to this definition">#</a></dt>
<dd><p>Combine a set of <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace" title="pyscf.agf2.aux_space.AuxiliarySpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a> objects. attr:<cite>chempot</cite>
is inherited from the first element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.compress_via_gf">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">compress_via_gf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#compress_via_gf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.compress_via_gf" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Compress the auxiliaries of the separate occupied and</dt><dd><p>virtual parts of the self-energy according to consistency
in the moments of the Green’s function</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>n<span class="classifier">int</span></dt><dd><p>Truncation parameter, conserves the separate particle
and hole moments to order 2*n+1.</p>
</dd>
<dt>tol<span class="classifier">float</span></dt><dd><p>Linear dependency tolerance. Default value is 1e-12</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.SelfEnergy" title="pyscf.agf2.aux_space.SelfEnergy"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></a> with reduced auxiliary dimension</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.compress_via_se">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">compress_via_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#compress_via_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.compress_via_se" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Compress the auxiliaries of the separate occupied and</dt><dd><p>virtual parts of the self-energy according to consistency
in its moments.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>n<span class="classifier">int</span></dt><dd><p>Truncation parameter, conserves the separate particle
and hole moments to order 2*n+1.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#pyscf.agf2.aux_space.SelfEnergy" title="pyscf.agf2.aux_space.SelfEnergy"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></a> with reduced auxiliary dimension</p>
</dd>
<dt>Ref:</dt><dd><dl class="simple">
<dt>[1] H. Muther, T. Taigel and T.T.S. Kuo, Nucl. Phys., 482,</dt><dd><p>1988, pp. 601-616.</p>
</dd>
<dt>[2] D. Van Neck,  K. Piers and M. Waroquier, J. Chem. Phys.,</dt><dd><p>115, 2001, pp. 15-25.</p>
</dd>
<dt>[3] H. Muther and L.D. Skouras, Nucl. Phys., 55, 1993,</dt><dd><p>pp. 541-562.</p>
</dd>
<dt>[4] Y. Dewulf, D. Van Neck, L. Van Daele and M. Waroquier,</dt><dd><p>Phys. Lett. B, 396, 1997, pp. 7-14.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.aux_space.davidson">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.aux_space.</span></span><span class="sig-name descname"><span class="pre">davidson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxspc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chempot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntrial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/aux_space.html#davidson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.aux_space.davidson" title="Link to this definition">#</a></dt>
<dd><dl>
<dt>Diagonalise the result of <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_array" title="pyscf.agf2.aux_space.AuxiliarySpace.get_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">AuxiliarySpace.get_array()</span></code></a> using</dt><dd><p>the sparse <a class="reference internal" href="#pyscf.agf2.aux_space.AuxiliarySpace.dot" title="pyscf.agf2.aux_space.AuxiliarySpace.dot"><code class="xref py py-func docutils literal notranslate"><span class="pre">AuxiliarySpace.dot()</span></code></a> method, with the Davidson
algorithm.</p>
<p>This algorithm may perform poorly for IPs or EAs if they are
not extremal eigenvalues, which they are not in standard AGF2.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>auxspc<span class="classifier">AuxiliarySpace or subclass</span></dt><dd><p>Auxiliary space object to solve for</p>
</dd>
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>chempot<span class="classifier">float</span></dt><dd><p>If provided, use instead of <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.chempot</span></code></p>
</dd>
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of roots to solve for. Default 1.</p>
</dd>
<dt>which<span class="classifier">str</span></dt><dd><dl class="simple">
<dt>Which eigenvalues to solve for. Options are:</dt><dd><p><cite>LM</cite> : Largest (in magnitude) eigenvalues.
<cite>SM</cite> : Smallest (in magnitude) eigenvalues.
<cite>LA</cite> : Largest (algebraic) eigenvalues.
<cite>SA</cite> : Smallest (algebraic) eigenvalues.</p>
</dd>
</dl>
<p>Default ‘SM’.</p>
</dd>
<dt>tol<span class="classifier">float</span></dt><dd><p>Convergence threshold</p>
</dd>
<dt>maxiter<span class="classifier">int</span></dt><dd><p>Maximum number of iterations. Default 10*dim</p>
</dd>
<dt>ntrial<span class="classifier">int</span></dt><dd><p>Maximum number of trial vectors. Default
min(dim, max(2*nroots+1, 20))</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays (eigenvalues, eigenvectors)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.agf2.chempot">
<span id="pyscf-agf2-chempot-module"></span><h2>pyscf.agf2.chempot module<a class="headerlink" href="#module-pyscf.agf2.chempot" title="Link to this heading">#</a></h2>
<p>Functions for tuning the chemical potential.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chempot.binsearch_chempot">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chempot.</span></span><span class="sig-name descname"><span class="pre">binsearch_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chempot.html#binsearch_chempot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chempot.binsearch_chempot" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Finds a chemical potential which best agrees with the number</dt><dd><p>of physical electrons and abides by the Aufbau principal via
a binary search.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>fock<span class="classifier">2D array or tuple of arrays</span></dt><dd><p>Fock matrix to diagonalise, may be the physical Fock matrix
or extended Fock matrix. Can also be the output of
<code class="xref py py-func docutils literal notranslate"><span class="pre">np.linalg.eigh()</span></code> for this matrix, i.e. a tuple of the
eigenvalues and eigenvectors.</p>
</dd>
<dt>nphys<span class="classifier">int</span></dt><dd><p>Number of physical degrees of freedom</p>
</dd>
<dt>nelec<span class="classifier">int</span></dt><dd><p>Number of physical electrons</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>occupancy<span class="classifier">int</span></dt><dd><p>Occupancy of the states, i.e. 2 for RHF and 1 for UHF.
Default 2.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>chemical potential, and the error in the number of electrons</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chempot.minimize_chempot">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chempot.</span></span><span class="sig-name descname"><span class="pre">minimize_chempot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fock</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chempot.html#minimize_chempot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chempot.minimize_chempot" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Finds a set of auxiliary energies and chemical potential on</dt><dd><p>the physical space which best satisfy the number of electrons.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">AuxiliarySpace</span></dt><dd><p>Auxiliary space</p>
</dd>
<dt>fock<span class="classifier">2D array</span></dt><dd><dl class="simple">
<dt>phys<span class="classifier">2D array</span></dt><dd><p>Physical space (1p + 1h), typically the Fock matrix</p>
</dd>
</dl>
</dd>
<dt>nelec<span class="classifier">int</span></dt><dd><p>Number of physical electrons</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>occupancy<span class="classifier">int</span></dt><dd><p>Occupancy of the states, i.e. 2 for RHF and 1 for UHF.
Default 2.</p>
</dd>
<dt>x0<span class="classifier">float</span></dt><dd><p>Initial guess for <code class="xref py py-attr docutils literal notranslate"><span class="pre">chempot</span></code>. Default 0.0</p>
</dd>
<dt>tol<span class="classifier">float</span></dt><dd><p>Convergence threshold (units are the same as <code class="xref py py-attr docutils literal notranslate"><span class="pre">nelec</span></code>).
Default 1e-6.</p>
</dd>
<dt>maxiter<span class="classifier">int</span></dt><dd><p>Maximum number of iterations. Default 200.</p>
</dd>
<dt>jac<span class="classifier">bool</span></dt><dd><p>If True, use gradient. Default True.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>AuxiliarySpace object with altered <code class="xref py py-attr docutils literal notranslate"><span class="pre">energy</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">chempot</span></code>, and the SciPy <code class="xref py py-attr docutils literal notranslate"><span class="pre">OptimizeResult</span></code> object.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.agf2.chkfile">
<span id="pyscf-agf2-chkfile-module"></span><h2>pyscf.agf2.chkfile module<a class="headerlink" href="#module-pyscf.agf2.chkfile" title="Link to this heading">#</a></h2>
<p>Functions to support chkfiles with MPI</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chkfile.dump_agf2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chkfile.</span></span><span class="sig-name descname"><span class="pre">dump_agf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agf2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chkfile.html#dump_agf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chkfile.dump_agf2" title="Link to this definition">#</a></dt>
<dd><p>Save the AGF2 calculation to a chkfile.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chkfile.load">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chkfile.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chkfile.html#load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chkfile.load" title="Link to this definition">#</a></dt>
<dd><p>Load array(s) from chkfile.</p>
<p>See pyscf.lib.chkfile</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chkfile.load_agf2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chkfile.</span></span><span class="sig-name descname"><span class="pre">load_agf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chkfile.html#load_agf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chkfile.load_agf2" title="Link to this definition">#</a></dt>
<dd><p>Load the AGF2 data from the chkfile.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.chkfile.load_mol">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.chkfile.</span></span><span class="sig-name descname"><span class="pre">load_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/chkfile.html#load_mol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.chkfile.load_mol" title="Link to this definition">#</a></dt>
<dd><p>Load the mol from the chkfile.</p>
<p>See pyscf.lib.chkfile</p>
</dd></dl>

</section>
<section id="module-pyscf.agf2.dfragf2">
<span id="pyscf-agf2-dfragf2-module"></span><h2>pyscf.agf2.dfragf2 module<a class="headerlink" href="#module-pyscf.agf2.dfragf2" title="Link to this heading">#</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory
with density fitting</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfragf2.</span></span><span class="sig-name descname"><span class="pre">DF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#DF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.DF" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.df.html#pyscf.df.df.DF" title="pyscf.df.df.DF"><code class="xref py py-class docutils literal notranslate"><span class="pre">DF</span></code></a></p>
<p>Replaces the <a class="reference internal" href="#pyscf.agf2.dfragf2.DF.prange" title="pyscf.agf2.dfragf2.DF.prange"><code class="xref py py-class docutils literal notranslate"><span class="pre">DF.prange</span></code></a> function with one which
natively supports MPI, if used.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DF.prange">
<span class="sig-name descname"><span class="pre">prange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#DF.prange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.DF.prange" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfragf2.</span></span><span class="sig-name descname"><span class="pre">DFRAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#DFRAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.ragf2.RAGF2" title="pyscf.agf2.ragf2.RAGF2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RAGF2</span></code></a></p>
<p>Restricted AGF2 with canonical HF reference with density fitting</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>allow_lowmem_build<span class="classifier">bool or str</span></dt><dd><p>Allow the self-energy build to switch to a serially slower
code with lower thread-private memory overhead if needed. One
of True, False or ‘force’. Default value is True.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#DFRAGF2.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2.ao2mo" title="Link to this definition">#</a></dt>
<dd><p>Get the density-fitted electronic repulsion integrals in
MO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2.get_jk">
<span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2.get_jk" title="Link to this definition">#</a></dt>
<dd><p>Get the J/K matrices.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">ndarray or H5 dataset</span></dt><dd><p>Electronic repulsion integrals (NOT as _ChemistsERIs). In
the case of no bra/ket symmetry, a tuple can be passed.</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>with_j<span class="classifier">bool</span></dt><dd><p>Whether to compute J. Default value is True</p>
</dd>
<dt>with_k<span class="classifier">bool</span></dt><dd><p>Whether to compute K. Default value is True</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays corresponding to J and K, if either are
not requested then they are set to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#DFRAGF2.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2.reset" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.DFRAGF2.with_df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">with_df</span></span><a class="headerlink" href="#pyscf.agf2.dfragf2.DFRAGF2.with_df" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfragf2.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.dfragf2.get_jk">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfragf2.</span></span><span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfragf2.html#get_jk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfragf2.get_jk" title="Link to this definition">#</a></dt>
<dd><p>Get the J/K matrices.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">ndarray or H5 dataset</span></dt><dd><p>Electronic repulsion integrals (NOT as _ChemistsERIs). In
the case of no bra/ket symmetry, a tuple can be passed.</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>with_j<span class="classifier">bool</span></dt><dd><p>Whether to compute J. Default value is True</p>
</dd>
<dt>with_k<span class="classifier">bool</span></dt><dd><p>Whether to compute K. Default value is True</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays corresponding to J and K, if either are
not requested then they are set to None.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.agf2.dfuagf2">
<span id="pyscf-agf2-dfuagf2-module"></span><h2>pyscf.agf2.dfuagf2 module<a class="headerlink" href="#module-pyscf.agf2.dfuagf2" title="Link to this heading">#</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory for
unrestricted references with density fitting</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfuagf2.</span></span><span class="sig-name descname"><span class="pre">DFUAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfuagf2.html#DFUAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.uagf2.UAGF2" title="pyscf.agf2.uagf2.UAGF2"><code class="xref py py-class docutils literal notranslate"><span class="pre">UAGF2</span></code></a></p>
<p>Unrestricted AGF2 with canonical HF reference with density fitting</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>allow_lowmem_build<span class="classifier">bool</span></dt><dd><p>Allow the self-energy build to switch to a serially slower
code with lower thread-private memory overhead if needed. One
of True, False or ‘force’. Default value is True.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfuagf2.html#DFUAGF2.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2.ao2mo" title="Link to this definition">#</a></dt>
<dd><p>Get the density-fitted electronic repulsion integrals in
MO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2.get_jk">
<span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2.get_jk" title="Link to this definition">#</a></dt>
<dd><p>Get the J/K matrices.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">ndarray or H5 dataset</span></dt><dd><p>Electronic repulsion integrals (NOT as _ChemistsERIs). In
the case of no bra/ket symmetry, a tuple can be passed.</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>with_j<span class="classifier">bool</span></dt><dd><p>Whether to compute J. Default value is True</p>
</dd>
<dt>with_k<span class="classifier">bool</span></dt><dd><p>Whether to compute K. Default value is True</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays corresponding to J and K, if either are
not requested then they are set to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfuagf2.html#DFUAGF2.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2.reset" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.DFUAGF2.with_df">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">with_df</span></span><a class="headerlink" href="#pyscf.agf2.dfuagf2.DFUAGF2.with_df" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.dfuagf2.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.dfuagf2.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/dfuagf2.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.dfuagf2.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.agf2.mpi_helper">
<span id="pyscf-agf2-mpi-helper-module"></span><h2>pyscf.agf2.mpi_helper module<a class="headerlink" href="#module-pyscf.agf2.mpi_helper" title="Link to this heading">#</a></h2>
<p>MPI helper functions using mpi4py</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.allreduce">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">allreduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sendbuf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#allreduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.allreduce" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.allreduce_safe_inplace">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">allreduce_safe_inplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#allreduce_safe_inplace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.allreduce_safe_inplace" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.barrier">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">barrier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#barrier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.barrier" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.bcast">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">bcast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#bcast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.bcast" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.bcast_dict">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">bcast_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#bcast_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.bcast_dict" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.nrange">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">nrange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#nrange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.nrange" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.prange">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">prange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#prange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.prange" title="Link to this definition">#</a></dt>
<dd><p><code class="xref py py-func docutils literal notranslate"><span class="pre">lib.prange()</span></code> distributed over MPI processes. Returns
the range for a single MPI rank.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.mpi_helper.reduce">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.mpi_helper.</span></span><span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sendbuf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/mpi_helper.html#reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.mpi_helper.reduce" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.agf2.ragf2">
<span id="pyscf-agf2-ragf2-module"></span><h2>pyscf.agf2.ragf2 module<a class="headerlink" href="#module-pyscf.agf2.ragf2" title="Link to this heading">#</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">RAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamObject</span></code></a></p>
<p>Restricted AGF2 with canonical HF reference</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <a class="reference internal" href="#pyscf.agf2.ragf2.RAGF2.e_tot" title="pyscf.agf2.ragf2.RAGF2.e_tot"><code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></a></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <a class="reference internal" href="#pyscf.agf2.ragf2.RAGF2.e_tot" title="pyscf.agf2.ragf2.RAGF2.e_tot"><code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></a></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.ao2mo" title="Link to this definition">#</a></dt>
<dd><p>Get the electronic repulsion integrals in MO basis.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.async_io">
<span class="sig-name descname"><span class="pre">async_io</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.async_io" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.build_gf">
<span class="sig-name descname"><span class="pre">build_gf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.build_gf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.build_gf" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds the auxiliaries of the Green’s function by solving</dt><dd><p>the Dyson equation.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.build_se">
<span class="sig-name descname"><span class="pre">build_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.build_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.build_se" title="Link to this definition">#</a></dt>
<dd><p>Builds the auxiliaries of the self-energy.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>se_prev<span class="classifier">SelfEnergy</span></dt><dd><p>Previous self-energy for damping. Default value is None</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.density_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.density_fit" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.dump_chk">
<span class="sig-name descname"><span class="pre">dump_chk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agf2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.dump_chk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.dump_chk" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.e_corr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_corr</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.e_corr" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.e_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_tot</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.e_tot" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.eaagf2">
<span class="sig-name descname"><span class="pre">eaagf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.eaagf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.eaagf2" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Find the (N+1)-electron charged excitations, corresponding</dt><dd><p>to the smallest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> poles of the virtual
Green’s function.</p>
</dd>
<dt>Kwargs:</dt><dd><p>See ipagf2()</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.energy_1body">
<span class="sig-name descname"><span class="pre">energy_1body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.energy_1body" title="Link to this definition">#</a></dt>
<dd><p>Calculates the one-body energy according to the RHF form.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of Green’s function</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>One-body energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.energy_2body">
<span class="sig-name descname"><span class="pre">energy_2body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.energy_2body" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula. The formula is symmetric and only
one side needs to be calculated.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>Two-body energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.energy_mp2">
<span class="sig-name descname"><span class="pre">energy_mp2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.energy_mp2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.energy_mp2" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.energy_nuc">
<span class="sig-name descname"><span class="pre">energy_nuc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.energy_nuc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.energy_nuc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.fock_loop">
<span class="sig-name descname"><span class="pre">fock_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.fock_loop" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Self-consistent loop for the density matrix via the HF self-</dt><dd><p>consistent field.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code> and a boolean
indicating whether convergence was successful.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.get_ea">
<span class="sig-name descname"><span class="pre">get_ea</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.get_ea"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.get_ea" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.get_fock" title="Link to this definition">#</a></dt>
<dd><p>Computes the physical space Fock matrix in MO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.get_ip">
<span class="sig-name descname"><span class="pre">get_ip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.get_ip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.get_ip" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.get_jk">
<span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.get_jk" title="Link to this definition">#</a></dt>
<dd><p>Get the J/K matrices.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">ndarray or H5 dataset</span></dt><dd><p>Electronic repulsion integrals (NOT as _ChemistsERIs)</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>with_j<span class="classifier">bool</span></dt><dd><p>Whether to compute J. Default value is True</p>
</dd>
<dt>with_k<span class="classifier">bool</span></dt><dd><p>Whether to compute K. Default value is True</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays corresponding to J and K, if either are
not requested then they are set to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.incore_complete">
<span class="sig-name descname"><span class="pre">incore_complete</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.incore_complete" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.init_gf">
<span class="sig-name descname"><span class="pre">init_gf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.init_gf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.init_gf" title="Link to this definition">#</a></dt>
<dd><p>Builds the Hartree-Fock Green’s function.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.ipagf2">
<span class="sig-name descname"><span class="pre">ipagf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.ipagf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.ipagf2" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Find the (N-1)-electron charged excitations, corresponding</dt><dd><p>to the largest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> poles of the occupied
Green’s function.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of roots (poles) requested. Default 1.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>IP and transition moment (float, 1D array) if <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code>
= 1, or array of IPs and moments (1D array, 2D array) if
<code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> &gt; 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.kernel" title="Link to this definition">#</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.make_rdm1" title="Link to this definition">#</a></dt>
<dd><p>Computes the one-body reduced density matrix in MO basis.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray of density matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.nmo" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.nocc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.qmo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_coeff</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.qmo_coeff" title="Link to this definition">#</a></dt>
<dd><p>Gives the couplings in AO basis</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.qmo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_energy</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.qmo_energy" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.qmo_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_occ</span></span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.qmo_occ" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.reset" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.run_diis">
<span class="sig-name descname"><span class="pre">run_diis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.run_diis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.run_diis" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Runs the direct inversion of the iterative subspace for the</dt><dd><p>self-energy.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>diis<span class="classifier">lib.diis.DIIS</span></dt><dd><p>DIIS object</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agf2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.update" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.update_from_chk">
<span class="sig-name descname"><span class="pre">update_from_chk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agf2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.update_from_chk" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.RAGF2.update_from_chk_">
<span class="sig-name descname"><span class="pre">update_from_chk_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agf2'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#RAGF2.update_from_chk_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.RAGF2.update_from_chk_" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.energy_1body">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">energy_1body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#energy_1body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.energy_1body" title="Link to this definition">#</a></dt>
<dd><p>Calculates the one-body energy according to the RHF form.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of Green’s function</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>One-body energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.energy_2body">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">energy_2body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#energy_2body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.energy_2body" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula. The formula is symmetric and only
one side needs to be calculated.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>Two-body energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.energy_mp2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">energy_mp2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#energy_mp2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.energy_mp2" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula for an MP2 self-energy. Per the
definition of one- and two-body partitioning in the Dyson
equation, this result is half of <a class="reference internal" href="#pyscf.agf2.ragf2.energy_2body" title="pyscf.agf2.ragf2.energy_2body"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy_2body()</span></code></a>.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>MP2 energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.fock_loop">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">fock_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#fock_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.fock_loop" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Self-consistent loop for the density matrix via the HF self-</dt><dd><p>consistent field.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code> and a boolean
indicating whether convergence was successful.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.get_fock">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.get_fock" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Computes the physical space Fock matrix in MO basis. If <code class="xref py py-attr docutils literal notranslate"><span class="pre">rdm1</span></code></dt><dd><p>is not supplied, it is built from <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf</span></code>, which defaults to
the mean-field Green’s function.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">Greensfunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray of physical space Fock matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.get_frozen_mask">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">get_frozen_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#get_frozen_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.get_frozen_mask" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.get_jk">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#get_jk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.get_jk" title="Link to this definition">#</a></dt>
<dd><p>Get the J/K matrices.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">ndarray or H5 dataset</span></dt><dd><p>Electronic repulsion integrals (NOT as _ChemistsERIs)</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>with_j<span class="classifier">bool</span></dt><dd><p>Whether to compute J. Default value is True</p>
</dd>
<dt>with_k<span class="classifier">bool</span></dt><dd><p>Whether to compute K. Default value is True</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarrays corresponding to J and K, if either are
not requested then they are set to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2.kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2.kernel" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.agf2.ragf2_slow">
<span id="pyscf-agf2-ragf2-slow-module"></span><h2>pyscf.agf2.ragf2_slow module<a class="headerlink" href="#module-pyscf.agf2.ragf2_slow" title="Link to this heading">#</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory for
arbitrary moment consistency</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.RAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2_slow.</span></span><span class="sig-name descname"><span class="pre">RAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2_slow.html#RAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2_slow.RAGF2" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.ragf2.RAGF2" title="pyscf.agf2.ragf2.RAGF2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RAGF2</span></code></a></p>
<dl class="simple">
<dt>Restricted AGF2 with canonical HF reference for arbitrary</dt><dd><p>moment consistency</p>
</dd>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>nmom<span class="classifier">tuple of int</span></dt><dd><p>Compression level of the Green’s function and
self-energy, respectively</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.RAGF2.build_se">
<span class="sig-name descname"><span class="pre">build_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2_slow.html#RAGF2.build_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2_slow.RAGF2.build_se" title="Link to this definition">#</a></dt>
<dd><p>Builds the auxiliaries of the self-energy.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>se_prev<span class="classifier">SelfEnergy</span></dt><dd><p>Previous self-energy for damping. Default value is None</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.RAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.ragf2_slow.RAGF2.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.RAGF2.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2_slow.html#RAGF2.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2_slow.RAGF2.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.RAGF2.run_diis">
<span class="sig-name descname"><span class="pre">run_diis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2_slow.html#RAGF2.run_diis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2_slow.RAGF2.run_diis" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Runs the direct inversion of the iterative subspace for the</dt><dd><p>self-energy.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>diis<span class="classifier">lib.diis.DIIS</span></dt><dd><p>DIIS object</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.ragf2_slow.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.ragf2_slow.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/ragf2_slow.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.ragf2_slow.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">GreensFunction</span></dt><dd><p>Occupied Green’s function</p>
</dd>
<dt>gf_vir<span class="classifier">GreensFunction</span></dt><dd><p>Virtual Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.agf2.uagf2">
<span id="pyscf-agf2-uagf2-module"></span><h2>pyscf.agf2.uagf2 module<a class="headerlink" href="#module-pyscf.agf2.uagf2" title="Link to this heading">#</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory for
unrestricted references</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">UAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.ragf2.RAGF2" title="pyscf.agf2.ragf2.RAGF2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RAGF2</span></code></a></p>
<p>Unrestricted AGF2 with canonical HF reference</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.ao2mo">
<span class="sig-name descname"><span class="pre">ao2mo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.ao2mo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.ao2mo" title="Link to this definition">#</a></dt>
<dd><p>Get the electronic repulsion integrals in MO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.build_gf">
<span class="sig-name descname"><span class="pre">build_gf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.build_gf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.build_gf" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds the auxiliaries of the Green’s functions by solving</dt><dd><p>the Dyson equation for each spin.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.build_se">
<span class="sig-name descname"><span class="pre">build_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.build_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.build_se" title="Link to this definition">#</a></dt>
<dd><p>Builds the auxiliaries of the self-energy.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>se_prev<span class="classifier">SelfEnergy</span></dt><dd><p>Previous self-energy for damping. Default value is None</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p>tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped,
for a single spin.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Occupied Green’s function for each spin</p>
</dd>
<dt>gf_vir<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Virtual Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.density_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.density_fit" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.eaagf2">
<span class="sig-name descname"><span class="pre">eaagf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.eaagf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.eaagf2" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Find the (N+1)-electron charged excitations, corresponding</dt><dd><p>to the smallest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> poles of the virtual
Green’s function.</p>
</dd>
<dt>Kwargs:</dt><dd><p>See ipagf2()</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.energy_1body">
<span class="sig-name descname"><span class="pre">energy_1body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.energy_1body" title="Link to this definition">#</a></dt>
<dd><p>Calculates the one-body energy according to the UHF form.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>One-body energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.energy_2body">
<span class="sig-name descname"><span class="pre">energy_2body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.energy_2body" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula. The formula is symmetric and only
one side needs to be calculated.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Two-body energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.energy_mp2">
<span class="sig-name descname"><span class="pre">energy_mp2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.energy_mp2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.energy_mp2" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.fock_loop">
<span class="sig-name descname"><span class="pre">fock_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.fock_loop" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Self-consistent loop for the density matrix via the HF self-</dt><dd><p>consistent field.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code> and a boolean
indicating whether convergence was successful.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.get_ea">
<span class="sig-name descname"><span class="pre">get_ea</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.get_ea"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.get_ea" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.get_fock">
<span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.get_fock" title="Link to this definition">#</a></dt>
<dd><p>Computes the physical space Fock matrix in MO basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.get_ip">
<span class="sig-name descname"><span class="pre">get_ip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.get_ip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.get_ip" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.init_gf">
<span class="sig-name descname"><span class="pre">init_gf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.init_gf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.init_gf" title="Link to this definition">#</a></dt>
<dd><p>Builds the Hartree-Fock Green’s function.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code>, tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.ipagf2">
<span class="sig-name descname"><span class="pre">ipagf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nroots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.ipagf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.ipagf2" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Find the (N-1)-electron charged excitations, corresponding</dt><dd><p>to the largest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> poles of the occupied
Green’s function.</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of roots (poles) requested. Default 1.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>IP and transition moment (float, 1D array) if <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code>
= 1, or array of IPs and moments (1D array, 2D array) if
<code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> &gt; 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.make_rdm1">
<span class="sig-name descname"><span class="pre">make_rdm1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.make_rdm1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.make_rdm1" title="Link to this definition">#</a></dt>
<dd><p>Compute the one-body reduced density matrix in MO basis.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s functions for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of ndarray of density matrices</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.nmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmo</span></span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.nmo" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.nocc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nocc</span></span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.nocc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.qmo_coeff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_coeff</span></span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.qmo_coeff" title="Link to this definition">#</a></dt>
<dd><p>Gives the couplings in AO basis</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.qmo_energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_energy</span></span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.qmo_energy" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.qmo_occ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qmo_occ</span></span><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.qmo_occ" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.UAGF2.run_diis">
<span class="sig-name descname"><span class="pre">run_diis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#UAGF2.run_diis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.UAGF2.run_diis" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Runs the direct inversion of the iterative subspace for the</dt><dd><p>self-energy.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>diis<span class="classifier">lib.diis.DIIS</span></dt><dd><p>DIIS object</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped,
for a single spin.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Occupied Green’s function for each spin</p>
</dd>
<dt>gf_vir<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Virtual Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.energy_1body">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">energy_1body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#energy_1body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.energy_1body" title="Link to this definition">#</a></dt>
<dd><p>Calculates the one-body energy according to the UHF form.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>One-body energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.energy_2body">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">energy_2body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#energy_2body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.energy_2body" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula. The formula is symmetric and only
one side needs to be calculated.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Two-body energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.energy_mp2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">energy_mp2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#energy_mp2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.energy_mp2" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Calculates the two-body energy using analytically integrated</dt><dd><p>Galitskii-Migdal formula for an MP2 self-energy. Per the
definition of one- and two-body partitioning in the Dyson
equation, this result is half of <a class="reference internal" href="#pyscf.agf2.uagf2.energy_2body" title="pyscf.agf2.uagf2.energy_2body"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy_2body()</span></code></a>.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>MP2 energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.fock_loop">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">fock_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#fock_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.fock_loop" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Self-consistent loop for the density matrix via the HF self-</dt><dd><p>consistent field.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">GreensFunction</span></code> and a boolean
indicating whether convergence was successful.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.get_fock">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">get_fock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#get_fock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.get_fock" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Computes the physical space Fock matrix in MO basis. If <code class="xref py py-attr docutils literal notranslate"><span class="pre">rdm1</span></code></dt><dd><p>is not supplied, it is built from <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf</span></code>, which defaults to
the mean-field Green’s function.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
<dt>rdm1<span class="classifier">2D array</span></dt><dd><p>Reduced density matrix</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>ndarray of physical space Fock matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2.get_frozen_mask">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2.</span></span><span class="sig-name descname"><span class="pre">get_frozen_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2.html#get_frozen_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2.get_frozen_mask" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.agf2.uagf2_slow">
<span id="pyscf-agf2-uagf2-slow-module"></span><h2>pyscf.agf2.uagf2_slow module<a class="headerlink" href="#module-pyscf.agf2.uagf2_slow" title="Link to this heading">#</a></h2>
<p>Auxiliary second-order Green’s function perturbation theory for
unrestricted references for arbitrary moment consistency</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.UAGF2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2_slow.</span></span><span class="sig-name descname"><span class="pre">UAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2_slow.html#UAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2_slow.UAGF2" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.agf2.uagf2.UAGF2" title="pyscf.agf2.uagf2.UAGF2"><code class="xref py py-class docutils literal notranslate"><span class="pre">UAGF2</span></code></a></p>
<dl class="simple">
<dt>Unrestricted AGF2 with canonical HF reference for arbitrary</dt><dd><p>moment consistency</p>
</dd>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>nmom<span class="classifier">tuple of int</span></dt><dd><p>Compression level of the Green’s function and
self-energy, respectively</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.UAGF2.build_se">
<span class="sig-name descname"><span class="pre">build_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2_slow.html#UAGF2.build_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2_slow.UAGF2.build_se" title="Link to this definition">#</a></dt>
<dd><p>Builds the auxiliaries of the self-energy.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>se_prev<span class="classifier">SelfEnergy</span></dt><dd><p>Previous self-energy for damping. Default value is None</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.UAGF2.build_se_part">
<span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.agf2.uagf2_slow.UAGF2.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped,
for a single spin.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Occupied Green’s function for each spin</p>
</dd>
<dt>gf_vir<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Virtual Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.UAGF2.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2_slow.html#UAGF2.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2_slow.UAGF2.dump_flags" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.UAGF2.run_diis">
<span class="sig-name descname"><span class="pre">run_diis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2_slow.html#UAGF2.run_diis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2_slow.UAGF2.run_diis" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Runs the direct inversion of the iterative subspace for the</dt><dd><p>self-energy.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>diis<span class="classifier">lib.diis.DIIS</span></dt><dd><p>DIIS object</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.uagf2_slow.build_se_part">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.uagf2_slow.</span></span><span class="sig-name descname"><span class="pre">build_se_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_vir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">os_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2/uagf2_slow.html#build_se_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.uagf2_slow.build_se_part" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Builds either the auxiliaries of the occupied self-energy,</dt><dd><p>or virtual if <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_occ</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">gf_vir</span></code> are swapped,
for a single spin.</p>
</dd>
<dt>Args:</dt><dd><dl class="simple">
<dt>eri<span class="classifier">_ChemistsERIs</span></dt><dd><p>Electronic repulsion integrals</p>
</dd>
<dt>gf_occ<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Occupied Green’s function for each spin</p>
</dd>
<dt>gf_vir<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Virtual Green’s function for each spin</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.agf2">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyscf.agf2" title="Link to this heading">#</a></h2>
<section id="auxiliary-second-order-green-s-function-perturbation-theory">
<h3>Auxiliary second-order Green’s function perturbation theory<a class="headerlink" href="#auxiliary-second-order-green-s-function-perturbation-theory" title="Link to this heading">#</a></h3>
<p>The AGF2 method permits the computation of quasiparticle excitations and 
ground-state properties at the AGF2(None,0) level.</p>
<p>When using results of this code for publications, please cite the follow papers:
“Wave function perspective and efficient truncation of renormalized second-order perturbation theory”, O. J. Backhouse, M. Nusspickel and G. H. Booth, J. Chem. Theory Comput., 16, 1090 (2020).
“Efficient excitations and spectra within a perturbative renormalization approach”, O. J. Backhouse and G. H. Booth, J. Chem. Theory Comput., 16, 6294 (2020).</p>
<p>Simple usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">agf2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gf2</span> <span class="o">=</span> <span class="n">agf2</span><span class="o">.</span><span class="n">AGF2</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gf2</span><span class="o">.</span><span class="n">ipagf2</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">agf2.AGF2()</span></code> returns an instance of AGF2 class.  Valid parameters to
control the AGF2 method are:</p>
<blockquote>
<div><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-6.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default 
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default 
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>diis_min_space<span class="classifier"></span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
</dl>
</div></blockquote>
<p>Saved result</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.AGF2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.</span></span><span class="sig-name descname"><span class="pre">AGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2.html#AGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.AGF2" title="Link to this definition">#</a></dt>
<dd><p>Restricted AGF2 with canonical HF reference</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.RAGF2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.</span></span><span class="sig-name descname"><span class="pre">RAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2.html#RAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.RAGF2" title="Link to this definition">#</a></dt>
<dd><p>Restricted AGF2 with canonical HF reference</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy</p>
</dd>
<dt>gf<span class="classifier">GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.agf2.UAGF2">
<span class="sig-prename descclassname"><span class="pre">pyscf.agf2.</span></span><span class="sig-name descname"><span class="pre">UAGF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/agf2.html#UAGF2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.agf2.UAGF2" title="Link to this definition">#</a></dt>
<dd><p>Unrestricted AGF2 with canonical HF reference</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>verbose<span class="classifier">int</span></dt><dd><p>Print level. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.verbose</span></code></p>
</dd>
<dt>max_memory<span class="classifier">float or int</span></dt><dd><p>Allowed memory in MB. Default value equals to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole.max_memory</span></code></p>
</dd>
<dt>incore_complete<span class="classifier">bool</span></dt><dd><p>Avoid all I/O. Default is False.</p>
</dd>
<dt>conv_tol<span class="classifier">float</span></dt><dd><p>Convergence threshold for AGF2 energy. Default value is 1e-7</p>
</dd>
<dt>conv_tol_rdm1<span class="classifier">float</span></dt><dd><p>Convergence threshold for first-order reduced density matrix.
Default value is 1e-8.</p>
</dd>
<dt>conv_tol_nelec<span class="classifier">float</span></dt><dd><p>Convergence threshold for the number of electrons. Default
value is 1e-6.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>Maximum number of AGF2 iterations. Default value is 50.</p>
</dd>
<dt>max_cycle_outer<span class="classifier">int</span></dt><dd><p>Maximum number of outer Fock loop iterations. Default
value is 20.</p>
</dd>
<dt>max_cycle_inner<span class="classifier">int</span></dt><dd><p>Maximum number of inner Fock loop iterations. Default
value is 50.</p>
</dd>
<dt>weight_tol<span class="classifier">float</span></dt><dd><p>Threshold in spectral weight of auxiliaries to be considered
zero. Default 1e-11.</p>
</dd>
<dt>diis<span class="classifier">bool or lib.diis.DIIS</span></dt><dd><p>Whether to use DIIS, can also be a lib.diis.DIIS object. Default
value is True.</p>
</dd>
<dt>diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size. Default value is 8.</p>
</dd>
<dt>diis_min_space<span class="classifier">int</span></dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>fock_diis_space<span class="classifier">int</span></dt><dd><p>DIIS space size for Fock loop iterations. Default value is 6.</p>
</dd>
<dt>fock_diis_min_space :</dt><dd><p>Minimum space of DIIS. Default value is 1.</p>
</dd>
<dt>os_factor<span class="classifier">float</span></dt><dd><p>Opposite-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>ss_factor<span class="classifier">float</span></dt><dd><p>Same-spin factor for spin-component-scaled (SCS)
calculations. Default 1.0</p>
</dd>
<dt>damping<span class="classifier">float</span></dt><dd><p>Damping factor for the self-energy. Default value is 0.0</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="simple">
<dt>e_corr<span class="classifier">float</span></dt><dd><p>AGF2 correlation energy</p>
</dd>
<dt>e_tot<span class="classifier">float</span></dt><dd><p>Total energy (HF + correlation)</p>
</dd>
<dt>e_1b<span class="classifier">float</span></dt><dd><p>One-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_2b<span class="classifier">float</span></dt><dd><p>Two-body part of <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_tot</span></code></p>
</dd>
<dt>e_init<span class="classifier">float</span></dt><dd><p>Initial correlation energy (truncated MP2)</p>
</dd>
<dt>converged<span class="classifier">bool</span></dt><dd><p>Whether convergence was successful</p>
</dd>
<dt>se<span class="classifier">tuple of SelfEnergy</span></dt><dd><p>Auxiliaries of the self-energy for each spin</p>
</dd>
<dt>gf<span class="classifier">tuple of GreensFunction</span></dt><dd><p>Auxiliaries of the Green’s function for each spin</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.agf2.aux_space">pyscf.agf2.aux_space module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.compress"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.compress()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.copy"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.copy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.dot"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.dot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.eig"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.eig()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_array"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.get_array()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_occupied"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.get_occupied()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.get_virtual"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.get_virtual()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.load"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.load()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.moment"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.moment()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.naux"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.naux</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.nphys"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.nphys</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.real_freq_spectrum"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.real_freq_spectrum()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.remove_uncoupled"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.remove_uncoupled()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.save"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.save()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.AuxiliarySpace.sort"><code class="docutils literal notranslate"><span class="pre">AuxiliarySpace.sort()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.GreensFunction"><code class="docutils literal notranslate"><span class="pre">GreensFunction</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.GreensFunction.compress"><code class="docutils literal notranslate"><span class="pre">GreensFunction.compress()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.GreensFunction.make_rdm1"><code class="docutils literal notranslate"><span class="pre">GreensFunction.make_rdm1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.GreensFunction.real_freq_spectrum"><code class="docutils literal notranslate"><span class="pre">GreensFunction.real_freq_spectrum()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.SelfEnergy"><code class="docutils literal notranslate"><span class="pre">SelfEnergy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.SelfEnergy.compress"><code class="docutils literal notranslate"><span class="pre">SelfEnergy.compress()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.SelfEnergy.get_greens_function"><code class="docutils literal notranslate"><span class="pre">SelfEnergy.get_greens_function()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.SelfEnergy.make_rdm1"><code class="docutils literal notranslate"><span class="pre">SelfEnergy.make_rdm1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.SelfEnergy.real_freq_spectrum"><code class="docutils literal notranslate"><span class="pre">SelfEnergy.real_freq_spectrum()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.combine"><code class="docutils literal notranslate"><span class="pre">combine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.compress_via_gf"><code class="docutils literal notranslate"><span class="pre">compress_via_gf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.compress_via_se"><code class="docutils literal notranslate"><span class="pre">compress_via_se()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.aux_space.davidson"><code class="docutils literal notranslate"><span class="pre">davidson()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.agf2.chempot">pyscf.agf2.chempot module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.chempot.binsearch_chempot"><code class="docutils literal notranslate"><span class="pre">binsearch_chempot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.chempot.minimize_chempot"><code class="docutils literal notranslate"><span class="pre">minimize_chempot()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.agf2.chkfile">pyscf.agf2.chkfile module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.chkfile.dump_agf2"><code class="docutils literal notranslate"><span class="pre">dump_agf2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.chkfile.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.chkfile.load_agf2"><code class="docutils literal notranslate"><span class="pre">load_agf2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.chkfile.load_mol"><code class="docutils literal notranslate"><span class="pre">load_mol()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.agf2.dfragf2">pyscf.agf2.dfragf2 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfragf2.DF"><code class="docutils literal notranslate"><span class="pre">DF</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfragf2.DF.prange"><code class="docutils literal notranslate"><span class="pre">DF.prange()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfragf2.DFRAGF2"><code class="docutils literal notranslate"><span class="pre">DFRAGF2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfragf2.DFRAGF2.ao2mo"><code class="docutils literal notranslate"><span class="pre">DFRAGF2.ao2mo()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfragf2.DFRAGF2.build_se_part"><code class="docutils literal notranslate"><span class="pre">DFRAGF2.build_se_part()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfragf2.DFRAGF2.get_jk"><code class="docutils literal notranslate"><span class="pre">DFRAGF2.get_jk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfragf2.DFRAGF2.reset"><code class="docutils literal notranslate"><span class="pre">DFRAGF2.reset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfragf2.DFRAGF2.with_df"><code class="docutils literal notranslate"><span class="pre">DFRAGF2.with_df</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfragf2.build_se_part"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfragf2.get_jk"><code class="docutils literal notranslate"><span class="pre">get_jk()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.agf2.dfuagf2">pyscf.agf2.dfuagf2 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfuagf2.DFUAGF2"><code class="docutils literal notranslate"><span class="pre">DFUAGF2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfuagf2.DFUAGF2.ao2mo"><code class="docutils literal notranslate"><span class="pre">DFUAGF2.ao2mo()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfuagf2.DFUAGF2.build_se_part"><code class="docutils literal notranslate"><span class="pre">DFUAGF2.build_se_part()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfuagf2.DFUAGF2.get_jk"><code class="docutils literal notranslate"><span class="pre">DFUAGF2.get_jk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfuagf2.DFUAGF2.reset"><code class="docutils literal notranslate"><span class="pre">DFUAGF2.reset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfuagf2.DFUAGF2.with_df"><code class="docutils literal notranslate"><span class="pre">DFUAGF2.with_df</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.dfuagf2.build_se_part"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.agf2.mpi_helper">pyscf.agf2.mpi_helper module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.mpi_helper.allreduce"><code class="docutils literal notranslate"><span class="pre">allreduce()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.mpi_helper.allreduce_safe_inplace"><code class="docutils literal notranslate"><span class="pre">allreduce_safe_inplace()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.mpi_helper.barrier"><code class="docutils literal notranslate"><span class="pre">barrier()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.mpi_helper.bcast"><code class="docutils literal notranslate"><span class="pre">bcast()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.mpi_helper.bcast_dict"><code class="docutils literal notranslate"><span class="pre">bcast_dict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.mpi_helper.nrange"><code class="docutils literal notranslate"><span class="pre">nrange()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.mpi_helper.prange"><code class="docutils literal notranslate"><span class="pre">prange()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.mpi_helper.reduce"><code class="docutils literal notranslate"><span class="pre">reduce()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.agf2.ragf2">pyscf.agf2.ragf2 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2"><code class="docutils literal notranslate"><span class="pre">RAGF2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.ao2mo"><code class="docutils literal notranslate"><span class="pre">RAGF2.ao2mo()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.async_io"><code class="docutils literal notranslate"><span class="pre">RAGF2.async_io</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.build_gf"><code class="docutils literal notranslate"><span class="pre">RAGF2.build_gf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.build_se"><code class="docutils literal notranslate"><span class="pre">RAGF2.build_se()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.build_se_part"><code class="docutils literal notranslate"><span class="pre">RAGF2.build_se_part()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.density_fit"><code class="docutils literal notranslate"><span class="pre">RAGF2.density_fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.dump_chk"><code class="docutils literal notranslate"><span class="pre">RAGF2.dump_chk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.dump_flags"><code class="docutils literal notranslate"><span class="pre">RAGF2.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.e_corr"><code class="docutils literal notranslate"><span class="pre">RAGF2.e_corr</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.e_tot"><code class="docutils literal notranslate"><span class="pre">RAGF2.e_tot</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.eaagf2"><code class="docutils literal notranslate"><span class="pre">RAGF2.eaagf2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.energy_1body"><code class="docutils literal notranslate"><span class="pre">RAGF2.energy_1body()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.energy_2body"><code class="docutils literal notranslate"><span class="pre">RAGF2.energy_2body()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.energy_mp2"><code class="docutils literal notranslate"><span class="pre">RAGF2.energy_mp2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.energy_nuc"><code class="docutils literal notranslate"><span class="pre">RAGF2.energy_nuc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.fock_loop"><code class="docutils literal notranslate"><span class="pre">RAGF2.fock_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.get_ea"><code class="docutils literal notranslate"><span class="pre">RAGF2.get_ea()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.get_fock"><code class="docutils literal notranslate"><span class="pre">RAGF2.get_fock()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.get_ip"><code class="docutils literal notranslate"><span class="pre">RAGF2.get_ip()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.get_jk"><code class="docutils literal notranslate"><span class="pre">RAGF2.get_jk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.incore_complete"><code class="docutils literal notranslate"><span class="pre">RAGF2.incore_complete</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.init_gf"><code class="docutils literal notranslate"><span class="pre">RAGF2.init_gf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.ipagf2"><code class="docutils literal notranslate"><span class="pre">RAGF2.ipagf2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.kernel"><code class="docutils literal notranslate"><span class="pre">RAGF2.kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.make_rdm1"><code class="docutils literal notranslate"><span class="pre">RAGF2.make_rdm1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.nmo"><code class="docutils literal notranslate"><span class="pre">RAGF2.nmo</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.nocc"><code class="docutils literal notranslate"><span class="pre">RAGF2.nocc</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.qmo_coeff"><code class="docutils literal notranslate"><span class="pre">RAGF2.qmo_coeff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.qmo_energy"><code class="docutils literal notranslate"><span class="pre">RAGF2.qmo_energy</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.qmo_occ"><code class="docutils literal notranslate"><span class="pre">RAGF2.qmo_occ</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.reset"><code class="docutils literal notranslate"><span class="pre">RAGF2.reset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.run_diis"><code class="docutils literal notranslate"><span class="pre">RAGF2.run_diis()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.update"><code class="docutils literal notranslate"><span class="pre">RAGF2.update()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.update_from_chk"><code class="docutils literal notranslate"><span class="pre">RAGF2.update_from_chk()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.RAGF2.update_from_chk_"><code class="docutils literal notranslate"><span class="pre">RAGF2.update_from_chk_()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.build_se_part"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.energy_1body"><code class="docutils literal notranslate"><span class="pre">energy_1body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.energy_2body"><code class="docutils literal notranslate"><span class="pre">energy_2body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.energy_mp2"><code class="docutils literal notranslate"><span class="pre">energy_mp2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.fock_loop"><code class="docutils literal notranslate"><span class="pre">fock_loop()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.get_fock"><code class="docutils literal notranslate"><span class="pre">get_fock()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.get_frozen_mask"><code class="docutils literal notranslate"><span class="pre">get_frozen_mask()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.get_jk"><code class="docutils literal notranslate"><span class="pre">get_jk()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2.kernel"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.agf2.ragf2_slow">pyscf.agf2.ragf2_slow module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2_slow.RAGF2"><code class="docutils literal notranslate"><span class="pre">RAGF2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2_slow.RAGF2.build_se"><code class="docutils literal notranslate"><span class="pre">RAGF2.build_se()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2_slow.RAGF2.build_se_part"><code class="docutils literal notranslate"><span class="pre">RAGF2.build_se_part()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2_slow.RAGF2.dump_flags"><code class="docutils literal notranslate"><span class="pre">RAGF2.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2_slow.RAGF2.run_diis"><code class="docutils literal notranslate"><span class="pre">RAGF2.run_diis()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.ragf2_slow.build_se_part"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.agf2.uagf2">pyscf.agf2.uagf2 module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2"><code class="docutils literal notranslate"><span class="pre">UAGF2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.ao2mo"><code class="docutils literal notranslate"><span class="pre">UAGF2.ao2mo()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.build_gf"><code class="docutils literal notranslate"><span class="pre">UAGF2.build_gf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.build_se"><code class="docutils literal notranslate"><span class="pre">UAGF2.build_se()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.build_se_part"><code class="docutils literal notranslate"><span class="pre">UAGF2.build_se_part()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.density_fit"><code class="docutils literal notranslate"><span class="pre">UAGF2.density_fit()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.eaagf2"><code class="docutils literal notranslate"><span class="pre">UAGF2.eaagf2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.energy_1body"><code class="docutils literal notranslate"><span class="pre">UAGF2.energy_1body()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.energy_2body"><code class="docutils literal notranslate"><span class="pre">UAGF2.energy_2body()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.energy_mp2"><code class="docutils literal notranslate"><span class="pre">UAGF2.energy_mp2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.fock_loop"><code class="docutils literal notranslate"><span class="pre">UAGF2.fock_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.get_ea"><code class="docutils literal notranslate"><span class="pre">UAGF2.get_ea()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.get_fock"><code class="docutils literal notranslate"><span class="pre">UAGF2.get_fock()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.get_ip"><code class="docutils literal notranslate"><span class="pre">UAGF2.get_ip()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.init_gf"><code class="docutils literal notranslate"><span class="pre">UAGF2.init_gf()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.ipagf2"><code class="docutils literal notranslate"><span class="pre">UAGF2.ipagf2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.make_rdm1"><code class="docutils literal notranslate"><span class="pre">UAGF2.make_rdm1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.nmo"><code class="docutils literal notranslate"><span class="pre">UAGF2.nmo</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.nocc"><code class="docutils literal notranslate"><span class="pre">UAGF2.nocc</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.qmo_coeff"><code class="docutils literal notranslate"><span class="pre">UAGF2.qmo_coeff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.qmo_energy"><code class="docutils literal notranslate"><span class="pre">UAGF2.qmo_energy</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.qmo_occ"><code class="docutils literal notranslate"><span class="pre">UAGF2.qmo_occ</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.UAGF2.run_diis"><code class="docutils literal notranslate"><span class="pre">UAGF2.run_diis()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.build_se_part"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.energy_1body"><code class="docutils literal notranslate"><span class="pre">energy_1body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.energy_2body"><code class="docutils literal notranslate"><span class="pre">energy_2body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.energy_mp2"><code class="docutils literal notranslate"><span class="pre">energy_mp2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.fock_loop"><code class="docutils literal notranslate"><span class="pre">fock_loop()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.get_fock"><code class="docutils literal notranslate"><span class="pre">get_fock()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2.get_frozen_mask"><code class="docutils literal notranslate"><span class="pre">get_frozen_mask()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.agf2.uagf2_slow">pyscf.agf2.uagf2_slow module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2_slow.UAGF2"><code class="docutils literal notranslate"><span class="pre">UAGF2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2_slow.UAGF2.build_se"><code class="docutils literal notranslate"><span class="pre">UAGF2.build_se()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2_slow.UAGF2.build_se_part"><code class="docutils literal notranslate"><span class="pre">UAGF2.build_se_part()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2_slow.UAGF2.dump_flags"><code class="docutils literal notranslate"><span class="pre">UAGF2.dump_flags()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2_slow.UAGF2.run_diis"><code class="docutils literal notranslate"><span class="pre">UAGF2.run_diis()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.uagf2_slow.build_se_part"><code class="docutils literal notranslate"><span class="pre">build_se_part()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.agf2">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#auxiliary-second-order-green-s-function-perturbation-theory">Auxiliary second-order Green’s function perturbation theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.AGF2"><code class="docutils literal notranslate"><span class="pre">AGF2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.RAGF2"><code class="docutils literal notranslate"><span class="pre">RAGF2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.agf2.UAGF2"><code class="docutils literal notranslate"><span class="pre">UAGF2()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/pyscf/pyscf.github.io/edit/master/source/pyscf_api_docs/pyscf.agf2.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, The PySCF Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>