
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pyscf.lib package &#8212; PySCF</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf-pst.css?v=ed6b5f64" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=dfec817d"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pyscf_api_docs/pyscf.lib';</script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.7" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-64x64.png" class="logo__image only-light" alt=""/>
    <img src="../_static/logo-64x64.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">PySCF</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../news.html">
    News
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../news.html">
    News
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pyscf.adc.html">pyscf.adc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.agf2.html">pyscf.agf2 package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.ao2mo.html">pyscf.ao2mo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.cc.html">pyscf.cc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.ci.html">pyscf.ci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.data.html">pyscf.data package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.df.html">pyscf.df package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.grad.html">pyscf.df.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.df.hessian.html">pyscf.df.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.dft.html">pyscf.dft package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.dft.xc.html">pyscf.dft.xc package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.eph.html">pyscf.eph package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.fci.html">pyscf.fci package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.geomopt.html">pyscf.geomopt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.grad.html">pyscf.grad package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.gto.html">pyscf.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.gto.basis.html">pyscf.gto.basis package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.gw.html">pyscf.gw package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.hessian.html">pyscf.hessian package</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">pyscf.lib package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.lo.html">pyscf.lo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mcscf.html">pyscf.mcscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mp.html">pyscf.mp package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.mrpt.html">pyscf.mrpt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.nac.html">pyscf.nac package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.pbc.html">pyscf.pbc package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.adc.html">pyscf.pbc.adc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ao2mo.html">pyscf.pbc.ao2mo package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.cc.html">pyscf.pbc.cc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.ci.html">pyscf.pbc.ci package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.df.html">pyscf.pbc.df package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.pbc.dft.html">pyscf.pbc.dft package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.dft.multigrid.html">pyscf.pbc.dft.multigrid package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.eph.html">pyscf.pbc.eph package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.geomopt.html">pyscf.pbc.geomopt package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.grad.html">pyscf.pbc.grad package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyscf.pbc.gto.html">pyscf.pbc.gto package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.basis.html">pyscf.pbc.gto.basis package</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyscf.pbc.gto.pseudo.html">pyscf.pbc.gto.pseudo package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.gw.html">pyscf.pbc.gw package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.lib.html">pyscf.pbc.lib package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mp.html">pyscf.pbc.mp package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpicc.html">pyscf.pbc.mpicc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.mpitools.html">pyscf.pbc.mpitools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.scf.html">pyscf.pbc.scf package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.symm.html">pyscf.pbc.symm package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tddft.html">pyscf.pbc.tddft package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tdscf.html">pyscf.pbc.tdscf package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.tools.html">pyscf.pbc.tools package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.pbc.x2c.html">pyscf.pbc.x2c package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.qmmm.html">pyscf.qmmm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.scf.html">pyscf.scf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.sgx.html">pyscf.sgx package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyscf.solvent.html">pyscf.solvent package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.grad.html">pyscf.solvent.grad package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscf.solvent.hessian.html">pyscf.solvent.hessian package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.soscf.html">pyscf.soscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.symm.html">pyscf.symm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tddft.html">pyscf.tddft package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tdscf.html">pyscf.tdscf package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.tools.html">pyscf.tools package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyscf.x2c.html">pyscf.x2c package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">pyscf.lib package</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pyscf-lib-package">
<h1>pyscf.lib package<a class="headerlink" href="#pyscf-lib-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-pyscf.lib.chkfile">
<span id="pyscf-lib-chkfile-module"></span><h2>pyscf.lib.chkfile module<a class="headerlink" href="#module-pyscf.lib.chkfile" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.chkfile.dump">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.chkfile.</span></span><span class="sig-name descname"><span class="pre">dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/chkfile.html#dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.chkfile.dump" title="Link to this definition">#</a></dt>
<dd><p>Save array(s) in chkfile</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Name of chkfile.</p>
</dd>
<dt>key<span class="classifier">str</span></dt><dd><p>key to be used in h5py object. It can contain “/” to represent the
path in the HDF5 storage structure.</p>
</dd>
<dt>value<span class="classifier">array, vector, list … or dict</span></dt><dd><p>If value is a python dict or list, the key/value of the dict will
be saved recursively as the HDF5 group/dataset structure.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>No return value</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ci</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ci&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;op&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">),</span> <span class="s1">&#39;irrep&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Ag&#39;</span><span class="p">,</span> <span class="s1">&#39;Au&#39;</span><span class="p">)}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;symm.chk&#39;</span><span class="p">,</span> <span class="s1">&#39;symm&#39;</span><span class="p">,</span> <span class="n">ci</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;symm.chk&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;symm&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;symm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;Ci&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;symm/Ci&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;op&#39;, &#39;irrep&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;symm/Ci/op&#39;</span><span class="p">]</span>
<span class="go">&lt;HDF5 dataset &quot;op&quot;: shape (2,), type &quot;|S1&quot;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.chkfile.dump_chkfile_key">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.chkfile.</span></span><span class="sig-name descname"><span class="pre">dump_chkfile_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.chkfile.dump_chkfile_key" title="Link to this definition">#</a></dt>
<dd><p>Save array(s) in chkfile</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Name of chkfile.</p>
</dd>
<dt>key<span class="classifier">str</span></dt><dd><p>key to be used in h5py object. It can contain “/” to represent the
path in the HDF5 storage structure.</p>
</dd>
<dt>value<span class="classifier">array, vector, list … or dict</span></dt><dd><p>If value is a python dict or list, the key/value of the dict will
be saved recursively as the HDF5 group/dataset structure.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>No return value</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ci</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ci&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;op&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">),</span> <span class="s1">&#39;irrep&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Ag&#39;</span><span class="p">,</span> <span class="s1">&#39;Au&#39;</span><span class="p">)}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;symm.chk&#39;</span><span class="p">,</span> <span class="s1">&#39;symm&#39;</span><span class="p">,</span> <span class="n">ci</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;symm.chk&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;symm&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;symm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;Ci&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;symm/Ci&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;op&#39;, &#39;irrep&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;symm/Ci/op&#39;</span><span class="p">]</span>
<span class="go">&lt;HDF5 dataset &quot;op&quot;: shape (2,), type &quot;|S1&quot;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.chkfile.dump_mol">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.chkfile.</span></span><span class="sig-name descname"><span class="pre">dump_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.chkfile.dump_mol" title="Link to this definition">#</a></dt>
<dd><p>Save Mole object in chkfile</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile str:</dt><dd><p>Name of chkfile.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>No return value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.chkfile.load">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.chkfile.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/chkfile.html#load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.chkfile.load" title="Link to this definition">#</a></dt>
<dd><p>Load array(s) from chkfile</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Name of chkfile. The chkfile needs to be saved in HDF5 format.</p>
</dd>
<dt>key<span class="classifier">str</span></dt><dd><p>HDF5.dataset name or group name.  If key is the name of a HDF5
group, the group will be loaded into a Python dict, recursively.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>whatever read from chkfile</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;He 0 0 0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">chkfile</span> <span class="o">=</span> <span class="s1">&#39;He.chk&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo_coeff</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;He.chk&#39;</span><span class="p">,</span> <span class="s1">&#39;scf/mo_coeff&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scfdat</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;He.chk&#39;</span><span class="p">,</span> <span class="s1">&#39;scf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scfdat</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;e_tot&#39;, &#39;mo_occ&#39;, &#39;mo_energy&#39;, &#39;mo_coeff&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.chkfile.load_chkfile_key">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.chkfile.</span></span><span class="sig-name descname"><span class="pre">load_chkfile_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.chkfile.load_chkfile_key" title="Link to this definition">#</a></dt>
<dd><p>Load array(s) from chkfile</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Name of chkfile. The chkfile needs to be saved in HDF5 format.</p>
</dd>
<dt>key<span class="classifier">str</span></dt><dd><p>HDF5.dataset name or group name.  If key is the name of a HDF5
group, the group will be loaded into a Python dict, recursively.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>whatever read from chkfile</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;He 0 0 0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">chkfile</span> <span class="o">=</span> <span class="s1">&#39;He.chk&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo_coeff</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;He.chk&#39;</span><span class="p">,</span> <span class="s1">&#39;scf/mo_coeff&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scfdat</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;He.chk&#39;</span><span class="p">,</span> <span class="s1">&#39;scf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scfdat</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;e_tot&#39;, &#39;mo_occ&#39;, &#39;mo_energy&#39;, &#39;mo_coeff&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.chkfile.load_mol">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.chkfile.</span></span><span class="sig-name descname"><span class="pre">load_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/chkfile.html#load_mol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.chkfile.load_mol" title="Link to this definition">#</a></dt>
<dd><p>Load Mole object from chkfile.
The save_mol/load_mol operation can be used a serialization method for Mole object.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Name of chkfile.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A (initialized/built) Mole object</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;He 0 0 0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">save_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s1">&#39;He.chk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">load_mol</span><span class="p">(</span><span class="s1">&#39;He.chk&#39;</span><span class="p">)</span>
<span class="go">&lt;pyscf.gto.mole.Mole object at 0x7fdcd94d7f50&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.chkfile.save">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.chkfile.</span></span><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.chkfile.save" title="Link to this definition">#</a></dt>
<dd><p>Save array(s) in chkfile</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile<span class="classifier">str</span></dt><dd><p>Name of chkfile.</p>
</dd>
<dt>key<span class="classifier">str</span></dt><dd><p>key to be used in h5py object. It can contain “/” to represent the
path in the HDF5 storage structure.</p>
</dd>
<dt>value<span class="classifier">array, vector, list … or dict</span></dt><dd><p>If value is a python dict or list, the key/value of the dict will
be saved recursively as the HDF5 group/dataset structure.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>No return value</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ci</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ci&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;op&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">),</span> <span class="s1">&#39;irrep&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Ag&#39;</span><span class="p">,</span> <span class="s1">&#39;Au&#39;</span><span class="p">)}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;symm.chk&#39;</span><span class="p">,</span> <span class="s1">&#39;symm&#39;</span><span class="p">,</span> <span class="n">ci</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;symm.chk&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;symm&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;symm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;Ci&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;symm/Ci&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;op&#39;, &#39;irrep&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;symm/Ci/op&#39;</span><span class="p">]</span>
<span class="go">&lt;HDF5 dataset &quot;op&quot;: shape (2,), type &quot;|S1&quot;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.chkfile.save_mol">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.chkfile.</span></span><span class="sig-name descname"><span class="pre">save_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chkfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/chkfile.html#save_mol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.chkfile.save_mol" title="Link to this definition">#</a></dt>
<dd><p>Save Mole object in chkfile</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>chkfile str:</dt><dd><p>Name of chkfile.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>No return value</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.lib.diis">
<span id="pyscf-lib-diis-module"></span><h2>pyscf.lib.diis module<a class="headerlink" href="#module-pyscf.lib.diis" title="Link to this heading">#</a></h2>
<p>DIIS</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.diis.DIIS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.diis.</span></span><span class="sig-name descname"><span class="pre">DIIS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/diis.html#DIIS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.diis.DIIS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Direct inversion in the iterative subspace method.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>space<span class="classifier">int</span></dt><dd><p>DIIS subspace size. The maximum number of the vectors to be stored.</p>
</dd>
<dt>min_space</dt><dd><p>The minimal size of subspace before DIIS extrapolation.</p>
</dd>
</dl>
</dd>
<dt>Functions:</dt><dd><dl class="simple">
<dt>update(x, xerr=None) :</dt><dd><p>If xerr the error vector is given, this function will push the target
vector and error vector in the DIIS subspace, and use the error vector
to extrapolate the vector and return the extrapolated vector.
If xerr is None, this function will take the difference between
the current given vector and the last given vector as the error
vector to extrapolate the vector.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_hcore</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_ovlp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">occ</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_occ</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># DIIS without error vector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adiis</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">diis</span><span class="o">.</span><span class="n">DIIS</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">dm</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">occ</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">f</span> <span class="o">=</span> <span class="n">h</span> <span class="o">+</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_veff</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">f</span> <span class="o">=</span> <span class="n">adiis</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;E_</span><span class="si">%d</span><span class="s1"> = </span><span class="si">%.12f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">energy_tot</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_veff</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm</span><span class="p">))))</span>
<span class="go">E_0 = -1.050329433306</span>
<span class="go">E_1 = -1.098566175145</span>
<span class="go">E_2 = -1.100103795287</span>
<span class="go">E_3 = -1.100152104615</span>
<span class="go">E_4 = -1.100153706922</span>
<span class="go">E_5 = -1.100153764848</span>
<span class="go">E_6 = -1.100153764878</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Take Hartree-Fock gradients as the error vector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adiis</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">diis</span><span class="o">.</span><span class="n">DIIS</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">dm</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">occ</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">f</span> <span class="o">=</span> <span class="n">h</span> <span class="o">+</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_veff</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">f</span> <span class="o">=</span> <span class="n">adiis</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_grad</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">occ</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;E_</span><span class="si">%d</span><span class="s1"> = </span><span class="si">%.12f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">energy_tot</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_veff</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm</span><span class="p">))))</span>
<span class="go">E_0 = -1.050329433306</span>
<span class="go">E_1 = -1.098566175145</span>
<span class="go">E_2 = -1.100103795287</span>
<span class="go">E_3 = -1.100152104615</span>
<span class="go">E_4 = -1.100153763813</span>
<span class="go">E_5 = -1.100153764878</span>
<span class="go">E_6 = -1.100153764878</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.diis.DIIS.extrapolate">
<span class="sig-name descname"><span class="pre">extrapolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/diis.html#DIIS.extrapolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.diis.DIIS.extrapolate" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.diis.DIIS.get_err_vec">
<span class="sig-name descname"><span class="pre">get_err_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/diis.html#DIIS.get_err_vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.diis.DIIS.get_err_vec" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.diis.DIIS.get_num_vec">
<span class="sig-name descname"><span class="pre">get_num_vec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/diis.html#DIIS.get_num_vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.diis.DIIS.get_num_vec" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.diis.DIIS.get_vec">
<span class="sig-name descname"><span class="pre">get_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/diis.html#DIIS.get_vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.diis.DIIS.get_vec" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.diis.DIIS.push_err_vec">
<span class="sig-name descname"><span class="pre">push_err_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/diis.html#DIIS.push_err_vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.diis.DIIS.push_err_vec" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.diis.DIIS.push_vec">
<span class="sig-name descname"><span class="pre">push_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/diis.html#DIIS.push_vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.diis.DIIS.push_vec" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.diis.DIIS.restore">
<span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/diis.html#DIIS.restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.diis.DIIS.restore" title="Link to this definition">#</a></dt>
<dd><p>Read diis contents from a diis file and replace the attributes of
current diis object if needed, then construct the vector.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.diis.DIIS.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.diis.DIIS.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.diis.DIIS.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/diis.html#DIIS.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.diis.DIIS.update" title="Link to this definition">#</a></dt>
<dd><p>Extrapolate vector</p>
<ul class="simple">
<li><p>If xerr the error vector is given, this function will push the target</p></li>
</ul>
<p>vector and error vector in the DIIS subspace, and use the error vector
to extrapolate the vector and return the extrapolated vector.
* If xerr is None, this function will take the difference between
the current given vector and the last given vector as the error
vector to extrapolate the vector.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.diis.restore">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.diis.</span></span><span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/diis.html#restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.diis.restore" title="Link to this definition">#</a></dt>
<dd><p>Restore/construct diis object based on a diis file</p>
</dd></dl>

</section>
<section id="module-pyscf.lib.exceptions">
<span id="pyscf-lib-exceptions-module"></span><h2>pyscf.lib.exceptions module<a class="headerlink" href="#module-pyscf.lib.exceptions" title="Link to this heading">#</a></h2>
<p>Errors and exceptions</p>
<dl class="py exception">
<dt class="sig sig-object py" id="pyscf.lib.exceptions.BasisNotFoundError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.exceptions.</span></span><span class="sig-name descname"><span class="pre">BasisNotFoundError</span></span><a class="reference internal" href="../_modules/pyscf/lib/exceptions.html#BasisNotFoundError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.exceptions.BasisNotFoundError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pyscf.lib.exceptions.PointGroupSymmetryError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.exceptions.</span></span><span class="sig-name descname"><span class="pre">PointGroupSymmetryError</span></span><a class="reference internal" href="../_modules/pyscf/lib/exceptions.html#PointGroupSymmetryError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.exceptions.PointGroupSymmetryError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pyscf.lib.exceptions.WfnSymmetryError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.exceptions.</span></span><span class="sig-name descname"><span class="pre">WfnSymmetryError</span></span><a class="reference internal" href="../_modules/pyscf/lib/exceptions.html#WfnSymmetryError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.exceptions.WfnSymmetryError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></p>
</dd></dl>

</section>
<section id="pyscf-lib-libagf2-module">
<h2>pyscf.lib.libagf2 module<a class="headerlink" href="#pyscf-lib-libagf2-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libao2mo-module">
<h2>pyscf.lib.libao2mo module<a class="headerlink" href="#pyscf-lib-libao2mo-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libcc-module">
<h2>pyscf.lib.libcc module<a class="headerlink" href="#pyscf-lib-libcc-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libcgto-module">
<h2>pyscf.lib.libcgto module<a class="headerlink" href="#pyscf-lib-libcgto-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libcvhf-module">
<h2>pyscf.lib.libcvhf module<a class="headerlink" href="#pyscf-lib-libcvhf-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libdft-module">
<h2>pyscf.lib.libdft module<a class="headerlink" href="#pyscf-lib-libdft-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libfci-module">
<h2>pyscf.lib.libfci module<a class="headerlink" href="#pyscf-lib-libfci-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libmcscf-module">
<h2>pyscf.lib.libmcscf module<a class="headerlink" href="#pyscf-lib-libmcscf-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libnp-helper-module">
<h2>pyscf.lib.libnp_helper module<a class="headerlink" href="#pyscf-lib-libnp-helper-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libopenblas-r0-f650aae0-module">
<h2>pyscf.lib.libopenblas-r0-f650aae0 module<a class="headerlink" href="#pyscf-lib-libopenblas-r0-f650aae0-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libpbc-module">
<h2>pyscf.lib.libpbc module<a class="headerlink" href="#pyscf-lib-libpbc-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libri-module">
<h2>pyscf.lib.libri module<a class="headerlink" href="#pyscf-lib-libri-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libsolvent-module">
<h2>pyscf.lib.libsolvent module<a class="headerlink" href="#pyscf-lib-libsolvent-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libxc-itrf-module">
<h2>pyscf.lib.libxc_itrf module<a class="headerlink" href="#pyscf-lib-libxc-itrf-module" title="Link to this heading">#</a></h2>
</section>
<section id="pyscf-lib-libxcfun-itrf-module">
<h2>pyscf.lib.libxcfun_itrf module<a class="headerlink" href="#pyscf-lib-libxcfun-itrf-module" title="Link to this heading">#</a></h2>
</section>
<section id="module-pyscf.lib.linalg_helper">
<span id="pyscf-lib-linalg-helper-module"></span><h2>pyscf.lib.linalg_helper module<a class="headerlink" href="#module-pyscf.lib.linalg_helper" title="Link to this heading">#</a></h2>
<p>Extension to scipy.linalg module</p>
<dl class="py exception">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.LinearDependenceError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">LinearDependenceError</span></span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#LinearDependenceError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.LinearDependenceError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.cho_solve">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">cho_solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_sym_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#cho_solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.cho_solve" title="Link to this definition">#</a></dt>
<dd><p>Solve ax = b, where a is a positive definite hermitian matrix</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>strict_sym_pos (bool)<span class="classifier">Whether to impose the strict positive definition</span></dt><dd><p>on matrix a</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.davidson">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">davidson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol=1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle=50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space=12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep=1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory=4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot=&lt;function</span> <span class="pre">dot&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lessio=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">follow_state=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#davidson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.davidson" title="Link to this definition">#</a></dt>
<dd><p>Davidson diagonalization method to solve  a c = e c.  Ref
[1] E.R. Davidson, J. Comput. Phys. 17 (1), 87-94 (1975).
[2] <a class="reference external" href="http://people.inf.ethz.ch/arbenz/ewp/Lnotes/chapter11.pdf">http://people.inf.ethz.ch/arbenz/ewp/Lnotes/chapter11.pdf</a></p>
<p>Note: This function has an overhead of memory usage ~4*x0.size*nroots</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>aop<span class="classifier">function(x) =&gt; array_like_x</span></dt><dd><p>aop(x) to mimic the matrix vector multiplication <span class="math notranslate nohighlight">\(\sum_{j}a_{ij}*x_j\)</span>.
The argument is a 1D array.  The returned value is a 1D array.</p>
</dd>
<dt>x0<span class="classifier">1D array or a list of 1D array</span></dt><dd><p>Initial guess.  The initial guess vector(s) are just used as the
initial subspace bases.  If the subspace is smaller than “nroots”,
eg 10 roots and one initial guess, all eigenvectors are chosen as
the eigenvectors during the iterations.  The first iteration has
one eigenvector, the next iteration has two, the third iteration
has 4, …, until the subspace size &gt; nroots.</p>
</dd>
<dt>precond<span class="classifier">diagonal elements of the matrix or  function(dx, e, x0) =&gt; array_like_dx</span></dt><dd><p>Preconditioner to generate new trial vector.
The argument dx is a residual vector <code class="docutils literal notranslate"><span class="pre">a*x0-e*x0</span></code>; e is the current
eigenvalue; x0 is the current eigenvector.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>tol<span class="classifier">float</span></dt><dd><p>Convergence tolerance.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>max number of iterations.</p>
</dd>
<dt>max_space<span class="classifier">int</span></dt><dd><p>space size to hold trial vectors.</p>
</dd>
<dt>lindep<span class="classifier">float</span></dt><dd><p>Linear dependency threshold.  The function is terminated when the
smallest eigenvalue of the metric of the trial vectors is lower
than this threshold.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>Allowed memory in MB.</p>
</dd>
<dt>dot<span class="classifier">function(x, y) =&gt; scalar</span></dt><dd><p>Inner product</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
environment.</p>
</dd>
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of eigenvalues to be computed.  When nroots &gt; 1, it affects
the shape of the return value</p>
</dd>
<dt>lessio<span class="classifier">bool</span></dt><dd><p>How to compute a*x0 for current eigenvector x0.  There are two
ways to compute a*x0.  One is to assemble the existed a*x.  The
other is to call aop(x0).  The default is the first method which
needs more IO and less computational cost.  When IO is slow, the
second method can be considered.</p>
</dd>
<dt>pick<span class="classifier">function(w,v,nroots) =&gt; (e[idx], w[:,idx], idx)</span></dt><dd><p>Function to filter eigenvalues and eigenvectors.</p>
</dd>
<dt>follow_state<span class="classifier">bool</span></dt><dd><p>If the solution dramatically changes in two iterations, clean the
subspace and restart the iteration with the old solution.  It can
help to improve numerical stability.  Default is False.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>e<span class="classifier">float or list of floats</span></dt><dd><p>Eigenvalue.  By default it’s one float number.  If <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> &gt; 1, it
is a list of floats for the lowest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> eigenvalues.</p>
</dd>
<dt>c<span class="classifier">1D array or list of 1D arrays</span></dt><dd><p>Eigenvector.  By default it’s a 1D array.  If <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> &gt; 1, it
is a list of arrays for the lowest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> eigenvectors.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aop</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precond</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">dx</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span> <span class="n">dx</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span><span class="o">-</span><span class="n">e</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x0</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">davidson</span><span class="p">(</span><span class="n">aop</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">precond</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.davidson1">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">davidson1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol=1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle=50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space=12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep=1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory=4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot=&lt;function</span> <span class="pre">dot&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lessio=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">follow_state=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_residual=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_heff=&lt;function</span> <span class="pre">_fill_heff_hermitian&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#davidson1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.davidson1" title="Link to this definition">#</a></dt>
<dd><p>Davidson diagonalization method to solve  a c = e c.  Ref
[1] E.R. Davidson, J. Comput. Phys. 17 (1), 87-94 (1975).
[2] <a class="reference external" href="http://people.inf.ethz.ch/arbenz/ewp/Lnotes/chapter11.pdf">http://people.inf.ethz.ch/arbenz/ewp/Lnotes/chapter11.pdf</a></p>
<p>Note: This function has an overhead of memory usage ~4*x0.size*nroots</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>aop<span class="classifier">function([x]) =&gt; [array_like_x]</span></dt><dd><p>Matrix vector multiplication <span class="math notranslate nohighlight">\(y_{ki} = \sum_{j}a_{ij}*x_{jk}\)</span>.</p>
</dd>
<dt>x0<span class="classifier">1D array or a list of 1D arrays or a function to generate x0 array(s)</span></dt><dd><p>Initial guess.  The initial guess vector(s) are just used as the
initial subspace bases.  If the subspace is smaller than “nroots”,
eg 10 roots and one initial guess, all eigenvectors are chosen as
the eigenvectors during the iterations.  The first iteration has
one eigenvector, the next iteration has two, the third iteration
has 4, …, until the subspace size &gt; nroots.</p>
</dd>
<dt>precond<span class="classifier">diagonal elements of the matrix or  function(dx, e, x0) =&gt; array_like_dx</span></dt><dd><p>Preconditioner to generate new trial vector.
The argument dx is a residual vector <code class="docutils literal notranslate"><span class="pre">a*x0-e*x0</span></code>; e is the current
eigenvalue; x0 is the current eigenvector.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>tol<span class="classifier">float</span></dt><dd><p>Convergence tolerance.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>max number of iterations.</p>
</dd>
<dt>max_space<span class="classifier">int</span></dt><dd><p>space size to hold trial vectors.</p>
</dd>
<dt>lindep<span class="classifier">float</span></dt><dd><p>Linear dependency threshold.  The function is terminated when the
smallest eigenvalue of the metric of the trial vectors is lower
than this threshold.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>Allowed memory in MB.</p>
</dd>
<dt>dot<span class="classifier">function(x, y) =&gt; scalar</span></dt><dd><p>Inner product</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
environment.</p>
</dd>
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of eigenvalues to be computed.  When nroots &gt; 1, it affects
the shape of the return value</p>
</dd>
<dt>lessio<span class="classifier">bool</span></dt><dd><p>How to compute a*x0 for current eigenvector x0.  There are two
ways to compute a*x0.  One is to assemble the existed a*x.  The
other is to call aop(x0).  The default is the first method which
needs more IO and less computational cost.  When IO is slow, the
second method can be considered.</p>
</dd>
<dt>pick<span class="classifier">function(w,v,nroots) =&gt; (e[idx], w[:,idx], idx)</span></dt><dd><p>Function to filter eigenvalues and eigenvectors.</p>
</dd>
<dt>follow_state<span class="classifier">bool</span></dt><dd><p>If the solution dramatically changes in two iterations, clean the
subspace and restart the iteration with the old solution.  It can
help to improve numerical stability.  Default is False.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>conv<span class="classifier">bool</span></dt><dd><p>Converged or not</p>
</dd>
<dt>e<span class="classifier">list of floats</span></dt><dd><p>The lowest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> eigenvalues.</p>
</dd>
<dt>c<span class="classifier">list of 1D arrays</span></dt><dd><p>The lowest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> eigenvectors.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aop</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xs</span><span class="p">:</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precond</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">dx</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span> <span class="n">dx</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span><span class="o">-</span><span class="n">e</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x0</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">davidson</span><span class="p">(</span><span class="n">aop</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">precond</span><span class="p">,</span> <span class="n">nroots</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.davidson_nosym">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">davidson_nosym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol=1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle=50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space=20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep=1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory=4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot=&lt;function</span> <span class="pre">dot&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lessio=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick=&lt;function</span> <span class="pre">pick_real_eigs&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">follow_state=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.linalg_helper.davidson_nosym" title="Link to this definition">#</a></dt>
<dd><p>Davidson diagonalization to solve the non-symmetric eigenvalue problem</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>aop<span class="classifier">function([x]) =&gt; [array_like_x]</span></dt><dd><p>Matrix vector multiplication <span class="math notranslate nohighlight">\(y_{ki} = \sum_{j}a_{ij}*x_{jk}\)</span>.</p>
</dd>
<dt>x0<span class="classifier">1D array or a list of 1D array</span></dt><dd><p>Initial guess.  The initial guess vector(s) are just used as the
initial subspace bases.  If the subspace is smaller than “nroots”,
eg 10 roots and one initial guess, all eigenvectors are chosen as
the eigenvectors during the iterations.  The first iteration has
one eigenvector, the next iteration has two, the third iteration
has 4, …, until the subspace size &gt; nroots.</p>
</dd>
<dt>precond<span class="classifier">diagonal elements of the matrix or  function(dx, e, x0) =&gt; array_like_dx</span></dt><dd><p>Preconditioner to generate new trial vector.
The argument dx is a residual vector <code class="docutils literal notranslate"><span class="pre">a*x0-e*x0</span></code>; e is the current
eigenvalue; x0 is the current eigenvector.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>tol<span class="classifier">float</span></dt><dd><p>Convergence tolerance.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>max number of iterations.</p>
</dd>
<dt>max_space<span class="classifier">int</span></dt><dd><p>space size to hold trial vectors.</p>
</dd>
<dt>lindep<span class="classifier">float</span></dt><dd><p>Linear dependency threshold.  The function is terminated when the
smallest eigenvalue of the metric of the trial vectors is lower
than this threshold.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>Allowed memory in MB.</p>
</dd>
<dt>dot<span class="classifier">function(x, y) =&gt; scalar</span></dt><dd><p>Inner product</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
environment.</p>
</dd>
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of eigenvalues to be computed.  When nroots &gt; 1, it affects
the shape of the return value</p>
</dd>
<dt>lessio<span class="classifier">bool</span></dt><dd><p>How to compute a*x0 for current eigenvector x0.  There are two
ways to compute a*x0.  One is to assemble the existed a*x.  The
other is to call aop(x0).  The default is the first method which
needs more IO and less computational cost.  When IO is slow, the
second method can be considered.</p>
</dd>
<dt>left<span class="classifier">bool</span></dt><dd><p>Whether to calculate and return left eigenvectors.  Default is False.</p>
</dd>
<dt>pick<span class="classifier">function(w,v,nroots) =&gt; (e[idx], w[:,idx], idx)</span></dt><dd><p>Function to filter eigenvalues and eigenvectors.</p>
</dd>
<dt>follow_state<span class="classifier">bool</span></dt><dd><p>If the solution dramatically changes in two iterations, clean the
subspace and restart the iteration with the old solution.  It can
help to improve numerical stability.  Default is False.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>conv<span class="classifier">bool</span></dt><dd><p>Converged or not</p>
</dd>
<dt>e<span class="classifier">list of eigenvalues</span></dt><dd><p>The eigenvalues can be sorted real or complex, depending on the
return value of <code class="docutils literal notranslate"><span class="pre">pick</span></code> function.</p>
</dd>
<dt>vl<span class="classifier">list of 1D arrays</span></dt><dd><p>Left eigenvectors. Only returned if <code class="docutils literal notranslate"><span class="pre">left=True</span></code>.</p>
</dd>
<dt>c<span class="classifier">list of 1D arrays</span></dt><dd><p>Right eigenvectors.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aop</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xs</span><span class="p">:</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precond</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">dx</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span> <span class="n">dx</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span><span class="o">-</span><span class="n">e</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x0</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vr</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">davidson</span><span class="p">(</span><span class="n">aop</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">precond</span><span class="p">,</span> <span class="n">nroots</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.davidson_nosym1">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">davidson_nosym1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol=1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle=50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space=20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep=1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory=4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot=&lt;function</span> <span class="pre">dot&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lessio=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick=&lt;function</span> <span class="pre">pick_real_eigs&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">follow_state=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_residual=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_heff=&lt;function</span> <span class="pre">_fill_heff&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#davidson_nosym1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.davidson_nosym1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.dgeev">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">dgeev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol=1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle=50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space=12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep=1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory=4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot=&lt;function</span> <span class="pre">dot&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lessio=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#dgeev"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.dgeev" title="Link to this definition">#</a></dt>
<dd><p>Davidson diagonalization method to solve  A c = e B c.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>abop<span class="classifier">function(x) =&gt; (array_like_x, array_like_x)</span></dt><dd><p>abop applies two matrix vector multiplications and returns tuple (Ax, Bx)</p>
</dd>
<dt>x0<span class="classifier">1D array</span></dt><dd><p>Initial guess</p>
</dd>
<dt>precond<span class="classifier">diagonal elements of the matrix or  function(dx, e, x0) =&gt; array_like_dx</span></dt><dd><p>Preconditioner to generate new trial vector.
The argument dx is a residual vector <code class="docutils literal notranslate"><span class="pre">a*x0-e*x0</span></code>; e is the current
eigenvalue; x0 is the current eigenvector.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>tol<span class="classifier">float</span></dt><dd><p>Convergence tolerance.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>max number of iterations.</p>
</dd>
<dt>max_space<span class="classifier">int</span></dt><dd><p>space size to hold trial vectors.</p>
</dd>
<dt>lindep<span class="classifier">float</span></dt><dd><p>Linear dependency threshold.  The function is terminated when the
smallest eigenvalue of the metric of the trial vectors is lower
than this threshold.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>Allowed memory in MB.</p>
</dd>
<dt>dot<span class="classifier">function(x, y) =&gt; scalar</span></dt><dd><p>Inner product</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
environment.</p>
</dd>
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of eigenvalues to be computed.  When nroots &gt; 1, it affects
the shape of the return value</p>
</dd>
<dt>lessio<span class="classifier">bool</span></dt><dd><p>How to compute a*x0 for current eigenvector x0.  There are two
ways to compute a*x0.  One is to assemble the existed a*x.  The
other is to call aop(x0).  The default is the first method which
needs more IO and less computational cost.  When IO is slow, the
second method can be considered.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>e<span class="classifier">list of floats</span></dt><dd><p>The lowest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> eigenvalues.</p>
</dd>
<dt>c<span class="classifier">list of 1D arrays</span></dt><dd><p>The lowest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> eigenvectors.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.dgeev1">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">dgeev1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol=1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle=50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space=12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep=1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory=4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot=&lt;function</span> <span class="pre">dot&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lessio=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_residual=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#dgeev1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.dgeev1" title="Link to this definition">#</a></dt>
<dd><p>Davidson diagonalization method to solve  A c = e B c.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>abop<span class="classifier">function([x]) =&gt; ([array_like_x], [array_like_x])</span></dt><dd><p>abop applies two matrix vector multiplications and returns tuple (Ax, Bx)</p>
</dd>
<dt>x0<span class="classifier">1D array</span></dt><dd><p>Initial guess</p>
</dd>
<dt>precond<span class="classifier">diagonal elements of the matrix or  function(dx, e, x0) =&gt; array_like_dx</span></dt><dd><p>Preconditioner to generate new trial vector.
The argument dx is a residual vector <code class="docutils literal notranslate"><span class="pre">a*x0-e*x0</span></code>; e is the current
eigenvalue; x0 is the current eigenvector.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>tol<span class="classifier">float</span></dt><dd><p>Convergence tolerance.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>max number of iterations.</p>
</dd>
<dt>max_space<span class="classifier">int</span></dt><dd><p>space size to hold trial vectors.</p>
</dd>
<dt>lindep<span class="classifier">float</span></dt><dd><p>Linear dependency threshold.  The function is terminated when the
smallest eigenvalue of the metric of the trial vectors is lower
than this threshold.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>Allowed memory in MB.</p>
</dd>
<dt>dot<span class="classifier">function(x, y) =&gt; scalar</span></dt><dd><p>Inner product</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
environment.</p>
</dd>
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of eigenvalues to be computed.  When nroots &gt; 1, it affects
the shape of the return value</p>
</dd>
<dt>lessio<span class="classifier">bool</span></dt><dd><p>How to compute a*x0 for current eigenvector x0.  There are two
ways to compute a*x0.  One is to assemble the existed a*x.  The
other is to call aop(x0).  The default is the first method which
needs more IO and less computational cost.  When IO is slow, the
second method can be considered.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>conv<span class="classifier">bool</span></dt><dd><p>Converged or not</p>
</dd>
<dt>e<span class="classifier">list of floats</span></dt><dd><p>The lowest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> eigenvalues.</p>
</dd>
<dt>c<span class="classifier">list of 1D arrays</span></dt><dd><p>The lowest <code class="xref py py-attr docutils literal notranslate"><span class="pre">nroots</span></code> eigenvectors.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.dsolve">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">dsolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol=1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle=60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot=&lt;function</span> <span class="pre">dot&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep=1e-13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_residual=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.linalg_helper.dsolve" title="Link to this definition">#</a></dt>
<dd><p>Solve a linear equation using the GMRES solver from the scipy.sparse module.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.dsyev">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">dsyev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.linalg_helper.dsyev" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.eig">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">eig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol=1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle=50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_space=20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep=1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory=4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot=&lt;function</span> <span class="pre">dot&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lessio=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick=&lt;function</span> <span class="pre">pick_real_eigs&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">follow_state=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#eig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.eig" title="Link to this definition">#</a></dt>
<dd><p>Davidson diagonalization to solve the non-symmetric eigenvalue problem</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>aop<span class="classifier">function([x]) =&gt; [array_like_x]</span></dt><dd><p>Matrix vector multiplication <span class="math notranslate nohighlight">\(y_{ki} = \sum_{j}a_{ij}*x_{jk}\)</span>.</p>
</dd>
<dt>x0<span class="classifier">1D array or a list of 1D array</span></dt><dd><p>Initial guess.  The initial guess vector(s) are just used as the
initial subspace bases.  If the subspace is smaller than “nroots”,
eg 10 roots and one initial guess, all eigenvectors are chosen as
the eigenvectors during the iterations.  The first iteration has
one eigenvector, the next iteration has two, the third iteration
has 4, …, until the subspace size &gt; nroots.</p>
</dd>
<dt>precond<span class="classifier">diagonal elements of the matrix or  function(dx, e, x0) =&gt; array_like_dx</span></dt><dd><p>Preconditioner to generate new trial vector.
The argument dx is a residual vector <code class="docutils literal notranslate"><span class="pre">a*x0-e*x0</span></code>; e is the current
eigenvalue; x0 is the current eigenvector.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>tol<span class="classifier">float</span></dt><dd><p>Convergence tolerance.</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>max number of iterations.</p>
</dd>
<dt>max_space<span class="classifier">int</span></dt><dd><p>space size to hold trial vectors.</p>
</dd>
<dt>lindep<span class="classifier">float</span></dt><dd><p>Linear dependency threshold.  The function is terminated when the
smallest eigenvalue of the metric of the trial vectors is lower
than this threshold.</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>Allowed memory in MB.</p>
</dd>
<dt>dot<span class="classifier">function(x, y) =&gt; scalar</span></dt><dd><p>Inner product</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
environment.</p>
</dd>
<dt>nroots<span class="classifier">int</span></dt><dd><p>Number of eigenvalues to be computed.  When nroots &gt; 1, it affects
the shape of the return value</p>
</dd>
<dt>lessio<span class="classifier">bool</span></dt><dd><p>How to compute a*x0 for current eigenvector x0.  There are two
ways to compute a*x0.  One is to assemble the existed a*x.  The
other is to call aop(x0).  The default is the first method which
needs more IO and less computational cost.  When IO is slow, the
second method can be considered.</p>
</dd>
<dt>left<span class="classifier">bool</span></dt><dd><p>Whether to calculate and return left eigenvectors.  Default is False.</p>
</dd>
<dt>pick<span class="classifier">function(w,v,nroots) =&gt; (e[idx], w[:,idx], idx)</span></dt><dd><p>Function to filter eigenvalues and eigenvectors.</p>
</dd>
<dt>follow_state<span class="classifier">bool</span></dt><dd><p>If the solution dramatically changes in two iterations, clean the
subspace and restart the iteration with the old solution.  It can
help to improve numerical stability.  Default is False.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>conv<span class="classifier">bool</span></dt><dd><p>Converged or not</p>
</dd>
<dt>e<span class="classifier">list of eigenvalues</span></dt><dd><p>The eigenvalues can be sorted real or complex, depending on the
return value of <code class="docutils literal notranslate"><span class="pre">pick</span></code> function.</p>
</dd>
<dt>vl<span class="classifier">list of 1D arrays</span></dt><dd><p>Left eigenvectors. Only returned if <code class="docutils literal notranslate"><span class="pre">left=True</span></code>.</p>
</dd>
<dt>c<span class="classifier">list of 1D arrays</span></dt><dd><p>Right eigenvectors.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aop</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xs</span><span class="p">:</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precond</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">dx</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span> <span class="n">dx</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span><span class="o">-</span><span class="n">e</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x0</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vr</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">davidson</span><span class="p">(</span><span class="n">aop</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">precond</span><span class="p">,</span> <span class="n">nroots</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.eigh">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">eigh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#eigh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.eigh" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.eigh_by_blocks">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">eigh_by_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#eigh_by_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.eigh_by_blocks" title="Link to this definition">#</a></dt>
<dd><p>Solve an ordinary or generalized eigenvalue problem for diagonal blocks.
The diagonal blocks are extracted based on the given basis “labels”.  The
rows and columns which have the same labels are put in the same block.
One common scenario one needs the block-wise diagonalization is to
diagonalize the matrix in symmetry adapted basis, in which “labels” is the
irreps of each basis.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h, s<span class="classifier">2D array</span></dt><dd><p>Complex Hermitian or real symmetric matrix.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><p>labels : list</p>
</dd>
<dt>Returns:</dt><dd><p>w, v.  w is the eigenvalue vector; v is the eigenfunction array.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">::</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">::</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">::</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">::</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">eigh_by_blocks</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="go">(array([ 0.,  0.,  2.,  4.]),</span>
<span class="go"> array([[ 1.,  0.,  0.,  0.],</span>
<span class="go">        [ 0.,  0.,  1.,  0.],</span>
<span class="go">        [ 0.,  0.,  0.,  1.],</span>
<span class="go">        [ 0.,  1.,  0.,  0.]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(array([ -8.82020545e-01,  -1.81556477e-16,   1.77653793e+00,   5.10548262e+00]),</span>
<span class="go"> array([[  6.40734630e-01,  -7.07106781e-01,   1.68598330e-01,   -2.47050070e-01],</span>
<span class="go">        [ -3.80616542e-01,   9.40505244e-17,   8.19944479e-01,   -4.27577008e-01],</span>
<span class="go">        [ -1.84524565e-01,   9.40505244e-17,  -5.20423152e-01,   -8.33732828e-01],</span>
<span class="go">        [  6.40734630e-01,   7.07106781e-01,   1.68598330e-01,   -2.47050070e-01]]))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">lib</span><span class="p">,</span> <span class="n">symm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">symm_orb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vnuc_so</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int1e_nuc_sph&#39;</span><span class="p">),</span> <span class="n">c</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orbsym</span> <span class="o">=</span> <span class="n">symm</span><span class="o">.</span><span class="n">label_orb_symm</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">irrep_name</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">symm_orb</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">eigh_by_blocks</span><span class="p">(</span><span class="n">vnuc_so</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">orbsym</span><span class="p">)</span>
<span class="go">(array([-4.50766885, -1.80666351, -1.7808565 , -1.7808565 , -1.74189134,</span>
<span class="go">        -0.98998583, -0.98998583, -0.40322226, -0.30242374, -0.07608981]),</span>
<span class="go"> ...)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.krylov">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">krylov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol=1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle=30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot=&lt;function</span> <span class="pre">dot&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep=1e-13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory=4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#krylov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.krylov" title="Link to this definition">#</a></dt>
<dd><p>Krylov subspace method to solve  (1+a) x = b.  Ref:
J. A. Pople et al, Int. J.  Quantum. Chem.  Symp. 13, 225 (1979).</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>aop<span class="classifier">function(x) =&gt; array_like_x</span></dt><dd><p>aop(x) to mimic the matrix vector multiplication <span class="math notranslate nohighlight">\(\sum_{j}a_{ij} x_j\)</span>.
The argument is a 1D array.  The returned value is a 1D array.</p>
</dd>
</dl>
<p>b : a vector or a list of vectors</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>x0<span class="classifier">1D array</span></dt><dd><p>Initial guess</p>
</dd>
<dt>tol<span class="classifier">float</span></dt><dd><p>Tolerance to terminate the operation aop(x).</p>
</dd>
<dt>max_cycle<span class="classifier">int</span></dt><dd><p>max number of iterations.</p>
</dd>
<dt>lindep<span class="classifier">float</span></dt><dd><p>Linear dependency threshold.  The function is terminated when the
smallest eigenvalue of the metric of the trial vectors is lower
than this threshold.</p>
</dd>
<dt>dot<span class="classifier">function(x, y) =&gt; scalar</span></dt><dd><p>Inner product</p>
</dd>
<dt>callback<span class="classifier">function(envs_dict) =&gt; None</span></dt><dd><p>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
environment.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>x : ndarray like b</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1e-2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aop</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">krylov</span><span class="p">(</span><span class="n">aop</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">aop</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.make_diag_precond">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">make_diag_precond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#make_diag_precond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.make_diag_precond" title="Link to this definition">#</a></dt>
<dd><p>Generate the preconditioner function with the diagonal function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.pick_real_eigs">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">pick_real_eigs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#pick_real_eigs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.pick_real_eigs" title="Link to this definition">#</a></dt>
<dd><p>This function searchs the real eigenvalues or eigenvalues with small
imaginary component.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.safe_eigh">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">safe_eigh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#safe_eigh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.safe_eigh" title="Link to this definition">#</a></dt>
<dd><p>Solve generalized eigenvalue problem  h v = w s v  in two passes.
First diagonalize s to get eigenvectors. Then in the eigenvectors space
transform and diagonalize h.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of eigenvalues and eigenvectors might be less than the
matrix dimension if linear dependency is found in metric s.</p>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>h, s<span class="classifier">2D array</span></dt><dd><p>Complex Hermitian or real symmetric matrix.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>lindep<span class="classifier">float</span></dt><dd><p>Linear dependency threshold.  By diagonalizing the metric s, we
consider the eigenvectors are linearly dependent subsets if their
eigenvalues are smaller than this threshold.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>w, v, seig.  w is the eigenvalue vector; v is the eigenfunction array;
seig is the eigenvalue vector of the metric s.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.linalg_helper.solve">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.linalg_helper.</span></span><span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol=1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cycle=60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot=&lt;function</span> <span class="pre">dot&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep=1e-13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_residual=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/linalg_helper.html#solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.linalg_helper.solve" title="Link to this definition">#</a></dt>
<dd><p>Solve a linear equation using the GMRES solver from the scipy.sparse module.</p>
</dd></dl>

</section>
<section id="module-pyscf.lib.logger">
<span id="pyscf-lib-logger-module"></span><h2>pyscf.lib.logger module<a class="headerlink" href="#module-pyscf.lib.logger" title="Link to this heading">#</a></h2>
<p>Logging system</p>
<section id="log-level">
<h3>Log level<a class="headerlink" href="#log-level" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>Level</p></td>
<td><p>number</p></td>
</tr>
<tr class="row-even"><td><p>DEBUG4</p></td>
<td><p>9</p></td>
</tr>
<tr class="row-odd"><td><p>DEBUG3</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-even"><td><p>DEBUG2</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-odd"><td><p>DEBUG1</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-even"><td><p>DEBUG</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>INFO</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>NOTE</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>WARN</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>ERROR</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>QUIET</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
</div>
<p>Large value means more noise in the output file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Error and warning messages are written to stderr.</p>
</div>
<p>Each Logger object has its own output destination and verbose level.  So
multiple Logger objects can be created to manage the message system without
affecting each other.
The methods provided by Logger class has the direct connection to the log level.
E.g.  <a class="reference internal" href="#pyscf.lib.logger.info" title="pyscf.lib.logger.info"><code class="xref py py-func docutils literal notranslate"><span class="pre">info()</span></code></a> print messages if the verbose level &gt;= 4 (INFO):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">Logger</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;info level&#39;</span><span class="p">)</span>
<span class="go">info level</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;info level&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">note</span><span class="p">(</span><span class="s1">&#39;note level&#39;</span><span class="p">)</span>
<span class="go">note level</span>
</pre></div>
</div>
</section>
<section id="timer">
<h3>timer<a class="headerlink" href="#timer" title="Link to this heading">#</a></h3>
<p>Logger object provides timer method for timing.  Set <code class="xref py py-attr docutils literal notranslate"><span class="pre">TIMER_LEVEL</span></code> to
control at which level the timing information should be output.  It is 5
(DEBUG) by default.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">Logger</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="n">process_clock</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">TIMER_LEVEL</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">timer</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span>
<span class="go">    CPU time for test      0.00 sec</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">Logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stdout=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#Logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.Logger" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>stdout<span class="classifier">file object or sys.stdout</span></dt><dd><p>The file to dump output message.</p>
</dd>
<dt>verbose<span class="classifier">int</span></dt><dd><p>Large value means more noise in the output file.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.debug" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.debug1">
<span class="sig-name descname"><span class="pre">debug1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.debug1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.debug2">
<span class="sig-name descname"><span class="pre">debug2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.debug2" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.debug3">
<span class="sig-name descname"><span class="pre">debug3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.debug3" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.debug4">
<span class="sig-name descname"><span class="pre">debug4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.debug4" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.error">
<span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.error" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.info" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.log" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.note">
<span class="sig-name descname"><span class="pre">note</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.note" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.timer">
<span class="sig-name descname"><span class="pre">timer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wall0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.timer" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.timer_debug1">
<span class="sig-name descname"><span class="pre">timer_debug1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wall0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.timer_debug1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.logger.Logger.warn">
<span class="sig-name descname"><span class="pre">warn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.logger.Logger.warn" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.debug">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.debug" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.debug1">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">debug1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#debug1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.debug1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.debug2">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">debug2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#debug2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.debug2" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.debug3">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">debug3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#debug3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.debug3" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.debug4">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">debug4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#debug4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.debug4" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.error">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.error" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.flush">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">flush</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#flush"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.flush" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.info">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.info" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.log">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.log" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.new_logger">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">new_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#new_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.new_logger" title="Link to this definition">#</a></dt>
<dd><p>Create and return a <a class="reference internal" href="#pyscf.lib.logger.Logger" title="pyscf.lib.logger.Logger"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></a> object</p>
<dl>
<dt>Args:</dt><dd><p>rec : An object which carries the attributes stdout and verbose</p>
<dl class="simple">
<dt>verbose<span class="classifier">a Logger object, or integer or None</span></dt><dd><p>The verbose level. If verbose is a Logger object, the Logger
object is returned. If verbose is not specified (None),
rec.verbose will be used in the new Logger object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.note">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">note</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#note"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.note" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.stdout">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">stdout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#stdout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.stdout" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.timer">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">timer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wall0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#timer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.timer" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.timer_debug1">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">timer_debug1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wall0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#timer_debug1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.timer_debug1" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.logger.warn">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.logger.</span></span><span class="sig-name descname"><span class="pre">warn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/logger.html#warn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.logger.warn" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyscf.lib.misc">
<span id="pyscf-lib-misc-module"></span><h2>pyscf.lib.misc module<a class="headerlink" href="#module-pyscf.lib.misc" title="Link to this heading">#</a></h2>
<p>Some helper functions</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.GradScanner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">GradScanner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#GradScanner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.GradScanner" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.lib.misc.GradScanner.converged">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">converged</span></span><a class="headerlink" href="#pyscf.lib.misc.GradScanner.converged" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyscf.lib.misc.GradScanner.e_tot">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_tot</span></span><a class="headerlink" href="#pyscf.lib.misc.GradScanner.e_tot" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.GradScanner.undo_scanner">
<span class="sig-name descname"><span class="pre">undo_scanner</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#GradScanner.undo_scanner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.GradScanner.undo_scanner" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.H5FileWrap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">H5FileWrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#H5FileWrap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.H5FileWrap" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></p>
<p>A wrapper for h5py.File that allows global options to be set by
the user via lib.param.H5F_WRITE_KWARGS, which is imported
upon startup from the user’s configuration file.</p>
<p>These options are, as the name suggests, not used when the
HDF5 file is opened in read-only mode.</p>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">temporary_env</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">param</span><span class="p">,</span> <span class="n">H5F_WRITE_KWARGS</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;driver&#39;</span><span class="p">:</span> <span class="s1">&#39;core&#39;</span><span class="p">}):</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">lib</span><span class="o">.</span><span class="n">H5TmpFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">driver</span><span class="p">)</span>
<span class="go">core</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.H5TmpFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">H5TmpFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/tmp'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#H5TmpFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.H5TmpFile" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.lib.misc.H5FileWrap" title="pyscf.lib.misc.H5FileWrap"><code class="xref py py-class docutils literal notranslate"><span class="pre">H5FileWrap</span></code></a></p>
<p>Create and return an HDF5 temporary file.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>filename<span class="classifier">str or None</span></dt><dd><p>If a string is given, an HDF5 file of the given filename will be
created. If filename is not specified, the HDF5 temporary
file will be deleted when the H5TmpFile object is released.</p>
</dd>
</dl>
</dd>
</dl>
<p>The return object is an h5py.File object. The file will be automatically
deleted when it is closed or the object is released (unless filename is
specified).</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ftmp</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">H5TmpFile</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.H5TmpFile.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#H5TmpFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.H5TmpFile.close" title="Link to this definition">#</a></dt>
<dd><p>Close the file.  All open objects become invalid</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pyscf.lib.misc.ProcessRuntimeError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">ProcessRuntimeError</span></span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#ProcessRuntimeError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.ProcessRuntimeError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.ProcessWithReturnValue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">ProcessWithReturnValue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#ProcessWithReturnValue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.ProcessWithReturnValue" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Process</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.ProcessWithReturnValue.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.misc.ProcessWithReturnValue.get" title="Link to this definition">#</a></dt>
<dd><p>Wait until child process terminates</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.ProcessWithReturnValue.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#ProcessWithReturnValue.join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.ProcessWithReturnValue.join" title="Link to this definition">#</a></dt>
<dd><p>Wait until child process terminates</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.SinglePointScanner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">SinglePointScanner</span></span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#SinglePointScanner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.SinglePointScanner" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.SinglePointScanner.undo_scanner">
<span class="sig-name descname"><span class="pre">undo_scanner</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#SinglePointScanner.undo_scanner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.SinglePointScanner.undo_scanner" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">StreamObject</span></span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#StreamObject"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.StreamObject" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>For most methods, there are three stream functions to pipe computing stream:</p>
<p>1 <code class="docutils literal notranslate"><span class="pre">.set_</span></code> function to update object attributes, eg
<code class="docutils literal notranslate"><span class="pre">mf</span> <span class="pre">=</span> <span class="pre">scf.RHF(mol).set(conv_tol=1e-5)</span></code> is identical to proceed in two steps
<code class="docutils literal notranslate"><span class="pre">mf</span> <span class="pre">=</span> <span class="pre">scf.RHF(mol);</span> <span class="pre">mf.conv_tol=1e-5</span></code></p>
<p>2 <code class="docutils literal notranslate"><span class="pre">.run</span></code> function to execute the kernel function (the function arguments
are passed to kernel function).  If keyword arguments is given, it will first
call <code class="docutils literal notranslate"><span class="pre">.set</span></code> function to update object attributes then execute the kernel
function.  Eg
<code class="docutils literal notranslate"><span class="pre">mf</span> <span class="pre">=</span> <span class="pre">scf.RHF(mol).run(dm_init,</span> <span class="pre">conv_tol=1e-5)</span></code> is identical to three steps
<code class="docutils literal notranslate"><span class="pre">mf</span> <span class="pre">=</span> <span class="pre">scf.RHF(mol);</span> <span class="pre">mf.conv_tol=1e-5;</span> <span class="pre">mf.kernel(dm_init)</span></code></p>
<p>3 <code class="docutils literal notranslate"><span class="pre">.apply</span></code> function to apply the given function/class to the current object
(function arguments and keyword arguments are passed to the given function).
Eg
<code class="docutils literal notranslate"><span class="pre">mol.apply(scf.RHF).run().apply(mcscf.CASSCF,</span> <span class="pre">6,</span> <span class="pre">4,</span> <span class="pre">frozen=4)</span></code> is identical to
<code class="docutils literal notranslate"><span class="pre">mf</span> <span class="pre">=</span> <span class="pre">scf.RHF(mol);</span> <span class="pre">mf.kernel();</span> <span class="pre">mcscf.CASSCF(mf,</span> <span class="pre">6,</span> <span class="pre">4,</span> <span class="pre">frozen=4)</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#StreamObject.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.StreamObject.apply" title="Link to this definition">#</a></dt>
<dd><p>Apply the fn to rest arguments:  return fn(<a href="#id1"><span class="problematic" id="id2">*</span></a>args, <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs).  The
return value of method set is the object itself.  This allows a series
of functions/methods to be executed in pipe.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject.check_sanity">
<span class="sig-name descname"><span class="pre">check_sanity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#StreamObject.check_sanity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.StreamObject.check_sanity" title="Link to this definition">#</a></dt>
<dd><p>Check input of class/object attributes, check whether a class method is
overwritten.  It does not check the attributes which are prefixed with
“_”.  The
return value of method set is the object itself.  This allows a series
of functions/methods to be executed in pipe.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#StreamObject.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.StreamObject.copy" title="Link to this definition">#</a></dt>
<dd><p>Returns a shallow copy</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#StreamObject.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.StreamObject.kernel" title="Link to this definition">#</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject.post_kernel">
<span class="sig-name descname"><span class="pre">post_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#StreamObject.post_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.StreamObject.post_kernel" title="Link to this definition">#</a></dt>
<dd><p>A hook to be run after the main body of the kernel function.  Internal
variables are exposed to post_kernel through the “envs” dictionary.
Return value of post_kernel function is not required.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject.pre_kernel">
<span class="sig-name descname"><span class="pre">pre_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">envs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#StreamObject.pre_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.StreamObject.pre_kernel" title="Link to this definition">#</a></dt>
<dd><p>A hook to be run before the main body of kernel function is executed.
Internal variables are exposed to pre_kernel through the “envs”
dictionary.  Return value of pre_kernel function is not required.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#StreamObject.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.StreamObject.run" title="Link to this definition">#</a></dt>
<dd><p>Call the kernel function of current object.  <cite>args</cite> will be passed
to kernel function.  <cite>kwargs</cite> will be used to update the attributes of
current object.  The return value of method run is the object itself.
This allows a series of functions/methods to be executed in pipe.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject.set">
<span class="sig-name descname"><span class="pre">set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#StreamObject.set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.StreamObject.set" title="Link to this definition">#</a></dt>
<dd><p>Update the attributes of the current object.  The return value of
method set is the object itself.  This allows a series of
functions/methods to be executed in pipe.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject.stdout">
<span class="sig-name descname"><span class="pre">stdout</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></em><a class="headerlink" href="#pyscf.lib.misc.StreamObject.stdout" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pyscf.lib.misc.StreamObject.verbose" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.StreamObject.view">
<span class="sig-name descname"><span class="pre">view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.misc.StreamObject.view" title="Link to this definition">#</a></dt>
<dd><p>New view of object with the same attributes.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pyscf.lib.misc.ThreadRuntimeError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">ThreadRuntimeError</span></span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#ThreadRuntimeError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.ThreadRuntimeError" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.ThreadWithReturnValue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">ThreadWithReturnValue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#ThreadWithReturnValue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.ThreadWithReturnValue" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Thread</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.ThreadWithReturnValue.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.misc.ThreadWithReturnValue.get" title="Link to this definition">#</a></dt>
<dd><p>Wait until the thread terminates.</p>
<p>This blocks the calling thread until the thread whose join() method is
called terminates – either normally or through an unhandled exception
or until the optional timeout occurs.</p>
<p>When the timeout argument is present and not None, it should be a
floating point number specifying a timeout for the operation in seconds
(or fractions thereof). As join() always returns None, you must call
is_alive() after join() to decide whether a timeout happened – if the
thread is still alive, the join() call timed out.</p>
<p>When the timeout argument is not present or None, the operation will
block until the thread terminates.</p>
<p>A thread can be join()ed many times.</p>
<p>join() raises a RuntimeError if an attempt is made to join the current
thread as that would cause a deadlock. It is also an error to join() a
thread before it has been started and attempts to do so raises the same
exception.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.ThreadWithReturnValue.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#ThreadWithReturnValue.join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.ThreadWithReturnValue.join" title="Link to this definition">#</a></dt>
<dd><p>Wait until the thread terminates.</p>
<p>This blocks the calling thread until the thread whose join() method is
called terminates – either normally or through an unhandled exception
or until the optional timeout occurs.</p>
<p>When the timeout argument is present and not None, it should be a
floating point number specifying a timeout for the operation in seconds
(or fractions thereof). As join() always returns None, you must call
is_alive() after join() to decide whether a timeout happened – if the
thread is still alive, the join() call timed out.</p>
<p>When the timeout argument is not present or None, the operation will
block until the thread terminates.</p>
<p>A thread can be join()ed many times.</p>
<p>join() raises a RuntimeError if an attempt is made to join the current
thread as that would cause a deadlock. It is also an error to join() a
thread before it has been started and attempts to do so raises the same
exception.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.ThreadWithTraceBack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">ThreadWithTraceBack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#ThreadWithTraceBack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.ThreadWithTraceBack" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Thread</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.ThreadWithTraceBack.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#ThreadWithTraceBack.join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.ThreadWithTraceBack.join" title="Link to this definition">#</a></dt>
<dd><p>Wait until the thread terminates.</p>
<p>This blocks the calling thread until the thread whose join() method is
called terminates – either normally or through an unhandled exception
or until the optional timeout occurs.</p>
<p>When the timeout argument is present and not None, it should be a
floating point number specifying a timeout for the operation in seconds
(or fractions thereof). As join() always returns None, you must call
is_alive() after join() to decide whether a timeout happened – if the
thread is still alive, the join() call timed out.</p>
<p>When the timeout argument is not present or None, the operation will
block until the thread terminates.</p>
<p>A thread can be join()ed many times.</p>
<p>join() raises a RuntimeError if an attempt is made to join the current
thread as that would cause a deadlock. It is also an error to join() a
thread before it has been started and attempts to do so raises the same
exception.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.alias">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">alias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alias_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#alias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.alias" title="Link to this definition">#</a></dt>
<dd><p>The statement “fn1 = alias(fn)” in a class is equivalent to define the
following method in the class:</p>
<p>Using alias function instead of fn1 = fn because some methods may be
overloaded in the child class. Using “alias” can make sure that the
overloaded methods were called when calling the aliased method.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.arg_first_match">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">arg_first_match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#arg_first_match"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.arg_first_match" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.background">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.misc.background" title="Link to this definition">#</a></dt>
<dd><p>applying function in background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.background_process">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">background_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#background_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.background_process" title="Link to this definition">#</a></dt>
<dd><p>applying function in background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.background_thread">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">background_thread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#background_thread"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.background_thread" title="Link to this definition">#</a></dt>
<dd><p>applying function in background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.bg">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">bg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.misc.bg" title="Link to this definition">#</a></dt>
<dd><p>applying function in background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.bg_process">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">bg_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.misc.bg_process" title="Link to this definition">#</a></dt>
<dd><p>applying function in background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.bg_thread">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">bg_thread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.misc.bg_thread" title="Link to this definition">#</a></dt>
<dd><p>applying function in background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.bp">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">bp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.misc.bp" title="Link to this definition">#</a></dt>
<dd><p>applying function in background</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.c_double_arr">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">c_double_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#c_double_arr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.c_double_arr" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.lib.misc.c_double_p">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">c_double_p</span></span><a class="headerlink" href="#pyscf.lib.misc.c_double_p" title="Link to this definition">#</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">LP_c_double</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.c_int_arr">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">c_int_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#c_int_arr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.c_int_arr" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.lib.misc.c_null_ptr">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">c_null_ptr</span></span><a class="headerlink" href="#pyscf.lib.misc.c_null_ptr" title="Link to this definition">#</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">LP_c_void_p</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.call_in_background">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">call_in_background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">fns</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#call_in_background"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.call_in_background" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Within this macro, function(s) can be executed asynchronously (the
given functions are executed in background).</p>
<dl class="simple">
<dt>Attributes:</dt><dd><dl class="simple">
<dt>sync (bool): Whether to run in synchronized mode.  The default value</dt><dd><p>is False (asynchronized mode).</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">call_in_background</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span> <span class="k">as</span> <span class="n">async_fun</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">async_fun</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># == fun(a, b)</span>
<span class="gp">... </span>    <span class="n">do_something_else</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">call_in_background</span><span class="p">(</span><span class="n">fun1</span><span class="p">,</span> <span class="n">fun2</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">afun1</span><span class="p">,</span> <span class="n">afun2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">afun2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">do_something_else</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">afun2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">do_something_else</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">afun1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">do_something_else</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.capture_stdout">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">capture_stdout</span></span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#capture_stdout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.capture_stdout" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>redirect all stdout (c printf &amp; python print) into a string</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">lib</span><span class="o">.</span><span class="n">capture_stdout</span><span class="p">()</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.lib.misc.capture_stdout.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#capture_stdout.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.capture_stdout.read" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.check_sanity">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">check_sanity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keysref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdout=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#check_sanity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.check_sanity" title="Link to this definition">#</a></dt>
<dd><p>Check misinput of class attributes, check whether a class method is
overwritten.  It does not check the attributes which are prefixed with
“_”.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.class_as_method">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">class_as_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#class_as_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.class_as_method" title="Link to this definition">#</a></dt>
<dd><p>The statement “fn1 = class_as_method(Class)” is equivalent to:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.lib.misc.ctypes_stdout">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">ctypes_stdout</span></span><a class="headerlink" href="#pyscf.lib.misc.ctypes_stdout" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.lib.misc.capture_stdout" title="pyscf.lib.misc.capture_stdout"><code class="xref py py-class docutils literal notranslate"><span class="pre">capture_stdout</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.current_memory">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">current_memory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#current_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.current_memory" title="Link to this definition">#</a></dt>
<dd><p>Return the size of used memory and allocated virtual memory (in MB)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.drop_class">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">drop_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_mixin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#drop_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.drop_class" title="Link to this definition">#</a></dt>
<dd><p>Recursively remove the first matched base_cls from cls MRO</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.f_double_arr">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">f_double_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#f_double_arr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.f_double_arr" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.f_int_arr">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">f_int_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#f_int_arr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.f_int_arr" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.find_if">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">find_if</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#find_if"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.find_if" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.finger">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">finger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.misc.finger" title="Link to this definition">#</a></dt>
<dd><p>Fingerprint of numpy array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.fingerprint">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">fingerprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#fingerprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.fingerprint" title="Link to this definition">#</a></dt>
<dd><p>Fingerprint of numpy array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.flatten">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#flatten"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.flatten" title="Link to this definition">#</a></dt>
<dd><p>flatten nested lists
x[0] + x[1] + x[2] + …</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flatten</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]])</span>
<span class="go">[0, 2, 1, [9, 8, 7]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.format_sys_info">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">format_sys_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#format_sys_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.format_sys_info" title="Link to this definition">#</a></dt>
<dd><p>Format a list of system information for printing.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.fp">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">fp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.lib.misc.fp" title="Link to this definition">#</a></dt>
<dd><p>Fingerprint of numpy array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.generate_pickle_methods">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">generate_pickle_methods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excludes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#generate_pickle_methods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.generate_pickle_methods" title="Link to this definition">#</a></dt>
<dd><p>Generate methods for pickle, e.g.:</p>
<dl class="simple">
<dt>class A:</dt><dd><p>__getstate__, __setstate__ = generate_pickle_methods(excludes=(‘a’, ‘b’, ‘c’))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.git_info">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">git_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#git_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.git_info" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.h5filewrite_options">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">h5filewrite_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#h5filewrite_options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.h5filewrite_options" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.lib.misc.temporary_env" title="pyscf.lib.misc.temporary_env"><code class="xref py py-class docutils literal notranslate"><span class="pre">temporary_env</span></code></a></p>
<p>Within the context of this macro, extra keyword arguments are
passed to h5py.File() whenever an HDF5 file is opened for writing.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">h5filewrite_options</span><span class="p">(</span><span class="n">alignment_interval</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">alignment_threshold</span><span class="o">=</span><span class="mi">4096</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">f</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">H5FileWrap</span><span class="p">(</span><span class="s1">&#39;mydata.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h5py</span><span class="o">.</span><span class="n">h5p</span><span class="o">.</span><span class="n">PropFAID</span><span class="o">.</span><span class="n">get_alignment</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">get_access_plist</span><span class="p">()))</span>
<span class="go">(4096, 4096)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.index_tril_to_pair">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">index_tril_to_pair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ij</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#index_tril_to_pair"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.index_tril_to_pair" title="Link to this definition">#</a></dt>
<dd><p>Given tril-index ij, compute the pair indices (i,j) which satisfy
ij = i * (i+1) / 2 + j</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.invalid_method">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">invalid_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#invalid_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.invalid_method" title="Link to this definition">#</a></dt>
<dd><p>The statement “fn1 = invalid_method(name)” can de-register a method</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.isinteger">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">isinteger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#isinteger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.isinteger" title="Link to this definition">#</a></dt>
<dd><p>Check if an object is an integer.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.isintsequence">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">isintsequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#isintsequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.isintsequence" title="Link to this definition">#</a></dt>
<dd><p>Determine if the object provided is a sequence of integers.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.issequence">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">issequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#issequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.issequence" title="Link to this definition">#</a></dt>
<dd><p>Determine if the object provided is a sequence.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.light_speed">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">light_speed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#light_speed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.light_speed" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.lib.misc.temporary_env" title="pyscf.lib.misc.temporary_env"><code class="xref py py-class docutils literal notranslate"><span class="pre">temporary_env</span></code></a></p>
<p>Within the context of this macro, the environment variable LIGHT_SPEED
can be customized.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">light_speed</span><span class="p">(</span><span class="mf">15.</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">LIGHT_SPEED</span><span class="p">)</span>
<span class="go">15.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">LIGHT_SPEED</span><span class="p">)</span>
<span class="go">137.03599967994</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.load_library">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">load_library</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">libname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#load_library"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.load_library" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.make_class">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">make_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#make_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.make_class" title="Link to this definition">#</a></dt>
<dd><p>Construct a class</p>
<dl class="simple">
<dt>class {name}(<a href="#id5"><span class="problematic" id="id6">*</span></a>bases):</dt><dd><p>__dict__ = attrs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.map_with_prefetch">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">map_with_prefetch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">iterables</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#map_with_prefetch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.map_with_prefetch" title="Link to this definition">#</a></dt>
<dd><p>Apply function to an task and prefetch the next task</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.member">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">member</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#member"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.member" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.module_method">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">module_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absences</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#module_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.module_method" title="Link to this definition">#</a></dt>
<dd><p>The statement “fn1 = module_method(fn, absences=[‘a’])”
in a class is equivalent to define the following method in the class:</p>
<p>If absences are not specified, all position arguments will be assigned in
terms of the corresponding attributes of self, i.e.</p>
<p>This function can be used to replace “staticmethod” when inserting a module
method into a class. In a child class, it allows one to call the method of a
base class with either “self.__class__.method_name(self, args)” or
“self.super().method_name(args)”. For method created with “staticmethod”,
calling “self.super().method_name(args)” is the only option.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.ndpointer">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">ndpointer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#ndpointer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.ndpointer" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.num_threads">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">num_threads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#num_threads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.num_threads" title="Link to this definition">#</a></dt>
<dd><p>Set the number of OMP threads.  If argument is not specified, the
function will return the total number of available OMP threads.</p>
<p>It’s recommended to call this function to set OMP threads than
“os.environ[‘OMP_NUM_THREADS’] = int(n)”. This is because environment
variables like OMP_NUM_THREADS were read when a module was imported. They
cannot be reset through os.environ after the module was loaded.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">num_threads</span><span class="p">())</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">num_threads</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">num_threads</span><span class="p">())</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.omnimethod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">omnimethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#omnimethod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.omnimethod" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.overwrite_mro">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">overwrite_mro</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mro</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#overwrite_mro"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.overwrite_mro" title="Link to this definition">#</a></dt>
<dd><p>A hacky function to overwrite the __mro__ attribute</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.prange">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">prange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#prange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.prange" title="Link to this definition">#</a></dt>
<dd><p>This function splits the number sequence between “start” and “end”
using uniform “step” length. It yields the boundary (start, end) for each
fragment.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
<span class="go">(0, 2)</span>
<span class="go">(2, 4)</span>
<span class="go">(4, 6)</span>
<span class="go">(6, 8)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.prange_split">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">prange_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sections</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#prange_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.prange_split" title="Link to this definition">#</a></dt>
<dd><p>Generate prange sequence that splits n_total elements into n sections.
The splits parallel to the np.array_split convention: the first (l % n)
sections of size l//n + 1 and the rest of size l//n.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange_split</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
<span class="go">(0, 4)</span>
<span class="go">(4, 7)</span>
<span class="go">(7, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.prange_tril">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">prange_tril</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocksize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#prange_tril"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.prange_tril" title="Link to this definition">#</a></dt>
<dd><p>Similar to <a class="reference internal" href="#pyscf.lib.misc.prange" title="pyscf.lib.misc.prange"><code class="xref py py-func docutils literal notranslate"><span class="pre">prange()</span></code></a>, yields start (p0) and end (p1) with the
restriction p1*(p1+1)/2-p0*(p0+1)/2 &lt; blocksize</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange_tril</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
<span class="go">(0, 6)</span>
<span class="go">(6, 9)</span>
<span class="go">(9, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.quite_run">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">quite_run</span></span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#quite_run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.quite_run" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>capture all stdout (c printf &amp; python print) but output nothing</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">lib</span><span class="o">.</span><span class="n">quite_run</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.remove_dup">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">remove_dup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#remove_dup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.remove_dup" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.remove_if">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">remove_if</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#remove_if"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.remove_if" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.replace_class">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">replace_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_cls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#replace_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.replace_class" title="Link to this definition">#</a></dt>
<dd><p>Replace the first matched class in MRO</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.repo_info">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">repo_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#repo_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.repo_info" title="Link to this definition">#</a></dt>
<dd><p>Repo location, version, git branch and commit ID</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.set_class">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">set_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#set_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.set_class" title="Link to this definition">#</a></dt>
<dd><p>Change the class of an object</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.square_mat_in_trilu_indices">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">square_mat_in_trilu_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#square_mat_in_trilu_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.square_mat_in_trilu_indices" title="Link to this definition">#</a></dt>
<dd><p>Return a n x n symmetric index matrix, in which the elements are the
indices of the unique elements of a tril vector
[0 1 3 … ]
[1 2 4 … ]
[3 4 5 … ]
[…       ]</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.temporary_env">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">temporary_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#temporary_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.temporary_env" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Within the context of this macro, the attributes of the object are
temporarily updated. When the program goes out of the scope of the
context, the original value of each attribute will be restored.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">temporary_env</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">param</span><span class="p">,</span> <span class="n">LIGHT_SPEED</span><span class="o">=</span><span class="mf">15.</span><span class="p">,</span> <span class="n">BOHR</span><span class="o">=</span><span class="mf">2.5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">LIGHT_SPEED</span><span class="p">,</span> <span class="n">lib</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">BOHR</span><span class="p">)</span>
<span class="go">15. 2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">LIGHT_SPEED</span><span class="p">,</span> <span class="n">lib</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">BOHR</span><span class="p">)</span>
<span class="go">137.03599967994 0.52917721092</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.to_gpu">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#to_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Convert a method to its corresponding GPU variant, and recursively
converts all attributes of a method to cupy objects or gpu4pyscf objects.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.tril_product">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">tril_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">iterables</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#tril_product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.tril_product" title="Link to this definition">#</a></dt>
<dd><p>Cartesian product in lower-triangular form for multiple indices</p>
<p>For a given list of indices (<cite>iterables</cite>), this function yields all
indices such that the sub-indices given by the kwarg <cite>tril_idx</cite> satisfy a
lower-triangular form.  The lower-triangular form satisfies:</p>
<div class="math notranslate nohighlight">
\[i[tril_idx[0]] &gt;= i[tril_idx[1]] &gt;= ... &gt;= i[tril_idx[len(tril_idx)-1]]\]</div>
<dl>
<dt>Args:</dt><dd><p><a href="#id7"><span class="problematic" id="id8">*</span></a>iterables: Variable length argument list of indices for the cartesian product
<a href="#id9"><span class="problematic" id="id10">**</span></a>kwds: Arbitrary keyword arguments.  Acceptable keywords include:</p>
<blockquote>
<div><p>repeat (int): Number of times to repeat the iterables
tril_idx (array_like): Indices to put into lower-triangular form.</p>
</div></blockquote>
</dd>
<dt>Yields:</dt><dd><p>product (tuple): Tuple in lower-triangular form.</p>
</dd>
<dt>Examples:</dt><dd><p>Specifying no <cite>tril_idx</cite> is equivalent to just a cartesian product.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">tril_product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[(0, 0), (0, 1), (1, 0), (1, 1)]</span>
</pre></div>
</div>
<p>We can specify only sub-indices to satisfy a lower-triangular form:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">tril_product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">tril_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">[(0, 0, 0), (0, 1, 0), (0, 1, 1), (1, 0, 0), (1, 1, 0), (1, 1, 1)]</span>
</pre></div>
</div>
<p>We specify all indices to satisfy a lower-triangular form, useful for iterating over
the symmetry unique elements of occupied/virtual orbitals in a 3-particle operator:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">tril_product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">tril_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">[(0, 0, 0), (1, 0, 0), (1, 1, 0), (1, 1, 1), (2, 0, 0), (2, 1, 0), (2, 1, 1), (2, 2, 0), (2, 2, 1), (2, 2, 2)]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.view">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.view" title="Link to this definition">#</a></dt>
<dd><p>New view of object with the same attributes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.misc.with_doc">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">with_doc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#with_doc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.with_doc" title="Link to this definition">#</a></dt>
<dd><p>Use this decorator to add doc string for function</p>
<blockquote>
<div><p>&#64;with_doc(doc)
def fn:</p>
<blockquote>
<div><p>…</p>
</div></blockquote>
</div></blockquote>
<p>is equivalent to</p>
<blockquote>
<div><p>fn.__doc__ = doc</p>
</div></blockquote>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.with_multiproc_nproc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">with_multiproc_nproc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nproc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#with_multiproc_nproc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.with_multiproc_nproc" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Using this macro to create a temporary context in which the number of
multi-processing processes are set to the required value.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.misc.with_omp_threads">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.misc.</span></span><span class="sig-name descname"><span class="pre">with_omp_threads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nthreads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/misc.html#with_omp_threads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.misc.with_omp_threads" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Using this macro to create a temporary context in which the number of
OpenMP threads are set to the required value. When the program exits the
context, the number OpenMP threads will be restored.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>nthreads : int</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">num_threads</span><span class="p">())</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">lib</span><span class="o">.</span><span class="n">with_omp_threads</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">num_threads</span><span class="p">())</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">num_threads</span><span class="p">())</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyscf.lib.numpy_helper">
<span id="pyscf-lib-numpy-helper-module"></span><h2>pyscf.lib.numpy_helper module<a class="headerlink" href="#module-pyscf.lib.numpy_helper" title="Link to this heading">#</a></h2>
<p>Extension to numpy and scipy</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.NPArrayWithTag">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">NPArrayWithTag</span></span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#NPArrayWithTag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.NPArrayWithTag" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.base_repr_int">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">base_repr_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndigits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#base_repr_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.base_repr_int" title="Link to this definition">#</a></dt>
<dd><p>Similar to numpy.base_repr, but returns a list of integers.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>number<span class="classifier">array or int</span></dt><dd><p>The value to convert. Negative values are converted to
their absolute values.</p>
</dd>
<dt>base<span class="classifier">int</span></dt><dd><p>Convert <cite>number</cite> to the <cite>base</cite> number system.</p>
</dd>
<dt>ndigits<span class="classifier">int, optional</span></dt><dd><p>Number of digits. If given, pad zeros to the left until the number
of digits reaches <cite>ndigits</cite>. Default is None, meaning no padding.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>out<span class="classifier">list</span></dt><dd><p>Representation of <cite>number</cite> in <cite>base</cite> system.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">base_repr_int</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<p>[3, 5]</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">base_repr_int</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[0, 3, 5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.cartesian_prod">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">cartesian_prod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#cartesian_prod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.cartesian_prod" title="Link to this definition">#</a></dt>
<dd><p>Generate a cartesian product of input arrays.
<a class="reference external" href="http://stackoverflow.com/questions/1208118/using-numpy-to-build-an-array-of-all-combinations-of-two-arrays">http://stackoverflow.com/questions/1208118/using-numpy-to-build-an-array-of-all-combinations-of-two-arrays</a></p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>arrays<span class="classifier">list of array-like</span></dt><dd><p>1-D arrays to form the cartesian product of.</p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>Array to place the cartesian product in.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>out<span class="classifier">ndarray</span></dt><dd><p>2-D array of shape (M, len(arrays)) containing cartesian products
formed of input arrays.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cartesian_prod</span><span class="p">(([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]))</span>
<span class="go">array([[1, 4, 6],</span>
<span class="go">       [1, 4, 7],</span>
<span class="go">       [1, 5, 6],</span>
<span class="go">       [1, 5, 7],</span>
<span class="go">       [2, 4, 6],</span>
<span class="go">       [2, 4, 7],</span>
<span class="go">       [2, 5, 6],</span>
<span class="go">       [2, 5, 7],</span>
<span class="go">       [3, 4, 6],</span>
<span class="go">       [3, 4, 7],</span>
<span class="go">       [3, 5, 6],</span>
<span class="go">       [3, 5, 7]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.cleanse">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">cleanse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#cleanse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.cleanse" title="Link to this definition">#</a></dt>
<dd><p>Remove floating-point errors by setting the
numbers with differences smaller than <cite>tol</cite>
to the same value. This should allow
<cite>numpy.round_</cite> and <cite>numpy.unique</cite> together
to work as expected.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>a<span class="classifier">ndarray</span></dt><dd><p>Array to be cleansed.</p>
</dd>
<dt>axis<span class="classifier">int or None</span></dt><dd><p>Axis along which the array values are compared.
Default is the first axis. If set to None,
the flattened array is used.</p>
</dd>
<dt>tol<span class="classifier">floating</span></dt><dd><p>Tolerance, default is 0.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Cleansed array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.cond">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">cond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#cond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.cond" title="Link to this definition">#</a></dt>
<dd><p>Compute the condition number</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.condense">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">condense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#condense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.condense" title="Link to this definition">#</a></dt>
<dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">i0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">loc_x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">i1</span> <span class="o">=</span> <span class="n">loc_x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">j0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">loc_y</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">j1</span> <span class="o">=</span> <span class="n">loc_y</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i0</span><span class="p">:</span><span class="n">i1</span><span class="p">,</span> <span class="n">j0</span><span class="p">:</span><span class="n">j1</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.ddot">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">ddot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#ddot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.ddot" title="Link to this definition">#</a></dt>
<dd><p>Matrix-matrix multiplication for double precision arrays</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.direct_sum">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">direct_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subscripts</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">operands</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#direct_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.direct_sum" title="Link to this definition">#</a></dt>
<dd><p>Apply the summation over many operands with the einsum fashion.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">direct_sum</span><span class="p">(</span><span class="s1">&#39;ij,klm-&gt;ijklm&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(6, 5, 4, 3, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">direct_sum</span><span class="p">(</span><span class="s1">&#39;ij,klm&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(6, 5, 4, 3, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">direct_sum</span><span class="p">(</span><span class="s1">&#39;i,j,klm-&gt;mjlik&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 6, 3, 5, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">direct_sum</span><span class="p">(</span><span class="s1">&#39;ij-klm-&gt;ijklm&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(6, 5, 4, 3, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">direct_sum</span><span class="p">(</span><span class="s1">&#39;ij+klm&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(6, 5, 4, 3, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">direct_sum</span><span class="p">(</span><span class="s1">&#39;-i-j+klm-&gt;mjlik&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 6, 3, 5, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">direct_sum</span><span class="p">(</span><span class="s1">&#39;ik+jk-&gt;kij&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># This is slow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.dot">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#dot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.dot" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.einsum">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">einsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subscripts</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">tensors</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#einsum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.einsum" title="Link to this definition">#</a></dt>
<dd><p>Perform a more efficient einsum via reshaping to a matrix multiply.</p>
<p>Current differences compared to numpy.einsum:
This assumes that each repeated index is actually summed (i.e. no ‘i,i-&gt;i’)
and appears only twice (i.e. no ‘ij,ik,il-&gt;jkl’). The output indices must
be explicitly specified (i.e. ‘ij,j-&gt;i’ and not ‘ij,j’).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.expm">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">expm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#expm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.expm" title="Link to this definition">#</a></dt>
<dd><p>Equivalent to scipy.linalg.expm</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.frompointer">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">frompointer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pointer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'float'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#frompointer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.frompointer" title="Link to this definition">#</a></dt>
<dd><p>Interpret a buffer that the pointer refers to as a 1-dimensional array.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>pointer<span class="classifier">int or ctypes pointer</span></dt><dd><p>address of a buffer</p>
</dd>
<dt>count<span class="classifier">int</span></dt><dd><p>Number of items to read.</p>
</dd>
<dt>dtype<span class="classifier">data-type, optional</span></dt><dd><p>Data-type of the returned array; default: float.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ptr</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frompointer</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
<span class="go">[1, 0, 1, 0, 1, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.hermi_sum">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">hermi_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#hermi_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.hermi_sum" title="Link to this definition">#</a></dt>
<dd><p>Computing a + a.T.conj() with better memory efficiency</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_sum</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">4.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[[ 0.  3.]</span>
<span class="go"> [ 3.  6.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.hermi_triu">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">hermi_triu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#hermi_triu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.hermi_triu" title="Link to this definition">#</a></dt>
<dd><p>Use the elements of the lower triangular part to fill the upper triangular part.</p>
<dl>
<dt>Kwargs:</dt><dd><p>hermi : int</p>
<blockquote>
<div><div class="line-block">
<div class="line">1 (default) return a hermitian matrix</div>
<div class="line">2           return an anti-hermitian matrix</div>
</div>
</div></blockquote>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hermi_triu</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[[ 0.  3.  6.]</span>
<span class="go"> [ 3.  4.  7.]</span>
<span class="go"> [ 6.  7.  8.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hermi_triu</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[[ 0. -3. -6.]</span>
<span class="go"> [ 3.  4. -7.]</span>
<span class="go"> [ 6.  7.  8.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.inv_base_repr_int">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">inv_base_repr_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#inv_base_repr_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.inv_base_repr_int" title="Link to this definition">#</a></dt>
<dd><p>Inverse of <cite>base_repr_int</cite>.
Similar to Python function int(), but for arbitrary base.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>x : array like
base : int</p>
</dd>
<dt>Returns:</dt><dd><p>out : int</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">inv_base_repr_int</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="mi">27</span><span class="p">)</span>
</pre></div>
</div>
<p>495</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">base_repr_int</span><span class="p">(</span><span class="mi">495</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[0, 18, 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.isin_1d">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">isin_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#isin_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.isin_1d" title="Link to this definition">#</a></dt>
<dd><p>Check if vector <cite>v</cite> is in vectors <cite>vs</cite>.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>v<span class="classifier">array like</span></dt><dd><p>The target vector. <cite>v</cite> is flattened.</p>
</dd>
<dt>vs<span class="classifier">array like</span></dt><dd><p>A list of vectors. The last dimension of <cite>vs</cite>
should be the same as the size of <cite>v</cite>.</p>
</dd>
<dt>return_index<span class="classifier">bool</span></dt><dd><p>Index of <cite>v</cite> in <cite>vs</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">isin_1d</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
<p>True</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span><span class="o">.</span><span class="n">isin_1d</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.locs_to_indices">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">locs_to_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">locs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segement_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#locs_to_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.locs_to_indices" title="Link to this definition">#</a></dt>
<dd><p>Generate indices based on the segement information list “locs” and the
required segements.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>locs<span class="classifier">list or ndarray</span></dt><dd><p>locs[i], locs[i+1] indicates the [start:end] index for i-th segement</p>
</dd>
<dt>segement_list: list or ndarray</dt><dd><p>The segement Ids to extract.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">locs_to_indices</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>array([0, 1, 5, 6, 7, 8, 15, 16])</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">locs_to_indices</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]))</span>
<span class="go">array([0, 1, 5, 6, 7, 8])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.ndarray_pointer_2d">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">ndarray_pointer_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#ndarray_pointer_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.ndarray_pointer_2d" title="Link to this definition">#</a></dt>
<dd><p>Return an array that contains the addresses of the first element in each
row of the input 2d array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.pack_tril">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">pack_tril</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#pack_tril"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.pack_tril" title="Link to this definition">#</a></dt>
<dd><p>flatten the lower triangular part of a matrix.
Given mat, it returns mat[…,numpy.tril_indices(mat.shape[0])]</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pack_tril</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[0 3 4 6 7 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.solve_lineq_by_SVD">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">solve_lineq_by_SVD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#solve_lineq_by_SVD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.solve_lineq_by_SVD" title="Link to this definition">#</a></dt>
<dd><p>Solving a * x = b.  If a is a singular matrix, its small SVD values are
neglected.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.split_reshape">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">split_reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#split_reshape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.split_reshape" title="Link to this definition">#</a></dt>
<dd><p>Split a vector into multiple tensors. shapes is a list of tuples.
The entries of shapes indicate the shape of each tensor.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>tensors : a list of tensors</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">split_reshape</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))))</span>
<span class="go">[array([[0, 1, 2],</span>
<span class="go">        [3, 4, 5]]),</span>
<span class="go"> array([6]),</span>
<span class="go"> [array([[ 7,  8],</span>
<span class="go">         [ 9, 10]]),</span>
<span class="go">  array([[11]])]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.tag_array">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">tag_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#tag_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.tag_array" title="Link to this definition">#</a></dt>
<dd><p>Attach attributes to numpy ndarray. The attribute name and value are
obtained from the keyword arguments.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.take_2d">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">take_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#take_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.take_2d" title="Link to this definition">#</a></dt>
<dd><p>Equivalent to a[idx[:,None],idy] for a 2D array.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take_2d</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">[[ 0.  2.]</span>
<span class="go"> [ 6.  8.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.takebak_2d">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">takebak_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thread_safe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#takebak_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.takebak_2d" title="Link to this definition">#</a></dt>
<dd><p>Reverse operation of take_2d.  Equivalent to out[idx[:,None],idy] += a
for a 2D array.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">takebak_2d</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">[[ 1.  0.  1.]</span>
<span class="go"> [ 0.  0.  0.]</span>
<span class="go"> [ 1.  0.  1.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.transpose">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#transpose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.transpose" title="Link to this definition">#</a></dt>
<dd><p>Transposing an array with better memory efficiency</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transpose</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">[[ 1.  1.  1.]</span>
<span class="go"> [ 1.  1.  1.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.transpose_sum">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">transpose_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#transpose_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.transpose_sum" title="Link to this definition">#</a></dt>
<dd><p>Computing a + a.T with better memory efficiency</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transpose_sum</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">4.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[[ 0.  3.]</span>
<span class="go"> [ 3.  6.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.unpack_row">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">unpack_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tril</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#unpack_row"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.unpack_row" title="Link to this definition">#</a></dt>
<dd><p>Extract one row of the lower triangular part of a matrix.
It is equivalent to unpack_tril(a)[row_id]</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_row</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">6.</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">[ 0. 1. 3.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_tril</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">6.</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[ 0. 1. 3.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.unpack_tril">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">unpack_tril</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tril</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filltriu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#unpack_tril"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.unpack_tril" title="Link to this definition">#</a></dt>
<dd><p>Reversed operation of pack_tril.</p>
<dl>
<dt>Kwargs:</dt><dd><p>filltriu : int</p>
<blockquote>
<div><div class="line-block">
<div class="line">0           Do not fill the upper triangular part, random number may appear
in the upper triangular part</div>
<div class="line">1 (default) Transpose the lower triangular part to fill the upper triangular part</div>
<div class="line">2           Similar to filltriu=1, negative of the lower triangular part is assign
to the upper triangular part to make the matrix anti-hermitian</div>
</div>
</div></blockquote>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_tril</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">6.</span><span class="p">))</span>
<span class="go">[[ 0. 1. 3.]</span>
<span class="go"> [ 1. 2. 4.]</span>
<span class="go"> [ 3. 4. 5.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_tril</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">6.</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">[[ 0. 0. 0.]</span>
<span class="go"> [ 1. 2. 0.]</span>
<span class="go"> [ 3. 4. 5.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_tril</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">6.</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[[ 0. -1. -3.]</span>
<span class="go"> [ 1.  2. -4.]</span>
<span class="go"> [ 3.  4.  5.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.zdot">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">zdot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#zdot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.zdot" title="Link to this definition">#</a></dt>
<dd><p>Matrix-matrix multiplication for double complex arrays</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.zdotCN">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">zdotCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#zdotCN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.zdotCN" title="Link to this definition">#</a></dt>
<dd><p>c = a.conj()*b</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.zdotNC">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">zdotNC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#zdotNC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.zdotNC" title="Link to this definition">#</a></dt>
<dd><p>c = a*b.conj()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.numpy_helper.zdotNN">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.numpy_helper.</span></span><span class="sig-name descname"><span class="pre">zdotNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/numpy_helper.html#zdotNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.numpy_helper.zdotNN" title="Link to this definition">#</a></dt>
<dd><p>c = a*b</p>
</dd></dl>

</section>
<section id="module-pyscf.lib.parameters">
<span id="pyscf-lib-parameters-module"></span><h2>pyscf.lib.parameters module<a class="headerlink" href="#module-pyscf.lib.parameters" title="Link to this heading">#</a></h2>
<p>PySCF environment variables are defined in this module.</p>
<section id="scratch-directory">
<h3>Scratch directory<a class="headerlink" href="#scratch-directory" title="Link to this heading">#</a></h3>
<p>The PySCF scratch directory is specified by <code class="xref py py-data docutils literal notranslate"><span class="pre">TMPDIR</span></code>.  Its default value
is the same to the system-wide environment variable <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code>.  It can be
overwritten by the environment variable <code class="docutils literal notranslate"><span class="pre">PYSCF_TMPDIR</span></code>.  Another place to set
<code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code> is the global configuration file (see <a class="reference internal" href="../design.html#global-config"><span class="std std-ref">Global configurations</span></a>).</p>
</section>
<section id="maximum-memory">
<span id="max-mem"></span><h3>Maximum memory<a class="headerlink" href="#maximum-memory" title="Link to this heading">#</a></h3>
<p>The variable <code class="xref py py-data docutils literal notranslate"><span class="pre">MAX_MEMORY</span></code> defines the maximum memory that PySCF can be
used in the calculation.  Its unit is MB.  The default value is 4000 MB.  It can
be overwritten by the system-wide environment variable <code class="docutils literal notranslate"><span class="pre">PYSCF_MAX_MEMORY</span></code>.
<code class="docutils literal notranslate"><span class="pre">MAX_MEMORY</span></code> can also be set in <a class="reference internal" href="../design.html#global-config"><span class="std std-ref">Global configurations</span></a> file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some calculations may exceed the max_memory limit, especially
when the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.incore_anyway</span></code> was set.</p>
</div>
</section>
</section>
<section id="module-pyscf.lib.scipy_helper">
<span id="pyscf-lib-scipy-helper-module"></span><h2>pyscf.lib.scipy_helper module<a class="headerlink" href="#module-pyscf.lib.scipy_helper" title="Link to this heading">#</a></h2>
<p>Extensions to the scipy.linalg module</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.scipy_helper.pivoted_cholesky">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.scipy_helper.</span></span><span class="sig-name descname"><span class="pre">pivoted_cholesky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/scipy_helper.html#pivoted_cholesky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.scipy_helper.pivoted_cholesky" title="Link to this definition">#</a></dt>
<dd><p>Performs a Cholesky factorization of A with full pivoting.
A can be a (singular) positive semidefinite matrix.</p>
<p>P.T * A * P = L * L.T   if   lower is True
P.T * A * P = U.T * U   if   lower if False</p>
<p>Use regular Cholesky factorization for positive definite matrices instead.</p>
<dl>
<dt>Args:</dt><dd><p>A : the matrix to be factorized
tol : the stopping tolerance (see LAPACK documentation for dpstrf)
lower : return lower triangular matrix L if true</p>
<blockquote>
<div><p>return upper triangular matrix U if false</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>the factor L or U, the pivot vector (starting with 0), the rank</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyscf.lib.scipy_helper.pivoted_cholesky_python">
<span class="sig-prename descclassname"><span class="pre">pyscf.lib.scipy_helper.</span></span><span class="sig-name descname"><span class="pre">pivoted_cholesky_python</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/lib/scipy_helper.html#pivoted_cholesky_python"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.lib.scipy_helper.pivoted_cholesky_python" title="Link to this definition">#</a></dt>
<dd><p>Pedestrian implementation of Cholesky factorization with full column pivoting.
The LAPACK version should be used instead whenever possible!</p>
<dl class="simple">
<dt>Args:</dt><dd><p>A : the positive semidefinite matrix to be factorized
tol : stopping tolerance
lower : return the lower or upper diagonal factorization</p>
</dd>
<dt>Returns:</dt><dd><p>the factor, the permutation vector, the rank</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyscf.lib">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyscf.lib" title="Link to this heading">#</a></h2>
<p>C extensions and helper functions</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.lib.chkfile">pyscf.lib.chkfile module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.chkfile.dump"><code class="docutils literal notranslate"><span class="pre">dump()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.chkfile.dump_chkfile_key"><code class="docutils literal notranslate"><span class="pre">dump_chkfile_key()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.chkfile.dump_mol"><code class="docutils literal notranslate"><span class="pre">dump_mol()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.chkfile.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.chkfile.load_chkfile_key"><code class="docutils literal notranslate"><span class="pre">load_chkfile_key()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.chkfile.load_mol"><code class="docutils literal notranslate"><span class="pre">load_mol()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.chkfile.save"><code class="docutils literal notranslate"><span class="pre">save()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.chkfile.save_mol"><code class="docutils literal notranslate"><span class="pre">save_mol()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.lib.diis">pyscf.lib.diis module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.diis.DIIS"><code class="docutils literal notranslate"><span class="pre">DIIS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.diis.DIIS.extrapolate"><code class="docutils literal notranslate"><span class="pre">DIIS.extrapolate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.diis.DIIS.get_err_vec"><code class="docutils literal notranslate"><span class="pre">DIIS.get_err_vec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.diis.DIIS.get_num_vec"><code class="docutils literal notranslate"><span class="pre">DIIS.get_num_vec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.diis.DIIS.get_vec"><code class="docutils literal notranslate"><span class="pre">DIIS.get_vec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.diis.DIIS.push_err_vec"><code class="docutils literal notranslate"><span class="pre">DIIS.push_err_vec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.diis.DIIS.push_vec"><code class="docutils literal notranslate"><span class="pre">DIIS.push_vec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.diis.DIIS.restore"><code class="docutils literal notranslate"><span class="pre">DIIS.restore()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.diis.DIIS.to_gpu"><code class="docutils literal notranslate"><span class="pre">DIIS.to_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.diis.DIIS.update"><code class="docutils literal notranslate"><span class="pre">DIIS.update()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.diis.restore"><code class="docutils literal notranslate"><span class="pre">restore()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.lib.exceptions">pyscf.lib.exceptions module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.exceptions.BasisNotFoundError"><code class="docutils literal notranslate"><span class="pre">BasisNotFoundError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.exceptions.PointGroupSymmetryError"><code class="docutils literal notranslate"><span class="pre">PointGroupSymmetryError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.exceptions.WfnSymmetryError"><code class="docutils literal notranslate"><span class="pre">WfnSymmetryError</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libagf2-module">pyscf.lib.libagf2 module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libao2mo-module">pyscf.lib.libao2mo module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libcc-module">pyscf.lib.libcc module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libcgto-module">pyscf.lib.libcgto module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libcvhf-module">pyscf.lib.libcvhf module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libdft-module">pyscf.lib.libdft module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libfci-module">pyscf.lib.libfci module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libmcscf-module">pyscf.lib.libmcscf module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libnp-helper-module">pyscf.lib.libnp_helper module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libopenblas-r0-f650aae0-module">pyscf.lib.libopenblas-r0-f650aae0 module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libpbc-module">pyscf.lib.libpbc module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libri-module">pyscf.lib.libri module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libsolvent-module">pyscf.lib.libsolvent module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libxc-itrf-module">pyscf.lib.libxc_itrf module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf-lib-libxcfun-itrf-module">pyscf.lib.libxcfun_itrf module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.lib.linalg_helper">pyscf.lib.linalg_helper module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.LinearDependenceError"><code class="docutils literal notranslate"><span class="pre">LinearDependenceError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.cho_solve"><code class="docutils literal notranslate"><span class="pre">cho_solve()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.davidson"><code class="docutils literal notranslate"><span class="pre">davidson()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.davidson1"><code class="docutils literal notranslate"><span class="pre">davidson1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.davidson_nosym"><code class="docutils literal notranslate"><span class="pre">davidson_nosym()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.davidson_nosym1"><code class="docutils literal notranslate"><span class="pre">davidson_nosym1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.dgeev"><code class="docutils literal notranslate"><span class="pre">dgeev()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.dgeev1"><code class="docutils literal notranslate"><span class="pre">dgeev1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.dsolve"><code class="docutils literal notranslate"><span class="pre">dsolve()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.dsyev"><code class="docutils literal notranslate"><span class="pre">dsyev()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.eig"><code class="docutils literal notranslate"><span class="pre">eig()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.eigh"><code class="docutils literal notranslate"><span class="pre">eigh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.eigh_by_blocks"><code class="docutils literal notranslate"><span class="pre">eigh_by_blocks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.krylov"><code class="docutils literal notranslate"><span class="pre">krylov()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.make_diag_precond"><code class="docutils literal notranslate"><span class="pre">make_diag_precond()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.pick_real_eigs"><code class="docutils literal notranslate"><span class="pre">pick_real_eigs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.safe_eigh"><code class="docutils literal notranslate"><span class="pre">safe_eigh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.linalg_helper.solve"><code class="docutils literal notranslate"><span class="pre">solve()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.lib.logger">pyscf.lib.logger module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-level">Log level</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#timer">timer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.debug"><code class="docutils literal notranslate"><span class="pre">Logger.debug()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.debug1"><code class="docutils literal notranslate"><span class="pre">Logger.debug1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.debug2"><code class="docutils literal notranslate"><span class="pre">Logger.debug2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.debug3"><code class="docutils literal notranslate"><span class="pre">Logger.debug3()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.debug4"><code class="docutils literal notranslate"><span class="pre">Logger.debug4()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.error"><code class="docutils literal notranslate"><span class="pre">Logger.error()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.info"><code class="docutils literal notranslate"><span class="pre">Logger.info()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.log"><code class="docutils literal notranslate"><span class="pre">Logger.log()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.note"><code class="docutils literal notranslate"><span class="pre">Logger.note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.timer"><code class="docutils literal notranslate"><span class="pre">Logger.timer()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.timer_debug1"><code class="docutils literal notranslate"><span class="pre">Logger.timer_debug1()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.Logger.warn"><code class="docutils literal notranslate"><span class="pre">Logger.warn()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.debug"><code class="docutils literal notranslate"><span class="pre">debug()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.debug1"><code class="docutils literal notranslate"><span class="pre">debug1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.debug2"><code class="docutils literal notranslate"><span class="pre">debug2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.debug3"><code class="docutils literal notranslate"><span class="pre">debug3()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.debug4"><code class="docutils literal notranslate"><span class="pre">debug4()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.error"><code class="docutils literal notranslate"><span class="pre">error()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.flush"><code class="docutils literal notranslate"><span class="pre">flush()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.info"><code class="docutils literal notranslate"><span class="pre">info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.log"><code class="docutils literal notranslate"><span class="pre">log()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.new_logger"><code class="docutils literal notranslate"><span class="pre">new_logger()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.note"><code class="docutils literal notranslate"><span class="pre">note()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.stdout"><code class="docutils literal notranslate"><span class="pre">stdout()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.timer"><code class="docutils literal notranslate"><span class="pre">timer()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.timer_debug1"><code class="docutils literal notranslate"><span class="pre">timer_debug1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.logger.warn"><code class="docutils literal notranslate"><span class="pre">warn()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.lib.misc">pyscf.lib.misc module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.GradScanner"><code class="docutils literal notranslate"><span class="pre">GradScanner</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.GradScanner.converged"><code class="docutils literal notranslate"><span class="pre">GradScanner.converged</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.GradScanner.e_tot"><code class="docutils literal notranslate"><span class="pre">GradScanner.e_tot</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.GradScanner.undo_scanner"><code class="docutils literal notranslate"><span class="pre">GradScanner.undo_scanner()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.H5FileWrap"><code class="docutils literal notranslate"><span class="pre">H5FileWrap</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.H5TmpFile"><code class="docutils literal notranslate"><span class="pre">H5TmpFile</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.H5TmpFile.close"><code class="docutils literal notranslate"><span class="pre">H5TmpFile.close()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ProcessRuntimeError"><code class="docutils literal notranslate"><span class="pre">ProcessRuntimeError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ProcessWithReturnValue"><code class="docutils literal notranslate"><span class="pre">ProcessWithReturnValue</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ProcessWithReturnValue.get"><code class="docutils literal notranslate"><span class="pre">ProcessWithReturnValue.get()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ProcessWithReturnValue.join"><code class="docutils literal notranslate"><span class="pre">ProcessWithReturnValue.join()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.SinglePointScanner"><code class="docutils literal notranslate"><span class="pre">SinglePointScanner</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.SinglePointScanner.undo_scanner"><code class="docutils literal notranslate"><span class="pre">SinglePointScanner.undo_scanner()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject"><code class="docutils literal notranslate"><span class="pre">StreamObject</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject.apply"><code class="docutils literal notranslate"><span class="pre">StreamObject.apply()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject.check_sanity"><code class="docutils literal notranslate"><span class="pre">StreamObject.check_sanity()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject.copy"><code class="docutils literal notranslate"><span class="pre">StreamObject.copy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject.kernel"><code class="docutils literal notranslate"><span class="pre">StreamObject.kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject.post_kernel"><code class="docutils literal notranslate"><span class="pre">StreamObject.post_kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject.pre_kernel"><code class="docutils literal notranslate"><span class="pre">StreamObject.pre_kernel()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject.run"><code class="docutils literal notranslate"><span class="pre">StreamObject.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject.set"><code class="docutils literal notranslate"><span class="pre">StreamObject.set()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject.stdout"><code class="docutils literal notranslate"><span class="pre">StreamObject.stdout</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject.verbose"><code class="docutils literal notranslate"><span class="pre">StreamObject.verbose</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.StreamObject.view"><code class="docutils literal notranslate"><span class="pre">StreamObject.view()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ThreadRuntimeError"><code class="docutils literal notranslate"><span class="pre">ThreadRuntimeError</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ThreadWithReturnValue"><code class="docutils literal notranslate"><span class="pre">ThreadWithReturnValue</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ThreadWithReturnValue.get"><code class="docutils literal notranslate"><span class="pre">ThreadWithReturnValue.get()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ThreadWithReturnValue.join"><code class="docutils literal notranslate"><span class="pre">ThreadWithReturnValue.join()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ThreadWithTraceBack"><code class="docutils literal notranslate"><span class="pre">ThreadWithTraceBack</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ThreadWithTraceBack.join"><code class="docutils literal notranslate"><span class="pre">ThreadWithTraceBack.join()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.alias"><code class="docutils literal notranslate"><span class="pre">alias()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.arg_first_match"><code class="docutils literal notranslate"><span class="pre">arg_first_match()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.background"><code class="docutils literal notranslate"><span class="pre">background()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.background_process"><code class="docutils literal notranslate"><span class="pre">background_process()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.background_thread"><code class="docutils literal notranslate"><span class="pre">background_thread()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.bg"><code class="docutils literal notranslate"><span class="pre">bg()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.bg_process"><code class="docutils literal notranslate"><span class="pre">bg_process()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.bg_thread"><code class="docutils literal notranslate"><span class="pre">bg_thread()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.bp"><code class="docutils literal notranslate"><span class="pre">bp()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.c_double_arr"><code class="docutils literal notranslate"><span class="pre">c_double_arr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.c_double_p"><code class="docutils literal notranslate"><span class="pre">c_double_p</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.c_int_arr"><code class="docutils literal notranslate"><span class="pre">c_int_arr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.c_null_ptr"><code class="docutils literal notranslate"><span class="pre">c_null_ptr</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.call_in_background"><code class="docutils literal notranslate"><span class="pre">call_in_background</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.capture_stdout"><code class="docutils literal notranslate"><span class="pre">capture_stdout</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.capture_stdout.read"><code class="docutils literal notranslate"><span class="pre">capture_stdout.read()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.check_sanity"><code class="docutils literal notranslate"><span class="pre">check_sanity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.class_as_method"><code class="docutils literal notranslate"><span class="pre">class_as_method()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ctypes_stdout"><code class="docutils literal notranslate"><span class="pre">ctypes_stdout</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.current_memory"><code class="docutils literal notranslate"><span class="pre">current_memory()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.drop_class"><code class="docutils literal notranslate"><span class="pre">drop_class()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.f_double_arr"><code class="docutils literal notranslate"><span class="pre">f_double_arr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.f_int_arr"><code class="docutils literal notranslate"><span class="pre">f_int_arr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.find_if"><code class="docutils literal notranslate"><span class="pre">find_if()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.finger"><code class="docutils literal notranslate"><span class="pre">finger()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.fingerprint"><code class="docutils literal notranslate"><span class="pre">fingerprint()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.flatten"><code class="docutils literal notranslate"><span class="pre">flatten()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.format_sys_info"><code class="docutils literal notranslate"><span class="pre">format_sys_info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.fp"><code class="docutils literal notranslate"><span class="pre">fp()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.generate_pickle_methods"><code class="docutils literal notranslate"><span class="pre">generate_pickle_methods()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.git_info"><code class="docutils literal notranslate"><span class="pre">git_info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.h5filewrite_options"><code class="docutils literal notranslate"><span class="pre">h5filewrite_options</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.index_tril_to_pair"><code class="docutils literal notranslate"><span class="pre">index_tril_to_pair()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.invalid_method"><code class="docutils literal notranslate"><span class="pre">invalid_method()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.isinteger"><code class="docutils literal notranslate"><span class="pre">isinteger()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.isintsequence"><code class="docutils literal notranslate"><span class="pre">isintsequence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.issequence"><code class="docutils literal notranslate"><span class="pre">issequence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.light_speed"><code class="docutils literal notranslate"><span class="pre">light_speed</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.load_library"><code class="docutils literal notranslate"><span class="pre">load_library()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.make_class"><code class="docutils literal notranslate"><span class="pre">make_class()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.map_with_prefetch"><code class="docutils literal notranslate"><span class="pre">map_with_prefetch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.member"><code class="docutils literal notranslate"><span class="pre">member()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.module_method"><code class="docutils literal notranslate"><span class="pre">module_method()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.ndpointer"><code class="docutils literal notranslate"><span class="pre">ndpointer()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.num_threads"><code class="docutils literal notranslate"><span class="pre">num_threads()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.omnimethod"><code class="docutils literal notranslate"><span class="pre">omnimethod</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.overwrite_mro"><code class="docutils literal notranslate"><span class="pre">overwrite_mro()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.prange"><code class="docutils literal notranslate"><span class="pre">prange()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.prange_split"><code class="docutils literal notranslate"><span class="pre">prange_split()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.prange_tril"><code class="docutils literal notranslate"><span class="pre">prange_tril()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.quite_run"><code class="docutils literal notranslate"><span class="pre">quite_run</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.remove_dup"><code class="docutils literal notranslate"><span class="pre">remove_dup()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.remove_if"><code class="docutils literal notranslate"><span class="pre">remove_if()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.replace_class"><code class="docutils literal notranslate"><span class="pre">replace_class()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.repo_info"><code class="docutils literal notranslate"><span class="pre">repo_info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.set_class"><code class="docutils literal notranslate"><span class="pre">set_class()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.square_mat_in_trilu_indices"><code class="docutils literal notranslate"><span class="pre">square_mat_in_trilu_indices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.temporary_env"><code class="docutils literal notranslate"><span class="pre">temporary_env</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.to_gpu"><code class="docutils literal notranslate"><span class="pre">to_gpu()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.tril_product"><code class="docutils literal notranslate"><span class="pre">tril_product()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.view"><code class="docutils literal notranslate"><span class="pre">view()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.with_doc"><code class="docutils literal notranslate"><span class="pre">with_doc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.with_multiproc_nproc"><code class="docutils literal notranslate"><span class="pre">with_multiproc_nproc</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.misc.with_omp_threads"><code class="docutils literal notranslate"><span class="pre">with_omp_threads</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.lib.numpy_helper">pyscf.lib.numpy_helper module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.NPArrayWithTag"><code class="docutils literal notranslate"><span class="pre">NPArrayWithTag</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.base_repr_int"><code class="docutils literal notranslate"><span class="pre">base_repr_int()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.cartesian_prod"><code class="docutils literal notranslate"><span class="pre">cartesian_prod()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.cleanse"><code class="docutils literal notranslate"><span class="pre">cleanse()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.cond"><code class="docutils literal notranslate"><span class="pre">cond()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.condense"><code class="docutils literal notranslate"><span class="pre">condense()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.ddot"><code class="docutils literal notranslate"><span class="pre">ddot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.direct_sum"><code class="docutils literal notranslate"><span class="pre">direct_sum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.dot"><code class="docutils literal notranslate"><span class="pre">dot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.einsum"><code class="docutils literal notranslate"><span class="pre">einsum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.expm"><code class="docutils literal notranslate"><span class="pre">expm()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.frompointer"><code class="docutils literal notranslate"><span class="pre">frompointer()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.hermi_sum"><code class="docutils literal notranslate"><span class="pre">hermi_sum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.hermi_triu"><code class="docutils literal notranslate"><span class="pre">hermi_triu()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.inv_base_repr_int"><code class="docutils literal notranslate"><span class="pre">inv_base_repr_int()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.isin_1d"><code class="docutils literal notranslate"><span class="pre">isin_1d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.locs_to_indices"><code class="docutils literal notranslate"><span class="pre">locs_to_indices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.ndarray_pointer_2d"><code class="docutils literal notranslate"><span class="pre">ndarray_pointer_2d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.pack_tril"><code class="docutils literal notranslate"><span class="pre">pack_tril()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.solve_lineq_by_SVD"><code class="docutils literal notranslate"><span class="pre">solve_lineq_by_SVD()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.split_reshape"><code class="docutils literal notranslate"><span class="pre">split_reshape()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.tag_array"><code class="docutils literal notranslate"><span class="pre">tag_array()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.take_2d"><code class="docutils literal notranslate"><span class="pre">take_2d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.takebak_2d"><code class="docutils literal notranslate"><span class="pre">takebak_2d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.transpose"><code class="docutils literal notranslate"><span class="pre">transpose()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.transpose_sum"><code class="docutils literal notranslate"><span class="pre">transpose_sum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.unpack_row"><code class="docutils literal notranslate"><span class="pre">unpack_row()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.unpack_tril"><code class="docutils literal notranslate"><span class="pre">unpack_tril()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.zdot"><code class="docutils literal notranslate"><span class="pre">zdot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.zdotCN"><code class="docutils literal notranslate"><span class="pre">zdotCN()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.zdotNC"><code class="docutils literal notranslate"><span class="pre">zdotNC()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.numpy_helper.zdotNN"><code class="docutils literal notranslate"><span class="pre">zdotNN()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.lib.parameters">pyscf.lib.parameters module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scratch-directory">Scratch directory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-memory">Maximum memory</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.lib.scipy_helper">pyscf.lib.scipy_helper module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.scipy_helper.pivoted_cholesky"><code class="docutils literal notranslate"><span class="pre">pivoted_cholesky()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyscf.lib.scipy_helper.pivoted_cholesky_python"><code class="docutils literal notranslate"><span class="pre">pivoted_cholesky_python()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-pyscf.lib">Module contents</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/pyscf/pyscf.github.io/edit/master/source/pyscf_api_docs/pyscf.lib.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, The PySCF Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>