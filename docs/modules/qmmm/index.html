
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>qmmm — QM/MM interface &#8212; PySCF 1.7.5.2 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/material.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../_static/favicon-32x32.png"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" /> 
  
   
  
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=amber>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#modules/qmmm" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../" title="PySCF 1.7.5.2 documentation"
           class="md-header-nav__button md-logo">
          
              <img src="../../_static/pyscf-logo-white.svg" height="26"
                   alt="PySCF 1.7.5.2 documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 1.7.5.2</span>
          <span class="md-header-nav__topic"> qmmm — QM/MM interface </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search/" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../../" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../../install/" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../../user/" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../../develop/" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="../../api_docs/modules/" class="md-tabs__link">API Docs</a></li>
            
            <li class="md-tabs__item"><a href="../../blog_wrapper/" class="md-tabs__link">Blog</a></li>
            
            <li class="md-tabs__item"><a href="../../about/" class="md-tabs__link">About</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../" title="PySCF 1.7.5.2 documentation" class="md-nav__button md-logo">
      
        <img src="../../_static/pyscf-logo-white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../"
       title="PySCF 1.7.5.2 documentation">PySCF 1.7.5.2</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../install/" class="md-nav__link">1. Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../user/" class="md-nav__link">2. User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../develop/" class="md-nav__link">3. Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../blog_wrapper/" class="md-nav__link">4. Blog</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#modules-qmmm--page-root" class="md-nav__link"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qmmm</span></code> — QM/MM interface</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#examples" class="md-nav__link">Examples</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/modules/qmmm.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
             <div class="section" id="qmmm-qm-mm-interface">
<span id="qmmm"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">qmmm</span></code> — QM/MM interface<a class="headerlink" href="#qmmm-qm-mm-interface" title="Permalink to this headline">¶</a></h1>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">qmmm</span></code> module implements a generic interface for use with MM programs.
To run HF with background charges, one could follow the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">qmmm</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">C       1.1879  -0.3829 0.0000</span>
<span class="s1">C       0.0000  0.5526  0.0000</span>
<span class="s1">O       -1.1867 -0.2472 0.0000</span>
<span class="s1">H       -1.9237 0.3850  0.0000</span>
<span class="s1">H       2.0985  0.2306  0.0000</span>
<span class="s1">H       1.1184  -1.0093 0.8869</span>
<span class="s1">H       1.1184  -1.0093 -0.8869</span>
<span class="s1">H       -0.0227 1.1812  0.8852</span>
<span class="s1">H       -0.0227 1.1812  -0.8852</span>
<span class="s1">            &#39;&#39;&#39;</span><span class="p">,</span>
            <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;3-21g&#39;</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">charges</span> <span class="o">=</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="o">-.</span><span class="mi">1</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">qmmm</span><span class="o">.</span><span class="n">mm_charge</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">charges</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a href="#id1"><span class="problematic" id="id2">:source:`examples/qmmm/00-hf.py`</span></a></p></li>
<li><p><a href="#id3"><span class="problematic" id="id4">:source:`examples/qmmm/01-dft.py`</span></a></p></li>
<li><p><a href="#id5"><span class="problematic" id="id6">:source:`examples/qmmm/02-mcscf.py`</span></a></p></li>
<li><p><a href="#id7"><span class="problematic" id="id8">:source:`examples/qmmm/03-ccsd.py`</span></a></p></li>
<li><p><a href="#id9"><span class="problematic" id="id10">:source:`examples/qmmm/04-cisd.py`</span></a></p></li>
<li><p><a href="#id11"><span class="problematic" id="id12">:source:`examples/qmmm/05-mp2.py`</span></a></p></li>
<li><p><a href="#id13"><span class="problematic" id="id14">:source:`examples/qmmm/06-tddft.py`</span></a></p></li>
<li><p><a href="#id15"><span class="problematic" id="id16">:source:`examples/qmmm/10-x2c.py`</span></a></p></li>
<li><p><a href="#id17"><span class="problematic" id="id18">:source:`examples/qmmm/11-newton.py`</span></a></p></li>
<li><p><a href="#id19"><span class="problematic" id="id20">:source:`examples/qmmm/11-soscf.py`</span></a></p></li>
<li><p><a href="#id21"><span class="problematic" id="id22">:source:`examples/qmmm/20-grad.py`</span></a></p></li>
<li><p><a href="#id23"><span class="problematic" id="id24">:source:`examples/qmmm/21-geom_opt.py`</span></a></p></li>
<li><p><a href="#id25"><span class="problematic" id="id26">:source:`examples/qmmm/22-with_solvent.py`</span></a></p></li>
<li><p><a href="#id27"><span class="problematic" id="id28">:source:`examples/qmmm/30-force_on_mm_particles.py`</span></a></p></li>
</ul>
<span class="target" id="module-pyscf.qmmm.itrf"></span><p>QM/MM helper functions that modify the QM methods.</p>
<dl class="py function">
<dt id="pyscf.qmmm.itrf.add_mm_charges">
<code class="sig-prename descclassname">pyscf.qmmm.itrf.</code><code class="sig-name descname">add_mm_charges</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scf_method</span></em>, <em class="sig-param"><span class="n">atoms_or_coords</span></em>, <em class="sig-param"><span class="n">charges</span></em>, <em class="sig-param"><span class="n">unit</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.qmmm.itrf.add_mm_charges" title="Permalink to this definition">¶</a></dt>
<dd><p>Embedding the one-electron (non-relativistic) potential generated by MM
point charges into QM Hamiltonian.</p>
<p>The total energy includes the regular QM energy, the interaction between
the nuclei in QM region and the MM charges, and the static Coulomb
interaction between the electron density and the MM charges. It does not
include the static Coulomb interactions of the MM point charges, the MM
energy, the vdw interaction or other bonding/non-bonding effects between
QM region and MM particles.</p>
<dl>
<dt>Args:</dt><dd><p>scf_method : a HF or DFT object</p>
<dl class="simple">
<dt>atoms_or_coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>MM particle coordinates</p>
</dd>
<dt>charges<span class="classifier">1D array</span></dt><dd><p>MM particle charges</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>unit<span class="classifier">str</span></dt><dd><p>Bohr, AU, Ang (case insensitive). Default is the same to mol.unit</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Same method object as the input scf_method with modified 1e Hamiltonian</p>
</dd>
<dt>Note:</dt><dd><p>1. if MM charge and X2C correction are used together, function mm_charge
needs to be applied after X2C decoration (.x2c method), eg
mf = mm_charge(scf.RHF(mol).x2c()), [(0.5,0.6,0.8)], [-0.5]).
2. Once mm_charge function is applied on the SCF object, it
affects all the post-HF calculations eg MP2, CCSD, MCSCF etc</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">mm_charge</span><span class="p">(</span><span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">)],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-101.940495711284</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyscf.qmmm.itrf.add_mm_charges_grad">
<code class="sig-prename descclassname">pyscf.qmmm.itrf.</code><code class="sig-name descname">add_mm_charges_grad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scf_grad</span></em>, <em class="sig-param"><span class="n">atoms_or_coords</span></em>, <em class="sig-param"><span class="n">charges</span></em>, <em class="sig-param"><span class="n">unit</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.qmmm.itrf.add_mm_charges_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the MM charges in the QM gradients’ method.  It affects both the
electronic and nuclear parts of the QM fragment.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>scf_grad<span class="classifier">a HF or DFT gradient object (grad.HF or grad.RKS etc)</span></dt><dd><p>Once the add_mm_charges_grad was applied, it affects all post-HF
calculations eg MP2, CCSD, MCSCF etc</p>
</dd>
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>MM particle coordinates</p>
</dd>
<dt>charges<span class="classifier">1D array</span></dt><dd><p>MM particle charges</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>unit<span class="classifier">str</span></dt><dd><p>Bohr, AU, Ang (case insensitive). Default is the same to mol.unit</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Same gradeints method object as the input scf_grad method</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">grad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">mm_charge</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">)],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-101.940495711284</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hfg</span> <span class="o">=</span> <span class="n">mm_charge_grad</span><span class="p">(</span><span class="n">grad</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mf</span><span class="p">),</span> <span class="n">coords</span><span class="p">,</span> <span class="n">charges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hfg</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">[[-0.25912357 -0.29235976 -0.38245077]</span>
<span class="go"> [-1.70497052 -1.89423883  1.2794798 ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyscf.qmmm.itrf.mm_charge">
<code class="sig-prename descclassname">pyscf.qmmm.itrf.</code><code class="sig-name descname">mm_charge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scf_method</span></em>, <em class="sig-param"><span class="n">atoms_or_coords</span></em>, <em class="sig-param"><span class="n">charges</span></em>, <em class="sig-param"><span class="n">unit</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.qmmm.itrf.mm_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Embedding the one-electron (non-relativistic) potential generated by MM
point charges into QM Hamiltonian.</p>
<p>The total energy includes the regular QM energy, the interaction between
the nuclei in QM region and the MM charges, and the static Coulomb
interaction between the electron density and the MM charges. It does not
include the static Coulomb interactions of the MM point charges, the MM
energy, the vdw interaction or other bonding/non-bonding effects between
QM region and MM particles.</p>
<dl>
<dt>Args:</dt><dd><p>scf_method : a HF or DFT object</p>
<dl class="simple">
<dt>atoms_or_coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>MM particle coordinates</p>
</dd>
<dt>charges<span class="classifier">1D array</span></dt><dd><p>MM particle charges</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>unit<span class="classifier">str</span></dt><dd><p>Bohr, AU, Ang (case insensitive). Default is the same to mol.unit</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Same method object as the input scf_method with modified 1e Hamiltonian</p>
</dd>
<dt>Note:</dt><dd><p>1. if MM charge and X2C correction are used together, function mm_charge
needs to be applied after X2C decoration (.x2c method), eg
mf = mm_charge(scf.RHF(mol).x2c()), [(0.5,0.6,0.8)], [-0.5]).
2. Once mm_charge function is applied on the SCF object, it
affects all the post-HF calculations eg MP2, CCSD, MCSCF etc</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">mm_charge</span><span class="p">(</span><span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">)],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-101.940495711284</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyscf.qmmm.itrf.mm_charge_grad">
<code class="sig-prename descclassname">pyscf.qmmm.itrf.</code><code class="sig-name descname">mm_charge_grad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scf_grad</span></em>, <em class="sig-param"><span class="n">atoms_or_coords</span></em>, <em class="sig-param"><span class="n">charges</span></em>, <em class="sig-param"><span class="n">unit</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.qmmm.itrf.mm_charge_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the MM charges in the QM gradients’ method.  It affects both the
electronic and nuclear parts of the QM fragment.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>scf_grad<span class="classifier">a HF or DFT gradient object (grad.HF or grad.RKS etc)</span></dt><dd><p>Once the add_mm_charges_grad was applied, it affects all post-HF
calculations eg MP2, CCSD, MCSCF etc</p>
</dd>
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>MM particle coordinates</p>
</dd>
<dt>charges<span class="classifier">1D array</span></dt><dd><p>MM particle charges</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>unit<span class="classifier">str</span></dt><dd><p>Bohr, AU, Ang (case insensitive). Default is the same to mol.unit</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Same gradeints method object as the input scf_grad method</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">grad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">mm_charge</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">)],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-101.940495711284</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hfg</span> <span class="o">=</span> <span class="n">mm_charge_grad</span><span class="p">(</span><span class="n">grad</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mf</span><span class="p">),</span> <span class="n">coords</span><span class="p">,</span> <span class="n">charges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hfg</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">[[-0.25912357 -0.29235976 -0.38245077]</span>
<span class="go"> [-1.70497052 -1.89423883  1.2794798 ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyscf.qmmm.itrf.qmmm_for_scf">
<code class="sig-prename descclassname">pyscf.qmmm.itrf.</code><code class="sig-name descname">qmmm_for_scf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scf_method</span></em>, <em class="sig-param"><span class="n">mm_mol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.qmmm.itrf.qmmm_for_scf" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the potential of MM particles to SCF (HF and DFT) method or CASCI
method then generate the corresponding QM/MM method for the QM system.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mm_mol : MM Mole object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyscf.qmmm.itrf.qmmm_grad_for_scf">
<code class="sig-prename descclassname">pyscf.qmmm.itrf.</code><code class="sig-name descname">qmmm_grad_for_scf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scf_grad</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.qmmm.itrf.qmmm_grad_for_scf" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the potential of MM particles to SCF (HF and DFT) object and then
generate the corresponding QM/MM gradients method for the QM system.</p>
</dd></dl>

</div>
</div>

<div class="section">
   
</div>

          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>