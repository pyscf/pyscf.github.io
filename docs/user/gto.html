
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Molecular structure &#8212; PySCF</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf-pst.css?v=ed6b5f64" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=dfec817d"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user/gto';</script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Crystal structure" href="pbcgto.html" />
    <link rel="prev" title="How to use PySCF" href="using.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.7" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-64x64.png" class="logo__image only-light" alt=""/>
    <img src="../_static/logo-64x64.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">PySCF</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../news.html">
    News
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../news.html">
    News
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="install.html">How to install PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="using.html">How to use PySCF</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Building molecules and crystals</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Molecular structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="pbcgto.html">Crystal structure</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronic structure methods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="scf.html">Self-consistent field (SCF) methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="dft.html">Density functional theory (DFT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="mp.html">Second-order Møller–Plesset perturbation theory (MP2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gw.html">GW approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ci.html">Configuration interaction (CISD and FCI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="cc.html">Coupled-cluster theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="adc.html">Algebraic diagrammatic construction (ADC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="agf2.html">Auxiliary second-order Green’s function perturbation theory (AGF2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="mcscf.html">Multi-configuration self-consistent field (MCSCF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrpt.html">Multi-reference perturbation theory (MRPT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tddft.html">Time-dependent Hartree-Fock and density functional theory</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other functionalities</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="solvent.html">Solvation models</a></li>
<li class="toctree-l1"><a class="reference internal" href="qmmm.html">QM/MM methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="md.html">Molecular Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="df.html">Density fitting (DF)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pbc.html">Periodic boundary conditions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pbc/gto.html">Crystal structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="pbc/scf.html">SCF and DFT methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="pbc/df.html">Density fitting for crystalline calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="pbc/mix_mol.html">Mixing PBC and molecular modules</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="eph.html">Electron-phonon coupling</a></li>
<li class="toctree-l1"><a class="reference internal" href="lo.html">Localized orbitals</a></li>
<li class="toctree-l1"><a class="reference internal" href="sgx.html">Seminumerical exchange (SGX)</a></li>
<li class="toctree-l1"><a class="reference internal" href="geomopt.html">Geometry optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu.html">GPU Acceleration (GPU4PySCF)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extensions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="extensions.html">Extensions</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Molecular structure</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="molecular-structure">
<span id="user-gto"></span><h1>Molecular structure<a class="headerlink" href="#molecular-structure" title="Link to this heading">#</a></h1>
<p><em>Modules</em>: <a class="reference internal" href="../pyscf_api_docs/pyscf.gto.html#module-pyscf.gto" title="pyscf.gto"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyscf.gto</span></code></a></p>
<section id="initializing-a-molecule">
<h2>Initializing a molecule<a class="headerlink" href="#initializing-a-molecule" title="Link to this heading">#</a></h2>
<p>There are three ways to define and initialize a molecule. The first is to use
the keyword arguments of the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Mole.build()</span></code> method to initialize a molecule:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;O 0 0 0; H  0 1 0; H 0 0 1&#39;&#39;&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The second way is to assign the geometry, basis etc., to the <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code>
object, followed by calling the <code class="xref py py-meth docutils literal notranslate"><span class="pre">build()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;O 0 0 0; H  0 1 0; H 0 0 1&#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</pre></div>
</div>
<p>The third way is to use the shortcut functions <a class="reference internal" href="../pyscf_api_docs/pyscf.html#pyscf.M" title="pyscf.M"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyscf.M()</span></code></a> or <code class="xref py py-func docutils literal notranslate"><span class="pre">Mole.M()</span></code>.
These functions pass all the arguments to the <code class="xref py py-func docutils literal notranslate"><span class="pre">build()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;O 0 0 0; H  0 1 0; H 0 0 1&#39;&#39;&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;O 0 0 0; H  0 1 0; H 0 0 1&#39;&#39;&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In any of these, you may have noticed two keywords <code class="docutils literal notranslate"><span class="pre">atom</span></code> and <code class="docutils literal notranslate"><span class="pre">basis</span></code>.
They are used to hold the molecular <a class="reference internal" href="#geometry">geometry</a> and <a class="reference internal" href="#basis-sets">basis sets</a>, which
can be defined along with other input options as follows.</p>
<section id="geometry">
<span id="id1"></span><h3>Geometry<a class="headerlink" href="#geometry" title="Link to this heading">#</a></h3>
<p>The molecular geometry can be input in Cartesian format
with the default unit being Angstrom
(one can specify the unit by setting the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">unit</span></code>
to either <code class="docutils literal notranslate"><span class="pre">'Angstrom'</span></code> or <code class="docutils literal notranslate"><span class="pre">'Bohr'</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    O   0. 0. 0.</span>
<span class="s1">    H   0. 1. 0.</span>
<span class="s1">    H   0. 0. 1.</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">mol</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span> <span class="c1"># case insensitive, any string not starts by &#39;B&#39; or &#39;AU&#39; is treated as &#39;Angstrom&#39;</span>
</pre></div>
</div>
<p>The atoms in the molecule are represented by an element symbol plus
three numbers for coordinates.  Different atoms should be separated by
<code class="docutils literal notranslate"><span class="pre">;</span></code> or a line break. In the same atom, <code class="docutils literal notranslate"><span class="pre">,</span></code> can be used to separate
different items. Blank lines or lines started with <code class="docutils literal notranslate"><span class="pre">#</span></code> will be
ignored:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
<span class="gp">... </span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">#O 0 0 0</span>
<span class="gp">... </span><span class="s1">H 0 1 0</span>
<span class="gp">...</span>
<span class="gp">... </span><span class="s1">H 0 0 1</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">natm</span>
<span class="go">2</span>
</pre></div>
</div>
<p>The input parser also supports the Z-matrix input
format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    O</span>
<span class="s1">    H  1  1.2</span>
<span class="s1">    H  1  1.2  2 105</span>
<span class="s1">&#39;&#39;&#39;</span>
</pre></div>
</div>
<p>Similarly, different atoms need to be separated by <code class="docutils literal notranslate"><span class="pre">;</span></code> or a line
break.</p>
<p>The geometry string is case-insensitive. It also supports to input the nuclear
charges of elements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;8 0. 0. 0.; h 0. 1. 0; H 0. 0. 1.&#39;&#39;&#39;</span>
</pre></div>
</div>
<p>If you need to label an atom to distinguish it from the
others, you can prefix or suffix the atom symbol with a number
<code class="docutils literal notranslate"><span class="pre">1234567890</span></code> or a special character <code class="docutils literal notranslate"><span class="pre">~!&#64;#$%^&amp;*()_+.?:&lt;&gt;[]{}|</span></code> (not
<code class="docutils literal notranslate"><span class="pre">,</span></code> and <code class="docutils literal notranslate"><span class="pre">;</span></code>). With this decoration, you can specify different
basis sets, masses, or nuclear models on different atoms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;8 0 0 0; h:1 0 1 0; H@2 0 0 1&#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="s1">&#39;cc-pvdz&#39;</span><span class="p">,</span> <span class="s1">&#39;H@2&#39;</span><span class="p">:</span> <span class="s1">&#39;6-31G&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">_atom</span><span class="p">)</span>
<span class="go">[[&#39;O&#39;, [0.0, 0.0, 0.0]], [&#39;H:1&#39;, [0.0, 1.0, 0.0]], [&#39;H@2&#39;, [0.0, 0.0, 1.0]]]</span>
</pre></div>
</div>
<p>You can also input the geometry in the internal format of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.atom</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">atom</span> <span class="o">=</span> <span class="p">[[</span><span class="n">atom1</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)],</span>
        <span class="p">[</span><span class="n">atom2</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)],</span>
        <span class="o">...</span>
        <span class="p">[</span><span class="n">atomN</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)]]</span>
</pre></div>
</div>
<p>This is convenient as you can use Python script to construct the geometry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;O&#39;</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)])</span>
</pre></div>
</div>
<p>Besides Python list, tuple and numpy.ndarray are all supported by the internal
format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
<p>You can also specify the path to an xyz file and PySCF will use the coordinates
from this file to build <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.atom</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s2">&quot;my_molecule.xyz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="s2">&quot;my_molecule.xyz&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</pre></div>
</div>
<p>No matter which format or symbols are used in the input, <code class="xref py py-func docutils literal notranslate"><span class="pre">Mole.build()</span></code>
will convert <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.atom</span></code> to the internal format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="go">    O        0,   0, 0             ; 1 0.0 1 0</span>

<span class="go">        H@2,0 0 1</span>
<span class="go">    &#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">_atom</span><span class="p">)</span>
<span class="go">[(&#39;O&#39;, [0.0, 0.0, 0.0]), (&#39;H&#39;, [0.0, 1.0, 0.0]), (&#39;H@2&#39;, [0.0, 0.0, 1.0])]</span>
</pre></div>
</div>
<p>which is stored as the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole._atom</span></code>.</p>
<p>Once the <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object is built, the molecular geometry can be
accessed through the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Mole.atom_coords()</span></code> function.
This function returns a (N,3) array for the coordinates of each atom:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">atom_coords</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;Bohr&#39;</span><span class="p">))</span> <span class="c1"># unit can be &quot;ANG&quot; or &quot;Bohr&quot;</span>
<span class="go">[[0. 0. 0.]</span>
<span class="go"> [0. 1. 0.]</span>
<span class="go"> [0. 0. 1.]]</span>
</pre></div>
</div>
<p>Please note the unit is Bohr by default. You can assign the keyword argument
<cite>unit=’Ang’</cite> to change the unit to Angstrom.
Ghost atoms can also be specified when inputting the geometry.
See <a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples/gto/03-ghost_atom.py">examples/gto/03-ghost_atom.py</a> for examples.</p>
</section>
<section id="basis-set">
<span id="basis-sets"></span><h3>Basis set<a class="headerlink" href="#basis-set" title="Link to this heading">#</a></h3>
<p>The simplest way to define the basis set is to assign the name of the
basis as a string to <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.basis</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span>
</pre></div>
</div>
<p>This input will apply the specified basis set to all atoms. The name
of the basis set in the string is case insensitive. White spaces,
dashes and underscores in the name are all ignored. If different
basis sets are required for different elements, a Python <code class="docutils literal notranslate"><span class="pre">dict</span></code> can
be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="s1">&#39;6-31g&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>One can also input custom basis sets with the helper functions.
The function <code class="xref py py-func docutils literal notranslate"><span class="pre">gto.basis.parse()</span></code> can parse a basis string in the NWChem format
(<a class="reference external" href="https://bse.pnl.gov/bse/portal">https://bse.pnl.gov/bse/portal</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="n">gto</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">C    S</span>
<span class="s1">     71.6168370              0.15432897</span>
<span class="s1">     13.0450960              0.53532814</span>
<span class="s1">      3.5305122              0.44463454</span>
<span class="s1">C    SP</span>
<span class="s1">      2.9412494             -0.09996723             0.15591627</span>
<span class="s1">      0.6834831              0.39951283             0.60768372</span>
<span class="s1">      0.2222899              0.70011547             0.39195739</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)}</span>
</pre></div>
</div>
<p>The functions <code class="xref py py-func docutils literal notranslate"><span class="pre">gto.basis.load()</span></code> can load arbitrary basis sets from the database, even
if the basis set does not match the element:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="n">gto</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;sto3g&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)}</span>
</pre></div>
</div>
<p>Both <code class="xref py py-func docutils literal notranslate"><span class="pre">gto.basis.parse()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">gto.basis.load()</span></code> return the basis set in the
internal format (see <a class="reference internal" href="#basis-format"><span class="std std-ref">Basis format</span></a>).</p>
<p>The basis parser also supports ghost atoms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;GHOST&#39;</span><span class="p">:</span> <span class="n">gto</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;cc-pvdz&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">),</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="s1">&#39;sto3g&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>More examples of ghost atoms can be found in
<a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples/gto/03-ghost_atom.py">examples/gto/03-ghost_atom.py</a>.</p>
<p>Like the requirements for geometry input, you can use atomic symbols
(case-insensitive) or atomic nuclear charges as the keyword of the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">basis</span></code> dictionary. Prefix and suffix of numbers and special
characters are allowed. If the decorated atomic symbol is appeared in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">atom</span></code> but not in <code class="xref py py-attr docutils literal notranslate"><span class="pre">basis</span></code>, the basis parser will
remove all decorations and seek the pure atomic symbol in the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">basis</span></code> dictionary. In the following example, the <code class="docutils literal notranslate"><span class="pre">6-31G</span></code> basis set
will be assigned to the atom <code class="docutils literal notranslate"><span class="pre">H1</span></code>,
but the <code class="docutils literal notranslate"><span class="pre">STO-3G</span></code> basis will be used for the atom <code class="docutils literal notranslate"><span class="pre">H2</span></code>:</p>
<blockquote>
<div><p>mol.atom = ‘8 0 0 0; h1 0 1 0; H2 0 0 1’
mol.basis = {‘O’: ‘sto-3g’, ‘H’: ‘sto3g’, ‘H1’: ‘6-31G’}</p>
</div></blockquote>
<p>See <a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples/gto/04-input_basis.py">examples/gto/04-input_basis.py</a> for more examples.</p>
</section>
<section id="basis-format">
<h3>Basis format<a class="headerlink" href="#basis-format" title="Link to this heading">#</a></h3>
<p>Basis data can be a text file or a python file.</p>
<p>The text file should store the
basis data in NWChem format. Most basis in PySCF were downloaded from
<a class="reference external" href="https://www.basissetexchange.org/">https://www.basissetexchange.org/</a> . Some basis (mostly the cc-pV*Z basis) were
downloaded with the option “optimize general contractions” checked.</p>
<p>The python basis format stores the basis in the internal format which looks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">angular</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="p">[[</span><span class="n">exp</span><span class="p">,</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">c_2</span><span class="p">,</span> <span class="o">..</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">exp</span><span class="p">,</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">c_2</span><span class="p">,</span> <span class="o">..</span><span class="p">],</span>
                   <span class="o">...</span> <span class="p">]],</span>
 <span class="p">[</span><span class="n">angular</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="p">[[</span><span class="n">exp</span><span class="p">,</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">c_2</span><span class="p">,</span> <span class="o">..</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">exp</span><span class="p">,</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">c_2</span><span class="p">,</span> <span class="o">..</span><span class="p">]</span>
                   <span class="o">...</span> <span class="p">]]]</span>
</pre></div>
</div>
<p>The list <cite>[angular, kappa, [[exp, c, …]]]</cite> defines the angular momentum of the
basis, the kappa value, the Gaussian exponents and basis contraction coefficients.
<cite>kappa</cite> can have value <span class="math notranslate nohighlight">\(-l-1\)</span> (corresponding to spinors with <span class="math notranslate nohighlight">\(j=l+1/2\)</span>),
<span class="math notranslate nohighlight">\(l\)</span> (corresponding to spinors with <span class="math notranslate nohighlight">\(j=l-1/2\)</span>) or 0. When kappa is 0, both
types of spinors are assumed in the basis. A few basis for relativistic
calculations (e.g. Dyall basis) were saved in this format.</p>
</section>
<section id="ordering-of-basis-functions">
<h3>Ordering of basis functions<a class="headerlink" href="#ordering-of-basis-functions" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>GTO basis functions are stored in the following order: (1) atoms, (2) angular</dt><dd><p>momentum, (3) shells, (4) spherical harmonics. This means that basis functions are first</p>
</dd>
</dl>
<p>grouped in terms of the atoms they are assigned to. On each atom, basis
functions are grouped according to their angular momentum.
For each value of the angular momentum, the individual shells
are sorted from inner shells to outer shells, that is, from large exponents to small exponents.
A shell can be a real atomic shell, formed as a linear combination of many Gaussians,
or just a single primitive Gaussian function that may have several angular components.
In each shell, the spherical parts of the GTO basis follow the
Condon-Shortley convention, with the ordering (and phase) given in
<cite>the Wikipedia table of spherical harmonics &lt;https://en.wikipedia.org/wiki/Table_of_spherical_harmonics&gt;</cite>,
except for the <cite>p</cite> functions for which the order of <cite>px</cite>, <cite>py</cite>, <cite>pz</cite> is used
instead of the order`py`, <cite>pz</cite>, <cite>px</cite> used in the table above.</p>
<p>Short notations are used for basis functions of <cite>s</cite>, <cite>p</cite> and <cite>d</cite> shells. We use
the label <cite>z^2</cite> for the <cite>Lz=0</cite> component of <cite>d</cite> function as the short name of
<cite>3z^2 - r^2</cite>.  For example, after applying all the rules above, we have the following
cc-pVTZ basis functions for carbon atom:</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>Atom Id</p></td>
<td><p>Shell</p></td>
<td><p>Angular momentum</p></td>
<td><p>Spherical part</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>1</p></td>
<td><p>s</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>2</p></td>
<td><p>s</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>3</p></td>
<td><p>s</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>s</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>2</p></td>
<td><p>p</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>2</p></td>
<td><p>p</p></td>
<td><p>y</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>2</p></td>
<td><p>p</p></td>
<td><p>z</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>3</p></td>
<td><p>p</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>3</p></td>
<td><p>p</p></td>
<td><p>y</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>3</p></td>
<td><p>p</p></td>
<td><p>z</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>p</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>p</p></td>
<td><p>y</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>p</p></td>
<td><p>z</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>3</p></td>
<td><p>d</p></td>
<td><p>xy</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>3</p></td>
<td><p>d</p></td>
<td><p>yz</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>3</p></td>
<td><p>d</p></td>
<td><p>z^2</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>3</p></td>
<td><p>d</p></td>
<td><p>xz</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>3</p></td>
<td><p>d</p></td>
<td><p>x2-y2</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>d</p></td>
<td><p>xy</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>d</p></td>
<td><p>yz</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>d</p></td>
<td><p>z^2</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>d</p></td>
<td><p>xz</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>d</p></td>
<td><p>x2-y2</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>f</p></td>
<td><p>-3</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>f</p></td>
<td><p>-2</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>f</p></td>
<td><p>-1</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>f</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>f</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>f</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>0 C</p></td>
<td><p>4</p></td>
<td><p>f</p></td>
<td><p>3</p></td>
</tr>
</tbody>
</table>
</div>
<p>The order of Cartesian GTOs is generated by the code below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">lx</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
  <span class="k">for</span> <span class="n">ly</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">lx</span><span class="p">)):</span>
    <span class="n">lz</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">-</span> <span class="n">ly</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span> <span class="o">*</span> <span class="n">lx</span> <span class="o">+</span> <span class="s1">&#39;y&#39;</span> <span class="o">*</span> <span class="n">ly</span> <span class="o">+</span> <span class="s1">&#39;z&#39;</span> <span class="o">*</span> <span class="n">lz</span>
</pre></div>
</div>
<p>For example, the Cartesian <cite>d</cite> functions are ordered as <cite>xx</cite>, <cite>xy</cite>, <cite>xz</cite>, <cite>yy</cite>, <cite>yz</cite>, <cite>zz</cite>.</p>
<blockquote>
<div><p>The ordering of the basis functions can be verified with the method <code class="xref py py-func docutils literal notranslate"><span class="pre">Mole.ao_labels()</span></code>.</p>
</div></blockquote>
</section>
<section id="ecp">
<h3>ECP<a class="headerlink" href="#ecp" title="Link to this heading">#</a></h3>
<p>Effective core potentials (ECPs) can be specified with the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.ecp</span></code>.
Scalar type ECPs are available for all molecular and crystal methods.
The built-in scalar ECP datasets include</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>Keyword</p></td>
<td><p>Comment</p></td>
</tr>
<tr class="row-even"><td><p>bfd</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>cc-pvdz-pp</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>cc-pvtz-pp</p></td>
<td><p>same to cc-pvdz-pp</p></td>
</tr>
<tr class="row-odd"><td><p>cc-pvqz-pp</p></td>
<td><p>same to cc-pvdz-pp</p></td>
</tr>
<tr class="row-even"><td><p>cc-pv5z-pp</p></td>
<td><p>same to cc-pvdz-pp</p></td>
</tr>
<tr class="row-odd"><td><p>crenbl</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>crenbs</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>def2-svp</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>def2-svpd</p></td>
<td><p>same to def2-svp</p></td>
</tr>
<tr class="row-odd"><td><p>def2-tzvp</p></td>
<td><p>same to def2-svp</p></td>
</tr>
<tr class="row-even"><td><p>def2-tzvpd</p></td>
<td><p>same to def2-svp</p></td>
</tr>
<tr class="row-odd"><td><p>def2-tzvpp</p></td>
<td><p>same to def2-svp</p></td>
</tr>
<tr class="row-even"><td><p>def2-tzvppd</p></td>
<td><p>same to def2-svp</p></td>
</tr>
<tr class="row-odd"><td><p>def2-qzvp</p></td>
<td><p>same to def2-svp</p></td>
</tr>
<tr class="row-even"><td><p>def2-qzvpd</p></td>
<td><p>same to def2-svp</p></td>
</tr>
<tr class="row-odd"><td><p>def2-qzvpp</p></td>
<td><p>same to def2-svp</p></td>
</tr>
<tr class="row-even"><td><p>def2-qzvppd</p></td>
<td><p>same to def2-svp</p></td>
</tr>
<tr class="row-odd"><td><p>lanl2dz</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>lanl2tz</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>lanl08</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>sbkjc</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>stuttgart</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>ECP parameters can be specified directly in input script using NWChem format.
Examples of ECP input can be found in <a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples/gto/05-input_ecp.py">examples/gto/05-input_ecp.py</a>.</p>
<p>Spin-orbit (SO) ECP integrals can be evaluated using PySCF’s integral driver.
However, SO-ECPs are not automatically applied to any methods in the current implementation.
They need to be added to the core Hamiltonian as shown in the examples
<a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples/gto/20-soc_ecp.py">examples/gto/20-soc_ecp.py</a> and
<a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples/scf/44-soc_ecp.py">examples/scf/44-soc_ecp.py</a>.
PySCF provides the following SO-ECPs</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>Keyword</p></td>
<td><p>Comment</p></td>
</tr>
<tr class="row-even"><td><p>crenbl</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>crenbs</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be careful with the SO-ECP conventions when inputting them directly in the
input script. SO-ECP parameters may take different conventions in different
packages. More particularly, the treatment of the factor 2/(2l+1).  PySCF
assumes that this factor has been multiplied into the SOC parameters. See also
relevant discussions in <a class="reference external" href="http://www.diracprogram.org/doc/master/molecule_and_basis/molecule_with_ecp.html">Dirac doc</a>
and <a class="reference external" href="https://nwchemgit.github.io/ECP.html">NWChem doc</a>.</p>
</div>
</section>
<section id="point-group-symmetry">
<h3>Point group symmetry<a class="headerlink" href="#point-group-symmetry" title="Link to this heading">#</a></h3>
<p>You can also invoke point group symmetry for molecular calculations
by setting the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.symmetry</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;B 0 0 0; H 0 1 1; H 1 0 1; H 1 1 0&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">symmetry</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>The point group symmetry information is held in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object.
The symmetry module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">symm</span></code>) of PySCF can detect arbitrary point groups.
The detected point group is saved in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.topgroup</span></code>,
and the supported subgroup is saved in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.groupname</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">topgroup</span><span class="p">)</span>
<span class="go">C3v</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">groupname</span><span class="p">)</span>
<span class="go">Cs</span>
</pre></div>
</div>
<p>Currently, PySCF supports linear molecular symmetries
<span class="math notranslate nohighlight">\(D_{\infty h}\)</span> (labelled as <code class="docutils literal notranslate"><span class="pre">Dooh</span></code> in the program) and <span class="math notranslate nohighlight">\(C_{\infty v}\)</span>
(labelled as <code class="docutils literal notranslate"><span class="pre">Coov</span></code>), the <span class="math notranslate nohighlight">\(D_{2h}\)</span> group and its subgroups.
Sometimes it is necessary to use a lower symmetry instead of the detected
symmetry group. The subgroup symmetry can be specified in
by <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.symmetry_subgroup</span></code> and the program will first detect the highest
possible symmetry group and then lower the point group symmetry to the specified
subgroup:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">symmetry</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">symmetry_subgroup</span> <span class="o">=</span> <span class="n">C2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">topgroup</span><span class="p">)</span>
<span class="go">Dooh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">groupname</span><span class="p">)</span>
<span class="go">C2</span>
</pre></div>
</div>
<p>When a particular symmetry is assigned to <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.symmetry</span></code>,
the initialization function <code class="xref py py-meth docutils literal notranslate"><span class="pre">Mole.build()</span></code> will test whether the molecule
geometry is subject to the required symmetry. If not, initialization will stop
and an error message will be issued:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;O 0 0 0; C 0 0 1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">symmetry</span> <span class="o">=</span> <span class="s1">&#39;Dooh&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="go">RuntimeWarning: Unable to identify input symmetry Dooh.</span>
<span class="go">Try symmetry=&quot;Coov&quot; with geometry (unit=&quot;Bohr&quot;)</span>
<span class="go">(&#39;O&#39;, [0.0, 0.0, -0.809882624813598])</span>
<span class="go">(&#39;C&#39;, [0.0, 0.0, 1.0798434997514639])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.symmetry_subgroup</span></code> has no effects
when specific symmetry group is assigned to <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.symmetry</span></code>.</p>
</div>
<p>When symmetry is enabled in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object, the point group symmetry
information will be used to construct the symmetry adapted orbital basis (see
also <code class="xref py py-mod docutils literal notranslate"><span class="pre">symm</span></code>).  The symmetry adapted orbitals are held in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.symm_orb</span></code> as a list of 2D arrays.  Each element of the list
is an AO (atomic orbital) to SO (symmetry-adapted orbital) transformation matrix
of an irreducible representation. The name of the irreducible representations
are stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.irrep_name</span></code> and their internal IDs (see more details
in <code class="xref py py-mod docutils literal notranslate"><span class="pre">symm</span></code>) are stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.irrep_id</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;O 0 0 0; O 0 0 1.2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">symmetry</span> <span class="o">=</span> <span class="s2">&quot;D2h&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">s</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">irrep_name</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">irrep_id</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">symm_orb</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">Ag 0 (10, 3)</span>
<span class="go">B2g 2 (10, 1)</span>
<span class="go">B3g 3 (10, 1)</span>
<span class="go">B1u 5 (10, 3)</span>
<span class="go">B2u 6 (10, 1)</span>
<span class="go">B3u 7 (10, 1)</span>
</pre></div>
</div>
<p>These symmetry-adapted orbitals are used as basis functions for the
following SCF or post-SCF calculations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">converged SCF energy = -147.631655286561</span>
</pre></div>
</div>
<p>and we can check the occupancy of the MOs in each irreducible representation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">symm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">myocc</span><span class="p">(</span><span class="n">mf</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">mol</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">mol</span>
<span class="gp">... </span>    <span class="n">orbsym</span> <span class="o">=</span> <span class="n">symm</span><span class="o">.</span><span class="n">label_orb_symm</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">irrep_id</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">symm_orb</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">doccsym</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">orbsym</span><span class="p">)[</span><span class="n">mf</span><span class="o">.</span><span class="n">mo_occ</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">soccsym</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">orbsym</span><span class="p">)[</span><span class="n">mf</span><span class="o">.</span><span class="n">mo_occ</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">ir</span><span class="p">,</span><span class="n">irname</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">irrep_id</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">irrep_name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">, double-occ = </span><span class="si">%d</span><span class="s1">, single-occ = </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span>
<span class="gp">... </span>              <span class="p">(</span><span class="n">irname</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">doccsym</span><span class="o">==</span><span class="n">ir</span><span class="p">),</span> <span class="nb">sum</span><span class="p">(</span><span class="n">soccsym</span><span class="o">==</span><span class="n">ir</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myocc</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="go">Ag, double-occ = 3, single-occ = 0</span>
<span class="go">B2g, double-occ = 0, single-occ = 1</span>
<span class="go">B3g, double-occ = 0, single-occ = 1</span>
<span class="go">B1u, double-occ = 2, single-occ = 0</span>
<span class="go">B2u, double-occ = 1, single-occ = 0</span>
<span class="go">B3u, double-occ = 1, single-occ = 0</span>
</pre></div>
</div>
<p>To label the irreducible representation of given orbitals,
<code class="xref py py-func docutils literal notranslate"><span class="pre">symm.label_orb_symm()</span></code> needs the information of the point group
symmetry which is initialized in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object, including the IDs of
irreducible representations (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.irrep_id</span></code>) and the symmetry
adapted basis <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.symm_orb</span></code>. For each <code class="xref py py-attr docutils literal notranslate"><span class="pre">irrep_id</span></code>,
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.irrep_name</span></code> gives the associated irrep symbol (A1, B1 …).
In the SCF calculation, you can control the symmetry of the wave
function by assigning the number of alpha electrons and beta electrons
<cite>(alpha,beta)</cite> for the irreps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">irrep_nelec</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;B2g&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;B3g&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;B2u&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;B3u&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">converged SCF energy = -146.97333043702</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">get_irrep_nelec</span><span class="p">()</span>
<span class="go">{&#39;Ag&#39;: (3, 3), &#39;B2g&#39;: (1, 1), &#39;B3g&#39;: (1, 1), &#39;B1u&#39;: (2, 2), &#39;B2u&#39;: (1, 0), &#39;B3u&#39;: (1, 0)}</span>
</pre></div>
</div>
</section>
<section id="spin-and-charge">
<h3>Spin and charge<a class="headerlink" href="#spin-and-charge" title="Link to this heading">#</a></h3>
<p>Charge and the number of unpaired electrons can be assigned to <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">mol</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.spin</span></code> is the number of unpaired electrons <em>2S</em>,
i.e. the difference between the number of alpha and beta electrons.</p>
</div>
<p>These two attributes do not affect any other parameters
in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.build</span></code> initialization function.
They can be set or modified after the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> object is initialized:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;O 0 0 0; h 0 1 0; h 0 0 1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-6g&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">nelec</span><span class="p">)</span>
<span class="go">(6, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">nelec</span><span class="p">)</span>
<span class="go">(5, 5)</span>
</pre></div>
</div>
<p>The attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.charge</span></code> is the parameter to define the total number of electrons in the
system. For custom systems such as the Hubbard lattice model, the total number
of electrons needs to be specified directly by setting the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mole.nelectron</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">nelectron</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
</section>
<section id="other-parameters">
<h3>Other parameters<a class="headerlink" href="#other-parameters" title="Link to this heading">#</a></h3>
<p>You can assign more information to the molecular object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">nucmod</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;O1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span> <span class="c1"># nuclear charge model: 0-point charge, 1-Gaussian distribution</span>
<span class="n">mol</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;O1&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>  <span class="c1"># atomic mass</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples/gto/07-nucmod.py">examples/gto/07-nucmod.py</a> for more examples of nuclear charge models.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> class also defines some global parameters.  You can control the
print level globally with <code class="xref py py-attr docutils literal notranslate"><span class="pre">verbose</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>The print level can be 0 (quiet, no output) to 9 (very noisy).  The
most useful messages are printed at level 4 (info) and 5 (debug).  You
can also specify a place where to write the output messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;path/to/log.txt&#39;</span>
</pre></div>
</div>
<p>If this variable is not assigned, messages will be dumped to
<code class="xref py py-attr docutils literal notranslate"><span class="pre">sys.stdout</span></code>.</p>
<p>The maximum memory usage can be controlled globally:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">max_memory</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># MB</span>
</pre></div>
</div>
<p>The default size can also be defined with the shell environment
variable <cite>PYSCF_MAX_MEMORY</cite>.</p>
<p>The attributes <code class="xref py py-attr docutils literal notranslate"><span class="pre">output</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">max_memory</span></code> can also be
assigned from command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python input.py -o /path/to/my_log.txt -m 1000
</pre></div>
</div>
<p>By default, command line has the highest priority, which means the
settings in the script will be overwritten by the command line arguments.
To make the input parser ignore the command line arguments, you can call the
<code class="xref py py-func docutils literal notranslate"><span class="pre">Mole.build()</span></code> with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The first <code class="docutils literal notranslate"><span class="pre">0</span></code> prevent <code class="xref py py-func docutils literal notranslate"><span class="pre">build()</span></code> dumping the input file.
The second <code class="docutils literal notranslate"><span class="pre">0</span></code> prevent <code class="xref py py-func docutils literal notranslate"><span class="pre">build()</span></code> parsing the command line arguments.</p>
</section>
</section>
<section id="access-ao-integrals">
<h2>Access AO integrals<a class="headerlink" href="#access-ao-integrals" title="Link to this heading">#</a></h2>
<p>PySCF uses <a class="reference external" href="https://github.com/sunqm/libcint">libcint</a> library as the AO
integral engine. A simple interface function <code class="xref py py-func docutils literal notranslate"><span class="pre">Mole.intor()</span></code> is provided
to obtain the one- and two-electron AO integrals:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kin</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int1e_kin&#39;</span><span class="p">)</span>
<span class="n">vnuc</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int1e_nuc&#39;</span><span class="p">)</span>
<span class="n">overlap</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int1e_ovlp&#39;</span><span class="p">)</span>
<span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For a full list of supported AO integrals, see <a class="reference internal" href="../pyscf_api_docs/pyscf.gto.html#module-pyscf.gto.moleintor"><span class="std std-ref">pyscf.gto.moleintor module</span></a>.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="using.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">How to use PySCF</p>
      </div>
    </a>
    <a class="right-next"
       href="pbcgto.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Crystal structure</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initializing-a-molecule">Initializing a molecule</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geometry">Geometry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basis-set">Basis set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basis-format">Basis format</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ordering-of-basis-functions">Ordering of basis functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ecp">ECP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#point-group-symmetry">Point group symmetry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spin-and-charge">Spin and charge</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#other-parameters">Other parameters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#access-ao-integrals">Access AO integrals</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/pyscf/pyscf.github.io/edit/master/source/user/gto.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, The PySCF Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>