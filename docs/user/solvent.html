
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>4.13. Solvation models &#8212; PySCF 2.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.14. QM/MM methods" href="qmmm.html" />
    <link rel="prev" title="Time-dependent Hartree-Fock and density functional theory" href="tddft.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=amber>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#user/solvent" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="PySCF 2.0.0 documentation"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/pyscf-logo-white.svg" height="26"
                   alt="PySCF 2.0.0 documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.0</span>
          <span class="md-header-nav__topic"> 4.13. Solvation models </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../overview.html" class="md-tabs__link">Overview</a></li>
            
            <li class="md-tabs__item"><a href="../install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../quickstart.html" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../pyscf_api_docs/modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../about.html" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="PySCF 2.0.0 documentation" class="md-nav__button md-logo">
      
        <img src="../_static/pyscf-logo-white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="PySCF 2.0.0 documentation">PySCF 2.0</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html" class="md-nav__link">2. Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickstart.html" class="md-nav__link">Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../user.html" class="md-nav__link">User Guide</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="gto.html" class="md-nav__link">4.1. Molecular structure</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="scf.html" class="md-nav__link">4.2. Self-consistent field (SCF) methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dft.html" class="md-nav__link">Density functional theory (DFT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mp.html" class="md-nav__link">Second-order Møller–Plesset perturbation theory (MP2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="gw.html" class="md-nav__link">4.5. GW approximation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ci.html" class="md-nav__link">Configuration interaction (CISD and FCI)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cc.html" class="md-nav__link">4.7. Coupled-cluster theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="adc.html" class="md-nav__link">Algebraic diagrammatic construction (ADC)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="agf2.html" class="md-nav__link">Auxiliary second-order Green’s function perturbation theory (AGF2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mcscf.html" class="md-nav__link">Multi-configuration self-consistent field (MCSCF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mrpt.html" class="md-nav__link">Multi-reference perturbation theory (MRPT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tddft.html" class="md-nav__link">Time-dependent Hartree-Fock and density functional theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> 4.13. Solvation models </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">4.13. Solvation models</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-solvent--page-root" class="md-nav__link">4.13. Solvation models</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">4.13.1. Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#ddcosmo" class="md-nav__link">4.13.2. ddCOSMO</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#self-consistent-solvents-for-ground-state" class="md-nav__link">4.13.2.1. Self-consistent solvents for ground state</a>
        </li>
        <li class="md-nav__item"><a href="#solvent-for-excited-states" class="md-nav__link">4.13.2.2. Solvent for excited states</a>
        </li>
        <li class="md-nav__item"><a href="#solvent-parameters" class="md-nav__link">4.13.2.3. Solvent parameters</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#polarizable-embedding" class="md-nav__link">4.13.3. Polarizable embedding</a>
        </li>
        <li class="md-nav__item"><a href="#references" class="md-nav__link">4.13.4. References</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/user/solvent.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="qmmm.html" class="md-nav__link">4.14. QM/MM methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="df.html" class="md-nav__link">Density fitting (DF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pbc.html" class="md-nav__link">4.16. Periodic boundary conditions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="eph.html" class="md-nav__link">Electron-phonon coupling</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lo.html" class="md-nav__link">Localized orbitals</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sgx.html" class="md-nav__link">Seminumerical exchange (SGX)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="geomopt.html" class="md-nav__link">4.20. Geometry optimization</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../pyscf_api_docs/pyscf.html" class="md-nav__link">5. API</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../interface.html" class="md-nav__link">6. Interface</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about.html" class="md-nav__link">7. About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-solvent--page-root" class="md-nav__link">4.13. Solvation models</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">4.13.1. Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#ddcosmo" class="md-nav__link">4.13.2. ddCOSMO</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#self-consistent-solvents-for-ground-state" class="md-nav__link">4.13.2.1. Self-consistent solvents for ground state</a>
        </li>
        <li class="md-nav__item"><a href="#solvent-for-excited-states" class="md-nav__link">4.13.2.2. Solvent for excited states</a>
        </li>
        <li class="md-nav__item"><a href="#solvent-parameters" class="md-nav__link">4.13.2.3. Solvent parameters</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#polarizable-embedding" class="md-nav__link">4.13.3. Polarizable embedding</a>
        </li>
        <li class="md-nav__item"><a href="#references" class="md-nav__link">4.13.4. References</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/user/solvent.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<span id="user-solvent"></span><h1 id="user-solvent--page-root">Solvation models<a class="headerlink" href="#user-solvent--page-root" title="Permalink to this headline">¶</a></h1>
<p><em>Modules</em>: <a class="reference internal" href="#module-solvent" title="solvent: Solvation models and solvent effects"><code class="xref py py-mod docutils literal notranslate"><span class="pre">solvent</span></code></a></p>
<span class="target" id="module-solvent"></span>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Solvation model allows the quantum chemistry calculations to include the
interactions between solvents and the quantum solute. Solvents can be treated
implicitly, known as continuum solvents, and explicitly. For continuum solvents,
we implemented the ddCOSMO (domain-decomposition COSMO solvation model). For
the explicit solvent environment, we provided the interface to call the
polarizable embedding library CPPE.</p>


<h2 id="ddcosmo">ddCOSMO<a class="headerlink" href="#ddcosmo" title="Permalink to this headline">¶</a></h2>

<h3 id="self-consistent-solvents-for-ground-state">Self-consistent solvents for ground state<a class="headerlink" href="#self-consistent-solvents-for-ground-state" title="Permalink to this headline">¶</a></h3>
<p>Solvent model can be applied on to an SCF object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="s1">'b3lyp'</span><span class="p">)</span><span class="o">.</span><span class="n">DDCOSMO</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>In regular MCSCF (CASCI or CASSCF), and post-SCF calculations, the setup for
self-consistent solvent is similar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">DDCOSMO</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">mp2_model</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">MP2</span><span class="p">()</span><span class="o">.</span><span class="n">DDCOSMO</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>


<h3 id="solvent-for-excited-states">Solvent for excited states<a class="headerlink" href="#solvent-for-excited-states" title="Permalink to this headline">¶</a></h3>
<p>When combining to TDDFT or other methods of excited states, solvent can be
modelled in the manner of self-consistency (fast solvent) or single shot (slow
solvent). Below we use TDDFT to demonstrate the treatments of fast solvent
and slow solvent.</p>
<p>In vertical excitations, the solvent almost does not respond to the change of
electronic structure. It should be viewed as slow solvent. The calculation
can be started with an SCF with fully relaxed solvent and followed by a regular
TDDFT method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">ddCOSMO</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">td</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">TDA</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>In the diabatic excitations, we would like to let the solvent rapidly responds
to the electronic structure of excited states. The entire solvation system
should converge to an equilibrium state between solvent and the excited state of
the solute. In this scenario, solvent model should be applied on to the excited
state methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">ddCOSMO</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">td</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">TDA</span><span class="p">()</span><span class="o">.</span><span class="n">ddCOSMO</span><span class="p">()</span>
<span class="n">td</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">equilibrium_solvation</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">td</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Please note that the flag <code class="docutils literal notranslate"><span class="pre">equilibrium_solvation</span></code> needs to be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>
in this case. PySCF by default assumes the slow solvent model for TDDFT.</p>
<p>In the complicated procedure which involves for example electronic states from
different states (typically in the MCSCF calculations with state-average or
state-specific approximations), PySCF ddCOSMO implementation allows to input a
density matrix and freeze the solvent equilibrated against the input density
matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">DDCOSMO</span><span class="p">()</span>
<span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">nstates</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">mc</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">state_id</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Slow solvent wrt the first excited state</span>
<span class="n">mc</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The slow solvent does not have to be corresponding to a particular state. It can
be even the solvent from a different geometry or an artificial quantum state of
solute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">scf_dm</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    1.035   -1.082</span>
<span class="s1">     H  0.   -1.035   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">DDCOSMO</span><span class="p">(</span><span class="n">dm</span><span class="o">=</span><span class="n">scf_dm</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>


<h3 id="solvent-parameters">Solvent parameters<a class="headerlink" href="#solvent-parameters" title="Permalink to this headline">¶</a></h3>
<p>The default solvent in the ddCOSMO module is water. When studying other types of
solvents, you can consider to modify the dielectric parameter <code class="docutils literal notranslate"><span class="pre">eps</span></code> using the
constants listed below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">ddCOSMO</span><span class="p">()</span>
<span class="n">mf</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="mf">32.613</span>   <span class="c1"># methanol</span>
<span class="n">mf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>These dielectric constants are obtained from <a class="reference external" href="https://gaussian.com/scrf/">https://gaussian.com/scrf/</a>.
More dataset can be found in Minnesota Solvent Descriptor Database
(<a class="reference external" href="https://comp.chem.umn.edu/solvation">https://comp.chem.umn.edu/solvation</a>)</p>
<table>
<colgroup>
<col style="width: 63%"/>
<col style="width: 37%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Solvent</p></th>
<th class="head"><p>dielectric constant</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Water</p></td>
<td><p>78.3553</p></td>
</tr>
<tr class="row-odd"><td><p>Acetonitrile</p></td>
<td><p>35.688</p></td>
</tr>
<tr class="row-even"><td><p>Methanol</p></td>
<td><p>32.613</p></td>
</tr>
<tr class="row-odd"><td><p>Ethanol</p></td>
<td><p>24.852</p></td>
</tr>
<tr class="row-even"><td><p>IsoQuinoline</p></td>
<td><p>11.00</p></td>
</tr>
<tr class="row-odd"><td><p>Quinoline</p></td>
<td><p>9.16</p></td>
</tr>
<tr class="row-even"><td><p>Chloroform</p></td>
<td><p>4.7113</p></td>
</tr>
<tr class="row-odd"><td><p>DiethylEther</p></td>
<td><p>4.2400</p></td>
</tr>
<tr class="row-even"><td><p>Dichloromethane</p></td>
<td><p>8.93</p></td>
</tr>
<tr class="row-odd"><td><p>DiChloroEthane</p></td>
<td><p>10.125</p></td>
</tr>
<tr class="row-even"><td><p>CarbonTetraChloride</p></td>
<td><p>2.2280</p></td>
</tr>
<tr class="row-odd"><td><p>Benzene</p></td>
<td><p>2.2706</p></td>
</tr>
<tr class="row-even"><td><p>Toluene</p></td>
<td><p>2.3741</p></td>
</tr>
<tr class="row-odd"><td><p>ChloroBenzene</p></td>
<td><p>5.6968</p></td>
</tr>
<tr class="row-even"><td><p>NitroMethane</p></td>
<td><p>36.562</p></td>
</tr>
<tr class="row-odd"><td><p>Heptane</p></td>
<td><p>1.9113</p></td>
</tr>
<tr class="row-even"><td><p>CycloHexane</p></td>
<td><p>2.0165</p></td>
</tr>
<tr class="row-odd"><td><p>Aniline</p></td>
<td><p>6.8882</p></td>
</tr>
<tr class="row-even"><td><p>Acetone</p></td>
<td><p>20.493</p></td>
</tr>
<tr class="row-odd"><td><p>TetraHydroFuran</p></td>
<td><p>7.4257</p></td>
</tr>
<tr class="row-even"><td><p>DiMethylSulfoxide</p></td>
<td><p>46.826</p></td>
</tr>
<tr class="row-odd"><td><p>Argon</p></td>
<td><p>1.430</p></td>
</tr>
<tr class="row-even"><td><p>Krypton</p></td>
<td><p>1.519</p></td>
</tr>
<tr class="row-odd"><td><p>Xenon</p></td>
<td><p>1.706</p></td>
</tr>
<tr class="row-even"><td><p>n-Octanol</p></td>
<td><p>9.8629</p></td>
</tr>
<tr class="row-odd"><td><p>1,1,1-TriChloroEthane</p></td>
<td><p>7.0826</p></td>
</tr>
<tr class="row-even"><td><p>1,1,2-TriChloroEthane</p></td>
<td><p>7.1937</p></td>
</tr>
<tr class="row-odd"><td><p>1,2,4-TriMethylBenzene</p></td>
<td><p>2.3653</p></td>
</tr>
<tr class="row-even"><td><p>1,2-DiBromoEthane</p></td>
<td><p>4.9313</p></td>
</tr>
<tr class="row-odd"><td><p>1,2-EthaneDiol</p></td>
<td><p>40.245</p></td>
</tr>
<tr class="row-even"><td><p>1,4-Dioxane</p></td>
<td><p>2.2099</p></td>
</tr>
<tr class="row-odd"><td><p>1-Bromo-2-MethylPropane</p></td>
<td><p>7.7792</p></td>
</tr>
<tr class="row-even"><td><p>1-BromoOctane</p></td>
<td><p>5.0244</p></td>
</tr>
<tr class="row-odd"><td><p>1-BromoPentane</p></td>
<td><p>6.269</p></td>
</tr>
<tr class="row-even"><td><p>1-BromoPropane</p></td>
<td><p>8.0496</p></td>
</tr>
<tr class="row-odd"><td><p>1-Butanol</p></td>
<td><p>17.332</p></td>
</tr>
<tr class="row-even"><td><p>1-ChloroHexane</p></td>
<td><p>5.9491</p></td>
</tr>
<tr class="row-odd"><td><p>1-ChloroPentane</p></td>
<td><p>6.5022</p></td>
</tr>
<tr class="row-even"><td><p>1-ChloroPropane</p></td>
<td><p>8.3548</p></td>
</tr>
<tr class="row-odd"><td><p>1-Decanol</p></td>
<td><p>7.5305</p></td>
</tr>
<tr class="row-even"><td><p>1-FluoroOctane</p></td>
<td><p>3.89</p></td>
</tr>
<tr class="row-odd"><td><p>1-Heptanol</p></td>
<td><p>11.321</p></td>
</tr>
<tr class="row-even"><td><p>1-Hexanol</p></td>
<td><p>12.51</p></td>
</tr>
<tr class="row-odd"><td><p>1-Hexene</p></td>
<td><p>2.0717</p></td>
</tr>
<tr class="row-even"><td><p>1-Hexyne</p></td>
<td><p>2.615</p></td>
</tr>
<tr class="row-odd"><td><p>1-IodoButane</p></td>
<td><p>6.173</p></td>
</tr>
<tr class="row-even"><td><p>1-IodoHexaDecane</p></td>
<td><p>3.5338</p></td>
</tr>
<tr class="row-odd"><td><p>1-IodoPentane</p></td>
<td><p>5.6973</p></td>
</tr>
<tr class="row-even"><td><p>1-IodoPropane</p></td>
<td><p>6.9626</p></td>
</tr>
<tr class="row-odd"><td><p>1-NitroPropane</p></td>
<td><p>23.73</p></td>
</tr>
<tr class="row-even"><td><p>1-Nonanol</p></td>
<td><p>8.5991</p></td>
</tr>
<tr class="row-odd"><td><p>1-Pentanol</p></td>
<td><p>15.13</p></td>
</tr>
<tr class="row-even"><td><p>1-Pentene</p></td>
<td><p>1.9905</p></td>
</tr>
<tr class="row-odd"><td><p>1-Propanol</p></td>
<td><p>20.524</p></td>
</tr>
<tr class="row-even"><td><p>2,2,2-TriFluoroEthanol</p></td>
<td><p>26.726</p></td>
</tr>
<tr class="row-odd"><td><p>2,2,4-TriMethylPentane</p></td>
<td><p>1.9358</p></td>
</tr>
<tr class="row-even"><td><p>2,4-DiMethylPentane</p></td>
<td><p>1.8939</p></td>
</tr>
<tr class="row-odd"><td><p>2,4-DiMethylPyridine</p></td>
<td><p>9.4176</p></td>
</tr>
<tr class="row-even"><td><p>2,6-DiMethylPyridine</p></td>
<td><p>7.1735</p></td>
</tr>
<tr class="row-odd"><td><p>2-BromoPropane</p></td>
<td><p>9.3610</p></td>
</tr>
<tr class="row-even"><td><p>2-Butanol</p></td>
<td><p>15.944</p></td>
</tr>
<tr class="row-odd"><td><p>2-ChloroButane</p></td>
<td><p>8.3930</p></td>
</tr>
<tr class="row-even"><td><p>2-Heptanone</p></td>
<td><p>11.658</p></td>
</tr>
<tr class="row-odd"><td><p>2-Hexanone</p></td>
<td><p>14.136</p></td>
</tr>
<tr class="row-even"><td><p>2-MethoxyEthanol</p></td>
<td><p>17.2</p></td>
</tr>
<tr class="row-odd"><td><p>2-Methyl-1-Propanol</p></td>
<td><p>16.777</p></td>
</tr>
<tr class="row-even"><td><p>2-Methyl-2-Propanol</p></td>
<td><p>12.47</p></td>
</tr>
<tr class="row-odd"><td><p>2-MethylPentane</p></td>
<td><p>1.89</p></td>
</tr>
<tr class="row-even"><td><p>2-MethylPyridine</p></td>
<td><p>9.9533</p></td>
</tr>
<tr class="row-odd"><td><p>2-NitroPropane</p></td>
<td><p>25.654</p></td>
</tr>
<tr class="row-even"><td><p>2-Octanone</p></td>
<td><p>9.4678</p></td>
</tr>
<tr class="row-odd"><td><p>2-Pentanone</p></td>
<td><p>15.200</p></td>
</tr>
<tr class="row-even"><td><p>2-Propanol</p></td>
<td><p>19.264</p></td>
</tr>
<tr class="row-odd"><td><p>2-Propen-1-ol</p></td>
<td><p>19.011</p></td>
</tr>
<tr class="row-even"><td><p>3-MethylPyridine</p></td>
<td><p>11.645</p></td>
</tr>
<tr class="row-odd"><td><p>3-Pentanone</p></td>
<td><p>16.78</p></td>
</tr>
<tr class="row-even"><td><p>4-Heptanone</p></td>
<td><p>12.257</p></td>
</tr>
<tr class="row-odd"><td><p>4-Methyl-2-Pentanone</p></td>
<td><p>12.887</p></td>
</tr>
<tr class="row-even"><td><p>4-MethylPyridine</p></td>
<td><p>11.957</p></td>
</tr>
<tr class="row-odd"><td><p>5-Nonanone</p></td>
<td><p>10.6</p></td>
</tr>
<tr class="row-even"><td><p>AceticAcid</p></td>
<td><p>6.2528</p></td>
</tr>
<tr class="row-odd"><td><p>AcetoPhenone</p></td>
<td><p>17.44</p></td>
</tr>
<tr class="row-even"><td><p>a-ChloroToluene</p></td>
<td><p>6.7175</p></td>
</tr>
<tr class="row-odd"><td><p>Anisole</p></td>
<td><p>4.2247</p></td>
</tr>
<tr class="row-even"><td><p>Benzaldehyde</p></td>
<td><p>18.220</p></td>
</tr>
<tr class="row-odd"><td><p>BenzoNitrile</p></td>
<td><p>25.592</p></td>
</tr>
<tr class="row-even"><td><p>BenzylAlcohol</p></td>
<td><p>12.457</p></td>
</tr>
<tr class="row-odd"><td><p>BromoBenzene</p></td>
<td><p>5.3954</p></td>
</tr>
<tr class="row-even"><td><p>BromoEthane</p></td>
<td><p>9.01</p></td>
</tr>
<tr class="row-odd"><td><p>Bromoform</p></td>
<td><p>4.2488</p></td>
</tr>
<tr class="row-even"><td><p>Butanal</p></td>
<td><p>13.45</p></td>
</tr>
<tr class="row-odd"><td><p>ButanoicAcid</p></td>
<td><p>2.9931</p></td>
</tr>
<tr class="row-even"><td><p>Butanone</p></td>
<td><p>18.246</p></td>
</tr>
<tr class="row-odd"><td><p>ButanoNitrile</p></td>
<td><p>24.291</p></td>
</tr>
<tr class="row-even"><td><p>ButylAmine</p></td>
<td><p>4.6178</p></td>
</tr>
<tr class="row-odd"><td><p>ButylEthanoate</p></td>
<td><p>4.9941</p></td>
</tr>
<tr class="row-even"><td><p>CarbonDiSulfide</p></td>
<td><p>2.6105</p></td>
</tr>
<tr class="row-odd"><td><p>Cis-1,2-DiMethylCycloHexane</p></td>
<td><p>2.06</p></td>
</tr>
<tr class="row-even"><td><p>Cis-Decalin</p></td>
<td><p>2.2139</p></td>
</tr>
<tr class="row-odd"><td><p>CycloHexanone</p></td>
<td><p>15.619</p></td>
</tr>
<tr class="row-even"><td><p>CycloPentane</p></td>
<td><p>1.9608</p></td>
</tr>
<tr class="row-odd"><td><p>CycloPentanol</p></td>
<td><p>16.989</p></td>
</tr>
<tr class="row-even"><td><p>CycloPentanone</p></td>
<td><p>13.58</p></td>
</tr>
<tr class="row-odd"><td><p>Decalin-mixture</p></td>
<td><p>2.196</p></td>
</tr>
<tr class="row-even"><td><p>DiBromomEthane</p></td>
<td><p>7.2273</p></td>
</tr>
<tr class="row-odd"><td><p>DiButylEther</p></td>
<td><p>3.0473</p></td>
</tr>
<tr class="row-even"><td><p>DiEthylAmine</p></td>
<td><p>3.5766</p></td>
</tr>
<tr class="row-odd"><td><p>DiEthylSulfide</p></td>
<td><p>5.723</p></td>
</tr>
<tr class="row-even"><td><p>DiIodoMethane</p></td>
<td><p>5.32</p></td>
</tr>
<tr class="row-odd"><td><p>DiIsoPropylEther</p></td>
<td><p>3.38</p></td>
</tr>
<tr class="row-even"><td><p>DiMethylDiSulfide</p></td>
<td><p>9.6</p></td>
</tr>
<tr class="row-odd"><td><p>DiPhenylEther</p></td>
<td><p>3.73</p></td>
</tr>
<tr class="row-even"><td><p>DiPropylAmine</p></td>
<td><p>2.9112</p></td>
</tr>
<tr class="row-odd"><td><p>e-1,2-DiChloroEthene</p></td>
<td><p>2.14</p></td>
</tr>
<tr class="row-even"><td><p>e-2-Pentene</p></td>
<td><p>2.051</p></td>
</tr>
<tr class="row-odd"><td><p>EthaneThiol</p></td>
<td><p>6.667</p></td>
</tr>
<tr class="row-even"><td><p>EthylBenzene</p></td>
<td><p>2.4339</p></td>
</tr>
<tr class="row-odd"><td><p>EthylEthanoate</p></td>
<td><p>5.9867</p></td>
</tr>
<tr class="row-even"><td><p>EthylMethanoate</p></td>
<td><p>8.3310</p></td>
</tr>
<tr class="row-odd"><td><p>EthylPhenylEther</p></td>
<td><p>4.1797</p></td>
</tr>
<tr class="row-even"><td><p>FluoroBenzene</p></td>
<td><p>5.42</p></td>
</tr>
<tr class="row-odd"><td><p>Formamide</p></td>
<td><p>108.94</p></td>
</tr>
<tr class="row-even"><td><p>FormicAcid</p></td>
<td><p>51.1</p></td>
</tr>
<tr class="row-odd"><td><p>HexanoicAcid</p></td>
<td><p>2.6</p></td>
</tr>
<tr class="row-even"><td><p>IodoBenzene</p></td>
<td><p>4.5470</p></td>
</tr>
<tr class="row-odd"><td><p>IodoEthane</p></td>
<td><p>7.6177</p></td>
</tr>
<tr class="row-even"><td><p>IodoMethane</p></td>
<td><p>6.8650</p></td>
</tr>
<tr class="row-odd"><td><p>IsoPropylBenzene</p></td>
<td><p>2.3712</p></td>
</tr>
<tr class="row-even"><td><p>m-Cresol</p></td>
<td><p>12.44</p></td>
</tr>
<tr class="row-odd"><td><p>Mesitylene</p></td>
<td><p>2.2650</p></td>
</tr>
<tr class="row-even"><td><p>MethylBenzoate</p></td>
<td><p>6.7367</p></td>
</tr>
<tr class="row-odd"><td><p>MethylButanoate</p></td>
<td><p>5.5607</p></td>
</tr>
<tr class="row-even"><td><p>MethylCycloHexane</p></td>
<td><p>2.024</p></td>
</tr>
<tr class="row-odd"><td><p>MethylEthanoate</p></td>
<td><p>6.8615</p></td>
</tr>
<tr class="row-even"><td><p>MethylMethanoate</p></td>
<td><p>8.8377</p></td>
</tr>
<tr class="row-odd"><td><p>MethylPropanoate</p></td>
<td><p>6.0777</p></td>
</tr>
<tr class="row-even"><td><p>m-Xylene</p></td>
<td><p>2.3478</p></td>
</tr>
<tr class="row-odd"><td><p>n-ButylBenzene</p></td>
<td><p>2.36</p></td>
</tr>
<tr class="row-even"><td><p>n-Decane</p></td>
<td><p>1.9846</p></td>
</tr>
<tr class="row-odd"><td><p>n-Dodecane</p></td>
<td><p>2.0060</p></td>
</tr>
<tr class="row-even"><td><p>n-Hexadecane</p></td>
<td><p>2.0402</p></td>
</tr>
<tr class="row-odd"><td><p>n-Hexane</p></td>
<td><p>1.8819</p></td>
</tr>
<tr class="row-even"><td><p>NitroBenzene</p></td>
<td><p>34.809</p></td>
</tr>
<tr class="row-odd"><td><p>NitroEthane</p></td>
<td><p>28.29</p></td>
</tr>
<tr class="row-even"><td><p>n-MethylAniline</p></td>
<td><p>5.9600</p></td>
</tr>
<tr class="row-odd"><td><p>n-MethylFormamide-mixture</p></td>
<td><p>181.56</p></td>
</tr>
<tr class="row-even"><td><p>n,n-DiMethylAcetamide</p></td>
<td><p>37.781</p></td>
</tr>
<tr class="row-odd"><td><p>n,n-DiMethylFormamide</p></td>
<td><p>37.219</p></td>
</tr>
<tr class="row-even"><td><p>n-Nonane</p></td>
<td><p>1.9605</p></td>
</tr>
<tr class="row-odd"><td><p>n-Octane</p></td>
<td><p>1.9406</p></td>
</tr>
<tr class="row-even"><td><p>n-Pentadecane</p></td>
<td><p>2.0333</p></td>
</tr>
<tr class="row-odd"><td><p>n-Pentane</p></td>
<td><p>1.8371</p></td>
</tr>
<tr class="row-even"><td><p>n-Undecane</p></td>
<td><p>1.9910</p></td>
</tr>
<tr class="row-odd"><td><p>o-ChloroToluene</p></td>
<td><p>4.6331</p></td>
</tr>
<tr class="row-even"><td><p>o-Cresol</p></td>
<td><p>6.76</p></td>
</tr>
<tr class="row-odd"><td><p>o-DiChloroBenzene</p></td>
<td><p>9.9949</p></td>
</tr>
<tr class="row-even"><td><p>o-NitroToluene</p></td>
<td><p>25.669</p></td>
</tr>
<tr class="row-odd"><td><p>o-Xylene</p></td>
<td><p>2.5454</p></td>
</tr>
<tr class="row-even"><td><p>Pentanal</p></td>
<td><p>10.0</p></td>
</tr>
<tr class="row-odd"><td><p>PentanoicAcid</p></td>
<td><p>2.6924</p></td>
</tr>
<tr class="row-even"><td><p>PentylAmine</p></td>
<td><p>4.2010</p></td>
</tr>
<tr class="row-odd"><td><p>PentylEthanoate</p></td>
<td><p>4.7297</p></td>
</tr>
<tr class="row-even"><td><p>PerFluoroBenzene</p></td>
<td><p>2.029</p></td>
</tr>
<tr class="row-odd"><td><p>p-IsoPropylToluene</p></td>
<td><p>2.2322</p></td>
</tr>
<tr class="row-even"><td><p>Propanal</p></td>
<td><p>18.5</p></td>
</tr>
<tr class="row-odd"><td><p>PropanoicAcid</p></td>
<td><p>3.44</p></td>
</tr>
<tr class="row-even"><td><p>PropanoNitrile</p></td>
<td><p>29.324</p></td>
</tr>
<tr class="row-odd"><td><p>PropylAmine</p></td>
<td><p>4.9912</p></td>
</tr>
<tr class="row-even"><td><p>PropylEthanoate</p></td>
<td><p>5.5205</p></td>
</tr>
<tr class="row-odd"><td><p>p-Xylene</p></td>
<td><p>2.2705</p></td>
</tr>
<tr class="row-even"><td><p>Pyridine</p></td>
<td><p>12.978</p></td>
</tr>
<tr class="row-odd"><td><p>sec-ButylBenzene</p></td>
<td><p>2.3446</p></td>
</tr>
<tr class="row-even"><td><p>tert-ButylBenzene</p></td>
<td><p>2.3447</p></td>
</tr>
<tr class="row-odd"><td><p>TetraChloroEthene</p></td>
<td><p>2.268</p></td>
</tr>
<tr class="row-even"><td><p>TetraHydroThiophene-s,s-dioxide</p></td>
<td><p>43.962</p></td>
</tr>
<tr class="row-odd"><td><p>Tetralin</p></td>
<td><p>2.771</p></td>
</tr>
<tr class="row-even"><td><p>Thiophene</p></td>
<td><p>2.7270</p></td>
</tr>
<tr class="row-odd"><td><p>Thiophenol</p></td>
<td><p>4.2728</p></td>
</tr>
<tr class="row-even"><td><p>trans-Decalin</p></td>
<td><p>2.1781</p></td>
</tr>
<tr class="row-odd"><td><p>TriButylPhosphate</p></td>
<td><p>8.1781</p></td>
</tr>
<tr class="row-even"><td><p>TriChloroEthene</p></td>
<td><p>3.422</p></td>
</tr>
<tr class="row-odd"><td><p>TriEthylAmine</p></td>
<td><p>2.3832</p></td>
</tr>
<tr class="row-even"><td><p>Xylene-mixture</p></td>
<td><p>2.3879</p></td>
</tr>
<tr class="row-odd"><td><p>z-1,2-DiChloroEthene</p></td>
<td><p>9.2</p></td>
</tr>
</tbody>
</table>



<h2 id="polarizable-embedding">Polarizable embedding<a class="headerlink" href="#polarizable-embedding" title="Permalink to this headline">¶</a></h2>
<p>To use polarizable embedding model for mean-field calculations, one would need
to first generate potential data for the input of CPPE library. The best way to
generate potential files is with <a class="reference external" href="https://gitlab.com/FraME-projects/PyFraME">PyFraME</a>.
You can directly throw in a pdb file, select the QM region and how to parametrize
different parts of the environment (with either pre-defined potentials, or with LoProp).
Some guidance is also provided in the Tutorial Review paper about PE, section 4:
<a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/qua.25717">https://onlinelibrary.wiley.com/doi/full/10.1002/qua.25717</a>
Therein, the format of the potential file is also explained (it’s the same
format as used in the original Dalton pelib implementation).</p>
<p>With the generated potential file, one can carry out the polarizable embedding
calculations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="s1">'b3lyp'</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">solvent</span><span class="o">.</span><span class="n">PE</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="s1">'potfile'</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>


<h2 id="references">References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-user/solvent-0"></p>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="tddft.html" title="Time-dependent Hartree-Fock and density functional theory"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Time-dependent Hartree-Fock and density functional theory </span>
              </div>
            </a>
          
          
            <a href="qmmm.html" title="4.14. QM/MM methods"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> <span class="section-number">4.14. </span>QM/MM methods </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>