<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Solvation models &#8212; PySCF</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf.css?v=9b431c29" />
    <script src="../_static/documentation_options.js?v=3db9c557"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="QM/MM methods" href="qmmm.html" />
    <link rel="prev" title="Time-dependent Hartree-Fock and density functional theory" href="tddft.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=pyscf data-md-color-accent=pyscf>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#user/solvent" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="PySCF"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.6</span>
          <span class="md-header-nav__topic"> Solvation models </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../quickstart.html" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../develop.html" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="../pyscf_api_docs/modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../about.html" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="PySCF" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="PySCF">PySCF 2.6</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../install.html" class="md-nav__link">Install PySCF</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#advanced-build-options" class="md-nav__link">Advanced build options</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#install-pyscf-extensions" class="md-nav__link">Install PySCF extensions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#troubleshooting" class="md-nav__link">Troubleshooting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickstart.html" class="md-nav__link">Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../user.html" class="md-nav__link">User Guide</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="gto.html" class="md-nav__link">Molecular structure</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="scf.html" class="md-nav__link">Self-consistent field (SCF) methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dft.html" class="md-nav__link">Density functional theory (DFT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mp.html" class="md-nav__link">Second-order Møller–Plesset perturbation theory (MP2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="gw.html" class="md-nav__link">GW approximation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ci.html" class="md-nav__link">Configuration interaction (CISD and FCI)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cc.html" class="md-nav__link">Coupled-cluster theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="adc.html" class="md-nav__link">Algebraic diagrammatic construction (ADC)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="agf2.html" class="md-nav__link">Auxiliary second-order Green’s function perturbation theory (AGF2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mcscf.html" class="md-nav__link">Multi-configuration self-consistent field (MCSCF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mrpt.html" class="md-nav__link">Multi-reference perturbation theory (MRPT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tddft.html" class="md-nav__link">Time-dependent Hartree-Fock and density functional theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Solvation models </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Solvation models</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-solvent--page-root" class="md-nav__link">Solvation models</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#pcm-model" class="md-nav__link">PCM model</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#solvent-for-excited-states" class="md-nav__link">Solvent for excited states</a>
        </li>
        <li class="md-nav__item"><a href="#solvent-parameters" class="md-nav__link">Solvent parameters</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#ddcosmo" class="md-nav__link">ddCOSMO</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#self-consistent-solvents-for-ground-state" class="md-nav__link">Self-consistent solvents for ground state</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#smd-model" class="md-nav__link">SMD model</a>
        </li>
        <li class="md-nav__item"><a href="#polarizable-embedding" class="md-nav__link">Polarizable embedding</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/user/solvent.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="qmmm.html" class="md-nav__link">QM/MM methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="md.html" class="md-nav__link">Molecular Dynamics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="df.html" class="md-nav__link">Density fitting (DF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pbc.html" class="md-nav__link">Periodic boundary conditions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="eph.html" class="md-nav__link">Electron-phonon coupling</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lo.html" class="md-nav__link">Localized orbitals</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sgx.html" class="md-nav__link">Seminumerical exchange (SGX)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="geomopt.html" class="md-nav__link">Geometry optimization</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="gpu.html" class="md-nav__link">GPU Acceleration (GPU4PySCF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="reference.html" class="md-nav__link">References</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../pyscf_api_docs/pyscf.html" class="md-nav__link">API</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about.html" class="md-nav__link">About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-solvent--page-root" class="md-nav__link">Solvation models</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#pcm-model" class="md-nav__link">PCM model</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#solvent-for-excited-states" class="md-nav__link">Solvent for excited states</a>
        </li>
        <li class="md-nav__item"><a href="#solvent-parameters" class="md-nav__link">Solvent parameters</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#ddcosmo" class="md-nav__link">ddCOSMO</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#self-consistent-solvents-for-ground-state" class="md-nav__link">Self-consistent solvents for ground state</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#smd-model" class="md-nav__link">SMD model</a>
        </li>
        <li class="md-nav__item"><a href="#polarizable-embedding" class="md-nav__link">Polarizable embedding</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/user/solvent.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="solvation-models">
<span id="user-solvent"></span><h1 id="user-solvent--page-root">Solvation models<a class="headerlink" href="#user-solvent--page-root" title="Link to this heading">¶</a></h1>
<p><em>Modules</em>: <a class="reference internal" href="../pyscf_api_docs/pyscf.solvent.html#module-pyscf.solvent" title="pyscf.solvent"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyscf.solvent</span></code></a></p>
<section id="introduction">
<span id="module-solvent"></span><h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>Solvation model allows the quantum chemistry calculations to include the
interactions between solvents and the quantum solute. Solvents can be treated
implicitly, known as continuum solvents, and explicitly. For continuum solvents,
we implemented the PCM (polarizable continuum model), ddCOSMO (domain-decomposition COSMO solvation model),
ddPCM (domain-decomposition polarizable continuum model),
and SMD (Solvation Model Density). For the explicit solvent environment,
we provided the interface to call the polarizable embedding library CPPE.</p>
</section>
<section id="pcm-model">
<h2 id="pcm-model">PCM model<a class="headerlink" href="#pcm-model" title="Link to this heading">¶</a></h2>
<p>PySCF support four types of PCM solvent models, i.e. C-PCM, IEF-PCM, SS(V)PE, and COSMO
(See <a class="reference external" href="https://manual.q-chem.com/5.2/Ch12.S2.SS2.html">https://manual.q-chem.com/5.2/Ch12.S2.SS2.html</a> for more detailed descriptions of these methods).
The analytical gradient and semi-analytical Hessian are also supported.</p>
<p>PCM solvent models can be applied on to an SCF object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="s1">'b3lyp'</span><span class="p">)</span><span class="o">.</span><span class="n">PCM</span><span class="p">()</span>
<span class="n">mf</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s1">'IEF-PCM'</span> <span class="c1"># C-PCM, SS(V)PE, COSMO</span>
<span class="n">mf</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="mf">78.3553</span> <span class="c1"># for water</span>
<span class="n">mf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>In regular MCSCF (CASCI or CASSCF), and post-SCF calculations, the setup for
self-consistent solvent is similar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">PCM</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">mp2_model</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">MP2</span><span class="p">()</span><span class="o">.</span><span class="n">PCM</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<section id="solvent-for-excited-states">
<h3 id="solvent-for-excited-states">Solvent for excited states<a class="headerlink" href="#solvent-for-excited-states" title="Link to this heading">¶</a></h3>
<p>When combining to TDDFT or other methods of excited states, solvent can be
modelled in the manner of self-consistency (fast solvent) or single shot (slow
solvent). Below we use TDDFT to demonstrate the treatments of fast solvent
and slow solvent.</p>
<p>In vertical excitations, the solvent almost does not respond to the change of
electronic structure. It should be viewed as slow solvent. The calculation
can be started with an SCF with fully relaxed solvent and followed by a regular
TDDFT method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">PCM</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">td</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">TDA</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>In the diabatic excitations, we would like to let the solvent rapidly responds
to the electronic structure of excited states. The entire solvation system
should converge to an equilibrium state between solvent and the excited state of
the solute. In this scenario, solvent model should be applied on to the excited
state methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">PCM</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">td</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">TDA</span><span class="p">()</span><span class="o">.</span><span class="n">PCM</span><span class="p">()</span>
<span class="n">td</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">equilibrium_solvation</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">td</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Please note that the flag <code class="docutils literal notranslate"><span class="pre">equilibrium_solvation</span></code> needs to be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>
in this case. PySCF by default assumes the slow solvent model for TDDFT.</p>
<p>In the complicated procedure which involves for example electronic states from
different states (typically in the MCSCF calculations with state-average or
state-specific approximations), PySCF PCM implementation allows to input a
density matrix and freeze the solvent equilibrated against the input density
matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">PCM</span><span class="p">()</span>
<span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">nstates</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">mc</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">state_id</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Slow solvent wrt the first excited state</span>
<span class="n">mc</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The slow solvent does not have to be corresponding to a particular state. It can
be even the solvent from a different geometry or an artificial quantum state of
solute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">scf_dm</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    1.035   -1.082</span>
<span class="s1">     H  0.   -1.035   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">PCM</span><span class="p">(</span><span class="n">dm</span><span class="o">=</span><span class="n">scf_dm</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="solvent-parameters">
<h3 id="solvent-parameters">Solvent parameters<a class="headerlink" href="#solvent-parameters" title="Link to this heading">¶</a></h3>
<p>The default solvent in the PCM module is water. When studying other types of
solvents, you can consider to modify the dielectric parameter <code class="docutils literal notranslate"><span class="pre">eps</span></code> using the
constants listed below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">PCM</span><span class="p">()</span>
<span class="n">mf</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="mf">32.613</span>   <span class="c1"># methanol</span>
<span class="n">mf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>These dielectric constants are obtained from <a class="reference external" href="https://gaussian.com/scrf/">https://gaussian.com/scrf/</a>.
More dataset can be found in Minnesota Solvent Descriptor Database
(<a class="reference external" href="https://comp.chem.umn.edu/solvation">https://comp.chem.umn.edu/solvation</a>)</p>
</section>
</section>
<section id="ddcosmo">
<h2 id="ddcosmo">ddCOSMO<a class="headerlink" href="#ddcosmo" title="Link to this heading">¶</a></h2>
<section id="self-consistent-solvents-for-ground-state">
<h3 id="self-consistent-solvents-for-ground-state">Self-consistent solvents for ground state<a class="headerlink" href="#self-consistent-solvents-for-ground-state" title="Link to this heading">¶</a></h3>
<p>Solvent model can be applied on to an SCF object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="s1">'b3lyp'</span><span class="p">)</span><span class="o">.</span><span class="n">DDCOSMO</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="smd-model">
<h2 id="smd-model">SMD model<a class="headerlink" href="#smd-model" title="Link to this heading">¶</a></h2>
<p>SMD model is recommended for computing solvation free energy. The implementation of SMD model
in PySCF is based on IEF-PCM. Other SMx models are not supported yet
(See <a class="reference external" href="https://manual.q-chem.com/5.2/Ch12.S2.SS8.html">https://manual.q-chem.com/5.2/Ch12.S2.SS8.html</a>). The source code for CDS contribution
is taken from NWChem (<a class="reference external" href="https://github.com/nwchemgit/nwchem/blob/master/src/solvation/mnsol.F">https://github.com/nwchemgit/nwchem/blob/master/src/solvation/mnsol.F</a>)
SMD solvent solvent models can be applied on to an SCF object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="s1">'b3lyp'</span><span class="p">)</span><span class="o">.</span><span class="n">SMD</span><span class="p">()</span>
<span class="n">mf</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">solvent</span> <span class="o">=</span> <span class="s1">'water'</span>
<span class="n">mf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The solvent descriptor can be assigned to the <code class="docutils literal notranslate"><span class="pre">with_solvent</span></code> directly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="s1">'b3lyp'</span><span class="p">)</span><span class="o">.</span><span class="n">SMD</span><span class="p">()</span>
<span class="n">mf</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">solvent_descriptors</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.3843</span><span class="p">,</span> <span class="mf">1.3766</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">35.06</span><span class="p">,</span> <span class="mf">13.45</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">mf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The format of solvant names are the same as Minnesota Solvent Descriptor Database
(<a class="reference external" href="https://comp.chem.umn.edu/solvation/mnsddb.pdf">https://comp.chem.umn.edu/solvation/mnsddb.pdf</a>). One can assign solvent descriptors in the format
<code class="docutils literal notranslate"><span class="pre">mf.with_solvent.solvent_descriptors</span> <span class="pre">=</span> <span class="pre">[n,</span> <span class="pre">n25,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma,</span> <span class="pre">epsilon,</span> <span class="pre">phi,</span> <span class="pre">psi]</span></code></p>
</section>
<section id="polarizable-embedding">
<h2 id="polarizable-embedding">Polarizable embedding<a class="headerlink" href="#polarizable-embedding" title="Link to this heading">¶</a></h2>
<p>To use polarizable embedding model for mean-field calculations, one would need
to first generate potential data for the input of CPPE library. The best way to
generate potential files is with <a class="reference external" href="https://gitlab.com/FraME-projects/PyFraME">PyFraME</a>.
You can directly throw in a pdb file, select the QM region and how to parametrize
different parts of the environment (with either pre-defined potentials, or with LoProp).
Some guidance is also provided in the Tutorial Review paper about PE, section 4:
<a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/qua.25717">https://onlinelibrary.wiley.com/doi/full/10.1002/qua.25717</a>
Therein, the format of the potential file is also explained (it’s the same
format as used in the original Dalton pelib implementation).</p>
<p>With the generated potential file, one can carry out the polarizable embedding
calculations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'''</span>
<span class="s1">     C  0.    0.      -0.542</span>
<span class="s1">     O  0.    0.       0.677</span>
<span class="s1">     H  0.    0.935   -1.082</span>
<span class="s1">     H  0.   -0.935   -1.082'''</span><span class="p">,</span>
              <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g*'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="s1">'b3lyp'</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">solvent</span><span class="o">.</span><span class="n">PE</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="s1">'potfile'</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="tddft.html" title="Time-dependent Hartree-Fock and density functional theory"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Time-dependent Hartree-Fock and density functional theory </span>
              </div>
            </a>
          
          
            <a href="qmmm.html" title="QM/MM methods"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> QM/MM methods </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>