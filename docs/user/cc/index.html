
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>4.7. Coupled-cluster theory &#8212; PySCF 2.0.0 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/material.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../../about/" />
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="4.8. Algebraic diagrammatic construction (ADC) scheme" href="../adc/" />
    <link rel="prev" title="4.6. Configuration interaction (CISD and FCI)" href="../ci/" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=amber>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#user/cc" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../" title="PySCF 2.0.0 documentation"
           class="md-header-nav__button md-logo">
          
              <img src="../../_static/pyscf-logo-white.svg" height="26"
                   alt="PySCF 2.0.0 documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.0</span>
          <span class="md-header-nav__topic"> 4.7. Coupled-cluster theory </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search/" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../../" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../../overview/" class="md-tabs__link">Overview</a></li>
            
            <li class="md-tabs__item"><a href="../../install/" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../../quickstart/" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../../pyscf_api_docs/modules/" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../../about/" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="../" class="md-tabs__link"><span class="section-number">4. </span>User guide</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../" title="PySCF 2.0.0 documentation" class="md-nav__button md-logo">
      
        <img src="../../_static/pyscf-logo-white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../"
       title="PySCF 2.0.0 documentation">PySCF 2.0</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../overview/" class="md-nav__link">1. Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../install/" class="md-nav__link">2. Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../quickstart/" class="md-nav__link">3. Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../" class="md-nav__link">4. User Guide</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../gto/" class="md-nav__link">4.1. Molecular structure</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../scf/" class="md-nav__link">4.2. Self-consistent field (SCF) methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../dft/" class="md-nav__link">4.3. Density functional theory (DFT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mp/" class="md-nav__link">4.4. Second-Order Møller–Plesset Perturbation Theory (MP2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../gw/" class="md-nav__link">4.5. GW approximation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../ci/" class="md-nav__link">4.6. Configuration interaction (CISD and FCI)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> 4.7. Coupled-cluster theory </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">4.7. Coupled-cluster theory</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-cc--page-root" class="md-nav__link">4.7. Coupled-cluster theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">4.7.1. Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#spin-symmetry" class="md-nav__link">4.7.2. Spin symmetry</a>
        </li>
        <li class="md-nav__item"><a href="#properties" class="md-nav__link">4.7.3. Properties</a>
        </li>
        <li class="md-nav__item"><a href="#frozen-orbitals" class="md-nav__link">4.7.4. Frozen orbitals</a>
        </li>
        <li class="md-nav__item"><a href="#equation-of-motion-coupled-cluster-theory" class="md-nav__link">4.7.5. Equation-of-motion coupled-cluster theory</a>
        </li>
        <li class="md-nav__item"><a href="#job-control" class="md-nav__link">4.7.6. Job control</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#saving-and-restarting" class="md-nav__link">4.7.6.1. Saving and restarting</a>
        </li>
        <li class="md-nav__item"><a href="#modifying-diis" class="md-nav__link">4.7.6.2. Modifying DIIS</a>
        </li>
        <li class="md-nav__item"><a href="#integral-direct-ccsd" class="md-nav__link">4.7.6.3. Integral-direct CCSD</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/user/cc.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../adc/" class="md-nav__link">4.8. Algebraic diagrammatic construction (ADC) scheme</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../agf2/" class="md-nav__link">4.9. Auxiliary second-order Green’s function perturbation theory (AGF2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mcscf/" class="md-nav__link">4.10. Multi-configuration self-consistent field (MCSCF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mrpt/" class="md-nav__link">4.11. Multi-Reference Perturbation Theory (MRPT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../tddft/" class="md-nav__link">4.12. Time-dependent Hartree-Fock and Density Functional Theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../solvent/" class="md-nav__link">4.13. Solvation models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../qmmm/" class="md-nav__link">4.14. QM/MM methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../df/" class="md-nav__link">4.15. Density fitting (DF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../pbc/" class="md-nav__link">4.16. Periodic boundary conditions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../eph/" class="md-nav__link">4.17. Electron Phonon Matrix</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../lo/" class="md-nav__link">4.18. Localized Orbitals</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../sgx/" class="md-nav__link">4.19. Seminumerical Exchange (SGX)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../geomopt/" class="md-nav__link">4.20. Geometry optimization</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../pyscf_api_docs/pyscf/" class="md-nav__link">5. API</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../interface/" class="md-nav__link">6. Interface</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../about/" class="md-nav__link">7. About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-cc--page-root" class="md-nav__link">4.7. Coupled-cluster theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">4.7.1. Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#spin-symmetry" class="md-nav__link">4.7.2. Spin symmetry</a>
        </li>
        <li class="md-nav__item"><a href="#properties" class="md-nav__link">4.7.3. Properties</a>
        </li>
        <li class="md-nav__item"><a href="#frozen-orbitals" class="md-nav__link">4.7.4. Frozen orbitals</a>
        </li>
        <li class="md-nav__item"><a href="#equation-of-motion-coupled-cluster-theory" class="md-nav__link">4.7.5. Equation-of-motion coupled-cluster theory</a>
        </li>
        <li class="md-nav__item"><a href="#job-control" class="md-nav__link">4.7.6. Job control</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#saving-and-restarting" class="md-nav__link">4.7.6.1. Saving and restarting</a>
        </li>
        <li class="md-nav__item"><a href="#modifying-diis" class="md-nav__link">4.7.6.2. Modifying DIIS</a>
        </li>
        <li class="md-nav__item"><a href="#integral-direct-ccsd" class="md-nav__link">4.7.6.3. Integral-direct CCSD</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/user/cc.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<span id="user-cc"></span><h1 id="user-cc--page-root"><span class="section-number">4.7. </span>Coupled-cluster theory<a class="headerlink" href="#user-cc--page-root" title="Permalink to this headline">¶</a></h1>
<p><em>Modules</em>: <a class="reference internal" href="../../modules/cc/#module-cc" title="cc: Coupled cluster energies and properties"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cc</span></code></a>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">pbc.cc</span></code></p>
<p>The MP2 and coupled-cluster functionalities of PySCF are similar.  See
also <a class="reference internal" href="../mp/#user-mp2"><span class="std std-numref">Section 4.4</span></a>.</p>

<h2 id="introduction"><span class="section-number">4.7.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Coupled-cluster (CC) theory is a post-Hartree-Fock method capable of describing
electron correlation in the ground state.  It is size extensive but not
variational.
PySCF has extensive support for CC calculations with single and double excitations (CCSD).
It can also include a perturbative treatment of triple excitations (CCSD(T)),
which is a very accurate method for single-reference quantum chemistry.
CC calculations can be performed with or without density fitting,
depending on the initial SCF calculation.
Correlated excited states are
accessible through the equation-of-motion (EOM) CCSD framework, described below.</p>
<p>A minimal example of a CCSD and CCSD(T) calculation is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">cc</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="s1">'H 0 0 0; F 0 0 1.1'</span><span class="p">,</span>  <span class="c1"># in Angstrom</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">'ccpvdz'</span><span class="p">,</span>
    <span class="n">symmetry</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># Note that the line following these comments could be replaced by</span>
<span class="c1"># mycc = cc.CCSD(mf)</span>
<span class="c1"># mycc.kernel()</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'CCSD total energy'</span><span class="p">,</span> <span class="n">mycc</span><span class="o">.</span><span class="n">e_tot</span><span class="p">)</span>
<span class="n">et</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">ccsd_t</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'CCSD(T) total energy'</span><span class="p">,</span> <span class="n">mycc</span><span class="o">.</span><span class="n">e_tot</span> <span class="o">+</span> <span class="n">et</span><span class="p">)</span>
</pre></div>
</div>


<h2 id="spin-symmetry"><span class="section-number">4.7.2. </span>Spin symmetry<a class="headerlink" href="#spin-symmetry" title="Permalink to this headline">¶</a></h2>
<p>The CC module in PySCF supports a number of reference wave functions with
broken spin symmetry.  In particular, CC can be performed with a
spin-restricted, spin-unrestricted, and general (spin-mixed) Hartree-Fock
solution, leading to the RCCSD, UCCSD, and GCCSD methods.</p>
<p>The module-level <code class="docutils literal notranslate"><span class="pre">cc.CCSD(mf)</span></code> constructor can infer the correct method based
on the level of symmetry-breaking in the mean-field argument.  For more explicit
control or inspection, the respective classes and functions can be found in
<code class="docutils literal notranslate"><span class="pre">ccsd.py</span></code> (restricted with real orbitals), <code class="docutils literal notranslate"><span class="pre">rccsd.py</span></code> (restricted with
potentially complex orbitals), <code class="docutils literal notranslate"><span class="pre">uccsd.py</span></code> (unrestricted), and <code class="docutils literal notranslate"><span class="pre">gccsd.py</span></code>
(general).</p>
<p>For example, a spin-unrestricted calculation on triplet oxygen can be performed
as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">cc</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="s1">'O 0 0 0; O 0 0 1.2'</span><span class="p">,</span>  <span class="c1"># in Angstrom</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">'ccpvdz'</span><span class="p">,</span>
    <span class="n">spin</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="c1"># this is UHF</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="c1"># this is UCCSD</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'UCCSD total energy = '</span><span class="p">,</span> <span class="n">mycc</span><span class="o">.</span><span class="n">e_tot</span><span class="p">)</span>
</pre></div>
</div>


<h2 id="properties"><span class="section-number">4.7.3. </span>Properties<a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<p>A number of properties are available at the CCSD level.</p>
<p>Unrelaxed 1- and 2-electron reduced density matrices can be calculated.
They are returned in the MO basis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dm1</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>
<span class="n">dm2</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">make_rdm2</span><span class="p">()</span>
</pre></div>
</div>
<p>Analytical nuclear gradients can be calculated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mygrad</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">nuc_grad_method</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The CCSD Lambda equations can be solved:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">solve_lambda</span><span class="p">()</span>
</pre></div>
</div>


<h2 id="frozen-orbitals"><span class="section-number">4.7.4. </span>Frozen orbitals<a class="headerlink" href="#frozen-orbitals" title="Permalink to this headline">¶</a></h2>
<p>By default, CCSD calculations in PySCF correlate all electrons in all available
orbitals. To freeze the lowest-energy core orbitals,
use the <code class="docutils literal notranslate"><span class="pre">frozen</span></code> keyword argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>To freeze occupied and/or unoccupied orbitals with finer control, a list of
0-based orbital indices can be provided as the <code class="docutils literal notranslate"><span class="pre">frozen</span></code> keyword argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># freeze 2 core orbitals</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># freeze 2 core orbitals and 3 unoccupied orbitals</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>


<h2 id="equation-of-motion-coupled-cluster-theory"><span class="section-number">4.7.5. </span>Equation-of-motion coupled-cluster theory<a class="headerlink" href="#equation-of-motion-coupled-cluster-theory" title="Permalink to this headline">¶</a></h2>
<p>EOM-CCSD can be used to calculate neutral excitation energies (EE-EOM-CCSD),
spin-flip excitations (SF-EOM-CCSD),
or charged excitations, i.e. ionization potentials (IP-EOM-CCSD) or electron affinities
(EA-EOM-CCSD).  The EOM functions return the requested number of
eigenvalues and right-hand eigenvectors. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="n">e_ip</span><span class="p">,</span> <span class="n">c_ip</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">ipccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_ea</span><span class="p">,</span> <span class="n">c_ea</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eaccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_ee</span><span class="p">,</span> <span class="n">c_ee</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eeccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_sf</span><span class="p">,</span> <span class="n">c_sf</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eomsf_ccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">eecsd()</span></code> function returns neutral excitations with all possible spin
multiplicities.  For closed-shell calculations (RHF and RCCSD), singlet and triplet
excitations can be requested explicitly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e_s</span><span class="p">,</span> <span class="n">c_s</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eomee_ccsd_singlet</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e_t</span><span class="p">,</span> <span class="n">c_t</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eomee_ccsd_triplet</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, PySCF calculates the <code class="docutils literal notranslate"><span class="pre">nroots</span></code> eigenvalues with the lowest energy,
which may include states with dominant double-excitation character.  To only
calculate states with dominant single-excitation character, use the <code class="docutils literal notranslate"><span class="pre">koopmans</span></code>
keyword argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eeccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">koopmans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>An initial guess wavefunction may be provided, in which case PySCF will try to
find the most similar EOM solution vector:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf.cc.eom_rccsd</span> <span class="kn">import</span> <span class="n">amplitudes_to_vector_ee</span>
<span class="n">r1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span><span class="n">nvir</span><span class="p">))</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span><span class="n">nocc</span><span class="p">,</span><span class="n">nvir</span><span class="p">,</span><span class="n">nvir</span><span class="p">))</span>
<span class="n">r1</span><span class="p">[</span><span class="n">occ_index</span><span class="p">,</span><span class="n">vir_index</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">myguess</span> <span class="o">=</span> <span class="n">amplitudes_to_vector_ee</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">)</span>
<span class="n">e_s</span><span class="p">,</span> <span class="n">c_s</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">eomee_ccsd_singlet</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="n">myguess</span><span class="p">)</span>
</pre></div>
</div>


<h2 id="job-control"><span class="section-number">4.7.6. </span>Job control<a class="headerlink" href="#job-control" title="Permalink to this headline">¶</a></h2>

<h3 id="saving-and-restarting"><span class="section-number">4.7.6.1. </span>Saving and restarting<a class="headerlink" href="#saving-and-restarting" title="Permalink to this headline">¶</a></h3>
<p>To allow for future restarts, the SCF information
and the CCSD DIIS information must be saved:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">chkfile</span> <span class="o">=</span> <span class="s1">'hf.chk'</span>
<span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">diis_file</span> <span class="o">=</span> <span class="s1">'ccdiis.h5'</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>To restart a CCSD calculation, first the molecule and SCF information must
be restored:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">load_mol</span><span class="p">(</span><span class="s1">'hf.chk'</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">chkfile</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'hf.chk'</span><span class="p">,</span> <span class="s1">'scf'</span><span class="p">))</span>
</pre></div>
</div>
<p>Next, the CCSD calculation can be restarted by using the previous
CCSD amplitudes as the initial guess:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">restore_from_diis_</span><span class="p">(</span><span class="s1">'ccdiis.h5'</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mycc</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span> <span class="n">mycc</span><span class="o">.</span><span class="n">t2</span><span class="p">)</span>
</pre></div>
</div>


<h3 id="modifying-diis"><span class="section-number">4.7.6.2. </span>Modifying DIIS<a class="headerlink" href="#modifying-diis" title="Permalink to this headline">¶</a></h3>
<p>The parameters of the DIIS algorithm can be tuned in cases where
convergence is difficult.  To increase the size of the DIIS space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">diis_space</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>By default, DIIS is activated on the first CCSD iteration.  Sometimes
it can be helpful to postpone the use of DIIS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">diis_start_cycle</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>


<h3 id="integral-direct-ccsd"><span class="section-number">4.7.6.3. </span>Integral-direct CCSD<a class="headerlink" href="#integral-direct-ccsd" title="Permalink to this headline">¶</a></h3>
<p>In order to avoid large memory requirements, the default behavior in CCSD calculations
is to store most two-electron integral tensors on disk.  This leads to a
potential I/O bottleneck.  For medium-sized molecules, an integral-direct
AO-driven implementation can be more efficient.  The user must manually
request an integral-direct CCSD calculation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">mycc</span><span class="o">.</span><span class="n">direct</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">e_corr</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">mycc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>





          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../ci/" title="4.6. Configuration interaction (CISD and FCI)"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> <span class="section-number">4.6. </span>Configuration interaction (CISD and FCI) </span>
              </div>
            </a>
          
          
            <a href="../adc/" title="4.8. Algebraic diagrammatic construction (ADC) scheme"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> <span class="section-number">4.8. </span>Algebraic diagrammatic construction (ADC) scheme </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>