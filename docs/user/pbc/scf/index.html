
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>2.16.2. SCF and DFT methods &#8212; PySCF 1.7.5.2 documentation</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/material.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../../_static/favicon-32x32.png"/>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="2.16.3. Density fitting for crystalline calculations" href="../df/" />
    <link rel="prev" title="2.16.1. Crystal structure" href="../gto/" /> 
  
   
  
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=amber>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#user/pbc/scf" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../" title="PySCF 1.7.5.2 documentation"
           class="md-header-nav__button md-logo">
          
              <img src="../../../_static/pyscf-logo-white.svg" height="26"
                   alt="PySCF 1.7.5.2 documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 1.7.5.2</span>
          <span class="md-header-nav__topic"> 2.16.2. SCF and DFT methods </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../../search/" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../../"versions.json"",
        target_loc = "../../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../../../" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../../../install/" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../../" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../../../develop/" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="../../../api_docs/modules/" class="md-tabs__link">API Docs</a></li>
            
            <li class="md-tabs__item"><a href="../../../blog_wrapper/" class="md-tabs__link">Blog</a></li>
            
            <li class="md-tabs__item"><a href="../../../about/" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="../../" class="md-tabs__link"><span class="section-number">2. </span>User guide</a></li>
          <li class="md-tabs__item"><a href="../" class="md-tabs__link"><span class="section-number">2.16. </span>Periodic boundary conditions</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../" title="PySCF 1.7.5.2 documentation" class="md-nav__button md-logo">
      
        <img src="../../../_static/pyscf-logo-white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../../"
       title="PySCF 1.7.5.2 documentation">PySCF 1.7.5.2</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../../install/" class="md-nav__link">1. Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../" class="md-nav__link">2. User Guide</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../../gto/" class="md-nav__link">2.1. Molecular structure</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../scf/" class="md-nav__link">2.2. Self-consistent field (SCF) methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../dft/" class="md-nav__link">2.3. Density functional theory (DFT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../mp/" class="md-nav__link">2.4. Second-Order Møller–Plesset Perturbation Theory (MP2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../gw/" class="md-nav__link">2.5. GW approximation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../ci/" class="md-nav__link">2.6. Configuration interaction (CISD and FCI)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../cc/" class="md-nav__link">2.7. Coupled-cluster theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../adc/" class="md-nav__link">2.8. Algebraic diagrammatic construction (ADC) scheme</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../mcscf/" class="md-nav__link">2.9. Multi-configuration self-consistent field (MCSCF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../tddft/" class="md-nav__link">2.10. Time-dependent Hartree-Fock and Density Functional Theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../rt/" class="md-nav__link">2.11. Real-time time-dependent density functional theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../solvent/" class="md-nav__link">2.12. Solvation models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../qmmm/" class="md-nav__link">2.13. QM/MM methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../x2c/" class="md-nav__link">2.14. Relativistic calculations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../df/" class="md-nav__link">2.15. Density fitting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../" class="md-nav__link">2.16. Periodic boundary conditions</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../develop/" class="md-nav__link">3. Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../blog_wrapper/" class="md-nav__link">4. Blog</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-pbc-scf--page-root" class="md-nav__link">2.16.2. SCF and DFT methods</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">2.16.2.1. Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#density-fitting" class="md-nav__link">2.16.2.2. Density fitting</a>
        </li>
        <li class="md-nav__item"><a href="#finite-size-effects" class="md-nav__link">2.16.2.3. Finite-size effects</a>
        </li>
        <li class="md-nav__item"><a href="#band-structure-calculations" class="md-nav__link">2.16.2.4. Band structure calculations</a>
        </li>
        <li class="md-nav__item"><a href="#add-ons" class="md-nav__link">2.16.2.5. Add-ons</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#linear-dependencies" class="md-nav__link">2.16.2.5.1. Linear dependencies</a>
        </li>
        <li class="md-nav__item"><a href="#smearing" class="md-nav__link">2.16.2.5.2. Smearing</a>
        </li>
        <li class="md-nav__item"><a href="#stability" class="md-nav__link">2.16.2.5.3. Stability</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#references" class="md-nav__link">2.16.2.6. References</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../_sources/user/pbc/scf.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
             <div class="section" id="scf-and-dft-methods">
<span id="user-pbc-scf"></span><h1><span class="section-number">2.16.2. </span>SCF and DFT methods<a class="headerlink" href="#scf-and-dft-methods" title="Permalink to this headline">¶</a></h1>
<p><em>Modules</em>: <a class="reference internal" href="../../../modules/scf/#module-scf" title="scf: restricted and unrestricted, closed shell and open shell Hartree-Fock methods"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scf</span></code></a>, <a class="reference internal" href="../../../modules/dft/#module-dft" title="dft: Density functional theory"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dft</span></code></a>, <a class="reference internal" href="../../../modules/pbc/scf/#module-pbc.scf" title="pbc.scf: Hartree-Fock methods with periodic boundary conditions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pbc.scf</span></code></a>, <a class="reference internal" href="../../../modules/pbc/dft/#module-pbc.dft" title="pbc.dft: Density functional theory with periodic boundary conditions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pbc.dft</span></code></a></p>
<div class="section" id="introduction">
<h2><span class="section-number">2.16.2.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>PySCF supports periodic Hartree-Fock and density functional theory calculations
with Brillouin zone sampling.  The results of these calculations serve
as input to a variety of periodic post-HF and post-DFT calculations.
A minimal example of a periodic HF calculation on diamond with
a 2x2x2 sampling of the Brillouin zone is shown below.  Note that the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">kpts</span></code> keyword argument must be in physical units (inverse bohr),
which can be easily achieved using the <code class="docutils literal notranslate"><span class="pre">Cell.make_kpts()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf.pbc</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;C 0.0000 0.0000 0.0000</span>
<span class="s1">              C 0.8917 0.8917 0.8917&#39;&#39;&#39;</span><span class="p">,</span>
    <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;0.0000 1.7834 1.7834</span>
<span class="s1">           1.7834 0.0000 1.7834</span>
<span class="s1">           1.7834 1.7834 0.0000&#39;&#39;&#39;</span><span class="p">,</span>
    <span class="n">pseudo</span> <span class="o">=</span> <span class="s1">&#39;gth-pade&#39;</span><span class="p">,</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;gth-szv&#39;</span>
    <span class="p">)</span>

<span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">kpts</span><span class="o">=</span><span class="n">cell</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># converged SCF energy = -10.9308552994574</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../gto/#user-pbc-gto"><span class="std std-ref">Crystal structure</span></a> and <a class="reference internal" href="../#user-pbc"><span class="std std-ref">Periodic boundary conditions</span></a> for more details about
the <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code> object and Brillouin zone sampling.</p>
</div>
<div class="section" id="density-fitting">
<h2><span class="section-number">2.16.2.2. </span>Density fitting<a class="headerlink" href="#density-fitting" title="Permalink to this headline">¶</a></h2>
<p>All periodic calculations in PySCF must be done with some type of density
fitting.  The default behavior is to use plane-wave density fitting (FFTDF).
The number of plane-waves used as an auxiliary basis is controlled by kinetic
energy cutoff, which is specified by the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Cell.ke_cutoff</span></code> parameter.  The
default value of this parameter is chosen to provide many digits of precision in
the ERIs and the subsequent energies.  If reduced precision is tolerable, this
parameter can be set manually, resulting in significant speedups and memory
savings.  For the diamond example above, lowering the kinetic energy cutoff to 100
hartree changes the SCF energy by about 5 microhartree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell</span><span class="o">.</span><span class="n">ke_cutoff</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="c1"># in Hartree</span>
<span class="n">cell</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># converged SCF energy = -10.9308602914696</span>
</pre></div>
</div>
<p>For many systems, Gaussian density fitting (GDF) is more economical, although it
incurs larger errors than FFTDF.  Periodic GDF can be activated in the same way
as for molecules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">()</span><span class="o">.</span><span class="n">density_fit</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>If a corresponding auxiliary basis is found for the chosen atomic orbital basis,
it will be used.  Otherwise, an even-tempered Gaussian basis will be used.</p>
<p>See <a class="reference internal" href="../df/#user-pbc-df"><span class="std std-ref">Density fitting for crystalline calculations</span></a> for more details about periodic density fitting.</p>
</div>
<div class="section" id="finite-size-effects">
<h2><span class="section-number">2.16.2.3. </span>Finite-size effects<a class="headerlink" href="#finite-size-effects" title="Permalink to this headline">¶</a></h2>
<p>The long-ranged nature of the Coulomb interaction is responsible for a number of
divergent contributions to the energy.  For charge-neutral unit cells, the
divergence of the nuclear repulsion energy, the electron-nuclear attraction
energy, and the electronic Hartree energy cancel one another.</p>
<p>The nonlocal exact exchange energy exhibits an integrable divergence at
<span class="math notranslate nohighlight">\(G=0\)</span> that is responsible for the leading-order finite-size error of HF
and hybrid DFT calculations <span id="id1">[<span>Paier2005</span><span>Broqvist2009</span><span>Sundararaman2013</span>]</span>.  In
PySCF, this exchange divergence can be addressed in a number of ways using the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">exxdiv</span></code> keyword argument to the mean-field class, with the following
possible values.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'ewald'</span></code> (default)</p>
<p>The <span class="math notranslate nohighlight">\(G=0\)</span> value of the Coulomb potential is the supercell Madelung
constant <span id="id2">[<span>Paier2005</span><span>Broqvist2009</span><span>Sundararaman2013</span>]</span>, which is evaluated by
Ewald summation.  The finite-size error of the exchange energy decays as
<span class="math notranslate nohighlight">\(N_k^{-1}\)</span>, where <span class="math notranslate nohighlight">\(N_k\)</span> is the number of k-points sampled in the
Brillouin zone.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
<p>The <span class="math notranslate nohighlight">\(G=0\)</span> value of the Coulomb potential is set to zero.  The
finite-size error of the exchange energy decays slowly as <span class="math notranslate nohighlight">\(N_k^{-1/3}\)</span>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'vcut_sph'</span></code></p>
<p>The Coulomb potential is spherically truncated in real space at a radius equal
to half of the supercell side length <span id="id3">[<span>Spencer2008</span>]</span>.  The finite-size
error of the exchange energy decays as <span class="math notranslate nohighlight">\(\exp(-aN_k^{1/3})\)</span>.  Only
supported with plane-wave density fitting (FFTDF).</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'vcut_ws'</span></code></p>
<p>The Coulomb potential is truncated outside of the Wigner-Seitz supercell
<span id="id4">[<span>Sundararaman2013</span>]</span>, which is more appropriate than spherical truncation
for anisotropic cells.  The finite-size error of the exchange energy decays as
<span class="math notranslate nohighlight">\(\exp(-aN_k^{1/3})\)</span>.  Only supported with plane-wave density fitting
(FFTDF).</p>
</li>
</ul>
<p>An example calculation with exchange treated with the spherically truncated
Coulomb potential is shown here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">kpts</span><span class="o">=</span><span class="n">kpts</span><span class="p">,</span> <span class="n">exxdiv</span><span class="o">=</span><span class="s1">&#39;vcut_sph&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="band-structure-calculations">
<h2><span class="section-number">2.16.2.4. </span>Band structure calculations<a class="headerlink" href="#band-structure-calculations" title="Permalink to this headline">¶</a></h2>
<p>After an SCF calculation has been performed, the band structure can be
calculated non-self-consistently along a k-point path using the
<code class="docutils literal notranslate"><span class="pre">SCF.get_bands(kpts)</span></code> function, where <code class="docutils literal notranslate"><span class="pre">kpts</span></code> is a list of k-points along
which the band structure is desired.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For Hartree-Fock or hybrid DFT, the discontinuity of the exchange potential
at <span class="math notranslate nohighlight">\(G=0\)</span> is problematic for band structure calculations.  Using
<code class="xref py py-attr docutils literal notranslate"><span class="pre">exxdiv='vcut_sph'</span></code> with FFTDF is recommended instead.  Alternatively,
the SCF procedure can be repeated at each k-point, which is much more
expensive but allows the use of any <code class="xref py py-attr docutils literal notranslate"><span class="pre">exxdiv</span></code> or density fitting.</p>
</div>
<p>See <a href="#id5"><span class="problematic" id="id6">:source:`examples/pbc/09-band_ase.py`</span></a> for an example DFT band structure
calculation.</p>
</div>
<div class="section" id="add-ons">
<h2><span class="section-number">2.16.2.5. </span>Add-ons<a class="headerlink" href="#add-ons" title="Permalink to this headline">¶</a></h2>
<p>All molecular SCF add-ons are also available for periodic SCF but
must be accessed through the molecular <a class="reference internal" href="../../../modules/scf/#module-pyscf.scf.addons" title="pyscf.scf.addons"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyscf.scf.addons</span></code></a> module.
Here we highlight a few of the most useful add-ons.</p>
<div class="section" id="linear-dependencies">
<h3><span class="section-number">2.16.2.5.1. </span>Linear dependencies<a class="headerlink" href="#linear-dependencies" title="Permalink to this headline">¶</a></h3>
<p>The dense packing of atoms in solids combined with the use of diffuse
atom-centered basis functions is responsible for frequent linear dependencies.
The linear dependency can be eliminated by Cholesky orthogonalization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">scf</span> <span class="k">as</span> <span class="n">mol_scf</span>
<span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">kpts</span><span class="o">=</span><span class="n">kpts</span><span class="p">)</span>
<span class="n">kmf</span> <span class="o">=</span> <span class="n">mol_scf</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">remove_linear_dep_</span><span class="p">(</span><span class="n">kmf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="smearing">
<h3><span class="section-number">2.16.2.5.2. </span>Smearing<a class="headerlink" href="#smearing" title="Permalink to this headline">¶</a></h3>
<p>For metals or small band gap semiconductors, it can be useful to smear the
orbital occupation numbers away from integer values.  This can improve SCF
convergence and can expedite convergence to the thermodynamic limit with k-point
sampling.  Because this approach assumes a finite electronic temperature, it
yields an entropy and free energy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">kpts</span><span class="o">=</span><span class="n">kpts</span><span class="p">)</span>
<span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">smearing_</span><span class="p">(</span><span class="n">kmf</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fermi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Entropy = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">kmf</span><span class="o">.</span><span class="n">entropy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Free energy = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">kmf</span><span class="o">.</span><span class="n">e_free</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Zero temperature energy = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">kmf</span><span class="o">.</span><span class="n">e_tot</span><span class="o">+</span><span class="n">kmf</span><span class="o">.</span><span class="n">e_free</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>Fermi-Dirac smearing (<code class="xref py py-attr docutils literal notranslate"><span class="pre">method='fermi'</span></code>) and Gaussian smearing
(<code class="xref py py-attr docutils literal notranslate"><span class="pre">method='gauss'</span></code>) are supported.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because most functions in PySCF assume integer occupations, they may fail if
combined with a mean-field calculation that was performed with smearing.</p>
</div>
</div>
<div class="section" id="stability">
<h3><span class="section-number">2.16.2.5.3. </span>Stability<a class="headerlink" href="#stability" title="Permalink to this headline">¶</a></h3>
<p>Periodic SCF solutions can be checked with stability analysis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kmf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">KRHF</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">kmf</span><span class="o">.</span><span class="n">stability</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="references">
<h2><span class="section-number">2.16.2.6. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<span class="target" id="id7"></span></div>
</div>

<div class="section">
   
</div>

          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../gto/" title="2.16.1. Crystal structure"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> <span class="section-number">2.16.1. </span>Crystal structure </span>
              </div>
            </a>
          
          
            <a href="../df/" title="2.16.3. Density fitting for crystalline calculations"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> <span class="section-number">2.16.3. </span>Density fitting for crystalline calculations </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>