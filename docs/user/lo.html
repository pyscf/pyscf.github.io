
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Localized orbitals &#8212; PySCF 2.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Seminumerical exchange (SGX)" href="sgx.html" />
    <link rel="prev" title="Electron-phonon coupling" href="eph.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=amber>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#user/lo" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="PySCF 2.0.0 documentation"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/pyscf-logo-white.svg" height="26"
                   alt="PySCF 2.0.0 documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.0</span>
          <span class="md-header-nav__topic"> Localized orbitals </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../overview.html" class="md-tabs__link">Overview</a></li>
            
            <li class="md-tabs__item"><a href="../install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../quickstart.html" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../pyscf_api_docs/modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../about.html" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="PySCF 2.0.0 documentation" class="md-nav__button md-logo">
      
        <img src="../_static/pyscf-logo-white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="PySCF 2.0.0 documentation">PySCF 2.0</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html" class="md-nav__link">2. Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickstart.html" class="md-nav__link">Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../user.html" class="md-nav__link">User Guide</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="gto.html" class="md-nav__link">4.1. Molecular structure</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="scf.html" class="md-nav__link">4.2. Self-consistent field (SCF) methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dft.html" class="md-nav__link">Density functional theory (DFT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mp.html" class="md-nav__link">Second-order Møller–Plesset perturbation theory (MP2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="gw.html" class="md-nav__link">4.5. GW approximation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ci.html" class="md-nav__link">Configuration interaction (CISD and FCI)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cc.html" class="md-nav__link">4.7. Coupled-cluster theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="adc.html" class="md-nav__link">Algebraic diagrammatic construction (ADC)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="agf2.html" class="md-nav__link">Auxiliary second-order Green’s function perturbation theory (AGF2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mcscf.html" class="md-nav__link">Multi-configuration self-consistent field (MCSCF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mrpt.html" class="md-nav__link">Multi-reference perturbation theory (MRPT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tddft.html" class="md-nav__link">Time-dependent Hartree-Fock and density functional theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="solvent.html" class="md-nav__link">4.13. Solvation models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="qmmm.html" class="md-nav__link">4.14. QM/MM methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="df.html" class="md-nav__link">Density fitting (DF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pbc.html" class="md-nav__link">4.16. Periodic boundary conditions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="eph.html" class="md-nav__link">Electron-phonon coupling</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Localized orbitals </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Localized orbitals</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-lo--page-root" class="md-nav__link">Localized orbitals</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#references" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/user/lo.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sgx.html" class="md-nav__link">Seminumerical exchange (SGX)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="geomopt.html" class="md-nav__link">4.20. Geometry optimization</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../pyscf_api_docs/pyscf.html" class="md-nav__link">5. API</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../interface.html" class="md-nav__link">6. Interface</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about.html" class="md-nav__link">7. About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-lo--page-root" class="md-nav__link">Localized orbitals</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#references" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/user/lo.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<span id="user-lo"></span><h1 id="user-lo--page-root">Localized orbitals<a class="headerlink" href="#user-lo--page-root" title="Permalink to this headline">¶</a></h1>
<p><em>Modules</em>: <code class="xref py py-mod docutils literal notranslate"><span class="pre">lo</span></code></p>

<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>A molecular orbital is usually delocalized, i.e. it has non-negligible amplitude over the whole system rather than only around some atom(s) or bond(s).
However, one can choose a unitary rotation <span class="math notranslate nohighlight">\(U\)</span></p>
<div class="math notranslate nohighlight">
\[\phi = \psi U\]</div>
<p>such that the resulting
orbitals <span class="math notranslate nohighlight">\(\phi\)</span> are as spatially localized as possible. This is typically achieved by one of two classes of
methods.
The first is to project the orbitals onto a predefined local set of orbitals, which can be e.g. atomic orbitals or pseudo-atomic orbitals.
The second is to optimize a cost function <span class="math notranslate nohighlight">\(f\)</span>, which measures the locality of the molecular orbitals.
Because there is no unambiguous choice for the localization criterion, several criteria have been suggested.
Boys localization minimizes the spread of the orbital</p>
<div class="math notranslate nohighlight">
\[f(U) = \sum_{i} \langle\psi_i|r^2|\psi_i\rangle - \langle\psi_i|r|\psi_i\rangle^2\]</div>
<p>Boys localized orbitals <a class="bibtex reference internal" href="#foster60" id="id1">[1]</a> in periodic systems are typically termed maximally localized
Wannier orbitals (MLWF) <a class="bibtex reference internal" href="#marzari97" id="id2">[2]</a>.</p>
<p>Pipek-Mezey (PM) localization <a class="bibtex reference internal" href="#pipek98" id="id3">[3]</a> maximizes the population charges on the atoms</p>
<div class="math notranslate nohighlight">
\[f(U) = \sum^{\mathrm{atoms}}_{I} \sum_{i} \left|q^{I}_{i} \right|^2\]</div>
<p>Note that PM localization depends on the choice of atomic orbitals used for
the population analysis. Several choices of populations are available, e.g.
Mulliken or based on (meta-) L"owdin orbitals.
Intrinsic bond orbitals (IBOs) can be viewed as a special case of PM
localization using intrinsic atomic orbitals (IAOs) as population method.
See Ref. <a class="bibtex reference internal" href="#lehtola14pm" id="id4">[4]</a> for a summary of choices of orbitals.
Note that PM localization preserves the separation between  <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\pi\)</span> orbitals.</p>
<p>Edmiston-Ruedenberg (ER) localization <a class="bibtex reference internal" href="#edmiston63" id="id5">[5]</a> maximizes the orbital Coulomb self-repulsion,</p>
<div class="math notranslate nohighlight">
\[f(U) = \sum_{i} (ii|ii)\]</div>
<p>ER localization, however, is computationally more expensive than the Boys or PM approaches.</p>
<p>Localized orbitals can be calculated via the pivoted Cholesky factorization of a density-like
matrix <span class="math notranslate nohighlight">\(\mathbf{D} = \mathbf{C} \mathbf{C}^\dagger\)</span>. <a class="bibtex reference internal" href="#aquilante06" id="id6">[6]</a> Since <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> is
generally a rectangular matrix containing only the subset of <span class="math notranslate nohighlight">\(N\)</span> orbitals intended for localization,
the matrix <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> is positive-semidefinite. It can be factored using a Cholesky decomposition
with full column pivoting,</p>
<div class="math notranslate nohighlight">
\[\mathbf{P}^\dagger \mathbf{D} \mathbf{P} = \mathbf{L} \mathbf{L}^\dagger ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> is a lower triangular matrix and <span class="math notranslate nohighlight">\(\mathbf{P}\)</span> is a permutation matrix.
In the end, the <span class="math notranslate nohighlight">\(N\)</span> leftmost columns of <span class="math notranslate nohighlight">\(\mathbf{P L}\)</span> are taken as the localized orbitals.
While Cholesky orbitals are usually not as localized as, for example, PM or Boys orbitals, the procedure
is non-iterative and produces unique result, except possibly for the impact of degeneracies.
Cholesky orbitals can serve as an excellent guess for iterative localization procedures.</p>
<p>A summary of the functionality of the <code class="xref py py-mod docutils literal notranslate"><span class="pre">lo</span></code> module is given below:</p>
<table>
<colgroup>
<col style="width: 28%"/>
<col style="width: 15%"/>
<col style="width: 21%"/>
<col style="width: 8%"/>
<col style="width: 27%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Method</p></td>
<td><p>optimization</p></td>
<td><p>cost function</p></td>
<td><p>PBC</p></td>
<td><p>ref</p></td>
</tr>
<tr class="row-even"><td><p>(meta-) L"owdin</p></td>
<td><p>No</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>yes</p></td>
<td><p><a class="bibtex reference internal" href="#lowdin50" id="id7">[7]</a><a class="bibtex reference internal" href="#sun14qmmm" id="id8">[8]</a></p></td>
</tr>
<tr class="row-odd"><td><p>Natural atomic orbitals</p></td>
<td><p>No</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>gamma</p></td>
<td><p><a class="bibtex reference internal" href="#reed85" id="id9">[9]</a></p></td>
</tr>
<tr class="row-even"><td><p>Intrinsic atomic orbitals</p></td>
<td><p>No</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>yes</p></td>
<td><p><a class="bibtex reference internal" href="#knizia13iao" id="id10">[10]</a></p></td>
</tr>
<tr class="row-odd"><td><p>Cholesky orbitals</p></td>
<td><p>No</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>no</p></td>
<td><p><a class="bibtex reference internal" href="#aquilante06" id="id11">[6]</a></p></td>
</tr>
<tr class="row-even"><td><p>Boys</p></td>
<td><p>yes</p></td>
<td><p>dipole</p></td>
<td><p>no</p></td>
<td><p><a class="bibtex reference internal" href="#foster60" id="id12">[1]</a></p></td>
</tr>
<tr class="row-odd"><td><p>Pipek-Mezey</p></td>
<td><p>yes</p></td>
<td><p>local charges</p></td>
<td><p>gamma</p></td>
<td><p><a class="bibtex reference internal" href="#pipek98" id="id13">[3]</a></p></td>
</tr>
<tr class="row-even"><td><p>Intrinsic bond orbitals</p></td>
<td><p>yes</p></td>
<td><p>IAO charges</p></td>
<td><p>gamma</p></td>
<td><p><a class="bibtex reference internal" href="#knizia13iao" id="id14">[10]</a></p></td>
</tr>
<tr class="row-odd"><td><p>Edmiston-Ruedenberg</p></td>
<td><p>yes</p></td>
<td><p>coulomb integral</p></td>
<td><p>gamma</p></td>
<td><p><a class="bibtex reference internal" href="#edmiston63" id="id15">[5]</a></p></td>
</tr>
</tbody>
</table>
<p>For example, to obtain the natural atomic orbital coefficients (in terms
of the original atomic orbitals):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">lo</span>

<span class="n">x</span> <span class="o">=</span> <span class="o">.</span><span class="mi">63</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="p">[[</span><span class="s1">'C'</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
                  <span class="p">[</span><span class="s1">'H'</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="p">,</span>  <span class="n">x</span><span class="p">,</span>  <span class="n">x</span><span class="p">)],</span>
                  <span class="p">[</span><span class="s1">'H'</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span>  <span class="n">x</span><span class="p">)],</span>
                  <span class="p">[</span><span class="s1">'H'</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span>  <span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)],</span>
                  <span class="p">[</span><span class="s1">'H'</span><span class="p">,</span> <span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)]],</span>
            <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvtz'</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># C matrix stores the AO to localized orbital coefficients</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">lo</span><span class="o">.</span><span class="n">orth_ao</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="s1">'nao'</span><span class="p">)</span>
</pre></div>
</div>


<h2 id="references">References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-user/lo-0"><dl class="citation">
<dt class="bibtex label" id="foster60"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id12">2</a>)</span></dt>
<dd><p>J. M. Foster and S. F. Boys. Canonical Configurational Interaction Procedure. <em>Rev. Mod. Phys.</em>, 32(2):300–302, 1960.</p>
</dd>
<dt class="bibtex label" id="marzari97"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>N. Marzari and D. Vanderbilt. Maximally Localized Generalized Wannier Functions for Composite Energy Bands. <em>Phys. Rev. B</em>, 56(20):12847–12865, 1997.</p>
</dd>
<dt class="bibtex label" id="pipek98"><span class="brackets">3</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id13">2</a>)</span></dt>
<dd><p>János Pipek and Paul G. Mezey. A fast intrinsic localization procedure applicable for ab-initio and semiempirical linear combination of atomic orbital wave functions. <em>J. Chem. Phys.</em>, 90(9):4916, 1998.</p>
</dd>
<dt class="bibtex label" id="lehtola14pm"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Susi Lehtola and Hannes Jónsson. Pipek–mezey orbital localization using various partial charge estimates. <em>Journal of chemical theory and computation</em>, 10(2):642–649, 2014.</p>
</dd>
<dt class="bibtex label" id="edmiston63"><span class="brackets">5</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id15">2</a>)</span></dt>
<dd><p>Clyde Edmiston and Klaus Ruedenberg. Localized Atomic and Molecular Orbitals. <em>Rev. Mod. Phys.</em>, 35(3):457–464, 1963.</p>
</dd>
<dt class="bibtex label" id="aquilante06"><span class="brackets">6</span><span class="fn-backref">(<a href="#id6">1</a>,<a href="#id11">2</a>)</span></dt>
<dd><p>Francesco Aquilante, Thomas Bondo Pedersen, Alfredo Sánchez de Merás, and Henrik Koch. Fast noniterative orbital localization for large molecules. <em>J. Chem. Phys.</em>, 125(17):174101, 2006. <a class="reference external" href="https://doi.org/10.1063/1.2360264">doi:10.1063/1.2360264</a>.</p>
</dd>
<dt class="bibtex label" id="lowdin50"><span class="brackets"><a class="fn-backref" href="#id7">7</a></span></dt>
<dd><p>Per-Olov Löwdin. On the Non-Orthogonality Problem Connected with the Use of Atomic Wave Functions in the Theory of Molecules and Crystals. <em>J. Chem. Phys.</em>, 18(3):365, 1950.</p>
</dd>
<dt class="bibtex label" id="sun14qmmm"><span class="brackets"><a class="fn-backref" href="#id8">8</a></span></dt>
<dd><p>Qiming Sun and Garnet Kin-Lic Chan. Exact and optimal quantum mechanics/molecular mechanics boundaries. <em>J. Chem. Theory Comput.</em>, 10:3784, 2014.</p>
</dd>
<dt class="bibtex label" id="reed85"><span class="brackets"><a class="fn-backref" href="#id9">9</a></span></dt>
<dd><p>Alan E. Reed, Robert B. Weinstock, and Frank Weinhold. Natural population analysis. <em>J. Chem. Phys.</em>, 83(2):735–746, 1985.</p>
</dd>
<dt class="bibtex label" id="knizia13iao"><span class="brackets">10</span><span class="fn-backref">(<a href="#id10">1</a>,<a href="#id14">2</a>)</span></dt>
<dd><p>Gerald Knizia. Intrinsic Atomic Orbitals: An Unbiased Bridge between Quantum Theory and Chemical Concepts. <em>J. Chem. Theory Comput.</em>, 9(11):4834–4843, 2013.</p>
</dd>
</dl>
</p>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="eph.html" title="Electron-phonon coupling"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Electron-phonon coupling </span>
              </div>
            </a>
          
          
            <a href="sgx.html" title="Seminumerical exchange (SGX)"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Seminumerical exchange (SGX) </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>