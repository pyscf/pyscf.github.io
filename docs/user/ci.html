
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Configuration interaction (CISD and FCI) &#8212; PySCF</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Coupled-cluster theory" href="cc.html" />
    <link rel="prev" title="GW approximation" href="gw.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=pyscf data-md-color-accent=pyscf>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#user/ci" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="PySCF"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/pyscf-logo-white.svg" height="26"
                   alt="PySCF logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.3</span>
          <span class="md-header-nav__topic"> Configuration interaction (CISD and FCI) </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../quickstart.html" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../develop.html" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="../pyscf_api_docs/modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../about.html" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="PySCF" class="md-nav__button md-logo">
      
        <img src="../_static/pyscf-logo-white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="PySCF">PySCF 2.3</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../install.html" class="md-nav__link">Install PySCF</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#advanced-build-options" class="md-nav__link">Advanced build options</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#install-pyscf-extensions" class="md-nav__link">Install PySCF extensions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../install.html#troubleshooting" class="md-nav__link">Troubleshooting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickstart.html" class="md-nav__link">Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../user.html" class="md-nav__link">User Guide</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="gto.html" class="md-nav__link">Molecular structure</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="scf.html" class="md-nav__link">Self-consistent field (SCF) methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dft.html" class="md-nav__link">Density functional theory (DFT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mp.html" class="md-nav__link">Second-order Møller–Plesset perturbation theory (MP2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="gw.html" class="md-nav__link">GW approximation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Configuration interaction (CISD and FCI) </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Configuration interaction (CISD and FCI)</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-ci--page-root" class="md-nav__link">Configuration interaction (CISD and FCI)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#configuration-interaction-singles-and-doubles-cisd" class="md-nav__link">Configuration interaction singles and doubles (CISD)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#spin-symmetry" class="md-nav__link">Spin symmetry</a>
        </li>
        <li class="md-nav__item"><a href="#properties" class="md-nav__link">Properties</a>
        </li>
        <li class="md-nav__item"><a href="#frozen-orbitals" class="md-nav__link">Frozen orbitals</a>
        </li>
        <li class="md-nav__item"><a href="#wavefunction-overlap" class="md-nav__link">Wavefunction overlap</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#full-configuration-interaction-fci" class="md-nav__link">Full configuration interaction (FCI)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#setting-spin-and-symmetry-of-wavefunction" class="md-nav__link">Setting Spin and Symmetry of Wavefunction</a>
        </li>
        <li class="md-nav__item"><a href="#id3" class="md-nav__link">Properties</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/user/ci.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cc.html" class="md-nav__link">Coupled-cluster theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="adc.html" class="md-nav__link">Algebraic diagrammatic construction (ADC)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="agf2.html" class="md-nav__link">Auxiliary second-order Green’s function perturbation theory (AGF2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mcscf.html" class="md-nav__link">Multi-configuration self-consistent field (MCSCF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mrpt.html" class="md-nav__link">Multi-reference perturbation theory (MRPT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tddft.html" class="md-nav__link">Time-dependent Hartree-Fock and density functional theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="solvent.html" class="md-nav__link">Solvation models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="qmmm.html" class="md-nav__link">QM/MM methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="md.html" class="md-nav__link">Molecular Dynamics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="df.html" class="md-nav__link">Density fitting (DF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pbc.html" class="md-nav__link">Periodic boundary conditions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="eph.html" class="md-nav__link">Electron-phonon coupling</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lo.html" class="md-nav__link">Localized orbitals</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sgx.html" class="md-nav__link">Seminumerical exchange (SGX)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="geomopt.html" class="md-nav__link">Geometry optimization</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="reference.html" class="md-nav__link">References</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../pyscf_api_docs/pyscf.html" class="md-nav__link">API</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about.html" class="md-nav__link">About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-ci--page-root" class="md-nav__link">Configuration interaction (CISD and FCI)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#configuration-interaction-singles-and-doubles-cisd" class="md-nav__link">Configuration interaction singles and doubles (CISD)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#spin-symmetry" class="md-nav__link">Spin symmetry</a>
        </li>
        <li class="md-nav__item"><a href="#properties" class="md-nav__link">Properties</a>
        </li>
        <li class="md-nav__item"><a href="#frozen-orbitals" class="md-nav__link">Frozen orbitals</a>
        </li>
        <li class="md-nav__item"><a href="#wavefunction-overlap" class="md-nav__link">Wavefunction overlap</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#full-configuration-interaction-fci" class="md-nav__link">Full configuration interaction (FCI)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#setting-spin-and-symmetry-of-wavefunction" class="md-nav__link">Setting Spin and Symmetry of Wavefunction</a>
        </li>
        <li class="md-nav__item"><a href="#id3" class="md-nav__link">Properties</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/user/ci.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="configuration-interaction-cisd-and-fci">
<span id="theory-ci"></span><h1 id="user-ci--page-root">Configuration interaction (CISD and FCI)<a class="headerlink" href="#user-ci--page-root" title="Permalink to this heading">¶</a></h1>
<p><em>Modules</em>: <a class="reference internal" href="../pyscf_api_docs/pyscf.ci.html#module-pyscf.ci" title="pyscf.ci"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyscf.ci</span></code></a>, <a class="reference internal" href="../pyscf_api_docs/pyscf.fci.html#module-pyscf.fci" title="pyscf.fci"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyscf.fci</span></code></a>, <a class="reference internal" href="../pyscf_api_docs/pyscf.pbc.ci.html#module-pyscf.pbc.ci" title="pyscf.pbc.ci"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyscf.pbc.ci</span></code></a></p>
<p>PySCF has separate molecular implementations for configuration
interaction singles and doubles (CISD) (<code class="xref py py-mod docutils literal notranslate"><span class="pre">ci</span></code>) and full
configuration interaction (FCI) (<code class="xref py py-mod docutils literal notranslate"><span class="pre">fci</span></code>). The functionalities of the
CISD implementation are similar to the functionalities of MP2
(<a class="reference internal" href="mp.html#user-mp2"><span class="std std-ref">Second-order Møller–Plesset perturbation theory (MP2)</span></a>) and CCSD (<a class="reference internal" href="cc.html#user-cc"><span class="std std-ref">Coupled-cluster theory</span></a>) in PySCF.</p>
<section id="introduction">
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>Configuration interaction (see e.g. <span id="id1">[<a class="reference internal" href="reference.html#id12" title="P. J. Knowles and N. C. Handy. A new determinant-based full configuration interaction method. Chem. Phys. Lett., 111(4):315, 1984. doi:10.1016/0009-2614(84)85513-X.">28</a>, <a class="reference internal" href="reference.html#id13" title="Attila Szabo and Neil S Ostlund. Modern quantum chemistry: introduction to advanced electronic structure theory. Courier Corporation, 2012.">29</a>, <a class="reference internal" href="reference.html#id14" title="T. Helgaker, P. Jørgensen, and J. Olsen. Configuration-Interaction Theory, chapter 11, pages 523. John Wiley &amp; Sons, Ltd, 2000. doi:10.1002/9781119019572.ch11.">30</a>]</span>)
is a post-Hartree–Fock method, diagonalising
the many-electron Hamiltonian matrix. FCI includes all Slater determinants of
appropriate symmetry in the eigenvector basis. CISD includes only those
that differ from the Hartree–Fock determinant by at most two occupied
spinorbitals.</p>
</section>
<section id="configuration-interaction-singles-and-doubles-cisd">
<h2 id="configuration-interaction-singles-and-doubles-cisd">Configuration interaction singles and doubles (CISD)<a class="headerlink" href="#configuration-interaction-singles-and-doubles-cisd" title="Permalink to this heading">¶</a></h2>
<p>A simple example (see <a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples/ci/00-simple_cisd.py">examples/ci/00-simple_cisd.py</a>) of running
a restricted and an unrestricted CISD calculation is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#</span>
<span class="c1"># Author: Qiming Sun &lt;osirpt.sun@gmail.com&gt;</span>
<span class="c1">#</span>

<span class="sd">'''</span>
<span class="sd">A simple example to run CISD calculation.</span>
<span class="sd">'''</span>

<span class="kn">import</span> <span class="nn">pyscf</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="s1">'H 0 0 0; F 0 0 1.1'</span><span class="p">,</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">'ccpvdz'</span><span class="p">)</span>

<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">HF</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">CISD</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'RCISD correlation energy'</span><span class="p">,</span> <span class="n">mycc</span><span class="o">.</span><span class="n">e_corr</span><span class="p">)</span>

<span class="n">mf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">UHF</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">CISD</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'UCISD correlation energy'</span><span class="p">,</span> <span class="n">mycc</span><span class="o">.</span><span class="n">e_corr</span><span class="p">)</span>

</pre></div>
</div>
<p>which outputs</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">converged</span> <span class="n">SCF</span> <span class="n">energy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">99.9873974403488</span>
<span class="n">E</span><span class="p">(</span><span class="n">RCISD</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">100.196182975762</span>  <span class="n">E_corr</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2087855354132202</span>
<span class="n">RCISD</span> <span class="n">correlation</span> <span class="n">energy</span> <span class="o">-</span><span class="mf">0.2087855354132202</span>
</pre></div>
</div>
<p>namely, the (restricted) Hartree–Fock energy, the RCISD energy and their
difference, the RCISD correlation energy, as well as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">converged</span> <span class="n">SCF</span> <span class="n">energy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">99.9873974403486</span>  <span class="o">&lt;</span><span class="n">S</span><span class="o">^</span><span class="mi">2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="mf">5.3734794e-13</span>  <span class="mi">2</span><span class="n">S</span><span class="o">+</span><span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">E</span><span class="p">(</span><span class="n">UCISD</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">100.196182975774</span>  <span class="n">E_corr</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2087855354254317</span>
<span class="n">UCISD</span> <span class="n">correlation</span> <span class="n">energy</span> <span class="o">-</span><span class="mf">0.20878553542543174</span>
</pre></div>
</div>
<p>namely, the (unrestricted) Hartree–Fock energy, the UCISD energy and
their difference, the UCISD correlation energy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mycc</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">CISD</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>could have been replaced by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myci</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">ci</span><span class="o">.</span><span class="n">CISD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span>
<span class="n">myci</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myci</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">ci</span><span class="o">.</span><span class="n">CISD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>for the same result.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Density fitting is not implemented for CISD.</p>
</div>
<section id="spin-symmetry">
<h3 id="spin-symmetry">Spin symmetry<a class="headerlink" href="#spin-symmetry" title="Permalink to this heading">¶</a></h3>
<p>The CISD module in PySCF supports a number of reference wavefunctions with
broken spin symmetry.  In particular, CISD can be performed with a
spin-restricted, spin-unrestricted, and general (spin-mixed) Hartree-Fock
solution, leading to the RCISD, UCISD, and GCISD methods. The small
example above shows this for RCISD and UCISD.</p>
<p>The module-level <code class="docutils literal notranslate"><span class="pre">ci.CISD(mf)</span></code> constructor can infer the correct method based
on the level of symmetry-breaking in the mean-field argument.  For more explicit
control or inspection, the respective classes and functions can be found in
<code class="docutils literal notranslate"><span class="pre">cisd.py</span></code> (restricted), <code class="docutils literal notranslate"><span class="pre">ucisd.py</span></code> (unrestricted), and <code class="docutils literal notranslate"><span class="pre">gcisd.py</span></code>
(general).</p>
<p>For example, a spin-unrestricted calculation on triplet oxygen can be performed
as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">ci</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="s1">'O 0 0 0; O 0 0 1.2'</span><span class="p">,</span>  <span class="c1"># in Angstrom</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">'ccpvdz'</span><span class="p">,</span>
    <span class="n">spin</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="c1"># this is UHF</span>
<span class="n">myci</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">CISD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="c1"># this is UCISD</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'UCISD total energy = '</span><span class="p">,</span> <span class="n">myci</span><span class="o">.</span><span class="n">e_tot</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="properties">
<h3 id="properties">Properties<a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h3>
<p>A number of properties are available at the CISD level.</p>
<p>Unrelaxed 1- and 2-electron reduced density matrices can be calculated.
They are returned in the MO basis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dm1</span> <span class="o">=</span> <span class="n">myci</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>
<span class="n">dm2</span> <span class="o">=</span> <span class="n">myci</span><span class="o">.</span><span class="n">make_rdm2</span><span class="p">()</span>
</pre></div>
</div>
<p>Analytical nuclear gradients can be calculated
(see <span id="id2">[<a class="reference internal" href="reference.html#id10" title="Y. Osamura, Y. Yamaguchi, and H. F. Schaefer III. Generalization of analytic energy derivatives for configuration interaction wave functions. Theoret. Chim. Acta, 72(2):71, 1987. doi:10.1007/BF00528133.">31</a>, <a class="reference internal" href="reference.html#id11" title="Y. Yamaguchi and H. F. Schaefer III. Analytic Derivative Methods in Molecular Electronic Structure Theory: A New Dimension to Quantum Chemistry and its Applications to Spectroscopy, chapter Fundamentals and Theory, pages 325. John Wiley &amp; Sons, Ltd., 2011. doi:10.1002/9780470749593.hrs006.">32</a>]</span> and references therein):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mygrad</span> <span class="o">=</span> <span class="n">myci</span><span class="o">.</span><span class="n">nuc_grad_method</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="frozen-orbitals">
<h3 id="frozen-orbitals">Frozen orbitals<a class="headerlink" href="#frozen-orbitals" title="Permalink to this heading">¶</a></h3>
<p>By default, CISD calculations in PySCF correlate all electrons in all available
orbitals. To freeze the lowest-energy core orbitals,
use the <code class="docutils literal notranslate"><span class="pre">frozen</span></code> keyword argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myci</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">CISD</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>To freeze occupied and/or unoccupied orbitals with finer control, a list of
0-based orbital indices can be provided as the <code class="docutils literal notranslate"><span class="pre">frozen</span></code> keyword argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># freeze 2 core orbitals</span>
<span class="n">myci</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">CISD</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># freeze 2 core orbitals and 3 unoccupied orbitals</span>
<span class="n">myci</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">CISD</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="wavefunction-overlap">
<h3 id="wavefunction-overlap">Wavefunction overlap<a class="headerlink" href="#wavefunction-overlap" title="Permalink to this heading">¶</a></h3>
<p>The following example shows how to evaluate the overlap of two different
CISD wavefunctions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#</span>
<span class="c1"># Author: Qiming Sun &lt;osirpt.sun@gmail.com&gt;</span>
<span class="c1">#</span>

<span class="sd">'''</span>
<span class="sd">Overlap of two CISD wave functions (they can be obtained from different</span>
<span class="sd">geometries).</span>
<span class="sd">'''</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">ci</span>

<span class="c1">#</span>
<span class="c1"># RCISD wavefunction overlap</span>
<span class="c1">#</span>
<span class="n">myhf1</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; F 0 0 1.1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">ci1</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">CISD</span><span class="p">(</span><span class="n">myhf1</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'CISD energy of mol1'</span><span class="p">,</span> <span class="n">ci1</span><span class="o">.</span><span class="n">e_tot</span><span class="p">)</span>

<span class="n">myhf2</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; F 0 0 1.2'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">ci2</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">CISD</span><span class="p">(</span><span class="n">myhf2</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'CISD energy of mol2'</span><span class="p">,</span> <span class="n">ci2</span><span class="o">.</span><span class="n">e_tot</span><span class="p">)</span>

<span class="n">s12</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">intor_cross</span><span class="p">(</span><span class="s1">'cint1e_ovlp_sph'</span><span class="p">,</span> <span class="n">myhf1</span><span class="o">.</span><span class="n">mol</span><span class="p">,</span> <span class="n">myhf2</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span>
<span class="n">s12</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">,</span> <span class="p">(</span><span class="n">myhf1</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">s12</span><span class="p">,</span> <span class="n">myhf2</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">))</span>
<span class="n">nmo</span> <span class="o">=</span> <span class="n">myhf2</span><span class="o">.</span><span class="n">mo_energy</span><span class="o">.</span><span class="n">size</span>
<span class="n">nocc</span> <span class="o">=</span> <span class="n">myhf2</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">nelectron</span> <span class="o">//</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'&lt;CISD-mol1|CISD-mol2&gt; = '</span><span class="p">,</span> <span class="n">ci</span><span class="o">.</span><span class="n">cisd</span><span class="o">.</span><span class="n">overlap</span><span class="p">(</span><span class="n">ci1</span><span class="o">.</span><span class="n">ci</span><span class="p">,</span> <span class="n">ci2</span><span class="o">.</span><span class="n">ci</span><span class="p">,</span> <span class="n">nmo</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">s12</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># UCISD wavefunction overlap</span>
<span class="c1">#</span>
<span class="n">myhf1</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; F 0 0 1.1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">ci1</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">UCISD</span><span class="p">(</span><span class="n">myhf1</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'CISD energy of mol1'</span><span class="p">,</span> <span class="n">ci1</span><span class="o">.</span><span class="n">e_tot</span><span class="p">)</span>

<span class="n">myhf2</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; F 0 0 1.2'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">ci2</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">UCISD</span><span class="p">(</span><span class="n">myhf2</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'CISD energy of mol2'</span><span class="p">,</span> <span class="n">ci2</span><span class="o">.</span><span class="n">e_tot</span><span class="p">)</span>

<span class="n">s12</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">intor_cross</span><span class="p">(</span><span class="s1">'cint1e_ovlp_sph'</span><span class="p">,</span> <span class="n">myhf1</span><span class="o">.</span><span class="n">mol</span><span class="p">,</span> <span class="n">myhf2</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mo1a</span><span class="p">,</span> <span class="n">mo1b</span> <span class="o">=</span> <span class="n">myhf1</span><span class="o">.</span><span class="n">mo_coeff</span>
<span class="n">mo2a</span><span class="p">,</span> <span class="n">mo2b</span> <span class="o">=</span> <span class="n">myhf2</span><span class="o">.</span><span class="n">mo_coeff</span>
<span class="n">s12</span> <span class="o">=</span> <span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1a</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">s12</span><span class="p">,</span> <span class="n">mo2a</span><span class="p">)),</span>
       <span class="n">reduce</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1b</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">s12</span><span class="p">,</span> <span class="n">mo2b</span><span class="p">)))</span>
<span class="n">nmo</span> <span class="o">=</span> <span class="p">(</span><span class="n">myhf2</span><span class="o">.</span><span class="n">mo_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">myhf2</span><span class="o">.</span><span class="n">mo_energy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">nocc</span> <span class="o">=</span> <span class="n">myhf2</span><span class="o">.</span><span class="n">nelec</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'&lt;CISD-mol1|CISD-mol2&gt; = '</span><span class="p">,</span> <span class="n">ci</span><span class="o">.</span><span class="n">ucisd</span><span class="o">.</span><span class="n">overlap</span><span class="p">(</span><span class="n">ci1</span><span class="o">.</span><span class="n">ci</span><span class="p">,</span> <span class="n">ci2</span><span class="o">.</span><span class="n">ci</span><span class="p">,</span> <span class="n">nmo</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">s12</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
<section id="full-configuration-interaction-fci">
<h2 id="full-configuration-interaction-fci">Full configuration interaction (FCI)<a class="headerlink" href="#full-configuration-interaction-fci" title="Permalink to this heading">¶</a></h2>
<p>A simple example (see <a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples/fci/00-simple-fci.py">examples/fci/00-simple-fci.py</a>) of running
a restricted and an unrestricted FCI calculation is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#</span>
<span class="c1"># Author: Qiming Sun &lt;osirpt.sun@gmail.com&gt;</span>
<span class="c1">#</span>

<span class="sd">'''</span>
<span class="sd">A simple example to run FCI</span>
<span class="sd">'''</span>

<span class="kn">import</span> <span class="nn">pyscf</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">M</span><span class="p">(</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="s1">'H 0 0 0; F 0 0 1.1'</span><span class="p">,</span>  <span class="c1"># in Angstrom</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">'6-31g'</span><span class="p">,</span>
    <span class="n">symmetry</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">myhf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1">#</span>
<span class="c1"># create an FCI solver based on the SCF object</span>
<span class="c1">#</span>
<span class="n">cisolver</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">myhf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'E(FCI) = </span><span class="si">%.12f</span><span class="s1">'</span> <span class="o">%</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">#</span>
<span class="c1"># create an FCI solver based on the SCF object</span>
<span class="c1">#</span>
<span class="n">myuhf</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">UHF</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">cisolver</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">myuhf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'E(UHF-FCI) = </span><span class="si">%.12f</span><span class="s1">'</span> <span class="o">%</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">#</span>
<span class="c1"># create an FCI solver based on the given orbitals and the num. electrons and</span>
<span class="c1"># spin of the mol object</span>
<span class="c1">#</span>
<span class="n">cisolver</span> <span class="o">=</span> <span class="n">pyscf</span><span class="o">.</span><span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">myhf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'E(FCI) = </span><span class="si">%.12f</span><span class="s1">'</span> <span class="o">%</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>



</pre></div>
</div>
<p>The second and third FCI calculation in the example show two different ways of
running unrestricted FCI calculations.</p>
<section id="setting-spin-and-symmetry-of-wavefunction">
<h3 id="setting-spin-and-symmetry-of-wavefunction">Setting Spin and Symmetry of Wavefunction<a class="headerlink" href="#setting-spin-and-symmetry-of-wavefunction" title="Permalink to this heading">¶</a></h3>
<p>The following example discusses how to set the spin for an FCI calculations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#</span>
<span class="c1"># Author: Qiming Sun &lt;osirpt.sun@gmail.com&gt;</span>
<span class="c1">#</span>

<span class="sd">'''</span>
<span class="sd">Assign spin state for FCI wavefunction.</span>

<span class="sd">By default, the FCI solver will take Mole attribute spin for the spin state.</span>
<span class="sd">It can be overwritten by passing kwarg ``nelec`` to the kernel function of FCI</span>
<span class="sd">solver.  The nelec argument is a two-element tuple.  The first is the number</span>
<span class="sd">of alpha electrons; the second is the number of beta electrons.</span>

<span class="sd">If spin-contamination is observed on FCI wavefunction, we can use the</span>
<span class="sd">decoration function :func:`fci.addons.fix_spin_` to level shift the energy of</span>
<span class="sd">states which do not have the target spin.</span>
<span class="sd">'''</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">fci</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'Ne 0 0 0'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'631g'</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="n">norb</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_energy</span><span class="o">.</span><span class="n">size</span>

<span class="n">fs</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'E = </span><span class="si">%.12f</span><span class="s1">  2S+1 = </span><span class="si">%.7f</span><span class="s1">'</span> <span class="o">%</span>
      <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">spin_square</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">nelec</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'E = </span><span class="si">%.12f</span><span class="s1">  2S+1 = </span><span class="si">%.7f</span><span class="s1">'</span> <span class="o">%</span>
      <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">spin_square</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))[</span><span class="mi">1</span><span class="p">]))</span>


<span class="n">fs</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">fix_spin_</span><span class="p">(</span><span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">),</span> <span class="n">shift</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'E = </span><span class="si">%.12f</span><span class="s1">  2S+1 = </span><span class="si">%.7f</span><span class="s1">'</span> <span class="o">%</span>
      <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">spin_square</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))[</span><span class="mi">1</span><span class="p">]))</span>


<span class="c1">#</span>
<span class="c1"># Example 2:  Oxygen molecule singlet state</span>
<span class="c1">#</span>

<span class="n">nelec</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'O 0 0 0; O 0 0 1.2'</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'sto3g'</span><span class="p">,</span>
            <span class="n">symmetry</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mci</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="n">mci</span><span class="o">.</span><span class="n">wfnsym</span> <span class="o">=</span> <span class="s1">'A1g'</span>
<span class="n">mci</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">fix_spin_</span><span class="p">(</span><span class="n">mci</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Use keyword argument nelec to explicitly control the spin. Otherwise</span>
<span class="c1"># mol.spin is applied.</span>
<span class="n">e</span><span class="p">,</span> <span class="n">civec</span> <span class="o">=</span> <span class="n">mci</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">nelec</span><span class="o">=</span><span class="n">nelec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'A1g singlet E = </span><span class="si">%.12f</span><span class="s1">  2S+1 = </span><span class="si">%.7f</span><span class="s1">'</span> <span class="o">%</span>
      <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">mci</span><span class="o">.</span><span class="n">spin_square</span><span class="p">(</span><span class="n">civec</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nelec</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">mci</span><span class="o">.</span><span class="n">wfnsym</span> <span class="o">=</span> <span class="s1">'A2g'</span>
<span class="n">mci</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">fix_spin_</span><span class="p">(</span><span class="n">mci</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">e</span><span class="p">,</span> <span class="n">civec</span> <span class="o">=</span> <span class="n">mci</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">nelec</span><span class="o">=</span><span class="n">nelec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'A2g singlet E = </span><span class="si">%.12f</span><span class="s1">  2S+1 = </span><span class="si">%.7f</span><span class="s1">'</span> <span class="o">%</span>
      <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">mci</span><span class="o">.</span><span class="n">spin_square</span><span class="p">(</span><span class="n">civec</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nelec</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'O 0 0 0; O 0 0 1.2'</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'sto3g'</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mci</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="n">mci</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">fix_spin_</span><span class="p">(</span><span class="n">mci</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">e</span><span class="p">,</span> <span class="n">civec</span> <span class="o">=</span> <span class="n">mci</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">nelec</span><span class="o">=</span><span class="n">nelec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Singlet E = </span><span class="si">%.12f</span><span class="s1">  2S+1 = </span><span class="si">%.7f</span><span class="s1">'</span> <span class="o">%</span>
      <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">mci</span><span class="o">.</span><span class="n">spin_square</span><span class="p">(</span><span class="n">civec</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nelec</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>


<span class="c1">#</span>
<span class="c1"># Example 3:  Triplet and Sz=0</span>
<span class="c1">#</span>
<span class="c1"># It's common that the default initial guess has no overlap with the ground</span>
<span class="c1"># state. In this example, the default initial guess is singlet. Computing</span>
<span class="c1"># multiple roots to overcome the initial guess issue.</span>
<span class="c1">#</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">atom</span> <span class="o">=</span> <span class="s1">'''</span>
<span class="s1">                  H     1  -1.      0</span>
<span class="s1">                  H     0  -1.     -1</span>
<span class="s1">                  H     0  -0.5    -0</span>
<span class="s1">                  H     0  -0.     -1</span>
<span class="s1">                  H     1  -0.5     0</span>
<span class="s1">                  H     0   1.      1'''</span><span class="p">,</span>
            <span class="n">basis</span><span class="o">=</span><span class="s1">'sto-3g'</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mci</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mci</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">fix_spin_</span><span class="p">(</span><span class="n">mci</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">e</span><span class="p">,</span> <span class="n">civec</span> <span class="o">=</span> <span class="n">mci</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">nelec</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Triplet E = </span><span class="si">%.12f</span><span class="s1">  2S+1 = </span><span class="si">%.7f</span><span class="s1">'</span> <span class="o">%</span>
      <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mci</span><span class="o">.</span><span class="n">spin_square</span><span class="p">(</span><span class="n">civec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nelec</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>


<span class="c1">#</span>
<span class="c1"># Be careful with the trick of energy penalty.  Numerical problems may be</span>
<span class="c1"># observed when function fix_spin_ was applied.</span>
<span class="c1">#</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'O 0 0 0'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31G'</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">norb</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">nelec</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nelec</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">fix_spin_</span><span class="p">(</span><span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">),</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fs</span><span class="o">.</span><span class="n">nroots</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">e</span><span class="p">,</span> <span class="n">fcivec</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># The first 5 states should be degenerated. The degeneracy may be broken.</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fcivec</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'state = </span><span class="si">%d</span><span class="s1">, E = </span><span class="si">%.9f</span><span class="s1">, S^2=</span><span class="si">%.4f</span><span class="s1">'</span> <span class="o">%</span>
          <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fci</span><span class="o">.</span><span class="n">spin_op</span><span class="o">.</span><span class="n">spin_square</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">nelec</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>

</pre></div>
</div>
<p>and the next example how to set symmetry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#</span>
<span class="c1"># Author: Qiming Sun &lt;osirpt.sun@gmail.com&gt;</span>
<span class="c1">#</span>

<span class="sd">'''</span>
<span class="sd">Assign FCI wavefunction symmetry</span>
<span class="sd">'''</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">fci</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span><span class="p">,</span> <span class="n">symm</span><span class="p">,</span> <span class="n">mcscf</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; F 0 0 1.1'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'631g'</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">norb</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">nelec</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nelec</span>

<span class="n">fs</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="n">fs</span><span class="o">.</span><span class="n">wfnsym</span> <span class="o">=</span> <span class="s1">'E1x'</span>
<span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Energy of </span><span class="si">%s</span><span class="s1"> state </span><span class="si">%.12f</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">wfnsym</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># Symmetry adapted FCI solver can be called with arbitrary Hamiltonian.  In the</span>
<span class="c1"># following example, you need to prepare 1-electron and 2-electron integrals,</span>
<span class="c1"># core energy shift, and the symmetry of orbitals.</span>
<span class="c1">#</span>
<span class="n">cas_idx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">core_idx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">mo_cas</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[:,</span><span class="n">cas_idx</span><span class="p">]</span>
<span class="n">mo_core</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[:,</span><span class="n">core_idx</span><span class="p">]</span>
<span class="n">dm_core</span> <span class="o">=</span> <span class="n">mo_core</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mo_core</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">vhf_core</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_veff</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm_core</span><span class="p">)</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">mo_cas</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">m</span><span class="o">.</span><span class="n">get_hcore</span><span class="p">()</span> <span class="o">+</span> <span class="n">vhf_core</span> <span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mo_cas</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo_cas</span><span class="p">)</span>
<span class="n">ecore</span> <span class="o">=</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">'ij,ji'</span><span class="p">,</span> <span class="n">dm_core</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">get_hcore</span><span class="p">())</span>
         <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">'ij,ji'</span><span class="p">,</span> <span class="n">dm_core</span><span class="p">,</span> <span class="n">vhf_core</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">energy_nuc</span><span class="p">())</span>
<span class="n">orbsym</span> <span class="o">=</span> <span class="n">symm</span><span class="o">.</span><span class="n">label_orb_symm</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">irrep_id</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">symm_orb</span><span class="p">,</span> <span class="n">mo_cas</span><span class="p">)</span>

<span class="n">norb</span> <span class="o">=</span> <span class="n">mo_cas</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ncore</span> <span class="o">=</span> <span class="n">mo_core</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">nelec</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nelectron</span> <span class="o">-</span> <span class="n">ncore</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin0_symm</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">fs</span><span class="o">.</span><span class="n">wfnsym</span> <span class="o">=</span> <span class="s1">'A2'</span>
<span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">nelec</span><span class="p">,</span> <span class="n">ecore</span><span class="o">=</span><span class="n">ecore</span><span class="p">,</span> <span class="n">orbsym</span><span class="o">=</span><span class="n">orbsym</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Energy of </span><span class="si">%s</span><span class="s1"> state </span><span class="si">%.12f</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">wfnsym</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># mcscf module has a function h1e_for_cas to generate 1-electron Hamiltonian and</span>
<span class="c1"># core energy.</span>
<span class="c1">#</span>
<span class="n">cas_idx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">core_idx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">mo_cas</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[:,</span><span class="n">cas_idx</span><span class="p">]</span>
<span class="n">mo_core</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[:,</span><span class="n">core_idx</span><span class="p">]</span>
<span class="n">norb</span> <span class="o">=</span> <span class="n">mo_cas</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ncore</span> <span class="o">=</span> <span class="n">mo_core</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">nelec</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nelectron</span> <span class="o">-</span> <span class="n">ncore</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">h1</span><span class="p">,</span> <span class="n">ecore</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">casci</span><span class="o">.</span><span class="n">h1e_for_cas</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">ncore</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo_cas</span><span class="p">)</span>
<span class="n">orbsym</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf_symm</span><span class="o">.</span><span class="n">get_orbsym</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)[</span><span class="n">cas_idx</span><span class="p">]</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin0_symm</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">fs</span><span class="o">.</span><span class="n">wfnsym</span> <span class="o">=</span> <span class="s1">'A2'</span>
<span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">nelec</span><span class="p">,</span> <span class="n">ecore</span><span class="o">=</span><span class="n">ecore</span><span class="p">,</span> <span class="n">orbsym</span><span class="o">=</span><span class="n">orbsym</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Energy of </span><span class="si">%s</span><span class="s1"> state </span><span class="si">%.12f</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">wfnsym</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># Using the CASCI object, initialization of 1-electron and 2-electron integrals</span>
<span class="c1"># can be further simplified.</span>
<span class="c1">#</span>
<span class="n">cas_idx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">norb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cas_idx</span><span class="p">)</span>
<span class="n">ncore</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">nelec</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nelectron</span> <span class="o">-</span> <span class="n">ncore</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">nelec</span><span class="p">)</span>
<span class="n">mo</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">sort_mo</span><span class="p">(</span><span class="n">cas_idx</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">h1</span><span class="p">,</span> <span class="n">ecore</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">get_h1eff</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">get_h2eff</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span>
<span class="n">orbsym</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf_symm</span><span class="o">.</span><span class="n">get_orbsym</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)[</span><span class="n">cas_idx</span><span class="p">]</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin0_symm</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">fs</span><span class="o">.</span><span class="n">wfnsym</span> <span class="o">=</span> <span class="s1">'A2'</span>
<span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">nelec</span><span class="p">,</span> <span class="n">ecore</span><span class="o">=</span><span class="n">ecore</span><span class="p">,</span> <span class="n">orbsym</span><span class="o">=</span><span class="n">orbsym</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Energy of </span><span class="si">%s</span><span class="s1"> state </span><span class="si">%.12f</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">wfnsym</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>


<span class="c1">#</span>
<span class="c1"># In the following example, the default initial guess of the regular FCI</span>
<span class="c1"># solver is different to the symmetry of HF wfn.  In the symmetry adapted FCI</span>
<span class="c1"># solver, the initial guess of required wfnsym is generated.  The FCI solution</span>
<span class="c1"># has the same symmetry as the HF wfn. </span>
<span class="c1">#</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'C 0. 0. 0.; C 0. 0. 1.24253'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'6-31g'</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">cas_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">norb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cas_idx</span><span class="p">)</span>
<span class="n">ncore</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">nelec</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">nelectron</span> <span class="o">-</span> <span class="n">ncore</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">nelec</span><span class="p">)</span>
<span class="n">h1</span><span class="p">,</span> <span class="n">ecore</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">get_h1eff</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">get_h2eff</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="n">orbsym</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf_symm</span><span class="o">.</span><span class="n">get_orbsym</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)[</span><span class="n">cas_idx</span><span class="p">]</span>

<span class="n">fs</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin0</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>  <span class="c1"># Regular FCI solver</span>
<span class="n">fs</span><span class="o">.</span><span class="n">davidson_only</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">nelec</span><span class="p">,</span> <span class="n">ecore</span><span class="o">=</span><span class="n">ecore</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'''Using regular FCI solver, FCI converges to</span>
<span class="s1">  wfnsym = </span><span class="si">%s</span><span class="s1">  E(FCI) = </span><span class="si">%.12f</span><span class="s1">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">guess_wfnsym</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cas_idx</span><span class="p">),</span> <span class="n">nelec</span><span class="p">,</span> <span class="n">orbsym</span><span class="p">),</span> <span class="n">e</span><span class="p">))</span>
<span class="n">hf_as_civec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="n">hf_as_civec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">nelec</span><span class="p">,</span> <span class="n">ecore</span><span class="o">=</span><span class="n">ecore</span><span class="p">,</span> <span class="n">ci0</span><span class="o">=</span><span class="n">hf_as_civec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'''Using HF determinant as initial guess, FCI converges to</span>
<span class="s1">  wfnsym = </span><span class="si">%s</span><span class="s1">  E(FCI) = </span><span class="si">%.12f</span><span class="s1">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">guess_wfnsym</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cas_idx</span><span class="p">),</span> <span class="n">nelec</span><span class="p">,</span> <span class="n">orbsym</span><span class="p">),</span> <span class="n">e</span><span class="p">))</span>

<span class="n">fs</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin0_symm</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>  <span class="c1"># Symmetry adapted FCI solver</span>
<span class="n">fs</span><span class="o">.</span><span class="n">wfnsym</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="n">nelec</span><span class="p">,</span> <span class="n">ecore</span><span class="o">=</span><span class="n">ecore</span><span class="p">,</span> <span class="n">orbsym</span><span class="o">=</span><span class="n">orbsym</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'''Using symmetry adapted FCI solver, FCI converges to</span>
<span class="s1">  wfnsym = </span><span class="si">%s</span><span class="s1">  E(FCI) = </span><span class="si">%.12f</span><span class="s1">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">guess_wfnsym</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cas_idx</span><span class="p">),</span> <span class="n">nelec</span><span class="p">,</span> <span class="n">orbsym</span><span class="p">),</span> <span class="n">e</span><span class="p">))</span>

</pre></div>
</div>
</section>
<section id="id3">
<h3 id="id3">Properties<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<p>Reduced density matrices can be evaluated, see the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#</span>
<span class="c1"># Author: Qiming Sun &lt;osirpt.sun@gmail.com&gt;</span>
<span class="c1">#</span>

<span class="sd">'''</span>
<span class="sd">Compute FCI 1,2,3,4-particle density matrices</span>
<span class="sd">'''</span>

<span class="c1">#</span>
<span class="c1"># Note: Environment variable LD_PRELOAD=...libmkl_def.so may cause this script</span>
<span class="c1"># crashing</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">fci</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="s1">'H 0 0 0; F 0 0 1.1'</span><span class="p">,</span>  <span class="c1"># in Angstrom</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">'6-31g'</span><span class="p">,</span>
    <span class="n">spin</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">myhf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">myhf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="c1">#</span>
<span class="c1"># First create FCI solver with function fci.FCI and solve the FCI problem</span>
<span class="c1">#</span>
<span class="n">cisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">myhf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="n">e</span><span class="p">,</span> <span class="n">fcivec</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="c1">#</span>
<span class="c1"># Spin-traced 1-particle density matrix</span>
<span class="c1">#</span>
<span class="n">norb</span> <span class="o">=</span> <span class="n">myhf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># 6 alpha electrons, 4 beta electrons because spin = nelec_a-nelec_b = 2</span>
<span class="n">nelec_a</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">nelec_b</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">dm1</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">(</span><span class="n">fcivec</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># alpha and beta 1-particle density matrices</span>
<span class="c1">#</span>
<span class="n">dm1a</span><span class="p">,</span> <span class="n">dm1b</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">make_rdm1s</span><span class="p">(</span><span class="n">fcivec</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>
<span class="k">assert</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm1a</span><span class="o">+</span><span class="n">dm1b</span><span class="p">,</span> <span class="n">dm1</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># Spin-traced 1 and 2-particle density matrices</span>
<span class="c1">#</span>
<span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">make_rdm12</span><span class="p">(</span><span class="n">fcivec</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># alpha and beta 1-particle density matrices</span>
<span class="c1"># For 2-particle density matrix,</span>
<span class="c1"># dm2aa corresponds to alpha spin for both 1st electron and 2nd electron</span>
<span class="c1"># dm2ab corresponds to alpha spin for 1st electron and beta spin for 2nd electron</span>
<span class="c1"># dm2bb corresponds to beta spin for both 1st electron and 2nd electron</span>
<span class="c1">#</span>
<span class="p">(</span><span class="n">dm1a</span><span class="p">,</span> <span class="n">dm1b</span><span class="p">),</span> <span class="p">(</span><span class="n">dm2aa</span><span class="p">,</span><span class="n">dm2ab</span><span class="p">,</span><span class="n">dm2bb</span><span class="p">)</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">make_rdm12s</span><span class="p">(</span><span class="n">fcivec</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>
<span class="k">assert</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm2aa</span><span class="o">+</span><span class="n">dm2ab</span><span class="o">+</span><span class="n">dm2ab</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">dm2bb</span><span class="p">,</span> <span class="n">dm2</span><span class="p">))</span>


<span class="c1">#########################################</span>
<span class="c1">#</span>
<span class="c1"># Transition density matrices</span>
<span class="c1">#</span>
<span class="c1">#########################################</span>

<span class="c1">#</span>
<span class="c1"># First generate two CI vectors, of which the transition density matrices will</span>
<span class="c1"># be computed</span>
<span class="c1">#</span>
<span class="n">cisolver</span><span class="o">.</span><span class="n">nroots</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">(</span><span class="n">e0</span><span class="p">,</span><span class="n">e1</span><span class="p">),</span> <span class="p">(</span><span class="n">fcivec0</span><span class="p">,</span><span class="n">fcivec1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="c1">#</span>
<span class="c1"># Spin-traced 1-particle transition density matrix</span>
<span class="c1"># &lt;0| p^+ q |1&gt;</span>
<span class="c1">#</span>
<span class="n">norb</span> <span class="o">=</span> <span class="n">myhf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">nelec_a</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">nelec_b</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">dm1</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">trans_rdm1</span><span class="p">(</span><span class="n">fcivec0</span><span class="p">,</span> <span class="n">fcivec1</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># alpha and beta 1-particle transition density matrices</span>
<span class="c1">#</span>
<span class="n">dm1a</span><span class="p">,</span> <span class="n">dm1b</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">trans_rdm1s</span><span class="p">(</span><span class="n">fcivec0</span><span class="p">,</span> <span class="n">fcivec1</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>
<span class="k">assert</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm1a</span><span class="o">+</span><span class="n">dm1b</span><span class="p">,</span> <span class="n">dm1</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># Spin-traced 1 and 2-particle transition density matrices</span>
<span class="c1">#</span>
<span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span> <span class="o">=</span> <span class="n">cisolver</span><span class="o">.</span><span class="n">trans_rdm12</span><span class="p">(</span><span class="n">fcivec0</span><span class="p">,</span> <span class="n">fcivec1</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># alpha and beta 1-particle transition density matrices</span>
<span class="c1"># For 2-particle density matrix,</span>
<span class="c1"># dm2aa corresponds to alpha spin for both 1st electron and 2nd electron</span>
<span class="c1"># dm2ab corresponds to alpha spin for 1st electron and beta spin for 2nd electron</span>
<span class="c1"># dm2ba corresponds to beta spin for 1st electron and alpha spin for 2nd electron</span>
<span class="c1"># dm2bb corresponds to beta spin for both 1st electron and 2nd electron</span>
<span class="c1">#</span>
<span class="p">(</span><span class="n">dm1a</span><span class="p">,</span> <span class="n">dm1b</span><span class="p">),</span> <span class="p">(</span><span class="n">dm2aa</span><span class="p">,</span> <span class="n">dm2ab</span><span class="p">,</span> <span class="n">dm2ba</span><span class="p">,</span> <span class="n">dm2bb</span><span class="p">)</span> <span class="o">=</span> \
        <span class="n">cisolver</span><span class="o">.</span><span class="n">trans_rdm12s</span><span class="p">(</span><span class="n">fcivec0</span><span class="p">,</span> <span class="n">fcivec1</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>
<span class="k">assert</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm2aa</span><span class="o">+</span><span class="n">dm2ab</span><span class="o">+</span><span class="n">dm2ba</span><span class="o">+</span><span class="n">dm2bb</span><span class="p">,</span> <span class="n">dm2</span><span class="p">))</span>


<span class="c1">#########################################</span>
<span class="c1">#</span>
<span class="c1"># 3 and 4-particle density matrices</span>
<span class="c1">#</span>
<span class="c1">#########################################</span>

<span class="c1">#</span>
<span class="c1"># Spin-traced 3-particle density matrix</span>
<span class="c1"># 1,2,3-pdm can be computed together.</span>
<span class="c1"># Note make_dm123 computes  dm3[p,q,r,s,t,u] = &lt;p^+ q r^+ s t^+ u&gt;  which is</span>
<span class="c1"># NOT the 3-particle density matrices.  Funciton reorder_dm123 transforms it</span>
<span class="c1"># to the true 3-particle DM  dm3[p,q,r,s,t,u] = &lt;p^+ r^+ t^+ u s q&gt; (as well</span>
<span class="c1"># as the 2-particle DM)</span>
<span class="c1">#</span>
<span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">rdm</span><span class="o">.</span><span class="n">make_dm123</span><span class="p">(</span><span class="s1">'FCI3pdm_kern_sf'</span><span class="p">,</span> <span class="n">fcivec0</span><span class="p">,</span> <span class="n">fcivec0</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span>
                                   <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>
<span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">rdm</span><span class="o">.</span><span class="n">reorder_dm123</span><span class="p">(</span><span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Spin-traced 3-particle transition density matrix</span>
<span class="c1">#</span>
<span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">rdm</span><span class="o">.</span><span class="n">make_dm123</span><span class="p">(</span><span class="s1">'FCI3pdm_kern_sf'</span><span class="p">,</span> <span class="n">fcivec0</span><span class="p">,</span> <span class="n">fcivec1</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span>
                                   <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>
<span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">rdm</span><span class="o">.</span><span class="n">reorder_dm123</span><span class="p">(</span><span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># NOTE computing 4-pdm is very slow</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># Spin-traced 4-particle density matrix</span>
<span class="c1"># Note make_dm1234 computes  dm4[p,q,r,s,t,u,v,w] = &lt;p^+ q r^+ s t^+ u v^+ w&gt;  which is</span>
<span class="c1"># NOT the 4-particle density matrices.  Funciton reorder_dm1234 transforms it</span>
<span class="c1"># to the true 4-particle DM  dm4[p,q,r,s,t,u,v,w] = &lt;p^+ r^+ t^+ v^+ w u s q&gt;</span>
<span class="c1"># (as well as the 2-particle and 3-particle DMs)</span>
<span class="c1">#</span>
<span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span><span class="p">,</span> <span class="n">dm4</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">rdm</span><span class="o">.</span><span class="n">make_dm1234</span><span class="p">(</span><span class="s1">'FCI4pdm_kern_sf'</span><span class="p">,</span> <span class="n">fcivec0</span><span class="p">,</span> <span class="n">fcivec0</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span>
                                         <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>
<span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span><span class="p">,</span> <span class="n">dm4</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">rdm</span><span class="o">.</span><span class="n">reorder_dm1234</span><span class="p">(</span><span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span><span class="p">,</span> <span class="n">dm4</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Spin-traced 4-particle transition density matrix</span>
<span class="c1">#</span>
<span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span><span class="p">,</span> <span class="n">dm4</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">rdm</span><span class="o">.</span><span class="n">make_dm1234</span><span class="p">(</span><span class="s1">'FCI4pdm_kern_sf'</span><span class="p">,</span> <span class="n">fcivec0</span><span class="p">,</span> <span class="n">fcivec1</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span>
                                         <span class="p">(</span><span class="n">nelec_a</span><span class="p">,</span><span class="n">nelec_b</span><span class="p">))</span>
<span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span><span class="p">,</span> <span class="n">dm4</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">rdm</span><span class="o">.</span><span class="n">reorder_dm1234</span><span class="p">(</span><span class="n">dm1</span><span class="p">,</span> <span class="n">dm2</span><span class="p">,</span> <span class="n">dm3</span><span class="p">,</span> <span class="n">dm4</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="gw.html" title="GW approximation"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> GW approximation </span>
              </div>
            </a>
          
          
            <a href="cc.html" title="Coupled-cluster theory"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Coupled-cluster theory </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>