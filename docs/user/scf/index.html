
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>2.2. Self-consistent field (SCF) methods &#8212; PySCF 1.7.5.2 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/material.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../_static/favicon-32x32.png"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="2.3. Density functional theory (DFT)" href="../dft/" />
    <link rel="prev" title="2.1. Molecular structure" href="../gto/" /> 
  
   
  
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=amber>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#user/scf" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../" title="PySCF 1.7.5.2 documentation"
           class="md-header-nav__button md-logo">
          
              <img src="../../_static/pyscf-logo-white.svg" height="26"
                   alt="PySCF 1.7.5.2 documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 1.7.5.2</span>
          <span class="md-header-nav__topic"> 2.2. Self-consistent field (SCF) methods </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search/" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../../" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../../install/" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../../develop/" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="../../api_docs/modules/" class="md-tabs__link">API Docs</a></li>
            
            <li class="md-tabs__item"><a href="../../blog_wrapper/" class="md-tabs__link">Blog</a></li>
            
            <li class="md-tabs__item"><a href="../../about/" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="../" class="md-tabs__link"><span class="section-number">2. </span>User guide</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../" title="PySCF 1.7.5.2 documentation" class="md-nav__button md-logo">
      
        <img src="../../_static/pyscf-logo-white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../"
       title="PySCF 1.7.5.2 documentation">PySCF 1.7.5.2</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../install/" class="md-nav__link">1. Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../" class="md-nav__link">2. User Guide</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../gto/" class="md-nav__link">2.1. Molecular structure</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> 2.2. Self-consistent field (SCF) methods </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">2.2. Self-consistent field (SCF) methods</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-scf--page-root" class="md-nav__link">2.2. Self-consistent field (SCF) methods</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">2.2.1. Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#initial-guess" class="md-nav__link">2.2.2. Initial guess</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#restart-from-an-old-calculation" class="md-nav__link">2.2.2.1. Restart from an old calculation</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#converging-scf-iterations" class="md-nav__link">2.2.3. Converging SCF iterations</a>
        </li>
        <li class="md-nav__item"><a href="#stability-analysis" class="md-nav__link">2.2.4. Stability analysis</a>
        </li>
        <li class="md-nav__item"><a href="#property-calculations" class="md-nav__link">2.2.5. Property calculations</a>
        </li>
        <li class="md-nav__item"><a href="#spin-restricted-spin-unrestricted-restricted-open-shell-and-generalized-calculations" class="md-nav__link">2.2.6. Spin-restricted, spin-unrestricted, restricted open-shell, and generalized calculations</a>
        </li>
        <li class="md-nav__item"><a href="#linear-dependencies" class="md-nav__link">2.2.7. Linear dependencies</a>
        </li>
        <li class="md-nav__item"><a href="#scalar-relativistic-correction" class="md-nav__link">2.2.8. Scalar relativistic correction</a>
        </li>
        <li class="md-nav__item"><a href="#references" class="md-nav__link">2.2.9. References</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/user/scf.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../dft/" class="md-nav__link">2.3. Density functional theory (DFT)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mp/" class="md-nav__link">2.4. Second-Order Møller–Plesset Perturbation Theory (MP2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../gw/" class="md-nav__link">2.5. GW approximation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../ci/" class="md-nav__link">2.6. Configuration interaction (CISD and FCI)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../cc/" class="md-nav__link">2.7. Coupled-cluster theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../adc/" class="md-nav__link">2.8. Algebraic diagrammatic construction (ADC) scheme</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mcscf/" class="md-nav__link">2.9. Multi-configuration self-consistent field (MCSCF)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../tddft/" class="md-nav__link">2.10. Time-dependent Hartree-Fock and Density Functional Theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../rt/" class="md-nav__link">2.11. Real-time time-dependent density functional theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../solvent/" class="md-nav__link">2.12. Solvation models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../qmmm/" class="md-nav__link">2.13. QM/MM methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../x2c/" class="md-nav__link">2.14. Relativistic calculations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../df/" class="md-nav__link">2.15. Density fitting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../pbc/" class="md-nav__link">2.16. Periodic boundary conditions</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../develop/" class="md-nav__link">3. Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../blog_wrapper/" class="md-nav__link">4. Blog</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#user-scf--page-root" class="md-nav__link">2.2. Self-consistent field (SCF) methods</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">2.2.1. Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#initial-guess" class="md-nav__link">2.2.2. Initial guess</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#restart-from-an-old-calculation" class="md-nav__link">2.2.2.1. Restart from an old calculation</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#converging-scf-iterations" class="md-nav__link">2.2.3. Converging SCF iterations</a>
        </li>
        <li class="md-nav__item"><a href="#stability-analysis" class="md-nav__link">2.2.4. Stability analysis</a>
        </li>
        <li class="md-nav__item"><a href="#property-calculations" class="md-nav__link">2.2.5. Property calculations</a>
        </li>
        <li class="md-nav__item"><a href="#spin-restricted-spin-unrestricted-restricted-open-shell-and-generalized-calculations" class="md-nav__link">2.2.6. Spin-restricted, spin-unrestricted, restricted open-shell, and generalized calculations</a>
        </li>
        <li class="md-nav__item"><a href="#linear-dependencies" class="md-nav__link">2.2.7. Linear dependencies</a>
        </li>
        <li class="md-nav__item"><a href="#scalar-relativistic-correction" class="md-nav__link">2.2.8. Scalar relativistic correction</a>
        </li>
        <li class="md-nav__item"><a href="#references" class="md-nav__link">2.2.9. References</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/user/scf.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
             <div class="section" id="self-consistent-field-scf-methods">
<span id="user-scf"></span><h1><span class="section-number">2.2. </span>Self-consistent field (SCF) methods<a class="headerlink" href="#self-consistent-field-scf-methods" title="Permalink to this headline">¶</a></h1>
<p><em>Modules</em>: <a class="reference internal" href="../../modules/scf/#module-scf" title="scf: restricted and unrestricted, closed shell and open shell Hartree-Fock methods"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scf</span></code></a>, <a class="reference internal" href="../../modules/pbc/scf/#module-pbc.scf" title="pbc.scf: Hartree-Fock methods with periodic boundary conditions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pbc.scf</span></code></a>, <a class="reference internal" href="../../modules/soscf/#module-soscf" title="soscf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">soscf</span></code></a></p>
<div class="section" id="introduction">
<h2><span class="section-number">2.2.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Self-consistent field (SCF) methods include both Hartree-Fock (HF) theory
and Kohn-Sham (KS) density functional theory (DFT). Self-consistent
field theories only depend on the electronic density matrices, and are
the simplest level of quantum chemical models. Details that are
specific to DFT can be found in <a class="reference internal" href="../dft/#user-dft"><span class="std std-numref">Section 2.3</span></a>.</p>
<p>In both HF and KS-DFT, the ground-state wavefunction is expressed as a
single Slater determinant <span class="math notranslate nohighlight">\(\Phi_0\)</span> of molecular orbitals (MOs)
<span class="math notranslate nohighlight">\(\psi\)</span>, <span class="math notranslate nohighlight">\(\Phi_0 = \mathcal{A}|\psi_1(1)\psi_2(2) \ldots
\psi_N(N)|\)</span>. The total electronic energy
<span class="math notranslate nohighlight">\(E=\langle\Psi_0|\hat{H}|\Psi_0\rangle\)</span> is then minimized,
subject to orbital orthogonality; this is equivalent to the
description of the electrons as independent particles that only
interact via each others’ mean field.</p>
<p>It can be shown that the minimization of the total energy within a
given basis set (see e.g. <span id="id1">[<span>Lehtola2020_M_1218</span>]</span> or any standard
textbook on quantum chemistry like <span id="id2">[<span>SzaOst2012</span>]</span>) leads to the
equation</p>
<div class="math notranslate nohighlight">
\[\mathbf{F} \mathbf{C} = \mathbf{S} \mathbf{C} \mathbf{E}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> is the matrix of molecular orbital
coefficients, <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> is a diagonal matrix of the
corresponding eigenenergies, and <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> is the atomic
orbital overlap matrix. The Fock matrix <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> is defined
as</p>
<div class="math notranslate nohighlight">
\[\mathbf{F} = \mathbf{T} + \mathbf{V} + \mathbf{J} + \mathbf{K}\;\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> is the kinetic energy matrix,
<span class="math notranslate nohighlight">\(\mathbf{V}\)</span> is the external potential, <span class="math notranslate nohighlight">\(\mathbf{J}\)</span> is
the Coulomb matrix, and <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> is the exchange matrix.</p>
</div>
<div class="section" id="initial-guess">
<h2><span class="section-number">2.2.2. </span>Initial guess<a class="headerlink" href="#initial-guess" title="Permalink to this headline">¶</a></h2>
<p>The Coulomb and exchange matrices depend on the occupied orbitals,
meaning that the SCF equation <span class="math notranslate nohighlight">\(\mathbf{F C}=\mathbf{S C E}\)</span>
needs to be solved self-consistently by some sort of iterative
procedure, which begins from some initial guess. The accuracy of
several initial guesses for SCF calculations has recently been
assessed in <span id="id3">[<span>Lehtola2019_JCTC_1593</span>]</span>, to which we refer for
detailed discussion on initial guesses.</p>
<p>Several of initial guess have been implemented in PySCF; the used
variant is controlled by the <code class="xref py py-attr docutils literal notranslate"><span class="pre">init_guess</span></code> attribute of the SCF
solver. The following values are possible</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'minao'</span></code> (default)</p>
<blockquote>
<div><p>Superposition of atomic densities projected in a minimal basis
obtained from the first contracted functions in the cc-pVTZ or
cc-pVTZ-PP basis set. The guess orbitals are obtained by
diagonalizing the Fock matrix that arises from the spin-restricted
guess density.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'1e'</span></code></p>
<blockquote>
<div><p>The one-electron guess, also known as the core guess, obtains the
guess orbitals from the diagonalization of the core Hamiltonian
<span class="math notranslate nohighlight">\(\mathbf{H}_0 = \mathbf{T} + \mathbf{V}\)</span>, thereby ignoring
all interelectronic interactions and the screening of nuclear
charge. The 1e guess should only be used as a last resort, because
it is so bad for molecular systems; see
<span id="id4">[<span>Lehtola2019_JCTC_1593</span>]</span>.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'atom'</span></code></p>
<blockquote>
<div><p>Superposition of atomic HF density matrices. The atomic HF
calculations are spin-restricted and employ spherically averaged
fractional occupations with ground states determined with fully
numerical calculations at the complete basis set limit in
<span id="id5">[<span>Lehtola2020_PRA_012516</span>]</span>.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'huckel'</span></code></p>
<blockquote>
<div><p>This is the parameter-free Hückel guess described in
<span id="id6">[<span>Lehtola2019_JCTC_1593</span>]</span>, which is based on on-the-fly atomic
HF calculations that are performed analogously to <code class="docutils literal notranslate"><span class="pre">'atom'</span></code>. The
spherically averaged atomic spin-restricted Hartree-Fock
calculations yield a minimal basis of atomic orbitals and orbital
energies, which are used to build a Hückel type matrix that is
diagonalized to obtain guess orbitals.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'vsap'</span></code></p>
<blockquote>
<div><p>Superposition of atomic potentials as described in
<span id="id7">[<span>Lehtola2019_JCTC_1593</span>]</span>. Pretabulated, fully numerical
atomic potentials determined with the approach of
<span id="id8">[<span>Lehtola2020_PRA_012516</span>]</span> are used to build a guess potential
on a DFT quadrature grid; this potential is then used to obtain
the orbitals. Note this option is only available for DFT
calculations in PySCF.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'chk'</span></code></p>
<blockquote>
<div><p>Read in the orbitals from the checkpoint file and use them as the
initial guess (see below for more details).</p>
</div></blockquote>
</li>
</ul>
<p>Alternatively, the user can also override the initial guess density
matrix for an SCF calculation through the <code class="docutils literal notranslate"><span class="pre">dm0</span></code> argument.  For
example, the following script first computes the HF density matrix for
the <span class="math notranslate nohighlight">\(\rm Cr^{6+}\)</span> cation, and then uses it as an initial guess
for a HF calculation of the <span class="math notranslate nohighlight">\(\rm Cr\)</span> atom.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># First calculate the Cr6+ cation</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
    <span class="n">symmetry</span> <span class="o">=</span> <span class="s1">&#39;D2h&#39;</span><span class="p">,</span>
    <span class="n">atom</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;Cr&#39;</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">],</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;cc-pvdz&#39;</span><span class="p">,</span>
    <span class="n">charge</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">spin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="n">dm1</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>

<span class="c1"># Now switch to the neutral atom in the septet state</span>
<span class="n">mol</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">mol</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>

<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">dm0</span><span class="o">=</span><span class="n">dm1</span><span class="p">)</span>
</pre></div>
</div>
<p>More examples can be found in
<a href="#id9"><span class="problematic" id="id10">:source:`examples/scf/15-initial_guess.py`</span></a>, and
<a href="#id11"><span class="problematic" id="id12">:source:`examples/scf/31-cr_atom_rohf_tune_init_guess.py`</span></a>.</p>
<div class="section" id="restart-from-an-old-calculation">
<h3><span class="section-number">2.2.2.1. </span>Restart from an old calculation<a class="headerlink" href="#restart-from-an-old-calculation" title="Permalink to this headline">¶</a></h3>
<p>Although alike many other quantum chemistry codes, there is no
<cite>restart</cite> mechanism available in PySCF package, calculations can still
be “restarted” by reading in an earlier wave function as the initial
guess for the wave function.  The initial guess can be prepared in
many ways.  One is to read the <code class="docutils literal notranslate"><span class="pre">chkpoint</span></code> file which is generated in
the previous or other calculations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">scf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">chkfile</span> <span class="o">=</span> <span class="s1">&#39;/path/to/chkfile&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">init_guess</span> <span class="o">=</span> <span class="s1">&#39;chkfile&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">/path/to/chkfile</span></code> can be found in the output in the calculation (if
<code class="docutils literal notranslate"><span class="pre">mol.verbose</span> <span class="pre">&gt;=</span> <span class="pre">4</span></code>, the filename of the chkfile will be dumped in
the output).  If the results of the calculation are needed at a later
stage (e.g. for an eventual restart or use as an initial guess for a
larger calculation), the <code class="xref py py-attr docutils literal notranslate"><span class="pre">chkfile</span></code> attribute should be set
explicitly as the chkfile might otherwise be deleted upon successful
completion of the calculation, see comments in
<a href="#id13"><span class="problematic" id="id14">:source:`examples/scf/14-restart.py`</span></a>.
By setting <code class="xref py py-attr docutils literal notranslate"><span class="pre">chkfile</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">init_guess</span></code>, the
SCF module can read the molecular orbitals from the given
<code class="xref py py-attr docutils literal notranslate"><span class="pre">chkfile</span></code> and rotate them to representation of the required
basis.</p>
<p>The initial guess can also be fed in directly to the calculation. For
example, we can read in the density matrix from a checkpoint file, and
pass it directly to the SCF solver with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">scf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">from_chk</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s1">&#39;/path/to/chkfile&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
<p>This approach leads to the same result as setting <code class="xref py py-attr docutils literal notranslate"><span class="pre">init_guess</span></code>
to <cite>chkfile</cite>.</p>
<p>N.B. The <code class="docutils literal notranslate"><span class="pre">chkfile</span></code> initial guess is not limited to calculations on
the same molecule or the same basis set. One can first do a cheaper
SCF calculation with smaller basis sets, or run an SCF calculation on
a model system (e.g. drop a few atoms or run the same system in an
easier charge/spin state), then use <code class="xref py py-func docutils literal notranslate"><span class="pre">scf.hf.from_chk()</span></code> to project
the results to the target basis sets.</p>
</div>
</div>
<div class="section" id="converging-scf-iterations">
<h2><span class="section-number">2.2.3. </span>Converging SCF iterations<a class="headerlink" href="#converging-scf-iterations" title="Permalink to this headline">¶</a></h2>
<p>Even with a very good initial guess, making the SCF procedure converge
is sometimes challenging. PySCF implements two kinds of approaches for
SCF, namely, direct inversion in the iterative subspace (DIIS) and
second-order SCF (SOSCF).</p>
<ul>
<li><p>DIIS (default)</p>
<blockquote>
<div><p>With DIIS, the Fock matrix at each iteration is extrapolated using
Fock matrices from the previous iterations, by minimizing the norm
of the commutator <span class="math notranslate nohighlight">\([\mathbf{F},\mathbf{PS}]\)</span> where
<span class="math notranslate nohighlight">\(\mathbf{P}\)</span> is the density matrix
<span id="id15">[<span>Pulay1980_CPL_393</span><span>Pulay1982_JCC_556</span>]</span>.  Two variants of DIIS
are implemented in PySCF, namely, EDIIS <span id="id16">[<span>Kudin2002_JCP_8255</span>]</span>
and ADIIS <span id="id17">[<span>Hu2010_JCP_054109</span>]</span>.  Examples of selecting
different DIIS schemes can be found in
<a href="#id18"><span class="problematic" id="id19">:source:`examples/scf/24-tune_diis.py`</span></a>.</p>
</div></blockquote>
</li>
<li><p>SOSCF</p>
<blockquote>
<div><p>To achieve quadratic convergence in the orbital optimization,
PySCF implements a general second-order solver called the
co-iterative augmented hessian (CIAH) method
<span id="id20">[<span>Sun2016</span><span>Sun2017_CPL_291</span>]</span>. This method can be invoked by
decorating the SCF objects with the <a class="reference internal" href="../../modules/soscf/#pyscf.soscf.newton_ah.newton" title="pyscf.soscf.newton_ah.newton"><code class="xref py py-func docutils literal notranslate"><span class="pre">newton()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">newton</span><span class="p">()</span>
</pre></div>
</div>
<p>More examples can be found in
<a href="#id21"><span class="problematic" id="id22">:source:`examples/scf/22-newton.py`</span></a>.</p>
</div></blockquote>
</li>
<li><p>Damping</p>
<blockquote>
<div><p>The Fock matrix can be damped before DIIS acceleration kicks in.
This is achieved by setting the attributes <code class="xref py py-attr docutils literal notranslate"><span class="pre">damp</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">diis_start_cycle</span></code>.  For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span><span class="o">.</span><span class="n">damp</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">mf</span><span class="o">.</span><span class="n">diis_start_cycle</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>means that DIIS will start at the second cycle, and that the Fock
matrix is damped by 50% in the first cycle.</p>
</div></blockquote>
</li>
<li><p>Level shifting</p>
<blockquote>
<div><p>A level shift increases the gap between the occupied and virtual
orbitals, thereby slowing down and stabilizing the orbital update.
A level shift can help to converge SCF in the case of systems with
small HOMO-LUMO gaps. Level shifting is invoked by setting the
attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">level_shift</span></code>.  See examples in
<a href="#id23"><span class="problematic" id="id24">:source:`examples/scf/03-level_shift.py`</span></a>, and
<a href="#id25"><span class="problematic" id="id26">:source:`examples/scf/52-dynamically_control_level_shift.py`</span></a>.</p>
</div></blockquote>
</li>
<li><p>Fractional occupations</p>
<blockquote>
<div><p>Fractional occupations can also be invoked to help the SCF
converge for small gap systems.  See the example in
<a href="#id27"><span class="problematic" id="id28">:source:`examples/scf/54-fractional_occupancy.py`</span></a>.</p>
</div></blockquote>
</li>
<li><p>Smearing</p>
<blockquote>
<div><p>Smearing sets fractional occupancies according to a temperature
function. See the example <a href="#id29"><span class="problematic" id="id30">:source:`examples/pbc/23-smearing.py`</span></a>.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="stability-analysis">
<span id="id31"></span><h2><span class="section-number">2.2.4. </span>Stability analysis<a class="headerlink" href="#stability-analysis" title="Permalink to this headline">¶</a></h2>
<p>Even when the SCF converges, the wave function that is found may not
correspond to a local minimum; calculations can sometimes also
converge onto saddle points. Since saddle points are also extrema of
the energy functional, the orbital gradient vanishes and the SCF
equation <span class="math notranslate nohighlight">\(\mathbf{F C}=\mathbf{S C E}\)</span> is satisfied
<span id="id32">[<span>Lehtola2020_M_1218</span>]</span>. However, in such cases the energy can be
decreased by perturbing the orbitals away from the saddle point, which
means that the wave function is unstable.</p>
<p>Instabilities in the wave function are conventionally classified as
either internal or external <span id="id33">[<span>Seeger1977_JCP_3045</span>]</span>. External
instabilities mean that the energy can be decreased by loosening some
constraints on the wave function, such as allowing restricted
Hartree-Fock orbitals to transform into unrestricted Hartree-Fock,
whereas internal instabilities mean that the SCF has converged onto an
excited state instead of the ground state. PySCF allows detecting both
internal and external instabilities for a given SCF calculation; see
the examples in <a href="#id34"><span class="problematic" id="id35">:source:`examples/scf/17-stability.py`</span></a>.</p>
</div>
<div class="section" id="property-calculations">
<h2><span class="section-number">2.2.5. </span>Property calculations<a class="headerlink" href="#property-calculations" title="Permalink to this headline">¶</a></h2>
<p>Various properties can be computed by calling the corresponding
functions, for example,</p>
<ul>
<li><p>dipole moment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span><span class="o">.</span><span class="n">dip_moment</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Mulliken population:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span><span class="o">.</span><span class="n">mulliken_pop</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>nuclear gradients:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">Gradients</span><span class="p">()</span>
<span class="n">g</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
<p>Also several response properties are available in PySCF, see the
examples in <a href="#id36"><span class="problematic" id="id37">:source:`examples/prop/17-stability.py`</span></a>.</p>
</div>
<div class="section" id="spin-restricted-spin-unrestricted-restricted-open-shell-and-generalized-calculations">
<h2><span class="section-number">2.2.6. </span>Spin-restricted, spin-unrestricted, restricted open-shell, and generalized calculations<a class="headerlink" href="#spin-restricted-spin-unrestricted-restricted-open-shell-and-generalized-calculations" title="Permalink to this headline">¶</a></h2>
<p>The general spin-orbital used in the HF or KS-DFT wave function can be
written as</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\psi_i(1) = \phi_{i\alpha}(r)\alpha + \phi_{i\beta}(r)\beta \;,\]</div>
</div></blockquote>
<p>Four variants of the ansatz <span class="math notranslate nohighlight">\(\psi(1)\)</span> are commonly used in
quantum chemistry; they are also all available in PySCF.</p>
<ul>
<li><p>Restricted (RHF/RKS)</p>
<p>The spin-orbitals are either alpha (spin-up) or beta (spin-down),
<span class="math notranslate nohighlight">\(\psi_i =\phi_i(r)\alpha\)</span> or <span class="math notranslate nohighlight">\(\psi_i = \phi_i(r)\beta\)</span>,
and the alpha and beta orbitals share the same spatial orbital
<span class="math notranslate nohighlight">\(\phi_i(r)\)</span>. The closed-shell determinant is thus
<span class="math notranslate nohighlight">\(\Phi=\mathcal{A}|\phi_1(r_1)\alpha \phi_1(r_2)\beta \ldots
\phi_{N/2}(r_{N-1})\alpha \phi_{N/2}(r_N)\beta|\)</span> and <span class="math notranslate nohighlight">\(S=0\)</span>.</p>
</li>
<li><p>Unrestricted (UHF/UKS)</p>
<p>The orbitals can have either alpha or beta spin, but the alpha and
beta orbitals may have different spatial components. The determinant
is thus <span class="math notranslate nohighlight">\(\Phi=\mathcal{A}|\phi_1(r_1)\sigma_1
\phi_2(r_2)\sigma_2 \ldots \phi_{N}(r_N)\sigma_N|\)</span> where
<span class="math notranslate nohighlight">\(\sigma \in \{\alpha,\beta\}\)</span>.  Spin contamination is
introduced for states that don’t have maximal <span class="math notranslate nohighlight">\(S_z\)</span>.</p>
</li>
<li><p>Restricted open-shell (ROHF/ROKS)</p>
<p>Equivalent to RHF/RKS for <span class="math notranslate nohighlight">\(N_\alpha = N_\beta\)</span>.  For
<span class="math notranslate nohighlight">\(N_\alpha &gt; N_\beta\)</span>, the first <span class="math notranslate nohighlight">\(N_\beta\)</span> orbitals have
the same spatial components for both <span class="math notranslate nohighlight">\(\alpha\)</span> and
<span class="math notranslate nohighlight">\(\beta\)</span> spin. The remaining <span class="math notranslate nohighlight">\(N_\alpha - N_\beta\)</span>
orbitals are of <span class="math notranslate nohighlight">\(\alpha\)</span> spin.  <span class="math notranslate nohighlight">\(\Phi=\mathcal{A}|\phi_1
\alpha \phi_1\beta \ldots \phi_{N_\beta} \alpha \phi_{N_\beta}\beta
\phi_{N_\beta+1}\alpha \ldots \phi_{N}\alpha|\)</span> The final
wavefunction is an eigenfunction of the <span class="math notranslate nohighlight">\(\hat{S}^2\)</span> operator
with <span class="math notranslate nohighlight">\(S_z=S\)</span>.</p>
</li>
<li><p>Generalized (GHF/GKS)</p>
<p>The general form of the spin-orbital <span class="math notranslate nohighlight">\(\psi\)</span> is used. GHF/GKS
is useful when none of the previous methods provide stable solutions
(see <a href="#id38"><span class="problematic" id="id39">:source:`examples/scf/17-stability.py`</span></a>), or when the
Hamiltonian does not commute with <span class="math notranslate nohighlight">\(\hat{S}_z\)</span> (e.g. in the
presence of spin-orbit coupling, see
<a href="#id40"><span class="problematic" id="id41">:source:`examples/scf/44-soc_ecp.py`</span></a>).</p>
</li>
</ul>
<p>Calculations with these methods can be invoked by creating an instance
of the corresponding class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">GHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">ROKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">GKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>More examples can be found in
<a href="#id42"><span class="problematic" id="id43">:source:`examples/scf/00-simple_hf.py`</span></a>,
<a href="#id44"><span class="problematic" id="id45">:source:`examples/scf/01-h2o.py`</span></a>,
<a href="#id46"><span class="problematic" id="id47">:source:`examples/scf/02-rohf_uhf.py`</span></a>, and
<a href="#id48"><span class="problematic" id="id49">:source:`examples/scf/02-ghf.py`</span></a>.</p>
</div>
<div class="section" id="linear-dependencies">
<h2><span class="section-number">2.2.7. </span>Linear dependencies<a class="headerlink" href="#linear-dependencies" title="Permalink to this headline">¶</a></h2>
<p>Most quantum chemistry programs solve the self-consistent field
equations</p>
<div class="math notranslate nohighlight">
\[\mathbf{F} \mathbf{C} = \mathbf{S} \mathbf{C} \mathbf{E}\]</div>
<p>in an orthonormal basis, which is formally obtained as</p>
<div class="math notranslate nohighlight">
\[\mathbf{C} = \mathbf{X} \tilde{\mathbf{C}}\]</div>
<p>where the orthogonalizing matrix <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is typically
chosen as <span class="math notranslate nohighlight">\(\mathbf{X}=\mathbf{S}^{-1/2}\)</span>. By expressing the
orbitals in terms of the half-inverse overlap matrix, the generalized
eigenproblem <span class="math notranslate nohighlight">\(\mathbf{F} \mathbf{C} = \mathbf{S} \mathbf{C}
\mathbf{E}\)</span> can be rewritten as a regular eigenproblem
<span class="math notranslate nohighlight">\(\tilde{\mathbf{F}} \tilde{\mathbf{C}} = \tilde{\mathbf{C}}
\mathbf{E}\)</span> <span id="id50">[<span>Lehtola2020_M_1218</span>]</span>.</p>
<p>Moreover, as the half-inverse overlap matrix <span class="math notranslate nohighlight">\(\mathbf{S}^{-1/2}\)</span>
is typically formed by the canonical orthonormalization procedure
<span id="id51">[<span>Lowdin1970_AQC_185</span>]</span> in which eigenvectors of the overlap matrix
with small eigenvalues are thrown out, this procedure typically
results in a better-conditioned basis since linearly dependent
combinations of the basis functions are excluded by the procedure.</p>
<p>At variance, PySCF relies on SciPy’s generalized eigenvalue solver by
default, which may fail for poorly conditioned basis sets. One can,
however, switch to the use of canonical orthonormalization by toggling
e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">remove_linear_dep_</span><span class="p">)</span>
</pre></div>
</div>
<p>In the presence of truly pathological linear dependencies, such as
those that occur in molecular calculations with multiply augmented
basis sets, and at extreme molecular geometries where two nuclei are
close to each other, also canonical orthonormalization fails.
However, the addons module also implements the partial Cholesky
orthonormalization technique
<span id="id52">[<span>Lehtola2019_JCP_241102</span><span>Lehtola2020_PRA_032504</span>]</span>, which has been
shown to work reliably even in the presence of such truly pathological
linear dependencies.</p>
</div>
<div class="section" id="scalar-relativistic-correction">
<h2><span class="section-number">2.2.8. </span>Scalar relativistic correction<a class="headerlink" href="#scalar-relativistic-correction" title="Permalink to this headline">¶</a></h2>
<p>Scalar relativistic effects can be applied on the one-body operators
through spin-free eXact-2-component (SFX2C) Hamiltonian
<span id="id53">[<span>dyall2001interfacing</span>]</span>.  The SFX2C Hamiltonian can be invoked by
decorating the SCF objects with the <code class="xref py py-func docutils literal notranslate"><span class="pre">x2c()</span></code> method, three other
equivalent function names are also listed below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">x2c</span><span class="p">()</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">x2c1e</span><span class="p">()</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">sfx2c</span><span class="p">()</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">sfx2c1e</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that the SFX2C Hamiltonian only changes the one-body operators,
and it only accounts for the mass-velocity effect, while picture
change effect and spin-orbit coupling are not included.  Once the SCF
object is decorated by <code class="xref py py-func docutils literal notranslate"><span class="pre">x2c()</span></code> method, the corresponding post-SCF
objects will also automatically have the SFX2C Hamiltonian applied.
To turn it off explicitly, one can do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span><span class="o">.</span><span class="n">with_x2c</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p>More examples can be found in
<a href="#id54"><span class="problematic" id="id55">:source:`examples/scf/21-x2c.py`</span></a>.</p>
</div>
<div class="section" id="references">
<h2><span class="section-number">2.2.9. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<span class="target" id="id56"></span></div>
</div>

<div class="section">
   
</div>

          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../gto/" title="2.1. Molecular structure"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> <span class="section-number">2.1. </span>Molecular structure </span>
              </div>
            </a>
          
          
            <a href="../dft/" title="2.3. Density functional theory (DFT)"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> <span class="section-number">2.3. </span>Density functional theory (DFT) </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>