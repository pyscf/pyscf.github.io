
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Quickstart &#8212; PySCF 2.0.0 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/material.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="User Guide" href="user.html" />
    <link rel="prev" title="Installation" href="install.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=amber>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#quickstart" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="PySCF 2.0.0 documentation"
           class="md-header-nav__button md-logo">
          
              <img src="_static/pyscf-logo-white.svg" height="26"
                   alt="PySCF 2.0.0 documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.0</span>
          <span class="md-header-nav__topic"> Quickstart </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="overview.html" class="md-tabs__link">Overview</a></li>
            
            <li class="md-tabs__item"><a href="install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="#" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="develop.html" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="pyscf_api_docs/modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="about.html" class="md-tabs__link">About</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="PySCF 2.0.0 documentation" class="md-nav__button md-logo">
      
        <img src="_static/pyscf-logo-white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="PySCF 2.0.0 documentation">PySCF 2.0</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="install.html" class="md-nav__link">Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Quickstart </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Quickstart</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#quickstart--page-root" class="md-nav__link">Quickstart</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#input-parsing" class="md-nav__link">Input Parsing</a>
        </li>
        <li class="md-nav__item"><a href="#mean-field-theory" class="md-nav__link">Mean-Field Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#hartree-fock" class="md-nav__link">Hartree-Fock</a>
        </li>
        <li class="md-nav__item"><a href="#kohn-sham-density-functional-theory" class="md-nav__link">Kohn-Sham Density Functional Theory</a>
        </li>
        <li class="md-nav__item"><a href="#time-dependent-mean-field-theory" class="md-nav__link">Time-Dependent Mean-Field Theory</a>
        </li>
        <li class="md-nav__item"><a href="#spatially-localized-molecular-orbitals" class="md-nav__link">Spatially Localized Molecular Orbitals</a>
        </li>
        <li class="md-nav__item"><a href="#relativistic-effects" class="md-nav__link">Relativistic Effects</a>
        </li>
        <li class="md-nav__item"><a href="#symmetry-handling" class="md-nav__link">Symmetry Handling</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#integrals-density-fitting" class="md-nav__link">Integrals & Density Fitting</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#and-2-electron-integrals" class="md-nav__link">1- and 2-Electron Integrals</a>
        </li>
        <li class="md-nav__item"><a href="#density-fitting-techniques" class="md-nav__link">Density Fitting Techniques</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#correlated-wave-function-theory" class="md-nav__link">Correlated Wave Function Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#perturbation-theory-coupled-cluster-and-algebraic-diagrammatic-constructions" class="md-nav__link">Perturbation Theory, Coupled Cluster, and Algebraic Diagrammatic Constructions</a>
        </li>
        <li class="md-nav__item"><a href="#full-configuration-interaction" class="md-nav__link">Full Configuration Interaction</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#multiconfigurational-methods" class="md-nav__link">Multiconfigurational Methods</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#complete-active-space-configuration-interaction-self-consistent-field" class="md-nav__link">Complete Active Space Configuration Interaction & Self-Consistent Field</a>
        </li>
        <li class="md-nav__item"><a href="#external-approximate-full-configuration-interaction-solvers" class="md-nav__link">External Approximate Full Configuration Interaction Solvers</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#geometry-optimization" class="md-nav__link">Geometry Optimization</a>
        </li>
        <li class="md-nav__item"><a href="#solvent-effects" class="md-nav__link">Solvent Effects</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#polarizable-continuum-cosmo-methods" class="md-nav__link">Polarizable Continuum & COSMO Methods</a>
        </li>
        <li class="md-nav__item"><a href="#quantum-mechanics-molecular-mechanics-methods" class="md-nav__link">Quantum Mechanics/Molecular Mechanics Methods</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#periodic-boundary-conditions" class="md-nav__link">Periodic Boundary Conditions</a>
        </li>
        <li class="md-nav__item"><a href="#summary" class="md-nav__link">Summary</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/quickstart.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#input-parsing" class="md-nav__link">Input Parsing</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#mean-field-theory" class="md-nav__link">Mean-Field Theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#integrals-density-fitting" class="md-nav__link">Integrals & Density Fitting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#correlated-wave-function-theory" class="md-nav__link">Correlated Wave Function Theory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#multiconfigurational-methods" class="md-nav__link">Multiconfigurational Methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#geometry-optimization" class="md-nav__link">Geometry Optimization</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#solvent-effects" class="md-nav__link">Solvent Effects</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#periodic-boundary-conditions" class="md-nav__link">Periodic Boundary Conditions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#summary" class="md-nav__link">Summary</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="develop.html" class="md-nav__link">Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf_api_docs/pyscf.html" class="md-nav__link">API</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="interface.html" class="md-nav__link">Interface</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="about.html" class="md-nav__link">About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#quickstart--page-root" class="md-nav__link">Quickstart</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#input-parsing" class="md-nav__link">Input Parsing</a>
        </li>
        <li class="md-nav__item"><a href="#mean-field-theory" class="md-nav__link">Mean-Field Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#hartree-fock" class="md-nav__link">Hartree-Fock</a>
        </li>
        <li class="md-nav__item"><a href="#kohn-sham-density-functional-theory" class="md-nav__link">Kohn-Sham Density Functional Theory</a>
        </li>
        <li class="md-nav__item"><a href="#time-dependent-mean-field-theory" class="md-nav__link">Time-Dependent Mean-Field Theory</a>
        </li>
        <li class="md-nav__item"><a href="#spatially-localized-molecular-orbitals" class="md-nav__link">Spatially Localized Molecular Orbitals</a>
        </li>
        <li class="md-nav__item"><a href="#relativistic-effects" class="md-nav__link">Relativistic Effects</a>
        </li>
        <li class="md-nav__item"><a href="#symmetry-handling" class="md-nav__link">Symmetry Handling</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#integrals-density-fitting" class="md-nav__link">Integrals & Density Fitting</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#and-2-electron-integrals" class="md-nav__link">1- and 2-Electron Integrals</a>
        </li>
        <li class="md-nav__item"><a href="#density-fitting-techniques" class="md-nav__link">Density Fitting Techniques</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#correlated-wave-function-theory" class="md-nav__link">Correlated Wave Function Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#perturbation-theory-coupled-cluster-and-algebraic-diagrammatic-constructions" class="md-nav__link">Perturbation Theory, Coupled Cluster, and Algebraic Diagrammatic Constructions</a>
        </li>
        <li class="md-nav__item"><a href="#full-configuration-interaction" class="md-nav__link">Full Configuration Interaction</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#multiconfigurational-methods" class="md-nav__link">Multiconfigurational Methods</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#complete-active-space-configuration-interaction-self-consistent-field" class="md-nav__link">Complete Active Space Configuration Interaction & Self-Consistent Field</a>
        </li>
        <li class="md-nav__item"><a href="#external-approximate-full-configuration-interaction-solvers" class="md-nav__link">External Approximate Full Configuration Interaction Solvers</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#geometry-optimization" class="md-nav__link">Geometry Optimization</a>
        </li>
        <li class="md-nav__item"><a href="#solvent-effects" class="md-nav__link">Solvent Effects</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#polarizable-continuum-cosmo-methods" class="md-nav__link">Polarizable Continuum & COSMO Methods</a>
        </li>
        <li class="md-nav__item"><a href="#quantum-mechanics-molecular-mechanics-methods" class="md-nav__link">Quantum Mechanics/Molecular Mechanics Methods</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#periodic-boundary-conditions" class="md-nav__link">Periodic Boundary Conditions</a>
        </li>
        <li class="md-nav__item"><a href="#summary" class="md-nav__link">Summary</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/quickstart.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="quickstart--page-root">Quickstart<a class="headerlink" href="#quickstart--page-root" title="Permalink to this headline">¶</a></h1>
<p>This quickstart provides a brief introduction to the use of PySCF in common quantum chemical simulations. These make reference to specific examples within the dedicated <a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples">examples</a> directory. For brevity, and so as to not repeat a number of function calls, please note that the cells below often share objects in-between one another. The selection below is far from exhaustive: additional details on the various modules are presented in the accompanying user guide and within the examples directory.</p>

<span id="input"></span><h2 id="input-parsing">Input Parsing<a class="headerlink" href="#input-parsing" title="Permalink to this headline">¶</a></h2>
<p>Molecules (or unit cells, cf. the <span class="xref std std-ref">periodic</span> section) can be created using the convenient shortcut function <code class="docutils literal notranslate"><span class="pre">Mole.build()</span></code> as in (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/gto/00-input_mole.py">gto/00-input_mole.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">'O 0 0 0; H 0 1 0; H 0 0 1'</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="s1">'ccpvdz'</span><span class="p">)</span>
</pre></div>
</div>
<p>Whenever you change the value of the attributes of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code>, you’ll need to call <code class="docutils literal notranslate"><span class="pre">build()</span></code> again to refresh the internal data of the object.</p>
<p>Symmetry may be specified in the <code class="docutils literal notranslate"><span class="pre">Mole.symmetry</span></code> attribute as either <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> (default is <code class="docutils literal notranslate"><span class="pre">False</span></code>, i.e., off). Alternatively, a particular subgroup can be specified by a string argument (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/gto/13-symmetry.py">gto/13-symmetry.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol_c2</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">'C 0 0 .625; O 0 0 -.625'</span><span class="p">,</span> <span class="n">symmetry</span> <span class="o">=</span> <span class="s1">'d2h'</span><span class="p">)</span>
</pre></div>
</div>
<p>There are many other ways to input a molecular or crystalline geometry (e.g., by means of Z-matrices or reading in .xyz files), cf. the complete suite of <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/gto">gto</a> and <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc">pbc</a> examples.</p>


<span id="mf"></span><h2 id="mean-field-theory">Mean-Field Theory<a class="headerlink" href="#mean-field-theory" title="Permalink to this headline">¶</a></h2>

<span id="hf"></span><h3 id="hartree-fock">Hartree-Fock<a class="headerlink" href="#hartree-fock" title="Permalink to this headline">¶</a></h3>
<p>A mean-field (e.g., Hartree-Fock) calculation on the H<sub>2</sub>O geometry of the <a class="reference internal" href="#input"><span class="std std-ref">above</span></a> section can be performed by (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/00-simple_hf.py">scf/00-simple_hf.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">scf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_h2o</span> <span class="o">=</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Besides the final converged ground-state energy, the mean-field object stores the accompanying MO coefficients, occupations, etc. To illustrate how open-shell, possibly spin-polarized calculations are performed, different Hartree-Fock simulations of the O<sub>2</sub> dimer - with its triplet ground state - can be setup as (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/02-rohf_uhf.py">scf/02-rohf_uhf.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol_o2</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'O 0 0 0; O 0 0 1.2'</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># (n+2 alpha, n beta) electrons</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uhf_o2</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol_o2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uhf_o2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rohf_o2</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">(</span><span class="n">mol_o2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rohf_o2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally, a second-order, Newton-Raphson SCF method is available, (which is also compatible with most but not all XC functionals, cf. <a class="reference internal" href="#ksdft"><span class="std std-ref">below</span></a>). This requires a set of orthonormal orbitals and their corresponding occupancies as initial guesses. These are automatically generated if none are provided (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/22-newton.py">scf/22-newton.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o</span> <span class="o">=</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">newton</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_h2o</span> <span class="o">=</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>


<span id="ksdft"></span><h3 id="kohn-sham-density-functional-theory">Kohn-Sham Density Functional Theory<a class="headerlink" href="#kohn-sham-density-functional-theory" title="Permalink to this headline">¶</a></h3>
<p>Running a KS-DFT calculation is as straightforward as the <a class="reference internal" href="#hf"><span class="std std-ref">above</span></a> HF counterpart (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/dft/00-simple_dft.py">dft/00-simple_dft.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_h2o</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span> <span class="c1"># likewise for UKS and ROKS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_h2o</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">'b3lyp'</span>
</pre></div>
</div>
<p>Besides the use of predefined XC functionals (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/pyscf/dft/libxc.py">pyscf/dft/libxc.py</a> and <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/pyscf/dft/xcfun.py">pyscf/dft/xcfun.py</a> for the complete lists of
available functionals), these can also be fully defined by the user (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/dft/24-custom_xc_functional.py">dft/24-custom_xc_functional.py</a>), as can the angular and radial grids used in the calculation (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/dft/11-grid_scheme.py">dft/11-grid_scheme.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rks_h2o</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">'.2 * HF + .08 * LDA + .72 * B88, .81 * LYP + .19 * VWN'</span> <span class="c1"># B3LYP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_h2o</span><span class="o">.</span><span class="n">grids</span><span class="o">.</span><span class="n">atom_grid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">770</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_h2o</span><span class="o">.</span><span class="n">grids</span><span class="o">.</span><span class="n">prune</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_rks</span> <span class="o">=</span> <span class="n">rks_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Combining dense and sparse grids is important whenever XC functionals with non-local dispersion (van der Waals) corrections are employed (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/dft/33-nlc_functionals.py">dft/33-nlc_functionals.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">'wb97m_v'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">nlc</span> <span class="o">=</span> <span class="s1">'vv10'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">grids</span><span class="o">.</span><span class="n">atom_grid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">99</span><span class="p">,</span><span class="mi">590</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">grids</span><span class="o">.</span><span class="n">prune</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">nlcgrids</span><span class="o">.</span><span class="n">atom_grid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">194</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">nlcgrids</span><span class="o">.</span><span class="n">prune</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">sg1_prune</span>
</pre></div>
</div>


<span id="tdmf"></span><h3 id="time-dependent-mean-field-theory">Time-Dependent Mean-Field Theory<a class="headerlink" href="#time-dependent-mean-field-theory" title="Permalink to this headline">¶</a></h3>
<p>Linear response theory is available for both HF and KS-DFT (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/tddft/00-simple_tddft.py">tddft/00-simple_tddft.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">tdscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tdhf_h2o</span> <span class="o">=</span> <span class="n">tdscf</span><span class="o">.</span><span class="n">TDHF</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tdhf_h2o</span><span class="o">.</span><span class="n">nstates</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tdhf_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tddft_h2o</span> <span class="o">=</span> <span class="n">tdscf</span><span class="o">.</span><span class="n">TDA</span><span class="p">(</span><span class="n">rks_h2o</span><span class="p">)</span> <span class="c1"># TDDFT with Tamm-Dancoff approximation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tddft_h2o</span><span class="o">.</span><span class="n">nstates</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tddft_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>From a converged time-dependent mean-field calculation, the corresponding natural transition orbitals for a particular excited state may be recovered as (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/tddft/01-nto_analysis.py">tddft/01-nto_analysis.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">nto</span> <span class="o">=</span> <span class="n">tdhf_h2o</span><span class="o">.</span><span class="n">get_nto</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>As an alternative to response theory, <span class="math notranslate nohighlight">\(\Delta\)</span>-SCF with Gill’s maximum overlap method is available to converge specific excited states, cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/50-mom-deltaSCF.py">scf/50-mom-deltaSCF.py</a>.</p>


<span id="loc"></span><h3 id="spatially-localized-molecular-orbitals">Spatially Localized Molecular Orbitals<a class="headerlink" href="#spatially-localized-molecular-orbitals" title="Permalink to this headline">¶</a></h3>
<p>PySCF offers a number of different standard schemes for localizing MOs, e.g., Pipek-Mezey, Foster-Boys, and Edmiston-Ruedenberg (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/local_orb/03-split_localization.py">local_orb/03-split_localization.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">occ_orbs</span> <span class="o">=</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[:,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_occ</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fb_h2o</span> <span class="o">=</span> <span class="n">lo</span><span class="o">.</span><span class="n">Boys</span><span class="p">(</span><span class="n">mol_h2o</span><span class="p">,</span> <span class="n">occ_orbs</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="p">)</span> <span class="c1"># Foster-Boys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loc_occ_orbs</span> <span class="o">=</span> <span class="n">fb</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">virt_orbs</span> <span class="o">=</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[:,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_occ</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pm_h2o</span> <span class="o">=</span> <span class="n">lo</span><span class="o">.</span><span class="n">PM</span><span class="p">(</span><span class="n">mol_h2o</span><span class="p">,</span> <span class="n">virt_orbs</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="p">)</span> <span class="c1"># Pipek-Mezey</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loc_virt_orbs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Knizia’s intrinsic bond orbitals can be computed as (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/local_orb/04-ibo_benzene_cubegen.py">local_orb/04-ibo_benzene_cubegen.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iao</span> <span class="o">=</span> <span class="n">lo</span><span class="o">.</span><span class="n">iao</span><span class="o">.</span><span class="n">iao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">occ_orbs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iao</span> <span class="o">=</span> <span class="n">lo</span><span class="o">.</span><span class="n">vec_lowdin</span><span class="p">(</span><span class="n">iao</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">get_ovlp</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibo</span> <span class="o">=</span> <span class="n">lo</span><span class="o">.</span><span class="n">ibo</span><span class="o">.</span><span class="n">ibo</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">occ_orbs</span><span class="p">,</span> <span class="n">iaos</span><span class="o">=</span><span class="n">iao</span><span class="p">)</span>
</pre></div>
</div>


<span id="rel"></span><h3 id="relativistic-effects">Relativistic Effects<a class="headerlink" href="#relativistic-effects" title="Permalink to this headline">¶</a></h3>
<p>PySCF implements a Dirac-Hartree-Fock solver for relativistic effects. Different Hamiltonians are available, for example with Breit and/or Gaunt interactions (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/05-breit_gaunt.py">scf/05-breit_gaunt.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dhf_c2</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">DHF</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dhf_c2</span><span class="o">.</span><span class="n">with_gaunt</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dhf_c2</span><span class="o">.</span><span class="n">with_breit</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dhf_c2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>At lower cost, scalar relativistic effects can be included in a mean-field treatment by decorating the a <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code> object (either HF or KS-DFT) with the <code class="docutils literal notranslate"><span class="pre">.x2c()</span></code> method (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/21-x2c.py">scf/21-x2c.py</a>). This modifies the Hamiltonian and affects subsequent correlated calculations:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uks_o2_x2c</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UKS</span><span class="p">(</span><span class="n">mol_o2</span><span class="p">)</span><span class="o">.</span><span class="n">x2c</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uks_o2_x2c</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>


<span id="sym"></span><h3 id="symmetry-handling">Symmetry Handling<a class="headerlink" href="#symmetry-handling" title="Permalink to this headline">¶</a></h3>
<p>Wave function symmetry may be explicitly controlled in an SCF calculation. For example, in the C<sub>2</sub> calculation of the <a class="reference internal" href="#input"><span class="std std-ref">above</span></a> section, one can specify a given orbital occupancy through the <code class="docutils literal notranslate"><span class="pre">SCF.irrep_nelec</span></code> attribute (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/13-symmetry.py">scf/13-symmetry.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_c2</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_c2</span><span class="o">.</span><span class="n">irrep_nelec</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'Ag'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">'B1u'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">'B2u'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'B3u'</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_c2</span> <span class="o">=</span> <span class="n">rhf_c2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Likewise, orbital symmetries may deduced from the MO coefficients (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/symm/32-symmetrize_natural_orbital.py">symm/32-symmetrize_natural_orbital</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">symm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orbsym</span> <span class="o">=</span> <span class="n">symm</span><span class="o">.</span><span class="n">label_orb_symm</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">,</span> <span class="n">mol_c2</span><span class="o">.</span><span class="n">irrep_id</span><span class="p">,</span> <span class="n">mol_c2</span><span class="o">.</span><span class="n">symm_orb</span><span class="p">,</span> <span class="n">rhf_c2</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
</pre></div>
</div>



<h2 id="integrals-density-fitting">Integrals &amp; Density Fitting<a class="headerlink" href="#integrals-density-fitting" title="Permalink to this headline">¶</a></h2>

<span id="int"></span><h3 id="and-2-electron-integrals">1- and 2-Electron Integrals<a class="headerlink" href="#and-2-electron-integrals" title="Permalink to this headline">¶</a></h3>
<p>A common use of PySCF is to obtain 1- and 2-electron integrals within a chosen MO basis. The latter are stored by default as (ij|kl) with 4-fold symmetry (cf. also <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/ao2mo/00-mo_integrals.py">ao2mo/00-mo_integrals.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hcore_ao</span> <span class="o">=</span> <span class="n">mol_h2o</span><span class="o">.</span><span class="n">intor_symmetric</span><span class="p">(</span><span class="s1">'int1e_kin'</span><span class="p">)</span> <span class="o">+</span> <span class="n">mol_h2o</span><span class="o">.</span><span class="n">intor_symmetric</span><span class="p">(</span><span class="s1">'int1e_nuc'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hcore_mo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">'pi,pq,qj-&gt;ij'</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="n">hcore_ao</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri_4fold_ao</span> <span class="o">=</span> <span class="n">mol_h2o</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">'int2e_sph'</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri_4fold_mo</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">eri_4fold_ao</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
</pre></div>
</div>
<p>The transformed 2-electron integrals may be saved to and read from a file in HDF5 format (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/ao2mo/01-outcore.py">ao2mo/01-outcore.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tempfile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ftmp</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol_h2o</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="n">ftmp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">ftmp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">eri_4fold</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">'eri_mo'</span><span class="p">]</span>
</pre></div>
</div>
<p>User-defined Hamiltonians can be used in PySCF, e.g., as input to a mean-field calculation and subsequent correlated treatments (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/40-customizing_hamiltonian.py">mcscf/40-customizing_hamiltonian.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1D anti-PBC Hubbard model at half filling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="mf">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_hub</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_hub</span><span class="o">.</span><span class="n">nelectron</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_hub</span><span class="o">.</span><span class="n">incore_anyway</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">h1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">h1</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h1</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">h1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">eri</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_hub</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span><span class="o">.</span><span class="n">get_hcore</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">h1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span><span class="o">.</span><span class="n">get_ovlp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span><span class="o">.</span><span class="n">_eri</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">eri</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="c1"># 8-fold symmetry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span><span class="o">.</span><span class="n">init_guess</span> <span class="o">=</span> <span class="s1">'1e'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>


<span id="df"></span><h3 id="density-fitting-techniques">Density Fitting Techniques<a class="headerlink" href="#density-fitting-techniques" title="Permalink to this headline">¶</a></h3>
<p>Density fitting of 2-electron integrals is conveniently invoked in either of two ways (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/df/00-with_df.py">df/00-with_df.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_c2_df</span> <span class="o">=</span> <span class="n">rhf_c2</span><span class="o">.</span><span class="n">density_fit</span><span class="p">(</span><span class="n">auxbasis</span><span class="o">=</span><span class="s1">'def2-universal-jfit'</span><span class="p">)</span> <span class="c1"># option 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">df</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_c2_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">density_fit</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">),</span> <span class="n">auxbasis</span><span class="o">=</span><span class="s1">'def2-universal-jfit'</span><span class="p">)</span> <span class="c1"># option 2</span>
</pre></div>
</div>
<p>In the former, decoration by the <code class="docutils literal notranslate"><span class="pre">scf.density_fit</span></code> function generates a new object that works in exactly the
same way as the regular <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code> object.</p>
<p>For an example of how to use density fitting alongside the <a class="reference internal" href="#hf"><span class="std std-ref">Newton-Raphson SCF algorithm</span></a> and <a class="reference internal" href="#rel"><span class="std std-ref">scalar relativistic effects</span></a>, please see <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/23-decorate_scf.py">scf/23-decorate_scf.py</a>.</p>



<h2 id="correlated-wave-function-theory">Correlated Wave Function Theory<a class="headerlink" href="#correlated-wave-function-theory" title="Permalink to this headline">¶</a></h2>

<span id="mpccadc"></span><h3 id="perturbation-theory-coupled-cluster-and-algebraic-diagrammatic-constructions">Perturbation Theory, Coupled Cluster, and Algebraic Diagrammatic Constructions<a class="headerlink" href="#perturbation-theory-coupled-cluster-and-algebraic-diagrammatic-constructions" title="Permalink to this headline">¶</a></h3>
<p>PySCF offers many facilities for correlated calculation. Common used examples include second-order Møller-Plesset, coupled cluster, and algebraic diagrammatic construction approximations. These modules can employ <a class="reference internal" href="#df"><span class="std std-ref">density fitting</span></a>, based on the <code class="docutils literal notranslate"><span class="pre">SCF.with_df</span></code> attribute of the underlying mean-field object (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mp/00-simple_mp2.py">mp/00-simple_mp2.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">mp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mp2_c2</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">MP2</span><span class="p">(</span><span class="n">rhf_c2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_c2</span> <span class="o">=</span> <span class="n">mp2_c2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mp2_c2_df</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">MP2</span><span class="p">(</span><span class="n">rhf_c2_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_c2_df</span> <span class="o">=</span> <span class="n">mp2_c2_df</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>At the coupled cluster level of theory, CCD, CCSD, and CCSD(T) calculation can be performed for both closed- and open-shell systems (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/cc/00-simple_ccsd_t.py">cc/00-simple_ccsd_t.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">cc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">direct</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># AO-direct algorithm to reduce I/O overhead</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">frozen</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># frozen core</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ccsd</span> <span class="o">=</span> <span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ccsd_t</span> <span class="o">=</span> <span class="n">e_ccsd</span> <span class="o">+</span> <span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">ccsd_t</span><span class="p">()</span>
</pre></div>
</div>
<p>Starting from a ground-state CCSD calculation, subsequent EOM-CCSD calculations in the spin-flip, IP/EA, and EE channels can be performed (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/cc/20-ip_ea_eom_ccsd.py">cc/20-ip_ea_eom_ccsd.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e_ip_ccsd</span> <span class="o">=</span> <span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">ipccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ea_ccsd</span> <span class="o">=</span> <span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">eaccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ee_ccsd</span> <span class="o">=</span> <span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">eeccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>ADC(2), ADC(2)-X, and ADC(3) schemes have been implemented using a similar API (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/adc/01-closed_shell.py">adc/01-closed_shell.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">adc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adc_h2o</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">ADC</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ip_adc2</span> <span class="o">=</span> <span class="n">adc_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># IP-ADC(2) for 1 root</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adc_h2o</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s2">"adc(2)-x"</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adc_h2o</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="s2">"ea"</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ea_adc2x</span> <span class="o">=</span> <span class="n">adc_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># EA-ADC(2)-x for 1 root</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adc_h2o</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s2">"adc(3)"</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adc_h2o</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="s2">"ea"</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ea_adc3</span> <span class="o">=</span> <span class="n">adc_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">nroots</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># EA-ADC(3) for 3 roots</span>
</pre></div>
</div>


<span id="fci"></span><h3 id="full-configuration-interaction">Full Configuration Interaction<a class="headerlink" href="#full-configuration-interaction" title="Permalink to this headline">¶</a></h3>
<p>PySCF offers powerful kernels to perform exact diagonalization of Hamiltonians optimized for different possible symmetries. For the simplest case, where all electrons of a given system are correlated among all orbitals, the syntax follows that of other correlation methods for closed- and open-shell systems (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/fci/00-simple_fci.py">fci/00-simple_fci.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fci_h2o</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_fci</span> <span class="o">=</span> <span class="n">fci_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>However, the various FCI solvers (tabulated in <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/pyscf/fci/__init__.py">pyscf/fci/__init__.py</a>) support user-defined 1- and 2-electron (<code class="docutils literal notranslate"><span class="pre">h1e,h2e</span></code>) Hamiltonians (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/fci/01-given_h1e_h2e.py">fci/01-given_h1e_h2e.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCI</span><span class="p">()</span> <span class="c1"># direct_spin0 instead for singlet system ground states</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">fcivec</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1e</span><span class="p">,</span> <span class="n">h2e</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="c1"># 8 electrons in N orbitals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">fcivec</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1e</span><span class="p">,</span> <span class="n">h2e</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># (5 alpha, 4 beta) electrons</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">fcivec</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1e</span><span class="p">,</span> <span class="n">h2e</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># (3 alpha, 1 beta) electrons</span>
</pre></div>
</div>
<p>One can obtain multiple states by setting <code class="docutils literal notranslate"><span class="pre">FCI.nroots</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>, and 1- to 4-electron density matrices, alongside 1- and 2-electron transition density matrices, (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/fci/14-density_matrix.py">fci/14-density_matrix.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdm1</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">(</span><span class="n">fcivec</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># spin-traced 1-electron density matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdm1a</span><span class="p">,</span> <span class="n">rdm1b</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">make_rdm1s</span><span class="p">(</span><span class="n">fcivec</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># alpha and beta 1-electron density matrices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_rdm1</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">trans_rdm1</span><span class="p">(</span><span class="n">fcivec0</span><span class="p">,</span> <span class="n">fcivec1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># spin-traced 1-electron transition density matrix</span>
</pre></div>
</div>
<p>In addition, the FCI code is accompanied by a large library of tools to manipulate and inspect wave functions, assign spin states and <a class="reference internal" href="#sym"><span class="std std-ref">symmetry</span></a>, etc.</p>



<h2 id="multiconfigurational-methods">Multiconfigurational Methods<a class="headerlink" href="#multiconfigurational-methods" title="Permalink to this headline">¶</a></h2>

<span id="cas"></span><h3 id="complete-active-space-configuration-interaction-self-consistent-field">Complete Active Space Configuration Interaction &amp; Self-Consistent Field<a class="headerlink" href="#complete-active-space-configuration-interaction-self-consistent-field" title="Permalink to this headline">¶</a></h3>
<p>The FCI solvers discussed <a class="reference internal" href="#fci"><span class="std std-ref">above</span></a> can be used with complete active space methods in PySCF, all of which share a similar API (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/00-simple_casci.py">mcscf/00-simple_casci.py</a> &amp; <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/00-simple_casscf.py">mcscf/00-simple_casscf.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casci_h2o</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_casci</span> <span class="o">=</span> <span class="n">casci_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_h2o</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_casscf</span> <span class="o">=</span> <span class="n">casscf_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>The CASCI and CASSCF classes support many variations, such as, <a class="reference internal" href="#df"><span class="std std-ref">density fitting of 2-electron integrals</span></a> (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/16-density_fitting.py">mcscf/16-density_fitting.py</a>) and the standard frozen-core approximation (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/19-frozen_core.py">mcscf/19-frozen_core.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_h2o_df</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">DFCASSCF</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">auxbasis</span><span class="o">=</span><span class="s1">'ccpvtzfit'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_h2o_df</span><span class="o">.</span><span class="n">frozen</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># frozen core</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_casscf_df</span> <span class="o">=</span> <span class="n">casscf_h2o_df</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>In the case of CASSCF calculations, these may be performed in a state-specific or state-averaged manner (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/41-state_average.py">mcscf/41-state_average.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_c2</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">rhf_c2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_t</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1_symm</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_t</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_t</span><span class="o">.</span><span class="n">nroots</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_t</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">fix_spin</span><span class="p">(</span><span class="n">solver_t</span><span class="p">,</span> <span class="n">shift</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># 1 triplet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_s</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin0_symm</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">)</span> <span class="c1"># 2 singlets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_s</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_s</span><span class="o">.</span><span class="n">nroots</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcscf</span><span class="o">.</span><span class="n">state_average_mix_</span><span class="p">(</span><span class="n">casscf_c2</span><span class="p">,</span> <span class="p">[</span><span class="n">solver_t</span><span class="p">,</span> <span class="n">solver_s</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_c2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally, additional dynamic correlation may be added by means of second-order perturbation theory in the form of NEVPT2 (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mrpt/02-cr2_nevpt2/cr2-scan.py">mrpt/02-cr2_nevpt2/cr2-scan.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">mrpt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_nevpt2</span> <span class="o">=</span> <span class="n">mrpt</span><span class="o">.</span><span class="n">NEVPT</span><span class="p">(</span><span class="n">casscf_h2o</span><span class="p">)</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>


<span id="extfci"></span><h3 id="external-approximate-full-configuration-interaction-solvers">External Approximate Full Configuration Interaction Solvers<a class="headerlink" href="#external-approximate-full-configuration-interaction-solvers" title="Permalink to this headline">¶</a></h3>
<p>Besides the exact solvers discussed <a class="reference internal" href="#fci"><span class="std std-ref">earlier</span></a>, PySCF has interfaces to efficient approximate solvers. For instance, the <a class="reference external" href="https://github.com/sanshar/StackBlock">StackBlock</a> code can be used as a DMRG solver to perform parallel DMRGSCF calculations across several processes (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/dmrg/01-dmrg_casscf_with_stackblock.py">dmrg/01-dmrg_casscf_with_stackblock.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">dmrgscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.dmrgscf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="s1">'SLURMD_NODENAME'</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span> <span class="c1"># slurm system</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">settings</span><span class="o">.</span><span class="n">MPIPREFIX</span> <span class="o">=</span> <span class="s1">'srun'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">elif</span> <span class="s1">'PBS_NODEFILE'</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span> <span class="c1"># PBS system</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">settings</span><span class="o">.</span><span class="n">MPIPREFIX</span> <span class="o">=</span> <span class="s1">'mpirun'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span> <span class="c1"># MPI on single node</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">settings</span><span class="o">.</span><span class="n">MPIPREFIX</span> <span class="o">=</span> <span class="s1">'mpirun -np 4'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmrgscf_c2</span> <span class="o">=</span> <span class="n">dmrgscf</span><span class="o">.</span><span class="n">DMRGSCF</span><span class="p">(</span><span class="n">rhf_c2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmrgscf_c2</span><span class="o">.</span><span class="n">state_average_</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmrgscf_c2</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># in GB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmrgscf_c2</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">num_thrds</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1"># number of threads to spawn on each MPI process</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_dmrgscf</span> <span class="o">=</span> <span class="n">dmrgscf_c2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Similar interfaces to i-FCIQMC (using <a class="reference external" href="https://github.com/ghb24/NECI_STABLE">NECI</a>) and SHCI (using either <a class="reference external" href="https://github.com/sanshar/Dice">Dice</a> or <a class="reference external" href="https://github.com/QMC-Cornell/shci">Arrow</a>) are available.</p>



<span id="geomopt"></span><h2 id="geometry-optimization">Geometry Optimization<a class="headerlink" href="#geometry-optimization" title="Permalink to this headline">¶</a></h2>
<p>In PySCF, geometry optimizations can be performed using the <a class="reference external" href="https://github.com/leeping/geomeTRIC">geomeTRIC</a> or <a class="reference external" href="https://github.com/jhrmnn/pyberny">PyBerny</a> libraries (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/geomopt/01-geomeTRIC.py">geomopt/01-geomeTRIC.py</a> and <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/geomopt/01-pyberny.py">geomopt/01-pyberny.py</a>, respectively):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.geomopt.geometric_solver</span> <span class="kn">import</span> <span class="n">optimize</span> <span class="k">as</span> <span class="n">geometric_opt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o_rhf_eq</span> <span class="o">=</span> <span class="n">geometric_opt</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.geomopt.berny_solver</span> <span class="kn">import</span> <span class="n">optimize</span> <span class="k">as</span> <span class="n">pyberny_opt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o_casscf_eq</span> <span class="o">=</span> <span class="n">pyberny_opt</span><span class="p">(</span><span class="n">casscf_h2o</span><span class="p">)</span>
</pre></div>
</div>
<p>For <a class="reference internal" href="#cas"><span class="std std-ref">multiconfigurational methods</span></a>, the geometry of an excited state can be optimized in either a state-specific or state-averaged manner (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/geomopt/12-mcscf_excited_states.py">geomopt/12-mcscf_excited_states.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">casci_h2o</span><span class="o">.</span><span class="n">state_specific_</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># state-specific opt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casci_grad</span> <span class="o">=</span> <span class="n">casci_h2o</span><span class="o">.</span><span class="n">nuc_grad_method</span><span class="p">()</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o_casci_2nd_ex</span> <span class="o">=</span> <span class="n">casci_grad</span><span class="o">.</span><span class="n">optimizer</span><span class="p">()</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_h2o</span><span class="o">.</span><span class="n">state_average_</span><span class="p">([</span><span class="o">.</span><span class="mi">25</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># state-averaged opt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_grad</span> <span class="o">=</span> <span class="n">casscf_h2o</span><span class="o">.</span><span class="n">nuc_grad_method</span><span class="p">()</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o_sa_casscf</span> <span class="o">=</span> <span class="n">casscf_grad</span><span class="o">.</span><span class="n">optimizer</span><span class="p">()</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>


<h2 id="solvent-effects">Solvent Effects<a class="headerlink" href="#solvent-effects" title="Permalink to this headline">¶</a></h2>

<span id="pcmcosmo"></span><h3 id="polarizable-continuum-cosmo-methods">Polarizable Continuum &amp; COSMO Methods<a class="headerlink" href="#polarizable-continuum-cosmo-methods" title="Permalink to this headline">¶</a></h3>
<p>PySCF can include solvent effects into most types of calculations, as implemented by either PCM or COSMO (both in their <a class="reference external" href="https://www.ddpcm.org/">domain-decomposed formulations</a> that yields a fast discretization of the polarization equations). For instance, <a class="reference internal" href="#geomopt"><span class="std std-ref">geometry optimizations</span></a> can be performed for ground and excited states in the presence of a solvent (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/solvent/21-tddft_geomopt.py">solvent/21-tddft_geomopt.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_pcm</span> <span class="o">=</span> <span class="n">mol_h2o</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">ddPCM</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_pcm</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tdhf_h2o_pcm</span> <span class="o">=</span> <span class="n">rhf_h2o_pcm</span><span class="o">.</span><span class="n">TDA</span><span class="p">()</span><span class="o">.</span><span class="n">ddPCM</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tdhf_h2o_pcm</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">equilibrium_solvation</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o_tdhf_pcm_2nd_ex</span> <span class="o">=</span> <span class="n">tdhf_h2o_pcm</span><span class="o">.</span><span class="n">nuc_grad_method</span><span class="p">()</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">optimizer</span><span class="p">()</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Similarly, correlated methods, e.g., CCSD, may be performed in the presence of a solvent with either a relaxed or unrelaxed (mean-field) potential (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/solvent/03-ccsd_with_ddcosmo.py">solvent/03-ccsd_with_ddcosmo.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">solvent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_cosmo</span> <span class="o">=</span> <span class="n">mol_h2o</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">ddCOSMO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_cosmo</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o_cosmo_rel</span> <span class="o">=</span> <span class="n">solvent</span><span class="o">.</span><span class="n">ddCOSMO</span><span class="p">(</span><span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o_cosmo_rel</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o_cosmo_unrel</span> <span class="o">=</span> <span class="n">solvent</span><span class="o">.</span><span class="n">ddCOSMO</span><span class="p">(</span><span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">rhf_h2o_cosmo</span><span class="p">),</span> <span class="n">dm</span><span class="o">=</span><span class="n">rhf_h2o_cosmo</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o_cosmo_unrel</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Different solvents are chosen by setting the <code class="docutils literal notranslate"><span class="pre">SCF.with_solvent.eps</span></code> attribute.</p>


<span id="qmmm"></span><h3 id="quantum-mechanics-molecular-mechanics-methods">Quantum Mechanics/Molecular Mechanics Methods<a class="headerlink" href="#quantum-mechanics-molecular-mechanics-methods" title="Permalink to this headline">¶</a></h3>
<p>QM/MM calculations can be performed by either of two different methods in PySCF. Standard point charges can be included in most calculations, be these mean-field or correlated. In the latter case, background charges can be conveniently added to the underlying SCF calculation (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/qmmm/03-ccsd.py">qmmm/03-ccsd.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">qmmm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="mf">10.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">charges</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="o">-.</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_qmmm</span> <span class="o">=</span> <span class="n">qmmm</span><span class="o">.</span><span class="n">mm_charge</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">charges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_qmmm</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o_qmmm</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">rhf_h2o_qmmm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ccsd</span> <span class="o">=</span> <span class="n">ccsd_h2o_qmmm</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Alternatively, a combination of the <a class="reference external" href="https://gitlab.com/FraME-projects/PyFraME">PyFraME</a> framework and <a class="reference external" href="https://github.com/maxscheurer/cppe">CPPE</a> library can be used to prepare and run polarizable embedding calculations from within PySCF, cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/solvent/04-pe_potfile_from_pyframe.py">solvent/04-pe_potfile_from_pyframe.py</a> and <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/solvent/04-scf_with_pe.py">solvent/04-scf_with_pe.py</a>.</p>



<span id="id1"></span><h2 id="periodic-boundary-conditions">Periodic Boundary Conditions<a class="headerlink" href="#periodic-boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>PySCF provides equal support for molecular and crystalline materials calculations. The latter functionality is found in
the PBC modules.  As discussed above in <a class="reference internal" href="#input"><span class="std std-ref">input parsing</span></a>, the API to initialize unit cells is almost identical to that for finite-size molecules (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc/00-input_cell.py">pbc/00-input_cell.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.pbc</span> <span class="kn">import</span> <span class="n">gto</span> <span class="k">as</span> <span class="n">pbcgto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_diamond</span> <span class="o">=</span> <span class="n">pbcgto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">'''C     0.      0.      0.</span>
<span class="go">                                      C     .8917    .8917   .8917</span>
<span class="go">                                      C     1.7834  1.7834  0.</span>
<span class="go">                                      C     2.6751  2.6751   .8917</span>
<span class="go">                                      C     1.7834  0.      1.7834</span>
<span class="go">                                      C     2.6751   .8917  2.6751</span>
<span class="go">                                      C     0.      1.7834  1.7834</span>
<span class="go">                                      C     .8917   2.6751  2.6751''',</span>
<span class="go">                            basis = 'gth-szv',</span>
<span class="go">                            pseudo = 'gth-pade',</span>
<span class="go">                            a = np.eye(3) * 3.5668)</span>
</pre></div>
</div>
<p>Besides the difference in import of the <code class="docutils literal notranslate"><span class="pre">gto</span></code> module, the only new attributes are <code class="docutils literal notranslate"><span class="pre">Cell.a</span></code> and <code class="docutils literal notranslate"><span class="pre">Cell.pseudo</span></code>. The former  (<code class="docutils literal notranslate"><span class="pre">a</span></code>) is a matrix of lattice vectors, where each row denotes a primitive vector, while the latter (<code class="docutils literal notranslate"><span class="pre">pseudo</span></code>) is an (optional) crystal pseudo potential (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/pyscf/pbc/gto/pseudo/GTH_POTENTIALS">pyscf/pbc/gto/pseudo/GTH_POTENTIALS</a> for a full list of these). All electron calculations can be performed by omitting <code class="docutils literal notranslate"><span class="pre">pseudo</span></code>.
Alternatively, molecular effective core potentials can be used by setting the <code class="docutils literal notranslate"><span class="pre">Cell.ecp</span></code> attribute, cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc/05-input_pp.py">pbc/05-input_pp.py</a>.</p>
<p>Generally, crystal calculations use the same or similar APIs to the molecule calculations.  For instance, an all-electron calculation with k-point sampling at the KS-DFT level using <a class="reference internal" href="#df"><span class="std std-ref">density fitting</span></a> (recommended) and a <a class="reference internal" href="#hf"><span class="std std-ref">second-order SCF algorithm</span></a> is specified as (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc/21-k_points_all_electron_scf.py">pbc/21-k_points_all_electron_scf.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.pbc</span> <span class="kn">import</span> <span class="n">dft</span> <span class="k">as</span> <span class="n">pbcdft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">cell_diamond</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">([</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># 4 k-poins for each axis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">krks_diamond</span> <span class="o">=</span> <span class="n">pbcdft</span><span class="o">.</span><span class="n">KRKS</span><span class="p">(</span><span class="n">cell_diamond</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span><span class="o">.</span><span class="n">density_fit</span><span class="p">(</span><span class="n">auxbasis</span><span class="o">=</span><span class="s1">'weigend'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">krks_diamond</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">'bp86'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">krks_diamond</span> <span class="o">=</span> <span class="n">krks_diamond</span><span class="o">.</span><span class="n">newton</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">krks_diamond</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>After converging the mean-field calculation, dynamic electron correlation can be treated by various methods, e.g. MP2 or (EOM-)CCSD. These calculations can again be performed with k-point sampling (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc/22-k_points_ccsd.py">pbc/22-k_points_ccsd.py</a>). At the <span class="math notranslate nohighlight">\(\Gamma\)</span>-point, all correlation methods available for molecules can be employed (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc/12-gamma_point_post_hf.py">pbc/12-gamma_point_post_hf.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.pbc</span> <span class="kn">import</span> <span class="n">scf</span> <span class="k">as</span> <span class="n">pbcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_diamond</span> <span class="o">=</span> <span class="n">pbcscf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">cell_diamond</span><span class="p">)</span><span class="o">.</span><span class="n">density_fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_diamond</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_diamond</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">rhf_diamond</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_diamond</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>


<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The above quickstart provides only a small sample of what is in PySCF from the perspective of a computational user. More details can be found in the user guide, and we highly encourage users to browse the large set of examples. Note that PySCF is designed for easy extensibility. Users interested in these aspects are encouraged to dive into the code! We sincerely hope you’ll enjoy using the library. For bug reports and feature requests, please submit tickets on the <a class="reference external" href="https://github.com/pyscf/pyscf/issues">issues</a> page.</p>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="install.html" title="Installation"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Installation </span>
              </div>
            </a>
          
          
            <a href="user.html" title="User Guide"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> User Guide </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.5.4.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>