
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Quickstart &#8212; PySCF</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/css/pyscf-pst.css?v=ed6b5f64" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=67920a36"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'quickstart';</script>
    <link rel="icon" href="_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="User Guide" href="user/index.html" />
    <link rel="prev" title="Quantum chemistry with Python" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.10" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo-64x64.png" class="logo__image only-light" alt=""/>
    <img src="_static/logo-64x64.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">PySCF</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Quickstart</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="quickstart">
<h1>Quickstart<a class="headerlink" href="#quickstart" title="Link to this heading">#</a></h1>
<p>This quickstart provides a brief introduction to the use of PySCF in common quantum chemical simulations. These make reference to specific examples within the dedicated <a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/examples">examples</a> directory. For brevity, and so as to not repeat a number of function calls, please note that the cells below often share objects in-between one another. The selection below is far from exhaustive: additional details on the various modules are presented in the accompanying user guide and within the examples directory.</p>
<section id="input-parsing">
<span id="input"></span><h2>Input Parsing<a class="headerlink" href="#input-parsing" title="Link to this heading">#</a></h2>
<p>Molecules (or unit cells, cf. the <span class="xref std std-ref">periodic</span> section) can be created using the convenient shortcut function <code class="docutils literal notranslate"><span class="pre">Mole.build()</span></code> as in (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/gto/00-input_mole.py">gto/00-input_mole.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;ccpvdz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Whenever you change the value of the attributes of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code>, you’ll need to call <code class="docutils literal notranslate"><span class="pre">build()</span></code> again to refresh the internal data of the object.</p>
<p>Symmetry may be specified in the <code class="docutils literal notranslate"><span class="pre">Mole.symmetry</span></code> attribute as either <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> (default is <code class="docutils literal notranslate"><span class="pre">False</span></code>, i.e., off). Alternatively, a particular subgroup can be specified by a string argument (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/gto/13-symmetry.py">gto/13-symmetry.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol_c2</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;C 0 0 .625; C 0 0 -.625&#39;</span><span class="p">,</span> <span class="n">symmetry</span> <span class="o">=</span> <span class="s1">&#39;d2h&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>There are many other ways to input a molecular or crystalline geometry (e.g., by means of Z-matrices or reading in .xyz files), cf. the complete suite of <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/gto">gto</a> and <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc">pbc</a> examples.</p>
</section>
<section id="mean-field-theory">
<span id="mf"></span><h2>Mean-Field Theory<a class="headerlink" href="#mean-field-theory" title="Link to this heading">#</a></h2>
<section id="hartree-fock">
<span id="hf"></span><h3>Hartree-Fock<a class="headerlink" href="#hartree-fock" title="Link to this heading">#</a></h3>
<p>A mean-field (e.g., Hartree-Fock) calculation on the H<sub>2</sub>O geometry of the <a class="reference internal" href="#input"><span class="std std-ref">above</span></a> section can be performed by (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/00-simple_hf.py">scf/00-simple_hf.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">scf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_h2o</span> <span class="o">=</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Besides the final converged ground-state energy, the mean-field object stores the accompanying MO coefficients, occupations, etc. To illustrate how open-shell, possibly spin-polarized calculations are performed, different Hartree-Fock simulations of the O<sub>2</sub> dimer - with its triplet ground state - can be setup as (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/02-rohf_uhf.py">scf/02-rohf_uhf.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol_o2</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; O 0 0 1.2&#39;</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># (n+2 alpha, n beta) electrons</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uhf_o2</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol_o2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uhf_o2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rohf_o2</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">(</span><span class="n">mol_o2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rohf_o2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally, a second-order, Newton-Raphson SCF method is available, (which is also compatible with most but not all XC functionals, cf. <a class="reference internal" href="#ksdft"><span class="std std-ref">below</span></a>). This requires a set of orthonormal orbitals and their corresponding occupancies as initial guesses. These are automatically generated if none are provided (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/22-newton.py">scf/22-newton.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o</span> <span class="o">=</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">newton</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_h2o</span> <span class="o">=</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="kohn-sham-density-functional-theory">
<span id="ksdft"></span><h3>Kohn-Sham Density Functional Theory<a class="headerlink" href="#kohn-sham-density-functional-theory" title="Link to this heading">#</a></h3>
<p>Running a KS-DFT calculation is as straightforward as the <a class="reference internal" href="#hf"><span class="std std-ref">above</span></a> HF counterpart (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/dft/00-simple_dft.py">dft/00-simple_dft.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">dft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_h2o</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span> <span class="c1"># likewise for UKS and ROKS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_h2o</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;b3lyp&#39;</span>
</pre></div>
</div>
<p>Besides the use of predefined XC functionals (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/pyscf/dft/libxc.py">pyscf/dft/libxc.py</a> and <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/pyscf/dft/xcfun.py">pyscf/dft/xcfun.py</a> for the complete lists of
available functionals), these can also be fully defined by the user (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/dft/24-custom_xc_functional.py">dft/24-custom_xc_functional.py</a>), as can the angular and radial grids used in the calculation (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/dft/11-grid_scheme.py">dft/11-grid_scheme.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rks_h2o</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;.2 * HF + .08 * LDA + .72 * B88, .81 * LYP + .19 * VWN&#39;</span> <span class="c1"># B3LYP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_h2o</span><span class="o">.</span><span class="n">grids</span><span class="o">.</span><span class="n">atom_grid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">770</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_h2o</span><span class="o">.</span><span class="n">grids</span><span class="o">.</span><span class="n">prune</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_rks</span> <span class="o">=</span> <span class="n">rks_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Combining dense and sparse grids is important whenever XC functionals with non-local dispersion (van der Waals) corrections are employed (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/dft/33-nlc_functionals.py">dft/33-nlc_functionals.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">RKS</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;wb97m_v&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">nlc</span> <span class="o">=</span> <span class="s1">&#39;vv10&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">grids</span><span class="o">.</span><span class="n">atom_grid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">99</span><span class="p">,</span><span class="mi">590</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">grids</span><span class="o">.</span><span class="n">prune</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">nlcgrids</span><span class="o">.</span><span class="n">atom_grid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">194</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rks_c2</span><span class="o">.</span><span class="n">nlcgrids</span><span class="o">.</span><span class="n">prune</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">gen_grid</span><span class="o">.</span><span class="n">sg1_prune</span>
</pre></div>
</div>
</section>
<section id="time-dependent-mean-field-theory">
<span id="tdmf"></span><h3>Time-Dependent Mean-Field Theory<a class="headerlink" href="#time-dependent-mean-field-theory" title="Link to this heading">#</a></h3>
<p>Linear response theory is available for both HF and KS-DFT (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/tddft/00-simple_tddft.py">tddft/00-simple_tddft.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">tdscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tdhf_h2o</span> <span class="o">=</span> <span class="n">tdscf</span><span class="o">.</span><span class="n">TDHF</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tdhf_h2o</span><span class="o">.</span><span class="n">nstates</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tdhf_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tddft_h2o</span> <span class="o">=</span> <span class="n">tdscf</span><span class="o">.</span><span class="n">TDA</span><span class="p">(</span><span class="n">rks_h2o</span><span class="p">)</span> <span class="c1"># TDDFT with Tamm-Dancoff approximation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tddft_h2o</span><span class="o">.</span><span class="n">nstates</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tddft_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>From a converged time-dependent mean-field calculation, the corresponding natural transition orbitals for a particular excited state may be recovered as (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/tddft/01-nto_analysis.py">tddft/01-nto_analysis.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">nto</span> <span class="o">=</span> <span class="n">tdhf_h2o</span><span class="o">.</span><span class="n">get_nto</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>As an alternative to response theory, <span class="math notranslate nohighlight">\(\Delta\)</span>-SCF with Gill’s maximum overlap method is available to converge specific excited states, cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/50-mom-deltaSCF.py">scf/50-mom-deltaSCF.py</a>.</p>
</section>
<section id="spatially-localized-molecular-orbitals">
<span id="loc"></span><h3>Spatially Localized Molecular Orbitals<a class="headerlink" href="#spatially-localized-molecular-orbitals" title="Link to this heading">#</a></h3>
<p>PySCF offers a number of different standard schemes for localizing MOs, e.g., Pipek-Mezey, Foster-Boys, and Edmiston-Ruedenberg (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/local_orb/03-split_localization.py">local_orb/03-split_localization.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">occ_orbs</span> <span class="o">=</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[:,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_occ</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fb_h2o</span> <span class="o">=</span> <span class="n">lo</span><span class="o">.</span><span class="n">Boys</span><span class="p">(</span><span class="n">mol_h2o</span><span class="p">,</span> <span class="n">occ_orbs</span><span class="p">)</span> <span class="c1"># Foster-Boys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loc_occ_orbs</span> <span class="o">=</span> <span class="n">fb_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">virt_orbs</span> <span class="o">=</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[:,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_occ</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pm_h2o</span> <span class="o">=</span> <span class="n">lo</span><span class="o">.</span><span class="n">PM</span><span class="p">(</span><span class="n">mol_h2o</span><span class="p">,</span> <span class="n">virt_orbs</span><span class="p">)</span> <span class="c1"># Pipek-Mezey</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loc_virt_orbs</span> <span class="o">=</span> <span class="n">pm_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Knizia’s intrinsic bond orbitals can be computed as (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/local_orb/04-ibo_benzene_cubegen.py">local_orb/04-ibo_benzene_cubegen.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iao</span> <span class="o">=</span> <span class="n">lo</span><span class="o">.</span><span class="n">iao</span><span class="o">.</span><span class="n">iao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">occ_orbs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iao</span> <span class="o">=</span> <span class="n">lo</span><span class="o">.</span><span class="n">vec_lowdin</span><span class="p">(</span><span class="n">iao</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">get_ovlp</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibo</span> <span class="o">=</span> <span class="n">lo</span><span class="o">.</span><span class="n">ibo</span><span class="o">.</span><span class="n">ibo</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">occ_orbs</span><span class="p">,</span> <span class="n">iaos</span><span class="o">=</span><span class="n">iao</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="relativistic-effects">
<span id="rel"></span><h3>Relativistic Effects<a class="headerlink" href="#relativistic-effects" title="Link to this heading">#</a></h3>
<p>PySCF implements a Dirac-Hartree-Fock solver for relativistic effects. Different Hamiltonians are available, for example with Breit and/or Gaunt interactions (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/05-breit_gaunt.py">scf/05-breit_gaunt.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dhf_c2</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">DHF</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dhf_c2</span><span class="o">.</span><span class="n">with_gaunt</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dhf_c2</span><span class="o">.</span><span class="n">with_breit</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dhf_c2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>At lower cost, scalar relativistic effects can be included in a mean-field treatment by decorating the a <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code> object (either HF or KS-DFT) with the <code class="docutils literal notranslate"><span class="pre">.x2c()</span></code> method (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/21-x2c.py">scf/21-x2c.py</a>). This modifies the Hamiltonian and affects subsequent correlated calculations:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uks_o2_x2c</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UKS</span><span class="p">(</span><span class="n">mol_o2</span><span class="p">)</span><span class="o">.</span><span class="n">x2c</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uks_o2_x2c</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="symmetry-handling">
<span id="sym"></span><h3>Symmetry Handling<a class="headerlink" href="#symmetry-handling" title="Link to this heading">#</a></h3>
<p>Wave function symmetry may be explicitly controlled in an SCF calculation. For example, in the C<sub>2</sub> calculation of the <a class="reference internal" href="#input"><span class="std std-ref">above</span></a> section, one can specify a given orbital occupancy through the <code class="docutils literal notranslate"><span class="pre">SCF.irrep_nelec</span></code> attribute (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/13-symmetry.py">scf/13-symmetry.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_c2</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_c2</span><span class="o">.</span><span class="n">irrep_nelec</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ag&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;B1u&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;B2u&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;B3u&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_c2</span> <span class="o">=</span> <span class="n">rhf_c2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Likewise, orbital symmetries may deduced from the MO coefficients (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/symm/32-symmetrize_natural_orbital.py">symm/32-symmetrize_natural_orbital</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">symm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">orbsym</span> <span class="o">=</span> <span class="n">symm</span><span class="o">.</span><span class="n">label_orb_symm</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">,</span> <span class="n">mol_c2</span><span class="o">.</span><span class="n">irrep_id</span><span class="p">,</span> <span class="n">mol_c2</span><span class="o">.</span><span class="n">symm_orb</span><span class="p">,</span> <span class="n">rhf_c2</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="integrals-density-fitting">
<h2>Integrals &amp; Density Fitting<a class="headerlink" href="#integrals-density-fitting" title="Link to this heading">#</a></h2>
<section id="and-2-electron-integrals">
<span id="int"></span><h3>1- and 2-Electron Integrals<a class="headerlink" href="#and-2-electron-integrals" title="Link to this heading">#</a></h3>
<p>A common use of PySCF is to obtain 1- and 2-electron integrals within a chosen MO basis. The latter are stored by default as (ij|kl) with 4-fold symmetry (cf. also <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/ao2mo/00-mo_integrals.py">ao2mo/00-mo_integrals.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hcore_ao</span> <span class="o">=</span> <span class="n">mol_h2o</span><span class="o">.</span><span class="n">intor_symmetric</span><span class="p">(</span><span class="s1">&#39;int1e_kin&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">mol_h2o</span><span class="o">.</span><span class="n">intor_symmetric</span><span class="p">(</span><span class="s1">&#39;int1e_nuc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hcore_mo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pi,pq,qj-&gt;ij&#39;</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="n">hcore_ao</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri_4fold_ao</span> <span class="o">=</span> <span class="n">mol_h2o</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri_4fold_mo</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">eri_4fold_ao</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
</pre></div>
</div>
<p>The transformed 2-electron integrals may be saved to and read from a file in HDF5 format (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/ao2mo/01-outcore.py">ao2mo/01-outcore.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tempfile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ftmp</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol_h2o</span><span class="p">,</span> <span class="n">rhf_h2o</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="n">ftmp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">ftmp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">eri_4fold</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;eri_mo&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>User-defined Hamiltonians can be used in PySCF, e.g., as input to a mean-field calculation and subsequent correlated treatments (<a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/40-customizing_hamiltonian.py">mcscf/40-customizing_hamiltonian.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1D anti-PBC Hubbard model at half filling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="mf">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_hub</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_hub</span><span class="o">.</span><span class="n">nelectron</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_hub</span><span class="o">.</span><span class="n">incore_anyway</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">h1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">h1</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h1</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">h1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">eri</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_hub</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span><span class="o">.</span><span class="n">get_hcore</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">h1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span><span class="o">.</span><span class="n">get_ovlp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span><span class="o">.</span><span class="n">_eri</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">eri</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="c1"># 8-fold symmetry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span><span class="o">.</span><span class="n">init_guess</span> <span class="o">=</span> <span class="s1">&#39;1e&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_hub</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="density-fitting-techniques">
<span id="df"></span><h3>Density Fitting Techniques<a class="headerlink" href="#density-fitting-techniques" title="Link to this heading">#</a></h3>
<p>Density fitting of 2-electron integrals is conveniently invoked in either of two ways (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/df/00-with_df.py">df/00-with_df.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_c2_df</span> <span class="o">=</span> <span class="n">rhf_c2</span><span class="o">.</span><span class="n">density_fit</span><span class="p">(</span><span class="n">auxbasis</span><span class="o">=</span><span class="s1">&#39;def2-universal-jfit&#39;</span><span class="p">)</span> <span class="c1"># option 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">df</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_c2_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">density_fit</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">),</span> <span class="n">auxbasis</span><span class="o">=</span><span class="s1">&#39;def2-universal-jfit&#39;</span><span class="p">)</span> <span class="c1"># option 2</span>
</pre></div>
</div>
<p>In the former, decoration by the <code class="docutils literal notranslate"><span class="pre">scf.density_fit</span></code> function generates a new object that works in exactly the
same way as the regular <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code> object.</p>
<p>For an example of how to use density fitting alongside the <a class="reference internal" href="#hf"><span class="std std-ref">Newton-Raphson SCF algorithm</span></a> and <a class="reference internal" href="#rel"><span class="std std-ref">scalar relativistic effects</span></a>, please see <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/scf/23-decorate_scf.py">scf/23-decorate_scf.py</a>.</p>
</section>
</section>
<section id="correlated-wave-function-theory">
<h2>Correlated Wave Function Theory<a class="headerlink" href="#correlated-wave-function-theory" title="Link to this heading">#</a></h2>
<section id="perturbation-theory-coupled-cluster-and-algebraic-diagrammatic-constructions">
<span id="mpccadc"></span><h3>Perturbation Theory, Coupled Cluster, and Algebraic Diagrammatic Constructions<a class="headerlink" href="#perturbation-theory-coupled-cluster-and-algebraic-diagrammatic-constructions" title="Link to this heading">#</a></h3>
<p>PySCF offers many facilities for correlated calculation. Common used examples include second-order Møller-Plesset, coupled cluster, and algebraic diagrammatic construction approximations. These modules can employ <a class="reference internal" href="#df"><span class="std std-ref">density fitting</span></a>, based on the <code class="docutils literal notranslate"><span class="pre">SCF.with_df</span></code> attribute of the underlying mean-field object (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mp/00-simple_mp2.py">mp/00-simple_mp2.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">mp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mp2_c2</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">MP2</span><span class="p">(</span><span class="n">rhf_c2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_c2</span> <span class="o">=</span> <span class="n">mp2_c2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mp2_c2_df</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">MP2</span><span class="p">(</span><span class="n">rhf_c2_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_c2_df</span> <span class="o">=</span> <span class="n">mp2_c2_df</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>At the coupled cluster level of theory, CCD, CCSD, and CCSD(T) calculation can be performed for both closed- and open-shell systems (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/cc/00-simple_ccsd_t.py">cc/00-simple_ccsd_t.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">cc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">direct</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># AO-direct algorithm to reduce I/O overhead</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">frozen</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># frozen core</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ccsd</span> <span class="o">=</span> <span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ccsd_t</span> <span class="o">=</span> <span class="n">e_ccsd</span> <span class="o">+</span> <span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">ccsd_t</span><span class="p">()</span>
</pre></div>
</div>
<p>Starting from a ground-state CCSD calculation, subsequent EOM-CCSD calculations in the spin-flip, IP/EA, and EE channels can be performed (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/cc/20-ip_ea_eom_ccsd.py">cc/20-ip_ea_eom_ccsd.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e_ip_ccsd</span> <span class="o">=</span> <span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">ipccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ea_ccsd</span> <span class="o">=</span> <span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">eaccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ee_ccsd</span> <span class="o">=</span> <span class="n">ccsd_h2o</span><span class="o">.</span><span class="n">eeccsd</span><span class="p">(</span><span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>ADC(2), ADC(2)-X, and ADC(3) schemes have been implemented using a similar API (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/adc/01-closed_shell.py">adc/01-closed_shell.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">adc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adc_h2o</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">ADC</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ip_adc2</span> <span class="o">=</span> <span class="n">adc_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># IP-ADC(2) for 1 root</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adc_h2o</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;adc(2)-x&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adc_h2o</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="s2">&quot;ea&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ea_adc2x</span> <span class="o">=</span> <span class="n">adc_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># EA-ADC(2)-x for 1 root</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adc_h2o</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;adc(3)&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adc_h2o</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="s2">&quot;ea&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ea_adc3</span> <span class="o">=</span> <span class="n">adc_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">nroots</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># EA-ADC(3) for 3 roots</span>
</pre></div>
</div>
</section>
<section id="full-configuration-interaction">
<span id="fci"></span><h3>Full Configuration Interaction<a class="headerlink" href="#full-configuration-interaction" title="Link to this heading">#</a></h3>
<p>PySCF offers powerful kernels to perform exact diagonalization of Hamiltonians optimized for different possible symmetries. For the simplest case, where all electrons of a given system are correlated among all orbitals, the syntax follows that of other correlation methods for closed- and open-shell systems (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/fci/00-simple_fci.py">fci/00-simple_fci.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fci_h2o</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_fci</span> <span class="o">=</span> <span class="n">fci_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>However, the various FCI solvers (tabulated in <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/pyscf/fci/__init__.py">pyscf/fci/__init__.py</a>) support user-defined 1- and 2-electron (<code class="docutils literal notranslate"><span class="pre">h1e,h2e</span></code>) Hamiltonians (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/fci/01-given_h1e_h2e.py">fci/01-given_h1e_h2e.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCI</span><span class="p">()</span> <span class="c1"># direct_spin0 instead for singlet system ground states</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">fcivec</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1e</span><span class="p">,</span> <span class="n">h2e</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="c1"># 8 electrons in N orbitals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">fcivec</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1e</span><span class="p">,</span> <span class="n">h2e</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># (5 alpha, 4 beta) electrons</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">fcivec</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">h1e</span><span class="p">,</span> <span class="n">h2e</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># (3 alpha, 1 beta) electrons</span>
</pre></div>
</div>
<p>One can obtain multiple states by setting <code class="docutils literal notranslate"><span class="pre">FCI.nroots</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>, and 1- to 4-electron density matrices, alongside 1- and 2-electron transition density matrices, (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/fci/14-density_matrix.py">fci/14-density_matrix.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdm1</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">(</span><span class="n">fcivec</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># spin-traced 1-electron density matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdm1a</span><span class="p">,</span> <span class="n">rdm1b</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">make_rdm1s</span><span class="p">(</span><span class="n">fcivec</span><span class="p">,</span> <span class="n">norb</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># alpha and beta 1-electron density matrices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_rdm1</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">trans_rdm1</span><span class="p">(</span><span class="n">fcivec0</span><span class="p">,</span> <span class="n">fcivec1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># spin-traced 1-electron transition density matrix</span>
</pre></div>
</div>
<p>In addition, the FCI code is accompanied by a large library of tools to manipulate and inspect wave functions, assign spin states and <a class="reference internal" href="#sym"><span class="std std-ref">symmetry</span></a>, etc.</p>
</section>
</section>
<section id="multiconfigurational-methods">
<h2>Multiconfigurational Methods<a class="headerlink" href="#multiconfigurational-methods" title="Link to this heading">#</a></h2>
<section id="complete-active-space-configuration-interaction-self-consistent-field">
<span id="cas"></span><h3>Complete Active Space Configuration Interaction &amp; Self-Consistent Field<a class="headerlink" href="#complete-active-space-configuration-interaction-self-consistent-field" title="Link to this heading">#</a></h3>
<p>The FCI solvers discussed <a class="reference internal" href="#fci"><span class="std std-ref">above</span></a> can be used with complete active space methods in PySCF, all of which share a similar API (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/00-simple_casci.py">mcscf/00-simple_casci.py</a> &amp; <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/00-simple_casscf.py">mcscf/00-simple_casscf.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casci_h2o</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_casci</span> <span class="o">=</span> <span class="n">casci_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_h2o</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_casscf</span> <span class="o">=</span> <span class="n">casscf_h2o</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>The CASCI and CASSCF classes support many variations, such as, <a class="reference internal" href="#df"><span class="std std-ref">density fitting of 2-electron integrals</span></a> (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/16-density_fitting.py">mcscf/16-density_fitting.py</a>) and the standard frozen-core approximation (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/19-frozen_core.py">mcscf/19-frozen_core.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_h2o_df</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">DFCASSCF</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">auxbasis</span><span class="o">=</span><span class="s1">&#39;ccpvtzfit&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_h2o_df</span><span class="o">.</span><span class="n">frozen</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># frozen core</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_casscf_df</span> <span class="o">=</span> <span class="n">casscf_h2o_df</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>In the case of CASSCF calculations, these may be performed in a state-specific or state-averaged manner (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mcscf/41-state_average.py">mcscf/41-state_average.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_c2</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">rhf_c2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_t</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1_symm</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_t</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_t</span><span class="o">.</span><span class="n">nroots</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_t</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">fix_spin</span><span class="p">(</span><span class="n">solver_t</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># 1 triplet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_s</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin0_symm</span><span class="o">.</span><span class="n">FCI</span><span class="p">(</span><span class="n">mol_c2</span><span class="p">)</span> <span class="c1"># 2 singlets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_s</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver_s</span><span class="o">.</span><span class="n">nroots</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcscf</span><span class="o">.</span><span class="n">state_average_mix_</span><span class="p">(</span><span class="n">casscf_c2</span><span class="p">,</span> <span class="p">[</span><span class="n">solver_t</span><span class="p">,</span> <span class="n">solver_s</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_c2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally, additional dynamic correlation may be added by means of second-order perturbation theory in the form of NEVPT2 (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/mrpt/02-cr2_nevpt2/cr2-scan.py">mrpt/02-cr2_nevpt2/cr2-scan.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">mrpt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_nevpt2</span> <span class="o">=</span> <span class="n">mrpt</span><span class="o">.</span><span class="n">NEVPT</span><span class="p">(</span><span class="n">casscf_h2o</span><span class="p">)</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="external-approximate-full-configuration-interaction-solvers">
<span id="extfci"></span><h3>External Approximate Full Configuration Interaction Solvers<a class="headerlink" href="#external-approximate-full-configuration-interaction-solvers" title="Link to this heading">#</a></h3>
<p>Besides the exact solvers discussed <a class="reference internal" href="#fci"><span class="std std-ref">earlier</span></a>, PySCF has interfaces to efficient approximate solvers. For instance, the <a class="reference external" href="https://github.com/sanshar/StackBlock">StackBlock</a> or <a class="reference external" href="https://github.com/block-hczhai/block2-preview">block2</a> code can be used as a DMRG solver to perform parallel DMRGSCF calculations across several processes (cf. <a class="reference external" href="https://github.com/pyscf/dmrgscf/blob/master/examples/01-dmrg_casscf_with_stackblock.py">dmrg/01-dmrg_casscf_with_stackblock.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">dmrgscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.dmrgscf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="s1">&#39;SLURMD_NODENAME&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span> <span class="c1"># slurm system</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">settings</span><span class="o">.</span><span class="n">MPIPREFIX</span> <span class="o">=</span> <span class="s1">&#39;srun&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">elif</span> <span class="s1">&#39;PBS_NODEFILE&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span> <span class="c1"># PBS system</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">settings</span><span class="o">.</span><span class="n">MPIPREFIX</span> <span class="o">=</span> <span class="s1">&#39;mpirun&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span> <span class="c1"># MPI on single node</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">settings</span><span class="o">.</span><span class="n">MPIPREFIX</span> <span class="o">=</span> <span class="s1">&#39;mpirun -np 4&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmrgscf_c2</span> <span class="o">=</span> <span class="n">dmrgscf</span><span class="o">.</span><span class="n">DMRGSCF</span><span class="p">(</span><span class="n">rhf_c2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmrgscf_c2</span><span class="o">.</span><span class="n">state_average_</span><span class="p">([</span><span class="mf">.5</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmrgscf_c2</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># in GB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmrgscf_c2</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">num_thrds</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1"># number of threads to spawn on each MPI process</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_dmrgscf</span> <span class="o">=</span> <span class="n">dmrgscf_c2</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Similar interfaces to i-FCIQMC (using <a class="reference external" href="https://github.com/ghb24/NECI_STABLE">NECI</a>) and SHCI (using either <a class="reference external" href="https://github.com/sanshar/Dice">Dice</a> or <a class="reference external" href="https://github.com/QMC-Cornell/shci">Arrow</a>) are available.</p>
</section>
</section>
<section id="geometry-optimization">
<span id="geomopt"></span><h2>Geometry Optimization<a class="headerlink" href="#geometry-optimization" title="Link to this heading">#</a></h2>
<p>In PySCF, geometry optimizations can be performed using the <a class="reference external" href="https://github.com/leeping/geomeTRIC">geomeTRIC</a> or <a class="reference external" href="https://github.com/jhrmnn/pyberny">PyBerny</a> libraries (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/geomopt/01-geomeTRIC.py">geomopt/01-geomeTRIC.py</a> and <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/geomopt/01-pyberny.py">geomopt/01-pyberny.py</a>, respectively):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.geomopt.geometric_solver</span> <span class="kn">import</span> <span class="n">optimize</span> <span class="k">as</span> <span class="n">geometric_opt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o_rhf_eq</span> <span class="o">=</span> <span class="n">geometric_opt</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.geomopt.berny_solver</span> <span class="kn">import</span> <span class="n">optimize</span> <span class="k">as</span> <span class="n">pyberny_opt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o_casscf_eq</span> <span class="o">=</span> <span class="n">pyberny_opt</span><span class="p">(</span><span class="n">casscf_h2o</span><span class="p">)</span>
</pre></div>
</div>
<p>For <a class="reference internal" href="#cas"><span class="std std-ref">multiconfigurational methods</span></a>, the geometry of an excited state can be optimized in either a state-specific or state-averaged manner (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/geomopt/12-mcscf_excited_states.py">geomopt/12-mcscf_excited_states.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">casci_h2o</span><span class="o">.</span><span class="n">state_specific_</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># state-specific opt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casci_grad</span> <span class="o">=</span> <span class="n">casci_h2o</span><span class="o">.</span><span class="n">nuc_grad_method</span><span class="p">()</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o_casci_2nd_ex</span> <span class="o">=</span> <span class="n">casci_grad</span><span class="o">.</span><span class="n">optimizer</span><span class="p">()</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_h2o</span><span class="o">.</span><span class="n">state_average_</span><span class="p">([</span><span class="mf">.25</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># state-averaged opt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">casscf_grad</span> <span class="o">=</span> <span class="n">casscf_h2o</span><span class="o">.</span><span class="n">nuc_grad_method</span><span class="p">()</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o_sa_casscf</span> <span class="o">=</span> <span class="n">casscf_grad</span><span class="o">.</span><span class="n">optimizer</span><span class="p">()</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="solvent-effects">
<h2>Solvent Effects<a class="headerlink" href="#solvent-effects" title="Link to this heading">#</a></h2>
<section id="polarizable-continuum-cosmo-methods">
<span id="pcmcosmo"></span><h3>Polarizable Continuum &amp; COSMO Methods<a class="headerlink" href="#polarizable-continuum-cosmo-methods" title="Link to this heading">#</a></h3>
<p>PySCF can include solvent effects into most types of calculations, as implemented by either PCM or COSMO (both in their <a class="reference external" href="https://www.ddpcm.org/">domain-decomposed formulations</a> that yields a fast discretization of the polarization equations). For instance, <a class="reference internal" href="#geomopt"><span class="std std-ref">geometry optimizations</span></a> can be performed for ground and excited states in the presence of a solvent (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/solvent/21-tddft_geomopt.py">solvent/21-tddft_geomopt.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_pcm</span> <span class="o">=</span> <span class="n">mol_h2o</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">ddPCM</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_pcm</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tdhf_h2o_pcm</span> <span class="o">=</span> <span class="n">rhf_h2o_pcm</span><span class="o">.</span><span class="n">TDA</span><span class="p">()</span><span class="o">.</span><span class="n">ddPCM</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tdhf_h2o_pcm</span><span class="o">.</span><span class="n">with_solvent</span><span class="o">.</span><span class="n">equilibrium_solvation</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_h2o_tdhf_pcm_2nd_ex</span> <span class="o">=</span> <span class="n">tdhf_h2o_pcm</span><span class="o">.</span><span class="n">nuc_grad_method</span><span class="p">()</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">optimizer</span><span class="p">()</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Similarly, correlated methods, e.g., CCSD, may be performed in the presence of a solvent with either a relaxed or unrelaxed (mean-field) potential (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/solvent/03-ccsd_with_ddcosmo.py">solvent/03-ccsd_with_ddcosmo.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">solvent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_cosmo</span> <span class="o">=</span> <span class="n">mol_h2o</span><span class="o">.</span><span class="n">RHF</span><span class="p">()</span><span class="o">.</span><span class="n">ddCOSMO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_cosmo</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o_cosmo_rel</span> <span class="o">=</span> <span class="n">solvent</span><span class="o">.</span><span class="n">ddCOSMO</span><span class="p">(</span><span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o_cosmo_rel</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o_cosmo_unrel</span> <span class="o">=</span> <span class="n">solvent</span><span class="o">.</span><span class="n">ddCOSMO</span><span class="p">(</span><span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">rhf_h2o_cosmo</span><span class="p">),</span> <span class="n">dm</span><span class="o">=</span><span class="n">rhf_h2o_cosmo</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o_cosmo_unrel</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Different solvents are chosen by setting the <code class="docutils literal notranslate"><span class="pre">SCF.with_solvent.eps</span></code> attribute.</p>
</section>
<section id="quantum-mechanics-molecular-mechanics-methods">
<span id="qmmm"></span><h3>Quantum Mechanics/Molecular Mechanics Methods<a class="headerlink" href="#quantum-mechanics-molecular-mechanics-methods" title="Link to this heading">#</a></h3>
<p>QM/MM calculations can be performed by either of two different methods in PySCF. Standard point charges can be included in most calculations, be these mean-field or correlated. In the latter case, background charges can be conveniently added to the underlying SCF calculation (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/qmmm/03-ccsd.py">qmmm/03-ccsd.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">qmmm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="mf">10.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">charges</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_qmmm</span> <span class="o">=</span> <span class="n">qmmm</span><span class="o">.</span><span class="n">mm_charge</span><span class="p">(</span><span class="n">rhf_h2o</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">charges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_h2o_qmmm</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_h2o_qmmm</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">rhf_h2o_qmmm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_ccsd</span> <span class="o">=</span> <span class="n">ccsd_h2o_qmmm</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Alternatively, a combination of the <a class="reference external" href="https://gitlab.com/FraME-projects/PyFraME">PyFraME</a> framework and <a class="reference external" href="https://github.com/maxscheurer/cppe">CPPE</a> library can be used to prepare and run polarizable embedding calculations from within PySCF, cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/solvent/04-pe_potfile_from_pyframe.py">solvent/04-pe_potfile_from_pyframe.py</a> and <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/solvent/04-scf_with_pe.py">solvent/04-scf_with_pe.py</a>.</p>
</section>
</section>
<section id="periodic-boundary-conditions">
<span id="id1"></span><h2>Periodic Boundary Conditions<a class="headerlink" href="#periodic-boundary-conditions" title="Link to this heading">#</a></h2>
<p>PySCF provides equal support for molecular and crystalline materials calculations. The latter functionality is found in
the PBC modules.  As discussed above in <a class="reference internal" href="#input"><span class="std std-ref">input parsing</span></a>, the API to initialize unit cells is almost identical to that for finite-size molecules (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc/00-input_cell.py">pbc/00-input_cell.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.pbc</span> <span class="kn">import</span> <span class="n">gto</span> <span class="k">as</span> <span class="n">pbcgto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_diamond</span> <span class="o">=</span> <span class="n">pbcgto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;C     0.      0.      0.</span>
<span class="go">                                      C     .8917    .8917   .8917</span>
<span class="go">                                      C     1.7834  1.7834  0.</span>
<span class="go">                                      C     2.6751  2.6751   .8917</span>
<span class="go">                                      C     1.7834  0.      1.7834</span>
<span class="go">                                      C     2.6751   .8917  2.6751</span>
<span class="go">                                      C     0.      1.7834  1.7834</span>
<span class="go">                                      C     .8917   2.6751  2.6751&#39;&#39;&#39;,</span>
<span class="go">                            basis = &#39;gth-szv&#39;,</span>
<span class="go">                            pseudo = &#39;gth-pade&#39;,</span>
<span class="go">                            a = np.eye(3) * 3.5668)</span>
</pre></div>
</div>
<p>Besides the difference in import of the <code class="docutils literal notranslate"><span class="pre">gto</span></code> module, the only new attributes are <code class="docutils literal notranslate"><span class="pre">Cell.a</span></code> and <code class="docutils literal notranslate"><span class="pre">Cell.pseudo</span></code>. The former  (<code class="docutils literal notranslate"><span class="pre">a</span></code>) is a matrix of lattice vectors, where each row denotes a primitive vector, while the latter (<code class="docutils literal notranslate"><span class="pre">pseudo</span></code>) is an (optional) crystal pseudo potential (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/pyscf/pbc/gto/pseudo/GTH_POTENTIALS">pyscf/pbc/gto/pseudo/GTH_POTENTIALS</a> for a full list of these). All electron calculations can be performed by omitting <code class="docutils literal notranslate"><span class="pre">pseudo</span></code>.
Alternatively, molecular effective core potentials can be used by setting the <code class="docutils literal notranslate"><span class="pre">Cell.ecp</span></code> attribute, cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc/05-input_pp.py">pbc/05-input_pp.py</a>.</p>
<p>Generally, crystal calculations use the same or similar APIs to the molecule calculations.  For instance, an all-electron calculation with k-point sampling at the KS-DFT level using <a class="reference internal" href="#df"><span class="std std-ref">density fitting</span></a> (recommended) and a <a class="reference internal" href="#hf"><span class="std std-ref">second-order SCF algorithm</span></a> is specified as (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc/21-k_points_all_electron_scf.py">pbc/21-k_points_all_electron_scf.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.pbc</span> <span class="kn">import</span> <span class="n">dft</span> <span class="k">as</span> <span class="n">pbcdft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts</span> <span class="o">=</span> <span class="n">cell_diamond</span><span class="o">.</span><span class="n">make_kpts</span><span class="p">([</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># 4 k-poins for each axis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">krks_diamond</span> <span class="o">=</span> <span class="n">pbcdft</span><span class="o">.</span><span class="n">KRKS</span><span class="p">(</span><span class="n">cell_diamond</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span><span class="o">.</span><span class="n">density_fit</span><span class="p">(</span><span class="n">auxbasis</span><span class="o">=</span><span class="s1">&#39;weigend&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">krks_diamond</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s1">&#39;bp86&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">krks_diamond</span> <span class="o">=</span> <span class="n">krks_diamond</span><span class="o">.</span><span class="n">newton</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">krks_diamond</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>After converging the mean-field calculation, dynamic electron correlation can be treated by various methods, e.g. MP2 or (EOM-)CCSD. These calculations can again be performed with k-point sampling (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc/22-k_points_ccsd.py">pbc/22-k_points_ccsd.py</a>). At the <span class="math notranslate nohighlight">\(\Gamma\)</span>-point, all correlation methods available for molecules can be employed (cf. <a class="reference external" href="https://github.com/pyscf/pyscf/blob/master/examples/pbc/12-gamma_point_post_hf.py">pbc/12-gamma_point_post_hf.py</a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.pbc</span> <span class="kn">import</span> <span class="n">scf</span> <span class="k">as</span> <span class="n">pbcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_diamond</span> <span class="o">=</span> <span class="n">pbcscf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">cell_diamond</span><span class="p">)</span><span class="o">.</span><span class="n">density_fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rhf_diamond</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_diamond</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">rhf_diamond</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccsd_diamond</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>The above quickstart provides only a small sample of what is in PySCF from the perspective of a computational user. More details can be found in the user guide, and we highly encourage users to browse the large set of examples. Note that PySCF is designed for easy extensibility. Users interested in these aspects are encouraged to dive into the code! We sincerely hope you’ll enjoy using the library. For bug reports and feature requests, please submit tickets on the <a class="reference external" href="https://github.com/pyscf/pyscf/issues">issues</a> page.</p>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#input-parsing">Input Parsing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-field-theory">Mean-Field Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hartree-fock">Hartree-Fock</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kohn-sham-density-functional-theory">Kohn-Sham Density Functional Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-dependent-mean-field-theory">Time-Dependent Mean-Field Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatially-localized-molecular-orbitals">Spatially Localized Molecular Orbitals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relativistic-effects">Relativistic Effects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetry-handling">Symmetry Handling</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrals-density-fitting">Integrals &amp; Density Fitting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#and-2-electron-integrals">1- and 2-Electron Integrals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#density-fitting-techniques">Density Fitting Techniques</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlated-wave-function-theory">Correlated Wave Function Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perturbation-theory-coupled-cluster-and-algebraic-diagrammatic-constructions">Perturbation Theory, Coupled Cluster, and Algebraic Diagrammatic Constructions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-configuration-interaction">Full Configuration Interaction</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiconfigurational-methods">Multiconfigurational Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-active-space-configuration-interaction-self-consistent-field">Complete Active Space Configuration Interaction &amp; Self-Consistent Field</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#external-approximate-full-configuration-interaction-solvers">External Approximate Full Configuration Interaction Solvers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geometry-optimization">Geometry Optimization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solvent-effects">Solvent Effects</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polarizable-continuum-cosmo-methods">Polarizable Continuum &amp; COSMO Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-mechanics-molecular-mechanics-methods">Quantum Mechanics/Molecular Mechanics Methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#periodic-boundary-conditions">Periodic Boundary Conditions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/pyscf/pyscf.github.io/edit/master/source/quickstart.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, The PySCF Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>