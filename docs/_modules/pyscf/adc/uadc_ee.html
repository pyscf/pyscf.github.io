
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyscf.adc.uadc_ee &#8212; PySCF</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/pyscf-pst.css?v=ed6b5f64" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=67920a36"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/pyscf/adc/uadc_ee';</script>
    <link rel="icon" href="../../../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.10" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo-64x64.png" class="logo__image only-light" alt=""/>
    <img src="../../../_static/logo-64x64.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">PySCF</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyscf/pyscf" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">Module code</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../pyscf.html" class="nav-link">pyscf</a></li>
    
    
    <li class="breadcrumb-item"><a href="../adc.html" class="nav-link">pyscf.adc</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">pyscf.adc.uadc_ee</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Source code for pyscf.adc.uadc_ee</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2014-2022 The PySCF Developers. All Rights Reserved.</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="c1">#</span>
<span class="c1"># Author: Terrence Stahl &lt;terrencestahl@gmail.com&gt;</span>
<span class="c1">#         Alexander Sokolov &lt;alexander.y.sokolov@gmail.com&gt;</span>
<span class="c1">#</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Unrestricted algebraic diagrammatic construction</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span><span class="p">,</span> <span class="n">symm</span>
<span class="kn">from</span> <span class="nn">pyscf.lib</span> <span class="kn">import</span> <span class="n">logger</span>
<span class="kn">from</span> <span class="nn">pyscf.adc</span> <span class="kn">import</span> <span class="n">uadc</span>
<span class="kn">from</span> <span class="nn">pyscf.scf</span> <span class="kn">import</span> <span class="n">hf_symm</span>
<span class="kn">from</span> <span class="nn">pyscf.adc</span> <span class="kn">import</span> <span class="n">uadc_ao2mo</span><span class="p">,</span> <span class="n">uadc_amplitudes</span>
<span class="kn">from</span> <span class="nn">pyscf.adc</span> <span class="kn">import</span> <span class="n">radc_ao2mo</span>
<span class="kn">from</span> <span class="nn">pyscf.adc</span> <span class="kn">import</span> <span class="n">dfadc</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">scf</span>


<div class="viewcode-block" id="get_imds">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.get_imds">[docs]</a>
<span class="k">def</span> <span class="nf">get_imds</span><span class="p">(</span><span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="n">cput0</span> <span class="o">=</span> <span class="p">(</span><span class="n">logger</span><span class="o">.</span><span class="n">process_clock</span><span class="p">(),</span> <span class="n">logger</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">())</span>
    <span class="n">log</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="n">Logger</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">adc</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;adc(2)&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(2)-x&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>

    <span class="n">method</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span>

    <span class="n">nocc_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_a</span>
    <span class="n">nocc_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_b</span>
    <span class="n">nvir_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_a</span>
    <span class="n">nvir_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_b</span>

    <span class="n">t1</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t1</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t2</span>

    <span class="n">ab_ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ab_ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_b</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>


    <span class="n">n_singles_a</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nvir_a</span>
    <span class="n">dim_a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_singles_a</span><span class="p">)</span>
    <span class="n">n_singles_b</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nvir_b</span>
    <span class="n">dim_b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_singles_b</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim_a</span><span class="p">,</span> <span class="n">dim_a</span><span class="p">))</span>
    <span class="n">M_ia_jb_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim_b</span><span class="p">,</span> <span class="n">dim_b</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">eris</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">eris</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">transform_integrals</span><span class="p">()</span>

    <span class="n">d_ai_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:][:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">-</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">]</span>
    <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">M_ia_jb_a</span><span class="p">,</span> <span class="n">d_ai_a</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">M_ia_jb_a</span> <span class="o">=</span> <span class="n">M_ia_jb_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">d_ai_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:][:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">-</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">]</span>
    <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">M_ia_jb_b</span><span class="p">,</span> <span class="n">d_ai_b</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="n">M_ia_jb_b</span> <span class="o">=</span> <span class="n">M_ia_jb_b</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">M_ia_jb_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijba-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">oovv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">M_ia_jb_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbai-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijba-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">M_ia_jb_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbai-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_aabb</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbai-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1">#    #M^(2)_0 term 3 iemf</span>
    <span class="n">vir_list_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nvir_a</span><span class="p">))</span>
    <span class="n">vir_list_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nvir_b</span><span class="p">))</span>
    <span class="n">occ_list_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">))</span>
    <span class="n">occ_list_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">))</span>

    <span class="n">t2_1_a</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
    <span class="n">M_ia_jb_a</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmef,iefm-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmef,ifem-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,jefm-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,jfem-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnae,mben-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnae,mebn-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnbe,maen-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnbe,mean-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmbe,iaem-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,jbem-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,jebm-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmbe,ieam-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_aabb</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,jbem-&gt;iajb&#39;</span><span class="p">,</span>
                               <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">t2_1_a</span>

    <span class="n">t2_1_ab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
    <span class="n">M_ia_jb_a</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmef,iefm-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,jefm-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnae,mben-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnbe,maen-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmbe,iaem-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_a</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,jbem-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mjfe,iefm-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mife,jefm-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;nmea,mben-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;nmeb,maen-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mjeb,iaem-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;miea,jbem-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_aabb</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mjeb,iaem-&gt;iajb&#39;</span><span class="p">,</span>
                               <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_aabb</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mjeb,ieam-&gt;iajb&#39;</span><span class="p">,</span>
                               <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_aabb</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,jbem-&gt;iajb&#39;</span><span class="p">,</span>
                               <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_aabb</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,jebm-&gt;iajb&#39;</span><span class="p">,</span>
                               <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">t2_1_ab</span>

    <span class="n">t2_1_b</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span>
    <span class="n">M_ia_jb_b</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmef,iefm-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmef,ifem-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,jefm-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,jfem-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnae,mben-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnae,mebn-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnbe,maen-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> \
        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnbe,mean-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmbe,iaem-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmbe,ieam-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,jbem-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,jebm-&gt;iajb&#39;</span><span class="p">,</span>
                                  <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">M_aabb</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mjeb,iaem-&gt;iajb&#39;</span><span class="p">,</span>
                               <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">t2_1_b</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>

        <span class="n">t1_1_a</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">f_ov_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">M_ia_jb_a</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,ie-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">f_ov_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_a</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,je-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">f_ov_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,mb-&gt;ab&#39;</span><span class="p">,</span> <span class="n">f_ov_a</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,ma-&gt;ab&#39;</span><span class="p">,</span> <span class="n">f_ov_a</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">f_ov_a</span>

        <span class="n">M_ia_jb_a</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meij-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_a</span><span class="p">[:,</span>
                  <span class="n">vir_list_a</span><span class="p">,</span>
                  <span class="p">:,</span>
                  <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,iemj-&gt;ij&#39;</span><span class="p">,</span>
                                            <span class="n">t1_1_a</span><span class="p">,</span>
                                            <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,jbmi-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span>
                                <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,mbji-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span>
                                <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,jbmi-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,iamj-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span>
                                <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,maij-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span>
                                <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_b</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meij-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_a</span><span class="p">[:,</span>
                  <span class="n">vir_list_a</span><span class="p">,</span>
                  <span class="p">:,</span>
                  <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,jemi-&gt;ij&#39;</span><span class="p">,</span>
                                            <span class="n">t1_1_a</span><span class="p">,</span>
                                            <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">t1_1_a</span>

        <span class="n">f_ov_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">t1_1_b</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
        <span class="n">M_ia_jb_b</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,ie-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">f_ov_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_b</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,je-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">f_ov_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,mb-&gt;ab&#39;</span><span class="p">,</span> <span class="n">f_ov_b</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,ma-&gt;ab&#39;</span><span class="p">,</span> <span class="n">f_ov_b</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">f_ov_b</span>

        <span class="n">M_ia_jb_a</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meij-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,iamj-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_b</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meij-&gt;ij&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_b</span><span class="p">[:,</span>
                  <span class="n">vir_list_b</span><span class="p">,</span>
                  <span class="p">:,</span>
                  <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,iemj-&gt;ij&#39;</span><span class="p">,</span>
                                            <span class="n">t1_1_b</span><span class="p">,</span>
                                            <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_b</span><span class="p">[:,</span>
                  <span class="n">vir_list_b</span><span class="p">,</span>
                  <span class="p">:,</span>
                  <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,jemi-&gt;ij&#39;</span><span class="p">,</span>
                                            <span class="n">t1_1_b</span><span class="p">,</span>
                                            <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,jbmi-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span>
                                <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,mbji-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span>
                                <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,iamj-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span>
                                <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">M_ia_jb_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,maij-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span>
                                <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">t1_1_b</span>

        <span class="n">t1_1_a</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovvv</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                <span class="n">eris_ovvv</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
                <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="n">occ_list_a</span><span class="p">,</span>
                          <span class="p">:]</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meba-&gt;ab&#39;</span><span class="p">,</span>
                                               <span class="n">t1_1_a</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                               <span class="n">eris_ovvv</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="n">occ_list_a</span><span class="p">,</span>
                          <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,mabe-&gt;ab&#39;</span><span class="p">,</span>
                                           <span class="n">t1_1_a</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                           <span class="n">eris_ovvv</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="n">occ_list_a</span><span class="p">,</span>
                          <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,mbea-&gt;ab&#39;</span><span class="p">,</span>
                                           <span class="n">t1_1_a</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                           <span class="n">eris_ovvv</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,ieab-&gt;iajb&#39;</span><span class="p">,</span>
                                                 <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,iaeb-&gt;iajb&#39;</span><span class="p">,</span>
                                                 <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_a</span><span class="p">[:,</span>
                          <span class="p">:,</span>
                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jeba-&gt;iajb&#39;</span><span class="p">,</span>
                                                 <span class="n">t1_1_a</span><span class="p">,</span>
                                                 <span class="n">eris_ovvv</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_a</span><span class="p">[:,</span>
                          <span class="p">:,</span>
                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jbea-&gt;iajb&#39;</span><span class="p">,</span>
                                                 <span class="n">t1_1_a</span><span class="p">,</span>
                                                 <span class="n">eris_ovvv</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">eris_ovvv</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eris_ovvv</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovvv</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
            <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meba-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,mabe-&gt;ab&#39;</span><span class="p">,</span>
                                       <span class="n">t1_1_a</span><span class="p">,</span>
                                       <span class="n">eris_ovvv</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,mbea-&gt;ab&#39;</span><span class="p">,</span>
                                       <span class="n">t1_1_a</span><span class="p">,</span>
                                       <span class="n">eris_ovvv</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,ieab-&gt;iajb&#39;</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,iaeb-&gt;iajb&#39;</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jeba-&gt;iajb&#39;</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jbea-&gt;iajb&#39;</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">eris_ovvv</span>
        <span class="k">del</span> <span class="n">t1_1_a</span>

        <span class="n">t1_1_b</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVVV</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_b</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                <span class="n">eris_OVVV</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LOV</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
                <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="n">occ_list_b</span><span class="p">,</span>
                          <span class="p">:]</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meba-&gt;ab&#39;</span><span class="p">,</span>
                                               <span class="n">t1_1_b</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                               <span class="n">eris_OVVV</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="n">occ_list_b</span><span class="p">,</span>
                          <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,mabe-&gt;ab&#39;</span><span class="p">,</span>
                                           <span class="n">t1_1_b</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                           <span class="n">eris_OVVV</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="n">occ_list_b</span><span class="p">,</span>
                          <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,mbea-&gt;ab&#39;</span><span class="p">,</span>
                                           <span class="n">t1_1_b</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                           <span class="n">eris_OVVV</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,ieab-&gt;iajb&#39;</span><span class="p">,</span>
                                                 <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,iaeb-&gt;iajb&#39;</span><span class="p">,</span>
                                                 <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_b</span><span class="p">[:,</span>
                          <span class="p">:,</span>
                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jeba-&gt;iajb&#39;</span><span class="p">,</span>
                                                 <span class="n">t1_1_b</span><span class="p">,</span>
                                                 <span class="n">eris_OVVV</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_ia_jb_b</span><span class="p">[:,</span>
                          <span class="p">:,</span>
                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jbea-&gt;iajb&#39;</span><span class="p">,</span>
                                                 <span class="n">t1_1_b</span><span class="p">,</span>
                                                 <span class="n">eris_OVVV</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">eris_OVVV</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eris_OVVV</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVVV</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
            <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meba-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,mabe-&gt;ab&#39;</span><span class="p">,</span>
                                       <span class="n">t1_1_b</span><span class="p">,</span>
                                       <span class="n">eris_OVVV</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,mbea-&gt;ab&#39;</span><span class="p">,</span>
                                       <span class="n">t1_1_b</span><span class="p">,</span>
                                       <span class="n">eris_OVVV</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,ieab-&gt;iajb&#39;</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,iaeb-&gt;iajb&#39;</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jeba-&gt;iajb&#39;</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_ia_jb_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jbea-&gt;iajb&#39;</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">eris_OVVV</span>
        <span class="k">del</span> <span class="n">t1_1_b</span>

        <span class="n">t1_1_a</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">t1_1_b</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVvv</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_b</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                <span class="n">eris_OVvv</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LOV</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
                <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="n">occ_list_a</span><span class="p">,</span>
                          <span class="p">:]</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meba-&gt;ab&#39;</span><span class="p">,</span>
                                               <span class="n">t1_1_b</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                               <span class="n">eris_OVvv</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_aabb</span><span class="p">[:,</span>
                       <span class="p">:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jbea-&gt;iajb&#39;</span><span class="p">,</span>
                                              <span class="n">t1_1_a</span><span class="p">,</span>
                                              <span class="n">eris_OVvv</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">eris_OVvv</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eris_OVvv</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVvv</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
            <span class="n">M_ia_jb_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_a</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meba-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris_OVvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jbea-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span>
                                 <span class="n">eris_OVvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">eris_OVvv</span>
        <span class="k">del</span> <span class="n">t1_1_a</span>
        <span class="k">del</span> <span class="n">t1_1_b</span>

        <span class="n">t1_1_a</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">t1_1_b</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovVV</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                <span class="n">eris_ovVV</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
                <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="n">occ_list_b</span><span class="p">,</span>
                          <span class="p">:]</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meba-&gt;ab&#39;</span><span class="p">,</span>
                                               <span class="n">t1_1_a</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                               <span class="n">eris_ovVV</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">M_aabb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,iaeb-&gt;iajb&#39;</span><span class="p">,</span>
                                              <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">eris_ovVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">eris_ovVV</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eris_ovVV</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovVV</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
            <span class="n">M_ia_jb_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">occ_list_b</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;me,meba-&gt;ab&#39;</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">eris_ovVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">M_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,iaeb-&gt;iajb&#39;</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span>
                                 <span class="n">eris_ovVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">eris_ovVV</span>
        <span class="k">del</span> <span class="n">t1_1_a</span>
        <span class="k">del</span> <span class="n">t1_1_b</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>

        <span class="n">t1</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t1</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t2</span>

        <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">h_ce_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
            <span class="n">h_ce_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
            <span class="n">t1_ce_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
            <span class="n">t1_ce_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h_ce_aa</span><span class="p">,</span> <span class="n">h_ce_bb</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span>
            <span class="n">t1_ce_aa</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
            <span class="n">t1_ce_bb</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>

        <span class="n">einsum_type</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">v_cccc_aaaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">oooo</span>
        <span class="n">v_cccc_bbbb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOOO</span>
        <span class="n">v_cccc_aabb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ooOO</span>

        <span class="n">v_ceec_aaaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span>
        <span class="n">v_ceec_bbbb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span>
        <span class="n">v_ceec_aabb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span>
        <span class="n">v_ceec_bbaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVvo</span>

        <span class="n">v_ccee_aaaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">oovv</span>
        <span class="n">v_ccee_bbbb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOVV</span>
        <span class="n">v_ccee_aabb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ooVV</span>
        <span class="n">v_ccee_bbaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOvv</span>

        <span class="n">v_cecc_aaaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span>
        <span class="n">v_cecc_bbbb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span>
        <span class="n">v_cecc_aabb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovOO</span>
        <span class="n">v_cecc_bbaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVoo</span>

        <span class="n">t2_ce_aa</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">t2_ce_bb</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>

        <span class="n">t1_ccee_aaaa</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t1_ccee_abab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t1_ccee_bbbb</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">t2_ccee_aaaa</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t2_ccee_abab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t2_ccee_bbbb</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>


        <span class="n">e_core_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">e_extern_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>


        <span class="n">e_core_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">e_extern_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">M_030_aa</span><span class="p">,</span> <span class="n">M_030_bb</span><span class="p">,</span> <span class="n">M_030_aabb</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="kc">None</span><span class="p">,)</span>

        <span class="c1"># In-core V^4 contribution</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>

            <span class="n">v_eeee_aaaa</span> <span class="o">=</span> <span class="n">radc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_2</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>

            <span class="n">M_030_aa</span> <span class="o">=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,Ia,Lb-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,Iiac,Libc-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,Iiac,Libc-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span> <span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;Aabc,IiDa,Libc-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span> <span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;Dabc,LiAa,Iibc-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ia,ib-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijac,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijac,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abcd,Iiab,Licd-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Aabc,ijDa,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dabc,ijAa,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_030_aabb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;Dbcd,ilba,Iicd-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="k">del</span> <span class="n">v_eeee_aaaa</span>

            <span class="n">v_eeee_bbbb</span> <span class="o">=</span> <span class="n">radc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_2</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">VVVV_p</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

            <span class="n">M_030_bb</span> <span class="o">=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,ib,lc-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,ijbe,ljce-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jieb,jlec-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;abce,ijdb,ljce-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;dbce,ljab,ijce-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bcef,ijbc,ljef-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jb,jc-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jkeb,jkec-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jkbe,jkce-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abce,jkdb,jkce-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;dbce,jkab,jkce-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;abcd,IiDb,licd-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="k">del</span> <span class="n">v_eeee_bbbb</span>

        <span class="c1"># Out-of-core V^4 contribution</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>

            <span class="n">t_v_con</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>

            <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">temp_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>

            <span class="n">interm</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">imds</span><span class="o">.</span><span class="n">t2_1_vvvv</span><span class="p">[</span><span class="mi">0</span><span class="p">][:]</span>
            <span class="n">interm</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">interm</span>

            <span class="n">t_v_con</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                    <span class="p">:,</span>
                    <span class="n">occ_list_a</span><span class="p">,</span>
                    <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                             <span class="n">interm</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                    <span class="p">:,</span>
                    <span class="n">occ_list_a</span><span class="p">,</span>
                    <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                             <span class="n">interm</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">:</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">vvvv</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:]</span>
                <span class="n">v_eeee_aaaa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                <span class="n">v_eeee_aaaa</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">vvvv</span>
                <span class="n">v_eeee_aaaa</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">vvvv</span>

                <span class="n">temp_1</span><span class="p">[:,</span>
                       <span class="p">:,</span>
                       <span class="p">:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,Ia,Lb-&gt;IDLA&#39;</span><span class="p">,</span>
                                               <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_1</span><span class="p">[:,</span>
                       <span class="p">:,</span>
                       <span class="p">:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,Iiac,Libc-&gt;IDLA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_1</span><span class="p">[:,</span>
                       <span class="p">:,</span>
                       <span class="p">:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,Iiac,Libc-&gt;IDLA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_1</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ia,ib-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_1</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijac,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_1</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijac,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">del</span> <span class="n">v_eeee_aaaa</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="n">k</span>
            <span class="n">M_030_aa</span> <span class="o">=</span> <span class="n">temp_1</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">temp_1</span>
            <span class="k">del</span> <span class="n">interm</span>

            <span class="n">t_v_con</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>

            <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">interm</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">imds</span><span class="o">.</span><span class="n">t2_1_vvvv</span><span class="p">[</span><span class="mi">2</span><span class="p">][:]</span>
            <span class="n">interm</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">interm</span>

            <span class="n">t_v_con</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                    <span class="p">:,</span>
                    <span class="n">occ_list_b</span><span class="p">,</span>
                    <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkdb,jkab-&gt;da&#39;</span><span class="p">,</span>
                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                             <span class="n">interm</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                    <span class="p">:,</span>
                    <span class="n">occ_list_b</span><span class="p">,</span>
                    <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkdb-&gt;da&#39;</span><span class="p">,</span>
                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                             <span class="n">interm</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijdb,ljab-&gt;idla&#39;</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljab,ijdb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijbc,ljbc-&gt;il&#39;</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">temp_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">eris</span><span class="o">.</span><span class="n">VVVV_p</span><span class="p">:</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">VVVV</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:]</span>
                <span class="n">v_eeee_bbbb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                <span class="n">v_eeee_bbbb</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">VVVV</span>
                <span class="n">v_eeee_bbbb</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">VVVV</span>

                <span class="n">temp_2</span><span class="p">[:,</span>
                       <span class="p">:,</span>
                       <span class="p">:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,ib,lc-&gt;idla&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_2</span><span class="p">[:,</span>
                       <span class="p">:,</span>
                       <span class="p">:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,ijbe,ljce-&gt;idla&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_2</span><span class="p">[:,</span>
                       <span class="p">:,</span>
                       <span class="p">:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jieb,jlec-&gt;idla&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_2</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jb,jc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_2</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jkeb,jkec-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_2</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jkbe,jkce-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">del</span> <span class="n">v_eeee_bbbb</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="n">k</span>
            <span class="n">M_030_bb</span> <span class="o">=</span> <span class="n">temp_2</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">temp_2</span>
            <span class="k">del</span> <span class="n">interm</span>

            <span class="n">interm</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">adc</span><span class="o">.</span><span class="n">imds</span><span class="o">.</span><span class="n">t2_1_vvvv</span><span class="p">[</span><span class="mi">0</span><span class="p">][:]</span>

            <span class="n">t_v_con</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilba,IiDb-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_030_aabb</span> <span class="o">=</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">interm</span>

            <span class="n">interm</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">adc</span><span class="o">.</span><span class="n">imds</span><span class="o">.</span><span class="n">t2_1_vvvv</span><span class="p">[</span><span class="mi">2</span><span class="p">][:]</span>
            <span class="n">t_v_con</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDb,liab-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">interm</span>

        <span class="c1"># Density fitting V^4 contribution</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t_v_con</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>

            <span class="n">interm</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">adc</span><span class="o">.</span><span class="n">imds</span><span class="o">.</span><span class="n">t2_1_vvvv</span><span class="p">[</span><span class="mi">0</span><span class="p">][:]</span>

            <span class="n">t_v_con</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                    <span class="p">:,</span>
                    <span class="n">occ_list_a</span><span class="p">,</span>
                    <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                             <span class="n">interm</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                    <span class="p">:,</span>
                    <span class="n">occ_list_a</span><span class="p">,</span>
                    <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                             <span class="n">interm</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span><span class="p">[:,</span> <span class="n">vir_list_a</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">temp_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nvir_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                <span class="n">v_eeee_aaaa</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_vvvv_antisym_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">,</span> <span class="n">pack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="n">temp_1</span><span class="p">[:,</span>
                       <span class="p">:,</span>
                       <span class="p">:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,Iiac,Libc-&gt;IDLA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_1</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijac,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_1</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijac,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                    <span class="n">temp_1</span><span class="p">[:,</span>
                           <span class="p">:,</span>
                           <span class="p">:,</span>
                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,Ia,Lb-&gt;IDLA&#39;</span><span class="p">,</span>
                                                   <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">temp_1</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                           <span class="p">:,</span>
                           <span class="n">occ_list_a</span><span class="p">,</span>
                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ia,ib-&gt;DA&#39;</span><span class="p">,</span>
                                                  <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                  <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                  <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">del</span> <span class="n">v_eeee_aaaa</span>
            <span class="n">M_030_aa</span> <span class="o">=</span> <span class="n">temp_1</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">temp_1</span>
            <span class="k">del</span> <span class="n">interm</span>

            <span class="n">t_v_con</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>

            <span class="n">interm</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">adc</span><span class="o">.</span><span class="n">imds</span><span class="o">.</span><span class="n">t2_1_vvvv</span><span class="p">[</span><span class="mi">2</span><span class="p">][:]</span>

            <span class="n">t_v_con</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                    <span class="p">:,</span>
                    <span class="n">occ_list_b</span><span class="p">,</span>
                    <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkdb,jkab-&gt;da&#39;</span><span class="p">,</span>
                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                             <span class="n">interm</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                    <span class="p">:,</span>
                    <span class="n">occ_list_b</span><span class="p">,</span>
                    <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkdb-&gt;da&#39;</span><span class="p">,</span>
                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                             <span class="n">interm</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijdb,ljab-&gt;idla&#39;</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljab,ijdb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con</span><span class="p">[:,</span> <span class="n">vir_list_b</span><span class="p">,</span> <span class="p">:,</span> <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijbc,ljbc-&gt;il&#39;</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">temp_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nvir_b</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                <span class="n">v_eeee_bbbb</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_vvvv_antisym_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">,</span> <span class="n">pack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="n">temp_2</span><span class="p">[:,</span>
                       <span class="p">:,</span>
                       <span class="p">:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,ijbe,ljce-&gt;idla&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_2</span><span class="p">[:,</span>
                       <span class="p">:,</span>
                       <span class="p">:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jieb,jlec-&gt;idla&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_2</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jkeb,jkec-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_2</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jkbe,jkce-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                    <span class="n">temp_2</span><span class="p">[:,</span>
                           <span class="p">:,</span>
                           <span class="p">:,</span>
                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,ib,lc-&gt;idla&#39;</span><span class="p">,</span>
                                                  <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                  <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                  <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">temp_2</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                           <span class="p">:,</span>
                           <span class="n">occ_list_b</span><span class="p">,</span>
                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abdc,jb,jc-&gt;da&#39;</span><span class="p">,</span>
                                                  <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                  <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                  <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">del</span> <span class="n">v_eeee_bbbb</span>
            <span class="n">M_030_bb</span> <span class="o">=</span> <span class="n">temp_2</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">temp_2</span>
            <span class="k">del</span> <span class="n">interm</span>

            <span class="n">interm</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">adc</span><span class="o">.</span><span class="n">imds</span><span class="o">.</span><span class="n">t2_1_vvvv</span><span class="p">[</span><span class="mi">0</span><span class="p">][:]</span>

            <span class="n">t_v_con</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilba,IiDb-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_030_aabb</span> <span class="o">=</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">interm</span>

            <span class="n">interm</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">adc</span><span class="o">.</span><span class="n">imds</span><span class="o">.</span><span class="n">t2_1_vvvv</span><span class="p">[</span><span class="mi">2</span><span class="p">][:]</span>
            <span class="n">t_v_con</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDb,liab-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">t_v_con</span>
            <span class="k">del</span> <span class="n">interm</span>

        <span class="c1"># In-core V^4 contribution</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>

            <span class="n">v_eeee_abab</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span>
            <span class="n">v_eeee_abab</span> <span class="o">=</span> <span class="n">v_eeee_abab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,Iica,Licb-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Aabc,IiDa,Libc-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dabc,LiAa,Iibc-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;abcd,Iiab,Licd-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_eeee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ia,ib-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijca,ijcb-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijac,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Aabc,ijDa,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dabc,ijAa,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jibe,jlce-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bace,jibd,jlce-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bcef,jibc,jlef-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_eeee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jkbe,jkce-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jb,jc-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jkbe,jkce-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bace,jkbd,jkce-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bdce,jkba,jkce-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bdce,jlba,jice-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_eeee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dbca,lb,Ic-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_eeee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dbca,libd,Iicd-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_eeee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dbca,ildb,Iicd-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_eeee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dbcd,liab,Iicd-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_eeee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,IiDb,ilcd-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_eeee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">v_eeee_abab</span>

        <span class="c1"># Out-of-core V^4 contribution</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>

            <span class="n">t_v_con_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
            <span class="n">t_v_con_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
            <span class="n">t_v_con_ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>

            <span class="n">interm</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">imds</span><span class="o">.</span><span class="n">t2_1_vvvv</span><span class="p">[</span><span class="mi">1</span><span class="p">][:]</span>
            <span class="n">t_v_con_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">interm</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">interm</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_a</span><span class="p">[:,</span>
                      <span class="n">vir_list_a</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                 <span class="n">interm</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">t_v_con_a</span>
            <span class="k">del</span> <span class="n">t_v_con_a</span>

            <span class="n">t_v_con_b</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;jlba,jibd-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">interm</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkbd,jkba-&gt;da&#39;</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">interm</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkba,jkbd-&gt;da&#39;</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">interm</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_b</span><span class="p">[:,</span>
                      <span class="n">vir_list_b</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jibc,jlbc-&gt;il&#39;</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">interm</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jibd,jlba-&gt;idla&#39;</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">t_v_con_b</span>
            <span class="k">del</span> <span class="n">t_v_con_b</span>

            <span class="n">t_v_con_ab</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;liab,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">interm</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDb,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">t_v_con_ab</span>
            <span class="k">del</span> <span class="n">t_v_con_ab</span>
            <span class="k">del</span> <span class="n">interm</span>

            <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">temp_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
            <span class="n">temp_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
            <span class="n">temp_aabb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span><span class="p">:</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">v_eeee_abab</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

                <span class="n">temp_a</span><span class="p">[:,</span>
                       <span class="p">:,</span>
                       <span class="p">:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,Iica,Licb-&gt;IDLA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ia,ib-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijca,ijcb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijac,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="n">temp_b</span> <span class="o">+=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jibe,jlce-&gt;idla&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                   <span class="p">:,</span>
                                                   <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jkbe,jkce-&gt;da&#39;</span><span class="p">,</span>
                                                <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                             <span class="p">:,</span>
                                                             <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                                                             <span class="p">:],</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jb,jc-&gt;da&#39;</span><span class="p">,</span>
                                        <span class="n">v_eeee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">[:,</span>
                                                 <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">],</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jkbe,jkce-&gt;da&#39;</span><span class="p">,</span>
                                        <span class="n">v_eeee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                     <span class="p">:,</span>
                                                     <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                                                     <span class="p">:],</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="n">temp_aabb</span><span class="p">[:,</span>
                          <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dbca,lb,Ic-&gt;IDla&#39;</span><span class="p">,</span>
                                           <span class="n">v_eeee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_aabb</span><span class="p">[:,</span>
                          <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dbca,libd,Iicd-&gt;IDla&#39;</span><span class="p">,</span>
                                           <span class="n">v_eeee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_aabb</span><span class="p">[:,</span>
                          <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dbca,ildb,Iicd-&gt;IDla&#39;</span><span class="p">,</span>
                                           <span class="n">v_eeee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">del</span> <span class="n">v_eeee_abab</span>
                <span class="n">a</span> <span class="o">+=</span> <span class="n">k</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">temp_a</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">temp_b</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">temp_aabb</span>
            <span class="k">del</span> <span class="n">temp_a</span>
            <span class="k">del</span> <span class="n">temp_b</span>
            <span class="k">del</span> <span class="n">temp_aabb</span>

        <span class="c1"># Density fitting V^4 contribution</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t_v_con_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
            <span class="n">t_v_con_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
            <span class="n">t_v_con_ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
            <span class="n">interm</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">imds</span><span class="o">.</span><span class="n">t2_1_vvvv</span><span class="p">[</span><span class="mi">1</span><span class="p">][:]</span>
            <span class="n">t_v_con_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">interm</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_a</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">interm</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_a</span><span class="p">[:,</span>
                      <span class="n">vir_list_a</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                 <span class="n">interm</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">t_v_con_a</span>
            <span class="k">del</span> <span class="n">t_v_con_a</span>

            <span class="n">t_v_con_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkbd,jkba-&gt;da&#39;</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">interm</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">occ_list_b</span><span class="p">,</span>
                      <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkba,jkbd-&gt;da&#39;</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">interm</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jlba,jibd-&gt;idla&#39;</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jibd,jlba-&gt;idla&#39;</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_b</span><span class="p">[:,</span>
                      <span class="n">vir_list_b</span><span class="p">,</span>
                      <span class="p">:,</span>
                      <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jibc,jlbc-&gt;il&#39;</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">interm</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">t_v_con_b</span>
            <span class="k">del</span> <span class="n">t_v_con_b</span>

            <span class="n">t_v_con_ab</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;liab,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">interm</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">t_v_con_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDb,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">interm</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">t_v_con_ab</span>
            <span class="k">del</span> <span class="n">t_v_con_ab</span>
            <span class="k">del</span> <span class="n">interm</span>

            <span class="n">temp_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
            <span class="n">temp_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
            <span class="n">temp_aabb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>

            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nvir_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                <span class="n">vVvV</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_vVvV_df</span><span class="p">(</span><span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span>
                <span class="n">v_eeee_abab</span> <span class="o">=</span> <span class="n">vVvV</span>

                <span class="n">temp_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijca,ijcb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_eeee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_a</span><span class="p">,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ijac,ijbc-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="n">temp_b</span> <span class="o">+=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jibe,jlce-&gt;idla&#39;</span><span class="p">,</span>
                                      <span class="n">v_eeee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                   <span class="p">:,</span>
                                                   <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jkbe,jkce-&gt;da&#39;</span><span class="p">,</span>
                                                <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                             <span class="p">:,</span>
                                                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                             <span class="p">:],</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:,</span>
                       <span class="n">occ_list_b</span><span class="p">,</span>
                       <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jkbe,jkce-&gt;da&#39;</span><span class="p">,</span>
                                        <span class="n">v_eeee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                     <span class="p">:,</span>
                                                     <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                     <span class="p">:],</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="n">temp_aabb</span><span class="p">[:,</span>
                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dbca,libd,Iicd-&gt;IDla&#39;</span><span class="p">,</span>
                                           <span class="n">v_eeee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_aabb</span><span class="p">[:,</span>
                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                          <span class="p">:,</span>
                          <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dbca,ildb,Iicd-&gt;IDla&#39;</span><span class="p">,</span>
                                           <span class="n">v_eeee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                    <span class="n">temp_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                           <span class="p">:,</span>
                           <span class="n">occ_list_a</span><span class="p">,</span>
                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ia,ib-&gt;DA&#39;</span><span class="p">,</span>
                                                  <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                  <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                  <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">temp_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                           <span class="p">:,</span>
                           <span class="n">occ_list_b</span><span class="p">,</span>
                           <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;bacd,jb,jc-&gt;da&#39;</span><span class="p">,</span>
                                            <span class="n">v_eeee_abab</span><span class="p">,</span>
                                            <span class="n">t1_ce_aa</span><span class="p">[:,</span>
                                                     <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ce_aa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">temp_aabb</span><span class="p">[:,</span>
                              <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                              <span class="p">:,</span>
                              <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Dbca,lb,Ic-&gt;IDla&#39;</span><span class="p">,</span>
                                               <span class="n">v_eeee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">del</span> <span class="n">v_eeee_abab</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">temp_a</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">temp_b</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">temp_aabb</span>
            <span class="k">del</span> <span class="n">temp_a</span>
            <span class="k">del</span> <span class="n">temp_b</span>
            <span class="k">del</span> <span class="n">temp_aabb</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovvv</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>

                <span class="n">v_ceee_aaaa</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>

                <span class="n">M_030_aa</span><span class="p">[:,</span>
                         <span class="p">:,</span>
                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,LaDA-&gt;IDLA&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_aa</span><span class="p">,</span>
                                          <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_aa</span><span class="p">[:,</span>
                         <span class="p">:,</span>
                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,LADa-&gt;IDLA&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_aa</span><span class="p">,</span>
                                          <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="p">:,</span>
                         <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,IaAD-&gt;IDLA&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_aa</span><span class="p">,</span>
                                          <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="p">:,</span>
                         <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,IDAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_aa</span><span class="p">,</span>
                                          <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaAD-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                          <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iADa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                          <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaDA-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                          <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iDAa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                          <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IaAD,Liab,ib-&gt;IDLA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IaAD,Liab,ib-&gt;IDLA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,Liab,Ib-&gt;IDLA&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LaDA,Iiab,ib-&gt;IDLA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LaDA,Iiab,ib-&gt;IDLA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,Iiab,Lb-&gt;IDLA&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LADa,Iiab,ib-&gt;IDLA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LADa,Iiab,ib-&gt;IDLA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAab,IiDb,ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADa,Iiab,Lb-&gt;IDLA&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAab,IiDb,La-&gt;IDLA&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                        <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDAa,Liab,ib-&gt;IDLA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDAa,Liab,ib-&gt;IDLA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IaAb,Liba,iD-&gt;IDLA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDAa,Liab,Ib-&gt;IDLA&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LabA,ib,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabA,Lb,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                        <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDab,LiAb,ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDab,LiAb,Ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                        <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LaDb,Iiba,iA-&gt;IDLA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IabD,ib,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabD,Ib,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                        <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="n">vir_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabc,Liac,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="n">vir_list_a</span><span class="p">,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labc,Iiac,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="n">vir_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabc,Iiac,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                                    <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                    <span class="p">:,</span>
                                                                    <span class="p">:],</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="n">vir_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabc,Ib,Lica-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                                    <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                    <span class="p">:,</span>
                                                                    <span class="p">:],</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADa,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADa,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAab,ijDb,ja-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDAa,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDAa,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAb,ijba,jD-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabA,jb,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDab,ijAb,ja-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDb,ijba,jA-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabD,jb,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDbc,ilca,Ib-&gt;IDla&#39;</span><span class="p">,</span>
                                             <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                             <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                          <span class="p">:,</span>
                                                          <span class="p">:,</span>
                                                          <span class="p">:],</span>
                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcD,Ic,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                             <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                             <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                          <span class="p">:,</span>
                                                          <span class="p">:,</span>
                                                          <span class="p">:],</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:,</span>
                               <span class="p">:,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDbc,ilca,ib-&gt;IDla&#39;</span><span class="p">,</span>
                                                <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:,</span>
                               <span class="p">:,</span>
                               <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IbcD,ic,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                                <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">v_ceee_aaaa</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v_ceee_aaaa</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovvv</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,LaDA-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,LADa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,IaAD-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,IDAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaAD-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">t2_ce_aa</span><span class="p">,</span>
                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iADa-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">t2_ce_aa</span><span class="p">,</span>
                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaDA-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">t2_ce_aa</span><span class="p">,</span>
                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iDAa-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">t2_ce_aa</span><span class="p">,</span>
                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IaAD,Liab,ib-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IaAD,Liab,ib-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,Liab,Ib-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LaDA,Iiab,ib-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LaDA,Iiab,ib-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,Iiab,Lb-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LADa,Iiab,ib-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LADa,Iiab,ib-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAab,IiDb,ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADa,Iiab,Lb-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAab,IiDb,La-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDAa,Liab,ib-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDAa,Liab,ib-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IaAb,Liba,iD-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDAa,Liab,Ib-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LabA,ib,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabA,Lb,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDab,LiAb,ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDab,LiAb,Ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LaDb,Iiba,iA-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IabD,ib,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabD,Ib,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabc,Liac,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labc,Iiac,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabc,Iiac,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabc,Ib,Lica-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADa,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADa,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAab,ijDb,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDAa,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDAa,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAb,ijba,jD-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabA,jb,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDab,ijAb,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDb,ijba,jA-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabD,jb,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDbc,ilca,ib-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDbc,ilca,Ib-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IbcD,ic,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcD,Ic,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">v_ceee_aaaa</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVVV</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_b</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>

                <span class="n">v_ceee_bbbb</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LOV</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

                <span class="n">M_030_bb</span><span class="p">[:,</span>
                         <span class="p">:,</span>
                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,lbda-&gt;idla&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_bb</span><span class="p">,</span>
                                          <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_bb</span><span class="p">[:,</span>
                         <span class="p">:,</span>
                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ladb-&gt;idla&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_bb</span><span class="p">,</span>
                                          <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="p">:,</span>
                         <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lb,ibad-&gt;idla&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_bb</span><span class="p">,</span>
                                          <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="p">:,</span>
                         <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lb,idab-&gt;idla&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_bb</span><span class="p">,</span>
                                          <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_b</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbad-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                          <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_b</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jadb-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                          <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_b</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbda-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                          <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_b</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jdab-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                          <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibad,ljbc,jc-&gt;idla&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibad,jlcb,jc-&gt;idla&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,ljbc,ic-&gt;idla&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbda,ijbc,jc-&gt;idla&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbda,jicb,jc-&gt;idla&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,ijbc,lc-&gt;idla&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ladb,ijbc,jc-&gt;idla&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ladb,jicb,jc-&gt;idla&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labc,ijdc,jb-&gt;idla&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadb,ijbc,lc-&gt;idla&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabc,ijdc,lb-&gt;idla&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                        <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idab,ljbc,jc-&gt;idla&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idab,jlcb,jc-&gt;idla&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibac,ljcb,jd-&gt;idla&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdab,ljbc,ic-&gt;idla&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbca,jc,ijdb-&gt;idla&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbca,lc,ijdb-&gt;idla&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                        <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbc,ljac,jb-&gt;idla&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbc,ljac,ib-&gt;idla&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                        <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbdc,ijcb,ja-&gt;idla&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcd,jc,ljab-&gt;idla&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbcd,ic,ljab-&gt;idla&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                        <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="n">vir_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibce,ljbe,jc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="n">vir_list_b</span><span class="p">,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbce,ijbe,jc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="n">vir_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbce,ijbe,lc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                                    <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                    <span class="p">:,</span>
                                                                    <span class="p">:],</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="n">vir_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbce,ic,ljeb-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                                    <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                    <span class="p">:,</span>
                                                                    <span class="p">:],</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,kjcb,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                   <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,kjcb,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                   <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadb,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadb,kjcb,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                   <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabc,jkdc,kb-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdab,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdab,kjcb,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                   <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbac,jkcb,kd-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbca,kc,jkdb-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbc,jkac,kb-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbdc,jkcb,ka-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbcd,kc,jkab-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labc,IiDc,ib-&gt;IDla&#39;</span><span class="p">,</span>
                                                <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabc,IiDc,lb-&gt;IDla&#39;</span><span class="p">,</span>
                                             <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                             <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                          <span class="p">:,</span>
                                                          <span class="p">:],</span>
                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbca,ic,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                                <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibca,lc,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                             <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                             <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                          <span class="p">:,</span>
                                                          <span class="p">:],</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">del</span> <span class="n">v_ceee_bbbb</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v_ceee_bbbb</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVVV</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,lbda-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ladb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lb,ibad-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lb,idab-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbad-&gt;da&#39;</span><span class="p">,</span>
                                               <span class="n">t2_ce_bb</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jadb-&gt;da&#39;</span><span class="p">,</span>
                                               <span class="n">t2_ce_bb</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbda-&gt;da&#39;</span><span class="p">,</span>
                                               <span class="n">t2_ce_bb</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jdab-&gt;da&#39;</span><span class="p">,</span>
                                               <span class="n">t2_ce_bb</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibad,ljbc,jc-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibad,jlcb,jc-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,ljbc,ic-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbda,ijbc,jc-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbda,jicb,jc-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,ijbc,lc-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ladb,ijbc,jc-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ladb,jicb,jc-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labc,ijdc,jb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadb,ijbc,lc-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabc,ijdc,lb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idab,ljbc,jc-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idab,jlcb,jc-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibac,ljcb,jd-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdab,ljbc,ic-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbca,jc,ijdb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbca,lc,ijdb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbc,ljac,jb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbc,ljac,ib-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbdc,ijcb,ja-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcd,jc,ljab-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbcd,ic,ljab-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibce,ljbe,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbce,ijbe,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbce,ijbe,lc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbce,ic,ljeb-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,kjcb,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,kjcb,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadb,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadb,kjcb,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabc,jkdc,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdab,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdab,kjcb,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbac,jkcb,kd-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbca,kc,jkdb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbc,jkac,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbdc,jkcb,ka-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbcd,kc,jkab-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labc,IiDc,ib-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabc,IiDc,lb-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbca,ic,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibca,lc,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">v_ceee_bbbb</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVvv</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_b</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>

                <span class="n">v_ceee_bbaa</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LOV</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
                <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaAD-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                          <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_a</span><span class="p">,</span>
                         <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaDA-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">t2_ce_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="p">:],</span>
                                          <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_aabb</span><span class="p">[:,</span>
                           <span class="p">:,</span>
                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                           <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ib,laDb-&gt;IDla&#39;</span><span class="p">,</span>
                                            <span class="n">t2_ce_aa</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                    <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,Liba,Ib-&gt;IDLA&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,Iiba,Lb-&gt;IDLA&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabA,Lb,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                        <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabD,Ib,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                        <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="n">vir_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabc,Ib,Lica-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                    <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                    <span class="p">:,</span>
                                                                    <span class="p">:],</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="n">vir_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabc,Iica,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                    <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                    <span class="p">:,</span>
                                                                    <span class="p">:],</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,jiba,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                   <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,jiba,jb-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                   <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAb,jiba,jD-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                   <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabA,jb,jiDa-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDb,jiba,jA-&gt;DA&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                   <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabD,jb,jiAa-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labc,jicd,jb-&gt;idla&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbc,jlca,jb-&gt;idla&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="n">vir_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibce,jleb,jc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="n">vir_list_b</span><span class="p">,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbce,jieb,jc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabc,kjcd,kb-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbc,kjca,kb-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;laDb,Iibc,ic-&gt;IDla&#39;</span><span class="p">,</span>
                                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;laDb,Iibc,ic-&gt;IDla&#39;</span><span class="p">,</span>
                                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbDc,Iicb,ia-&gt;IDla&#39;</span><span class="p">,</span>
                                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDb,Iibc,lc-&gt;IDla&#39;</span><span class="p">,</span>
                                                     <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                     <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                                  <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                  <span class="p">:,</span>
                                                                  <span class="p">:],</span>
                                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcD,Ic,liab-&gt;IDla&#39;</span><span class="p">,</span>
                                             <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                             <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                          <span class="p">:,</span>
                                                          <span class="p">:],</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labc,IiDc,ib-&gt;IDla&#39;</span><span class="p">,</span>
                                                <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">v_ceee_bbaa</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v_ceee_bbaa</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVvv</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>

            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaAD-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">t2_ce_bb</span><span class="p">,</span>
                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaDA-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">t2_ce_bb</span><span class="p">,</span>
                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,Liba,Ib-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,Iiba,Lb-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabA,Lb,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabD,Ib,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabc,Ib,Lica-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabc,Iica,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAD,jiba,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,ijab,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDA,jiba,jb-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaAb,jiba,jD-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabA,jb,jiDa-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDb,jiba,jA-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabD,jb,jiAa-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labc,jicd,jb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbc,jlca,jb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibce,jleb,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbce,jieb,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabc,kjcd,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbc,kjca,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ib,laDb-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">t2_ce_aa</span><span class="p">,</span>
                                     <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;laDb,Iibc,ic-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;laDb,Iibc,ic-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbDc,Iicb,ia-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaDb,Iibc,lc-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceee_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcD,Ic,liab-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labc,IiDc,ib-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">v_ceee_bbaa</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovVV</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>

                <span class="n">v_ceee_aabb</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
                <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbad-&gt;da&#39;</span><span class="p">,</span>
                                                   <span class="n">t2_ce_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                            <span class="p">:],</span>
                                                   <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                         <span class="p">:,</span>
                         <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbda-&gt;da&#39;</span><span class="p">,</span>
                                                   <span class="n">t2_ce_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                            <span class="p">:],</span>
                                                   <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_030_aabb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                           <span class="p">:,</span>
                           <span class="p">:,</span>
                           <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lb,IDab-&gt;IDla&#39;</span><span class="p">,</span>
                                            <span class="n">t2_ce_bb</span><span class="p">,</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="p">:,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAab,IiDb,ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="p">:,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDab,LiAb,ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="n">vir_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabc,Liac,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[:,</span>
                             <span class="n">vir_list_a</span><span class="p">,</span>
                             <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                             <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labc,Iiac,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAab,ijDb,ja-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_a</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDab,ijAb,ja-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,jlbc,ic-&gt;idla&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,jibc,lc-&gt;idla&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:,</span>
                                                                <span class="p">:],</span>
                                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbca,lc,jibd-&gt;idla&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbcd,ic,jlba-&gt;idla&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:,</span>
                                                        <span class="p">:],</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="n">vir_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbce,ic,jlbe-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                    <span class="p">:,</span>
                                                                    <span class="p">:,</span>
                                                                    <span class="p">:],</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[:,</span>
                             <span class="n">vir_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbce,lc,jibe-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                    <span class="p">:,</span>
                                                                    <span class="p">:,</span>
                                                                    <span class="p">:],</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbac,jkbc,kd-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbca,kc,jkbd-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbdc,jkbc,ka-&gt;da&#39;</span><span class="p">,</span>
                                                      <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:,</span>
                                                                   <span class="p">:],</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:,</span>
                             <span class="n">occ_list_b</span><span class="p">,</span>
                             <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbcd,kc,jkba-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:,</span>
                                                           <span class="p">:],</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:,</span>
                               <span class="p">:,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDab,libc,ic-&gt;IDla&#39;</span><span class="p">,</span>
                                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:,</span>
                               <span class="p">:,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDab,ilcb,ic-&gt;IDla&#39;</span><span class="p">,</span>
                                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:,</span>
                               <span class="p">:,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDbc,liac,ib-&gt;IDla&#39;</span><span class="p">,</span>
                                                <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDab,ilcb,Ic-&gt;IDla&#39;</span><span class="p">,</span>
                                                     <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                     <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                                  <span class="p">:,</span>
                                                                  <span class="p">:,</span>
                                                                  <span class="p">:],</span>
                                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:,</span>
                               <span class="p">:,</span>
                               <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ibac,ilbc,iD-&gt;IDla&#39;</span><span class="p">,</span>
                                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibca,lc,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                             <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                             <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                                          <span class="p">:,</span>
                                                          <span class="p">:],</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">del</span> <span class="n">v_ceee_aabb</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v_ceee_aabb</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovVV</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAab,IiDb,ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDab,LiAb,ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabc,Liac,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labc,Iiac,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAab,ijDb,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDab,ijAb,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbad-&gt;da&#39;</span><span class="p">,</span>
                                               <span class="n">t2_ce_aa</span><span class="p">,</span>
                                               <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbda-&gt;da&#39;</span><span class="p">,</span>
                                               <span class="n">t2_ce_aa</span><span class="p">,</span>
                                               <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,jlbc,ic-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_aabb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,jibc,lc-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceee_aabb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbca,lc,jibd-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbcd,ic,jlba-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbce,ic,jlbe-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbce,lc,jibe-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbad,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbda,jkbc,kc-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbac,jkbc,kd-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbca,kc,jkbd-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbdc,jkbc,ka-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbcd,kc,jkba-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lb,IDab-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">t2_ce_bb</span><span class="p">,</span>
                                     <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDab,libc,ic-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceee_aabb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDab,ilcb,ic-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceee_aabb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDbc,liac,ib-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDab,ilcb,Ic-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceee_aabb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ibac,ilbc,iD-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceee_aabb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibca,lc,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,IDiL-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">t2_ce_aa</span><span class="p">,</span>
                               <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,iDIL-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">t2_ce_aa</span><span class="p">,</span>
                               <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,LAiI-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">t2_ce_aa</span><span class="p">,</span>
                               <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,iALI-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">t2_ce_aa</span><span class="p">,</span>
                               <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,LAai-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,iAaL-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,LAai-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">v_ceec_aabb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LiAa,IDai-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LiAa,iDaI-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LiAa,IDai-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">v_ceec_aabb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_a</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">e_core_a</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">e_core_a</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">e_extern_a</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">e_extern_a</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">e_core_b</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">e_core_b</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,IiDa,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">e_extern_b</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,LiAa,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">e_extern_b</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,iD-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">h_ce_aa</span><span class="p">,</span>
                                  <span class="n">t2_ce_aa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,iA-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">h_ce_aa</span><span class="p">,</span>
                                  <span class="n">t2_ce_aa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,La-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">h_ce_aa</span><span class="p">,</span>
                                           <span class="n">t2_ce_aa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,Ia-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">h_ce_aa</span><span class="p">,</span>
                                           <span class="n">t2_ce_aa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,Labi-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,Labi-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Liab,Iabi-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Liab,Iabi-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaIL-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_aa</span><span class="p">,</span>
                                           <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,LaiI-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_aa</span><span class="p">,</span>
                                           <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaLI-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_aa</span><span class="p">,</span>
                                           <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IaiL-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_aa</span><span class="p">,</span>
                                           <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaIL-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_bb</span><span class="p">,</span>
                                           <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iaLI-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_bb</span><span class="p">,</span>
                                           <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,iDaj-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,iAaj-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,iDaj-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,iAaj-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiAD,ijab,Ljab-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiAD,ijab,Ljab-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iLAD,ijab,Ijab-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iLAD,ijab,Ijab-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAD,Liab,Ijab-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAD,Liab,Ijab-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAaI,ijab,ijDb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAaI,ijab,ijDb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LADi,ijab,Ijab-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LADi,ijab,Ijab-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAai,ijab,IjDb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAai,ijab,IjDb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAai,ijab,IjDb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAai,jiba,IjDb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADI,ijab,Ljab-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADI,ijab,Ljab-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaI,ijDb,Ljab-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaI,ijDb,Ljab-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADj,Iiab,Ljab-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaj,IiDb,Ljab-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaj,IiDb,Ljba-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILAa,ijab,ijDb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILAa,ijab,ijDb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiAa,Ljab,ijDb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiAa,Ljab,ijDb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iLAa,ijab,IjDb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iLAa,ijab,IjDb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,Liab,IjDb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,Liab,IjDb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDaL,ijab,ijAb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDaL,ijab,ijAb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDai,ijab,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDai,ijab,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDai,ijab,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDai,jiba,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaL,ijAb,Ijab-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaL,ijAb,Ijab-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,LiAb,Ijab-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,LiAb,Ijba-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LIDa,ijab,ijAb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LIDa,ijab,ijAb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LiDa,Ijab,ijAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LiDa,Ijab,ijAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iIDa,ijab,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iIDa,ijab,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,Iiab,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,Iiab,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILij,ikAa,jkDa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILij,ikAa,jkDa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILij,kiAa,kjDa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IijL,ikDa,jkAa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IijL,ikDa,jkAa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iijk,ikDa,LjAa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijDa,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iijk,ikDa,LjAa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijDa,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabi,LjAa,ijDb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabi,LjAa,jiDb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Lijk,ikAa,IjDa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Liab,ijAa,IjDb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Lijk,ikAa,IjDa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Liab,ijAa,IjDb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labi,IjDa,ijAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labi,IjDa,jiAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,IiDb,LjAa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,IiDa,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,IiDa,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,IiDb,LjAa-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,IiDa,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,IiDa,LjAb-&gt;IDLA&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_a</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_a</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_a</span><span class="p">,</span>
                                          <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                          <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_a</span><span class="p">,</span>
                                          <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                          <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_a</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_a</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_a</span><span class="p">,</span>
                                          <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                          <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_a</span><span class="p">,</span>
                                          <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                          <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_a</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_a</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,Liab,Iiab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_a</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,Liab,Iiab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_a</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_a</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_a</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,Liab,Iiab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_a</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,Liab,Iiab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_a</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_a</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,Liab,Iiab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_a</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_a</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_a</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_a</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_a</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_a</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_a</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,Liab,Iiab-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_a</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,Liab,Iiab-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_a</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_a</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_a</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,Iiab,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">e_core_b</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,Liab,Iiab-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">e_core_b</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,jiAa,jiDa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_b</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,jiDa,jiAa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_b</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,Iiba,Liba-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_b</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,Liba,Iiba-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_b</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ijAa,ijDa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">e_extern_b</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ijDa,ijAa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">e_extern_b</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILij,ikab,jkab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILij,ikab,jkab-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILab,ijac,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILab,ijac,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILij,ikab,jkab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILij,kiab,kjab-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILab,ijca,ijcb-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILab,ijac,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IijL,ikab,jkab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IijL,ikab,jkab-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iijk,ikab,Ljab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijac,Ljbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijac,Ljbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iijk,ikab,Ljab-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijca,Ljcb-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IabL,ijac,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IabL,ijac,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabi,Ljac,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabi,Ljac,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabi,Ljac,jicb-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabi,Ljac,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Lijk,ikab,Ijab-&gt;IL&#39;</span><span class="p">,</span>
                                                   <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Liab,ijac,Ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Liab,ijac,Ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Lijk,ikab,Ijab-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Liab,ijca,Ijcb-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labi,Ijac,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labi,Ijac,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labi,Ijac,jicb-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labi,Ijac,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,Iibc,Ljac-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,Iiac,Ljbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,Iiac,Ljcb-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,Iibc,Ljac-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,Iicb,Ljca-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,Iica,Ljbc-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[:,</span>
                 <span class="n">vir_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,Iica,Ljcb-&gt;IL&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAD,ikab,jkab-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAD,ikab,jkab-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAD,ikab,jkab-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAD,kiab,kjab-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADj,ikab,jkab-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADj,ikab,jkab-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaj,ikDb,jkab-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaj,ikDb,jkab-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaj,ikDb,kjba-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaj,ikDb,jkab-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,ikab,jkDb-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,ikab,jkDb-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,kiab,kjDb-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,ikAb,jkab-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,ikAb,jkab-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,ikAb,kjba-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,ikAb,jkab-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ikab,jkAb-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ikab,jkAb-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,kiab,kjAb-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijkl,ikAa,jlDa-&gt;DA&#39;</span><span class="p">,</span>
                                          <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ikAb,jkDa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijkl,ikAa,jlDa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ikAb,jkDa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,ikAa,jkDb-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,ikAa,kjDb-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,ikDa,kjAb-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,kiAb,kjDa-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_a</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,kiAa,kjDb-&gt;DA&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,IiDa,La-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">h_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,LiAa,Ia-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">h_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,LiAa,iD-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">h_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,IiDa,iA-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">h_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiAD,ia,La-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iLAD,ia,Ia-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAiI,ijDa,ja-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAiI,ijDa,ja-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAaI,ia,iD-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceec_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LADi,ia,Ia-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceec_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAij,ja,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAai,Ia,iD-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LAij,ja,IiDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADI,ia,La-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceec_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iALI,ijDa,ja-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iALI,ijDa,ja-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jAiI,jiDa,La-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaI,iD,La-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jALi,IjDa,ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaL,iD,Ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILAa,ia,iD-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiAa,La,iD-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDiL,ijAa,ja-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDiL,ijAa,ja-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDaL,ia,iA-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ceec_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDij,ja,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDai,La,iA-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDij,ja,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDIL,ijAa,ja-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDIL,ijAa,ja-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jDiL,jiAa,Ia-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaL,iA,Ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jDIi,LjAa,ia-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaI,iA,La-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LIDa,ia,iA-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LiDa,Ia,iA-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILij,iA,jD-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaIL,ijAa,jD-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaLI,ijDa,jA-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaIL,jiAa,jD-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaLI,jiDa,jA-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IijL,iD,jA-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaIi,iD,LjAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LaiI,ijDa,jA-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaIi,iD,LjAa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IaiL,ijAa,jD-&gt;IDLA&#39;</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iaij,LiAa,jD-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaLi,iA,IjDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaLi,iA,IjDa-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Laij,IiDa,jA-&gt;IDLA&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,iA,iD-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">e_extern_a</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t2_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,iD,iA-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">e_extern_a</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t2_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,iA,iD-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">e_extern_a</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t2_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,iD,iA-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">e_extern_a</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t2_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,Ia,La-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">e_core_a</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,La,Ia-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">e_core_a</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,Ia,La-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">e_core_a</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,La,Ia-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">e_core_a</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,iA,iD-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">e_core_a</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t2_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,iD,iA-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">e_core_a</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t2_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,Ia,La-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">e_extern_a</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t2_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,La,Ia-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">e_extern_a</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t2_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;A,iA,IiDa,La-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_extern_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;A,iD,Ia,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_extern_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;D,iA,IiDa,La-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_extern_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;D,iD,Ia,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_extern_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;I,iA,IiDa,La-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_core_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;I,iD,Ia,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_core_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;L,iA,IiDa,La-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_core_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;L,iD,Ia,LiAa-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_core_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;i,iD,LiAa,Ia-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_core_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;i,IiDa,iA,La-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_core_a</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;a,La,IiDa,iA-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_extern_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;a,LiAa,Ia,iD-&gt;IDLA&#39;</span><span class="p">,</span>
                <span class="n">e_extern_a</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,ijDa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,ijDa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,ijAa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,ijAa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Liab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Liab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,Iiab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,Iiab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Iiab,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liab,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAa,jD-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijDa,jA-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Iiba,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liba,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiAa,jD-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiDa,jA-&gt;DA&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILij,ia,ja-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaIL,ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaIL,ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaLI,ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaLI,ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILab,ia,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILij,ia,ja-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaIL,ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaIL,jiba,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaLI,ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iaLI,jiba,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILab,ia,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IijL,ia,ja-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaIi,ib,Ljab-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LaiI,ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;LaiI,ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaiI,ijab,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ia,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaIi,ib,Ljba-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaiI,ijba,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IaiL,ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IaiL,ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iaij,Liab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabi,La,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabi,ia,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IabL,ia,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabi,La,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iaij,Liab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabi,La,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iabi,La,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaLi,ib,Ijab-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaiL,ijab,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Liab,ia,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaLi,ib,Ijba-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaiL,ijba,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Laij,Iiab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labi,Ia,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labi,ia,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labi,Ia,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Laij,Iiab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labi,Ia,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Labi,Ia,ib-&gt;IL&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAD,ia,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAD,ia,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iADj,ia,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kAij,kiDa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaj,iD,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaj,iD,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaj,ia,jD-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kAij,kiDa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaj,iD,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iAaj,iD,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAa,ia,jD-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kDij,kiAa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,iA,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,iA,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,ia,jA-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kDij,kiAa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,iA,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,iA,ja-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ia,jA-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kaij,jA,ikDa-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kaij,jD,ikAa-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kaij,jA,ikDa-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kaij,jD,ikAa-&gt;DA&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,iA,ijDa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,iA,ijDa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,iD,ijAa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;A,iD,ijAa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,iA,ijDa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,iA,ijDa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,iD,ijAa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,iD,ijAa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,Iiab,La,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,Ia,Liab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,Ia,Liab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,Iiab,La,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,Iiab,La,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,Ia,Liab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,Ia,Liab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;L,Iiab,La,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,Iiab,ia,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,Liab,ia,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ia,Iiab,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ia,Liab,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,iD,ijAa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,iD,ijAa,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijAa,ia,jD-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijDa,iA,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijDa,ia,jA-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ia,ijAa,jD-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ia,ijDa,jA-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijDa,iA,ja-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,La,Iiab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,La,Iiab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,Liab,Ia,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,Liab,ia,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,Liab,Ia,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ia,Iiab,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ia,ijDa,jA-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ijAa,ia,jD-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,Iiab,ib,La-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,Liab,ib,Ia-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ia,Iiba,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ia,Liba,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ia,jiAa,jD-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ia,jiDa,jA-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,jiAa,ia,jD-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,jiDa,ia,jA-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,Liba,ia,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_b</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[:,</span>
                     <span class="n">vir_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ia,Iiba,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ia,jiDa,jA-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aa</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_a</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ijAa,ja,iD-&gt;DA&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

<span class="c1">##########################################################################</span>

        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,idjl-&gt;idla&#39;</span><span class="p">,</span> <span class="n">t2_ce_bb</span><span class="p">,</span>
                               <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jdil-&gt;idla&#39;</span><span class="p">,</span> <span class="n">t2_ce_bb</span><span class="p">,</span>
                               <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jd,laji-&gt;idla&#39;</span><span class="p">,</span> <span class="n">t2_ce_bb</span><span class="p">,</span>
                               <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jd,jali-&gt;idla&#39;</span><span class="p">,</span> <span class="n">t2_ce_bb</span><span class="p">,</span>
                               <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijdb,labj-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijdb,jabl-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljab,idbj-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljab,jdbi-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jibd,labj-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jlba,idbj-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ijdb,ljab-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ljab,ijdb-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,jibd,jlba-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,jlba,jibd-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,ijdb,ljab-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,ljab,ijdb-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,jibd,jlba-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,jlba,jibd-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_extern_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijdb,ljab-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ljab,ijdb-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,jibd,jlba-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,jlba,jibd-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,ijdb,ljab-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,ljab,ijdb-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,jibd,jlba-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,jlba,jibd-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">e_core_b</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jibd,jlba-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">e_core_a</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jlba,jibd-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">e_core_a</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jibd,jlba-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">e_extern_a</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jlba,jibd-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">e_extern_a</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t2_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,ijdb,ljab-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">e_core_b</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,ljab,ijdb-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">e_core_b</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,ijdb,ljab-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">e_extern_b</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,ljab,ijdb-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">e_extern_b</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jd-&gt;da&#39;</span><span class="p">,</span>
                                           <span class="n">h_ce_bb</span><span class="p">,</span>
                                           <span class="n">t2_ce_bb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jd,ja-&gt;da&#39;</span><span class="p">,</span>
                                           <span class="n">h_ce_bb</span><span class="p">,</span>
                                           <span class="n">t2_ce_bb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,lb-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">h_ce_bb</span><span class="p">,</span>
                                           <span class="n">t2_ce_bb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lb,ib-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">h_ce_bb</span><span class="p">,</span>
                                           <span class="n">t2_ce_bb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijbc,lbcj-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljbc,ibcj-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jibc,lcbj-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jlbc,icbj-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbil-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_aa</span><span class="p">,</span>
                                           <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbli-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_aa</span><span class="p">,</span>
                                           <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbil-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_bb</span><span class="p">,</span>
                                           <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,lbji-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_bb</span><span class="p">,</span>
                                           <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jbli-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_bb</span><span class="p">,</span>
                                           <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,ibjl-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ce_bb</span><span class="p">,</span>
                                           <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkba,kdbj-&gt;da&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkbd,kabj-&gt;da&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jdbk-&gt;da&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkdb,jabk-&gt;da&#39;</span><span class="p">,</span>
                                           <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijad,jkbc,lkbc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijad,kjbc,klbc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,jlbc,kibc-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jlad,jkbc,ikbc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jlad,kjbc,kibc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,ljbc,ikbc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labi,jkcb,jkcd-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labi,jkbc,jkdc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labj,jkbc,kicd-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labj,jkbc,ikdc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ladj,jkbc,ikbc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ladj,kjbc,kibc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labj,jkbc,ikdc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labj,kjcb,kicd-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadi,jkbc,lkbc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadi,kjbc,klbc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabi,jkdc,lkbc-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabi,kjcd,klcb-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabk,ijdc,klbc-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadk,ijbc,lkbc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabk,ijdc,lkbc-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilab,jkcb,jkcd-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilab,jkbc,jkdc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,lkbc,jkdc-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,klcb,kjcd-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jlcb,kicd-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jlab,jkbc,ikdc-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jlab,kjcb,kicd-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,ljbc,ikdc-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbl,jkcb,jkca-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbl,jkbc,jkac-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbj,jkbc,klca-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbj,jkbc,lkac-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbj,jkbc,lkac-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbj,kjcb,klca-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbl,jkac,ikbc-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbl,kjca,kicb-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbk,ljac,kibc-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbk,ljac,ikbc-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lidb,jkcb,jkca-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lidb,jkbc,jkac-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljdb,ikbc,jkac-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljdb,kicb,kjca-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkdb,jicb,klca-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jidb,jkbc,lkac-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jidb,kjcb,klca-&gt;idla&#39;</span><span class="p">,</span>
                                       <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkdb,ijbc,lkac-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iljk,jmab,kmdb-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iljk,mjba,mkbd-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kmij,mjbd,klba-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijbc,kjbd,klca-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijkl,jmdb,kmab-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijkl,mjbd,mkba-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijkm,jmdb,lkab-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijbc,jkdb,lkac-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,lkab,jkcd-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,lkab,jkdc-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kmlj,mjba,kibd-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_aabb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljbc,kjba,kicd-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljkm,jmab,ikdb-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljbc,jkab,ikdc-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbcj,ikdb,jkca-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbcj,ikdb,jkac-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkbc,jicd,klba-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,jibd,klca-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkbc,ijdc,lkab-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,ijdb,klca-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,ljab,kicd-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,ijdb,lkac-&gt;idla&#39;</span><span class="p">,</span>
                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,jkba,jkbd-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_b</span><span class="p">,</span>
                                          <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                          <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,jkbd,jkba-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_b</span><span class="p">,</span>
                                          <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                          <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,jkab,jkdb-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_b</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,jkdb,jkab-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_b</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,jkba,jkbd-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_b</span><span class="p">,</span>
                                          <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                          <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,jkbd,jkba-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_b</span><span class="p">,</span>
                                          <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                          <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,jkab,jkdb-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_b</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,jkdb,jkab-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_b</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijbc,ljbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_b</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ljbc,ijbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_b</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,jibc,jlbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_b</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,jlbc,jibc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_b</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,ijbc,ljbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_b</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,ljbc,ijbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_b</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,jibc,jlbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_b</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,jlbc,jibc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_b</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jibc,jlbc-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">e_core_a</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jlbc,jibc-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">e_core_a</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jkba,jkbd-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_a</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jkbd,jkba-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_a</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jibc,jlbc-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_a</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jlbc,jibc-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_a</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jkba,jkbd-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">e_extern_a</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jkbd,jkba-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">e_extern_a</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,ijbc,ljbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_b</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,ljbc,ijbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">e_core_b</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jkab,jkdb-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_b</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jkdb,jkab-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_b</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,kjba,kjbd-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_b</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,kjbd,kjba-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">e_core_b</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,ijbc,ljbc-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_b</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,ljbc,ijbc-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_b</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jicb,jlcb-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_b</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jlcb,jicb-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">e_extern_b</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jkab,jkdb-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_b</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jkdb,jkab-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">e_extern_b</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkil,jmbc,kmbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkil,jmbc,kmbc-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilbc,jkbe,jkce-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilbc,jkbe,jkce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iljk,jmbc,kmbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iljk,mjbc,mkbc-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilbc,jkeb,jkec-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilbc,jkbe,jkce-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kmij,mjbc,klbc-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijbc,kjbe,klce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijkl,jmbc,kmbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijkl,mjbc,mkbc-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijkm,jmbc,lkbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijbc,jkbe,lkce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijbc,kjeb,klec-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,lkbe,jkce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,kleb,jkce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcl,jkeb,jkec-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcl,jkbe,jkce-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,lkbe,jkce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,kleb,kjec-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kmlj,mjbc,kibc-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljbc,kjbe,kice-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljkm,jmbc,ikbc-&gt;il&#39;</span><span class="p">,</span>
                                                   <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljbc,jkbe,ikce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljbc,kjeb,kiec-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbcj,ikbe,jkce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbcj,kieb,jkce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbcj,ikbe,jkce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbcj,kieb,kjec-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkbc,jice,klbe-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkbc,jiec,kleb-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,jibe,klce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkbc,ijce,lkbe-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,ijbe,klce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,ljbe,kice-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[:,</span>
                 <span class="n">vir_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,ijbe,lkce-&gt;il&#39;</span><span class="p">,</span>
                                           <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                           <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,jmbc,kmbc-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,jmbc,kmbc-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,jmbc,kmbc-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,mjbc,mkbc-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabk,jmdc,kmbc-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabk,mjcd,kmbc-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadk,jmbc,kmbc-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadk,mjbc,mkbc-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabk,jmdc,kmbc-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabk,mjcd,mkcb-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jmcb,kmcd-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jmbc,kmdc-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,mjcb,mkcd-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbk,jmac,kmbc-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbk,mjca,kmbc-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbk,jmac,kmbc-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbk,mjca,mkcb-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkdb,jmcb,kmca-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkdb,jmbc,kmac-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkdb,mjcb,mkca-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkbc,jmca,kmbd-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkmn,jmba,knbd-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,jmba,kmcd-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkbc,mjca,mkbd-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkmn,jmab,kndb-&gt;da&#39;</span><span class="p">,</span>
                                          <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                          <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkbc,jmac,kmdb-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,jmab,kmcd-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,jmdb,kmca-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:,</span>
                 <span class="n">occ_list_b</span><span class="p">,</span>
                 <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbck,jmab,kmdc-&gt;da&#39;</span><span class="p">,</span>
                                  <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ijdb,lb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">h_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jd,ljab,ib-&gt;idla&#39;</span><span class="p">,</span> <span class="n">h_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ljab,jd-&gt;idla&#39;</span><span class="p">,</span> <span class="n">h_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lb,ijdb,ja-&gt;idla&#39;</span><span class="p">,</span> <span class="n">h_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijad,jb,lb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jlad,jb,ib-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;laji,jkdb,kb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;laji,kjbd,kb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labi,jb,jd-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceec_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lajk,kb,jibd-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ladj,jb,ib-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceec_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lajk,kb,ijdb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labj,ib,jd-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadi,jb,lb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceec_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jali,jkdb,kb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jali,kjbd,kb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kaji,kjdb,lb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabi,jd,lb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kalj,ikdb,jb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabl,jd,ib-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilab,jb,jd-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,lb,jd-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idjl,jkab,kb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idjl,kjba,kb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbl,jb,ja-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ceec_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idjk,kb,jlba-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idjk,kb,ljab-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;idbj,lb,ja-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdil,jkab,kb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdil,kjba,kb-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kdjl,kjab,ib-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbl,ja,ib-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kdij,lkab,jb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbi,ja,lb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lidb,jb,ja-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljdb,ib,ja-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbil,jkba,kd-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_aabb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbli,jkbd,ka-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_aabb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iljk,ja,kd-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbil,jkab,kd-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbli,jkdb,ka-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kbij,jd,klba-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijkl,jd,ka-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kbij,jd,lkab-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbji,jkdb,ka-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibjl,jkab,kd-&gt;idla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibjk,ljab,kd-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kblj,ja,kibd-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kblj,ja,ikdb-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbjk,ijdb,ka-&gt;idla&#39;</span><span class="p">,</span>
                                   <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ja,jd-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">e_extern_b</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t2_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,jd,ja-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">e_extern_b</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t2_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,ja,jd-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">e_extern_b</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t2_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,jd,ja-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">e_extern_b</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t2_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ib,lb-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">e_core_b</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,lb,ib-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">e_core_b</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,ib,lb-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">e_core_b</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,lb,ib-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">e_core_b</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,ja,jd-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">e_core_b</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t2_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jd,ja-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">e_core_b</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t2_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,ib,lb-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">e_extern_b</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t2_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,lb,ib-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">e_extern_b</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t2_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;a,ja,ijdb,lb-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_b</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;a,jd,ib,ljab-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_b</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;d,ja,ijdb,lb-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_b</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;d,jd,ib,ljab-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_b</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;i,ja,ijdb,lb-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_core_b</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;i,jd,ib,ljab-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_core_b</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;l,ja,ijdb,lb-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_core_b</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;l,jd,ib,ljab-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_core_b</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;j,jd,ljab,ib-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_core_b</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;j,ijdb,ja,lb-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_core_b</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;b,lb,ijdb,ja-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_b</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;b,ljab,ib,jd-&gt;idla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_b</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jkdb,kb-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kjbd,kb-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jd,jkab,kb-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jd,kjba,kb-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ljbc,jc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jlcb,jc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lb,ijbc,jc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lb,jicb,jc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jibc,lc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jlbc,ic-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jkba,kd-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jkbd,ka-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,ijbc,lc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,ljbc,ic-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">h_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jkab,kd-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,jkdb,ka-&gt;da&#39;</span><span class="p">,</span>
                                              <span class="n">h_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkil,jb,kb-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbil,jkbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbil,jkbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbli,jkbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbli,jkbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilbc,jb,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iljk,jb,kb-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbil,jkbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbil,kjcb,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbli,jkbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbli,kjcb,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilbc,jb,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kbij,jc,klbc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kbji,kjbc,lc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijkl,jb,kb-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kbij,jc,lkbc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbji,jkbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbji,kjcb,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kbji,jkbc,lc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijbc,jb,lc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibjk,jlcb,kc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,lb,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,lb,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibjl,jkbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibjl,kjcb,kc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibjk,ljbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,lb,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,jb,lc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcl,jb,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,lb,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kblj,jc,kibc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kbjl,kjbc,ic-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kblj,jc,ikbc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kbjl,jkbc,ic-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ljbc,jb,ic-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbjk,jicb,kc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbcj,ib,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbcj,ib,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbjk,ijbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbcj,ib,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbcj,jb,ic-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbcj,ib,jc-&gt;il&#39;</span><span class="p">,</span>
                                               <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,jb,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,jb,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;majk,jmbd,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabk,jd,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabk,jd,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jadk,jb,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;majk,mjdb,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabk,jd,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabk,jd,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jabk,jb,kd-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jb,kd-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mdjk,jmba,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbk,ja,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbk,ja,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mdjk,mjab,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbk,ja,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbk,ja,kb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jdbk,jb,ka-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkdb,jb,ka-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mbjk,ka,mjbd-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mbjk,kd,mjba-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mbjk,ka,jmdb-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mbjk,kd,jmab-&gt;da&#39;</span><span class="p">,</span>
                                      <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ja,jkdb,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ja,kjbd,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,jd,jkab,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,jd,kjba,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,ja,jkdb,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,ja,kjbd,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,jd,jkab,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;d,jd,kjba,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijbc,lb,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ib,ljbc,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ib,jlcb,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,lb,jicb,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,ijbc,lb,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,ib,ljbc,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,ib,jlcb,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,lb,jicb,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jibc,jb,lc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jlbc,jb,ic-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jb,jibc,lc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jb,jlbc,ic-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jb,jkba,kd-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jb,jkbd,ka-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jkba,jb,kd-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jkbd,jb,ka-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_a</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jb,jibc,lc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_a</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jlbc,jb,ic-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_a</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jb,jkbd,ka-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jkba,jb,kd-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,ijbc,jb,lc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,ljbc,jb,ic-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jb,ijbc,lc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jb,ljbc,ic-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_core_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jd,jkab,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jd,kjba,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jkab,jb,kd-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jkdb,ja,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jkdb,jb,ka-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jb,jkab,kd-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,jb,jkdb,ka-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;j,kjbd,ja,kb-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_core_b</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,lb,ijbc,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,lb,jicb,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,ljbc,ib,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_b</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,ljbc,jb,ic-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_b</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jb,ijbc,lc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_b</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[:,</span>
                     <span class="n">vir_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">vir_list_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jlcb,ib,jc-&gt;il&#39;</span><span class="p">,</span>
                                                             <span class="n">e_extern_b</span><span class="p">,</span>
                                                             <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                             <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jb,jkdb,ka-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_bb</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:,</span>
                     <span class="n">occ_list_b</span><span class="p">,</span>
                     <span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,jkab,jb,kd-&gt;da&#39;</span><span class="p">,</span>
                                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,laiI-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">v_cecc_bbaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDb,labi-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDb,labi-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                 <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDb,iabl-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                 <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IDil-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">v_cecc_aabb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;liab,IDbi-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilba,IDbi-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                 <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilba,iDbI-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                 <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,IiDb,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_extern_a</span><span class="p">,</span>
                                         <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                         <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,IiDb,liab-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_extern_a</span><span class="p">,</span>
                                         <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                         <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,liab,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_extern_a</span><span class="p">,</span>
                                         <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                         <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;D,ilba,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_extern_a</span><span class="p">,</span>
                                         <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                         <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,IiDb,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_core_a</span><span class="p">,</span>
                                         <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                         <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,IiDb,liab-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_core_a</span><span class="p">,</span>
                                         <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                         <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,liab,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_core_a</span><span class="p">,</span>
                                         <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                         <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;I,ilba,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_core_a</span><span class="p">,</span>
                                         <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                         <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,IiDb,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_extern_b</span><span class="p">,</span>
                                         <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                         <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,IiDb,liab-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_extern_b</span><span class="p">,</span>
                                         <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                         <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,liab,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_extern_b</span><span class="p">,</span>
                                         <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                         <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;a,ilba,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_extern_b</span><span class="p">,</span>
                                         <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                         <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,IiDb,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_core_b</span><span class="p">,</span>
                                         <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                         <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,IiDb,liab-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_core_b</span><span class="p">,</span>
                                         <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                         <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,liab,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_core_b</span><span class="p">,</span>
                                         <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                         <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;l,ilba,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                         <span class="n">e_core_b</span><span class="p">,</span>
                                         <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                         <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,IiDb,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">e_core_a</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ilba,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">e_core_a</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,IiDb,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">e_extern_a</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,ilba,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">e_extern_a</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,IiDb,liab-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">e_core_b</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,liab,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">e_core_b</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,IiDb,liab-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">e_extern_b</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;b,liab,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">e_extern_b</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;IDbl,ijcb,ijca-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aabb</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;IDbl,ijbc,ijac-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aabb</span><span class="p">,</span>
            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;IDbi,ijbc,jlca-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aaaa</span><span class="p">,</span>
            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;IDbi,ijbc,ljac-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aaaa</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;IDai,ijbc,ljbc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aabb</span><span class="p">,</span>
            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;IDai,jibc,jlbc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aabb</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;IDbi,ijbc,ljac-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aabb</span><span class="p">,</span>
            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;IDbi,jicb,jlca-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aabb</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;iDal,ijbc,Ijbc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aabb</span><span class="p">,</span>
            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;iDal,ijbc,Ijbc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aabb</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDbj,ilca,Ijbc-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDaj,ilbc,Ijbc-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;liDb,Ijbc,jica-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;liDb,Ijbc,ijac-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;iIDb,ijbc,jlca-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ccee_aaaa</span><span class="p">,</span>
            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;iIDb,ijbc,ljac-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ccee_aaaa</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDb,Iibc,jlca-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDb,Iibc,ljac-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijDc,jlcb-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijDc,ljbc-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iijk,ikDb,jlba-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iibc,ijDb,jlca-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iijl,ikDb,kjba-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iijl,ikDb,jkab-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iijk,ikDb,ljab-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iibc,ijDb,ljac-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;Ibal,ijbc,ijDc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aabb</span><span class="p">,</span>
            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;Ibal,ijbc,ijDc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_aabb</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ibai,jlbc,jiDc-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ibci,jlba,ijDc-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;labi,ijbc,IjDc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_bbaa</span><span class="p">,</span>
            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;labi,ijbc,IjDc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_bbaa</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;labi,ijbc,IjDc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_bbbb</span><span class="p">,</span>
            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;labi,jicb,IjDc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ceec_bbbb</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,IiDc,jlbc-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iabj,IiDc,ljbc-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ilcb,IjDc-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;ilab,ijbc,IjDc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ccee_bbbb</span><span class="p">,</span>
            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;ilab,jicb,IjDc-&gt;IDla&#39;</span><span class="p">,</span>
            <span class="n">v_ccee_bbbb</span><span class="p">,</span>
            <span class="n">t1_ccee_abab</span><span class="p">,</span>
            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,libc,IjDc-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkli,kiba,IjDb-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;libc,jiba,IjDc-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lijk,ikab,IjDb-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;libc,ijab,IjDc-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbci,IjDb,ijca-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbci,IjDb,ijac-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijbc,IiDc,jlba-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,IiDb,jlca-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,IiDb,ljac-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijbc,IiDc,ljab-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,IiDb,jlca-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcj,IiDb,ljac-&gt;IDla&#39;</span><span class="p">,</span>
                                 <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                 <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                 <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,ilba,Ib-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">h_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ib,ilba,iD-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">h_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IiDb,lb-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">h_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lb,IiDb,ia-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">h_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDil,ijab,jb-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_cecc_aabb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDil,jiba,jb-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_cecc_aabb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDbl,ib,ia-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceec_aabb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDij,jb,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDai,ib,lb-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceec_aabb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDij,jb,liab-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IDbi,lb,ia-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDal,ib,Ib-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceec_aabb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jDil,jiba,Ib-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_cecc_aabb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jDIi,jlba,ib-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;liDb,Ib,ia-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;laiI,ijDb,jb-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;laiI,ijDb,jb-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jaiI,ijDb,lb-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,iD,lb-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbIi,iD,jlba-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iijl,iD,ja-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbIi,iD,ljab-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbiI,ijDb,ja-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_cecc_bbaa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ibal,ib,iD-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_ceec_aabb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ibij,ilba,jD-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ibil,jiba,jD-&gt;IDla&#39;</span><span class="p">,</span> <span class="n">v_cecc_aabb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;laij,jb,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;labi,Ib,iD-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;laij,jb,IiDb-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jali,IjDb,ib-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbli,ia,IjDb-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jbli,ia,IjDb-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;lbij,IiDb,ja-&gt;IDla&#39;</span><span class="p">,</span>
                                     <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;D,iD,Ib,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;D,IiDb,ia,lb-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_a</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;I,iD,Ib,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_core_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;I,IiDb,ia,lb-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_core_a</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;a,iD,Ib,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_b</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;a,IiDb,ia,lb-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_b</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;l,iD,Ib,ilba-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_core_b</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;l,IiDb,ia,lb-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_core_b</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;i,iD,ilba,Ib-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_core_a</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;b,ilba,Ib,iD-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_a</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">t1_ce_aa</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;i,IiDb,ia,lb-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_core_b</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_030_aabb</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;b,lb,IiDb,ia-&gt;IDla&#39;</span><span class="p">,</span>
                <span class="n">e_extern_b</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">t1_ce_bb</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="n">M_ia_jb_a</span> <span class="o">+=</span> <span class="n">M_030_aa</span>
        <span class="n">M_ia_jb_b</span> <span class="o">+=</span> <span class="n">M_030_bb</span>
        <span class="n">M_aabb</span> <span class="o">+=</span> <span class="n">M_030_aabb</span>

    <span class="n">M_ia_jb_a</span> <span class="o">=</span> <span class="n">M_ia_jb_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_singles_a</span><span class="p">,</span> <span class="n">n_singles_a</span><span class="p">)</span>
    <span class="n">M_ia_jb_b</span> <span class="o">=</span> <span class="n">M_ia_jb_b</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_singles_b</span><span class="p">,</span> <span class="n">n_singles_b</span><span class="p">)</span>
    <span class="n">M_aabb</span> <span class="o">=</span> <span class="n">M_aabb</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_singles_a</span><span class="p">,</span> <span class="n">n_singles_b</span><span class="p">)</span>

    <span class="n">M_ia_jb</span> <span class="o">=</span> <span class="p">(</span><span class="n">M_ia_jb_a</span><span class="p">,</span> <span class="n">M_ia_jb_b</span><span class="p">,</span> <span class="n">M_aabb</span><span class="p">)</span>
    <span class="n">cput0</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">timer_debug1</span><span class="p">(</span><span class="s2">&quot;Completed M_ia_jb  ADC calculation&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">cput0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">M_ia_jb</span></div>



<div class="viewcode-block" id="get_diag">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.get_diag">[docs]</a>
<span class="k">def</span> <span class="nf">get_diag</span><span class="p">(</span><span class="n">adc</span><span class="p">,</span> <span class="n">M_ia_jb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eris</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;adc(2)&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(2)-x&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>


    <span class="n">nocc_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_a</span>
    <span class="n">nocc_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_b</span>
    <span class="n">nvir_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_a</span>
    <span class="n">nvir_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_b</span>

    <span class="n">ij_ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ij_ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ab_ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ab_ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_b</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">n_singles_a</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nvir_a</span>
    <span class="n">n_singles_b</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nvir_b</span>
    <span class="n">n_doubles_aaaa</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
    <span class="n">n_doubles_abab</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nvir_a</span> <span class="o">*</span> <span class="n">nvir_b</span>
    <span class="n">n_doubles_bbbb</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="n">n_singles_a</span> <span class="o">+</span> <span class="n">n_singles_b</span> <span class="o">+</span> <span class="n">n_doubles_aaaa</span> <span class="o">+</span> <span class="n">n_doubles_abab</span> <span class="o">+</span> <span class="n">n_doubles_bbbb</span>

    <span class="n">e_occ_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">]</span>
    <span class="n">e_occ_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">]</span>
    <span class="n">e_vir_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:]</span>
    <span class="n">e_vir_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:]</span>

    <span class="n">diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>

    <span class="n">s_a</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">f_a</span> <span class="o">=</span> <span class="n">n_singles_a</span>
    <span class="n">s_b</span> <span class="o">=</span> <span class="n">f_a</span>
    <span class="n">f_b</span> <span class="o">=</span> <span class="n">s_b</span> <span class="o">+</span> <span class="n">n_singles_b</span>
    <span class="n">s_aaaa</span> <span class="o">=</span> <span class="n">f_b</span>
    <span class="n">f_aaaa</span> <span class="o">=</span> <span class="n">s_aaaa</span> <span class="o">+</span> <span class="n">n_doubles_aaaa</span>
    <span class="n">s_abab</span> <span class="o">=</span> <span class="n">f_aaaa</span>
    <span class="n">f_abab</span> <span class="o">=</span> <span class="n">s_abab</span> <span class="o">+</span> <span class="n">n_doubles_abab</span>
    <span class="n">s_bbbb</span> <span class="o">=</span> <span class="n">f_abab</span>
    <span class="n">f_bbbb</span> <span class="o">=</span> <span class="n">s_bbbb</span> <span class="o">+</span> <span class="n">n_doubles_bbbb</span>

    <span class="k">if</span> <span class="n">eris</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">eris</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">transform_integrals</span><span class="p">()</span>

    <span class="n">d_ij_a</span> <span class="o">=</span> <span class="n">e_occ_a</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_occ_a</span>
    <span class="n">d_ij_b</span> <span class="o">=</span> <span class="n">e_occ_b</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_occ_b</span>
    <span class="n">d_ab_a</span> <span class="o">=</span> <span class="n">e_vir_a</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_vir_a</span>
    <span class="n">d_ab_b</span> <span class="o">=</span> <span class="n">e_vir_b</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_vir_b</span>

    <span class="n">D_ijab_a</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">d_ij_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">d_ab_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span>
                                                                      <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                                      <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">diag</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span> <span class="o">=</span> <span class="n">D_ijab_a</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">D_ijab_a</span>

    <span class="n">D_ijab_b</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">d_ij_b</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">d_ab_b</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span>
                                                                      <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                                      <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">diag</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span> <span class="o">=</span> <span class="n">D_ijab_b</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">D_ijab_b</span>

    <span class="n">d_ij_abab</span> <span class="o">=</span> <span class="n">e_occ_a</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_occ_b</span>
    <span class="n">d_ab_abab</span> <span class="o">=</span> <span class="n">e_vir_a</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_vir_b</span>
    <span class="n">diag</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_abab</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">d_ij_abab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">d_ab_abab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">M_ia_jb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">M_ia_jb</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">get_imds</span><span class="p">()</span>

    <span class="n">M_ia_jb_a</span><span class="p">,</span> <span class="n">M_ia_jb_b</span> <span class="o">=</span> <span class="n">M_ia_jb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">M_ia_jb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Compute precond</span>
    <span class="n">diag</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">M_ia_jb_a</span><span class="p">)</span>
    <span class="n">diag</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">M_ia_jb_b</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">diag</span></div>



<div class="viewcode-block" id="matvec">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.matvec">[docs]</a>
<span class="k">def</span> <span class="nf">matvec</span><span class="p">(</span><span class="n">adc</span><span class="p">,</span> <span class="n">M_ia_jb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eris</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;adc(2)&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(2)-x&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>

    <span class="n">method</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span>

    <span class="k">if</span> <span class="n">M_ia_jb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">M_ia_jb</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">get_imds</span><span class="p">()</span>

    <span class="n">nocc_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_a</span>
    <span class="n">nocc_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_b</span>
    <span class="n">nvir_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_a</span>
    <span class="n">nvir_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_b</span>

    <span class="n">n_singles_a</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nvir_a</span>
    <span class="n">n_singles_b</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nvir_b</span>
    <span class="n">n_doubles_aaaa</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
    <span class="n">n_doubles_ab</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nvir_a</span> <span class="o">*</span> <span class="n">nvir_b</span>
    <span class="n">n_doubles_bbbb</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="n">n_singles_a</span> <span class="o">+</span> <span class="n">n_singles_b</span> <span class="o">+</span> <span class="n">n_doubles_aaaa</span> <span class="o">+</span> <span class="n">n_doubles_ab</span> <span class="o">+</span> <span class="n">n_doubles_bbbb</span>

    <span class="n">e_occ_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">]</span>
    <span class="n">e_occ_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">]</span>
    <span class="n">e_vir_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:]</span>
    <span class="n">e_vir_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:]</span>

    <span class="n">ij_ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ij_ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ab_ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ab_ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_b</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">s_a</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">f_a</span> <span class="o">=</span> <span class="n">n_singles_a</span>
    <span class="n">s_b</span> <span class="o">=</span> <span class="n">f_a</span>
    <span class="n">f_b</span> <span class="o">=</span> <span class="n">s_b</span> <span class="o">+</span> <span class="n">n_singles_b</span>
    <span class="n">s_aaaa</span> <span class="o">=</span> <span class="n">f_b</span>
    <span class="n">f_aaaa</span> <span class="o">=</span> <span class="n">s_aaaa</span> <span class="o">+</span> <span class="n">n_doubles_aaaa</span>
    <span class="n">s_abab</span> <span class="o">=</span> <span class="n">f_aaaa</span>
    <span class="n">f_ab</span> <span class="o">=</span> <span class="n">s_abab</span> <span class="o">+</span> <span class="n">n_doubles_ab</span>
    <span class="n">s_bbbb</span> <span class="o">=</span> <span class="n">f_ab</span>
    <span class="n">f_bbbb</span> <span class="o">=</span> <span class="n">s_bbbb</span> <span class="o">+</span> <span class="n">n_doubles_bbbb</span>

    <span class="n">d_ij_a</span> <span class="o">=</span> <span class="n">e_occ_a</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_occ_a</span>
    <span class="n">d_ij_b</span> <span class="o">=</span> <span class="n">e_occ_b</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_occ_b</span>
    <span class="n">d_ab_a</span> <span class="o">=</span> <span class="n">e_vir_a</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_vir_a</span>
    <span class="n">d_ab_b</span> <span class="o">=</span> <span class="n">e_vir_b</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_vir_b</span>

    <span class="n">d_ij_abab</span> <span class="o">=</span> <span class="n">e_occ_a</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_occ_b</span>
    <span class="n">d_ab_abab</span> <span class="o">=</span> <span class="n">e_vir_a</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_vir_b</span>

    <span class="k">def</span> <span class="nf">sigma_</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>

        <span class="n">r1_a</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span>
        <span class="n">r1_b</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span>

        <span class="n">r1_a_ov</span> <span class="o">=</span> <span class="n">r1_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
        <span class="n">r1_b_ov</span> <span class="o">=</span> <span class="n">r1_b</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

        <span class="n">r1_ab</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span>

        <span class="n">r_vv_u_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">r_vv_u_a</span><span class="p">[:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">r_vv_u_a</span><span class="p">[:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">r2_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">r2_a</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">r_vv_u_a</span>
        <span class="n">r2_a</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">r_vv_u_a</span>

        <span class="k">del</span> <span class="n">r_vv_u_a</span>

        <span class="n">r_vv_u_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">r_vv_u_b</span><span class="p">[:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">r_vv_u_b</span><span class="p">[:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">r2_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">r2_b</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">r_vv_u_b</span>
        <span class="n">r2_b</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">r_vv_u_b</span>

        <span class="k">del</span> <span class="n">r_vv_u_b</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>


<span class="c1">############## ADC(2) 1 block ############################</span>
<span class="c1">#</span>

        <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,b-&gt;a&#39;</span><span class="p">,</span> <span class="n">M_ia_jb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,b-&gt;a&#39;</span><span class="p">,</span> <span class="n">M_ia_jb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,b-&gt;a&#39;</span><span class="p">,</span> <span class="n">M_ia_jb</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">r1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ba,b-&gt;a&#39;</span><span class="p">,</span> <span class="n">M_ia_jb</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">r1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">D_ijab_a</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">d_ij_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">d_ab_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span>
                                                                      <span class="n">nocc_a</span><span class="p">,</span>
                                                                      <span class="n">nvir_a</span><span class="p">,</span>
                                                                      <span class="n">nvir_a</span><span class="p">))[:,</span>
                                                                               <span class="p">:,</span>
                                                                               <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                                               <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">s</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">D_ijab_a</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                     <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">D_ijab_a</span>

        <span class="n">D_ijab_b</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">d_ij_b</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">d_ab_b</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span>
                                                                      <span class="n">nocc_b</span><span class="p">,</span>
                                                                      <span class="n">nvir_b</span><span class="p">,</span>
                                                                      <span class="n">nvir_b</span><span class="p">))[:,</span>
                                                                               <span class="p">:,</span>
                                                                               <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                                               <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">s</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">D_ijab_b</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                     <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">D_ijab_b</span>

        <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="n">d_ij_abab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">d_ab_abab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">r1_ab</span>

        <span class="n">r1_ab</span> <span class="o">=</span> <span class="n">r1_ab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
        <span class="c1"># M^(1)_h0_h1</span>
        <span class="n">temp_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovvv</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                <span class="n">eris_ovvv</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,mfea-&gt;ia&#39;</span><span class="p">,</span>
                                               <span class="n">r2_a</span><span class="p">[:,</span>
                                                    <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                               <span class="n">eris_ovvv</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,mefa-&gt;ia&#39;</span><span class="p">,</span>
                                               <span class="n">r2_a</span><span class="p">[:,</span>
                                                    <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                               <span class="n">eris_ovvv</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">temp_a</span><span class="p">[:,</span> <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jabe-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_a_ov</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">temp_a</span><span class="p">[:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jbae-&gt;ijab&#39;</span><span class="p">,</span>
                                              <span class="n">r1_a_ov</span><span class="p">,</span>
                                              <span class="n">eris_ovvv</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">temp_a</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,iabe-&gt;ijab&#39;</span><span class="p">,</span>
                                              <span class="n">r1_a_ov</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">temp_a</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,ibae-&gt;ijab&#39;</span><span class="p">,</span>
                                              <span class="n">r1_a_ov</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">eris_ovvv</span>
            <span class="n">temp_a</span> <span class="o">=</span> <span class="n">temp_a</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_a</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                       <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_aaaa</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">temp_a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eris_ovvv</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovvv</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,mfea-&gt;ia&#39;</span><span class="p">,</span> <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,mefa-&gt;ia&#39;</span><span class="p">,</span> <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">temp_a</span> <span class="o">=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jabe-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_a_ov</span><span class="p">,</span>
                                 <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jbae-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_a_ov</span><span class="p">,</span>
                                 <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,iabe-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_a_ov</span><span class="p">,</span>
                                 <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,ibae-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_a_ov</span><span class="p">,</span>
                                 <span class="n">eris_ovvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_a</span> <span class="o">=</span> <span class="n">temp_a</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_a</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                       <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_aaaa</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">temp_a</span>
            <span class="k">del</span> <span class="n">eris_ovvv</span>

        <span class="n">temp_abab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVvv</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_b</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                <span class="n">eris_OVvv</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LOV</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,mfea-&gt;ia&#39;</span><span class="p">,</span>
                                         <span class="n">r1_ab</span><span class="p">[:,</span>
                                               <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                         <span class="n">eris_OVvv</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">temp_abab</span><span class="p">[:,</span>
                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jbae-&gt;ijab&#39;</span><span class="p">,</span>
                                                 <span class="n">r1_a_ov</span><span class="p">,</span>
                                                 <span class="n">eris_OVvv</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">eris_OVvv</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_abab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">temp_abab</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eris_OVvv</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVvv</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,mfea-&gt;ia&#39;</span><span class="p">,</span>
                                     <span class="n">r1_ab</span><span class="p">,</span>
                                     <span class="n">eris_OVvv</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">temp_abab</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ie,jbae-&gt;ijab&#39;</span><span class="p">,</span>
                <span class="n">r1_a_ov</span><span class="p">,</span>
                <span class="n">eris_OVvv</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_abab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">temp_abab</span>
            <span class="k">del</span> <span class="n">eris_OVvv</span>

        <span class="n">temp_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVVV</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_b</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                <span class="n">eris_OVVV</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LOV</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">eris_OVVV</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,mfea-&gt;ia&#39;</span><span class="p">,</span>
                                               <span class="n">r2_b</span><span class="p">[:,</span>
                                                    <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                               <span class="n">eris_OVVV</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,mefa-&gt;ia&#39;</span><span class="p">,</span>
                                               <span class="n">r2_b</span><span class="p">[:,</span>
                                                    <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                               <span class="n">eris_OVVV</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">temp_b</span><span class="p">[:,</span> <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jabe-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_b_ov</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">temp_b</span><span class="p">[:,</span>
                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jbae-&gt;ijab&#39;</span><span class="p">,</span>
                                              <span class="n">r1_b_ov</span><span class="p">,</span>
                                              <span class="n">eris_OVVV</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">temp_b</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,iabe-&gt;ijab&#39;</span><span class="p">,</span>
                                              <span class="n">r1_b_ov</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">temp_b</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,ibae-&gt;ijab&#39;</span><span class="p">,</span>
                                              <span class="n">r1_b_ov</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">eris_OVVV</span>
            <span class="n">temp_b</span> <span class="o">=</span> <span class="n">temp_b</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_b</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                       <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_bbbb</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">temp_b</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eris_OVVV</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVVV</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,mfea-&gt;ia&#39;</span><span class="p">,</span> <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imef,mefa-&gt;ia&#39;</span><span class="p">,</span> <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">temp_b</span> <span class="o">=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jabe-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_b_ov</span><span class="p">,</span>
                                 <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ie,jbae-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_b_ov</span><span class="p">,</span>
                                 <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,iabe-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_b_ov</span><span class="p">,</span>
                                 <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,ibae-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_b_ov</span><span class="p">,</span>
                                 <span class="n">eris_OVVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_b</span> <span class="o">=</span> <span class="n">temp_b</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_b</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                       <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_bbbb</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">temp_b</span>
            <span class="k">del</span> <span class="n">eris_OVVV</span>

        <span class="n">temp_abab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovVV</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                <span class="n">eris_ovVV</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mife,mfea-&gt;ia&#39;</span><span class="p">,</span>
                                         <span class="n">r1_ab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                         <span class="n">eris_ovVV</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">temp_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;je,iabe-&gt;ijab&#39;</span><span class="p">,</span>
                                                 <span class="n">r1_b_ov</span><span class="p">,</span> <span class="n">eris_ovVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">eris_ovVV</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_abab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">temp_abab</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eris_ovVV</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovVV</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mife,mfea-&gt;ia&#39;</span><span class="p">,</span>
                                     <span class="n">r1_ab</span><span class="p">,</span>
                                     <span class="n">eris_ovVV</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">temp_abab</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;je,iabe-&gt;ijab&#39;</span><span class="p">,</span>
                <span class="n">r1_b_ov</span><span class="p">,</span>
                <span class="n">eris_ovVV</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_abab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">temp_abab</span>
            <span class="k">del</span> <span class="n">eris_ovVV</span>

        <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnae,neim-&gt;ia&#39;</span><span class="p">,</span> <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnae,mein-&gt;ia&#39;</span><span class="p">,</span> <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnae,neim-&gt;ia&#39;</span><span class="p">,</span> <span class="n">r1_ab</span><span class="p">,</span>
                                 <span class="n">eris</span><span class="o">.</span><span class="n">OVoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnae,neim-&gt;ia&#39;</span><span class="p">,</span> <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnae,mein-&gt;ia&#39;</span><span class="p">,</span> <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnea,mein-&gt;ia&#39;</span><span class="p">,</span> <span class="n">r1_ab</span><span class="p">,</span>
                                 <span class="n">eris</span><span class="o">.</span><span class="n">ovOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#        # # M^(1)_h1_h0</span>

        <span class="n">temp_a</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,ibjm-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_a_ov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,jbim-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_a_ov</span><span class="p">,</span>
                             <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,iajm-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_a_ov</span><span class="p">,</span>
                             <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,jaim-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_a_ov</span><span class="p">,</span>
                             <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span> <span class="o">=</span> <span class="n">temp_a</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">s</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_a</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_aaaa</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">temp_a</span>

        <span class="n">temp_b</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,ibjm-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_b_ov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,jbim-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_b_ov</span><span class="p">,</span>
                             <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,iajm-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_b_ov</span><span class="p">,</span>
                             <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,jaim-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r1_b_ov</span><span class="p">,</span>
                             <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span> <span class="o">=</span> <span class="n">temp_b</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">s</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_b</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_bbbb</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">temp_b</span>

        <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ma,jbim-&gt;ijab&#39;</span><span class="p">,</span>
                                     <span class="n">r1_a_ov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVoo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mb,iajm-&gt;ijab&#39;</span><span class="p">,</span>
                                     <span class="n">r1_b_ov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(2)&quot;</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">r1_ab</span>
            <span class="k">del</span> <span class="n">r2_a</span>
            <span class="k">del</span> <span class="n">r2_b</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(2)-x&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>

            <span class="n">ladder_int_a</span><span class="p">,</span> <span class="n">ladder_int_b</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">interim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span>
                    <span class="n">r2_a</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">interim</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)[</span>
                    <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_aaaa</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">interim</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span> <span class="o">+=</span> <span class="n">uadc_amplitudes</span><span class="o">.</span><span class="n">contract_ladder_antisym</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">)[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_aaaa</span><span class="p">)</span>

            <span class="c1"># Save intermediate for DF-ADC(3)/ROHF</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span> <span class="ow">and</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">:</span>
                <span class="n">ladder_int_a</span> <span class="o">=</span> <span class="n">uadc_amplitudes</span><span class="o">.</span><span class="n">contract_ladder</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">r2_a</span><span class="p">,</span> <span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">),</span> <span class="n">pack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">pack</span> <span class="o">=</span> <span class="n">ladder_int_a</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">pack</span> <span class="o">=</span> <span class="n">pack</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_aaaa</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span> <span class="o">+=</span> <span class="n">pack</span>
                <span class="k">del</span> <span class="n">pack</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span> <span class="o">+=</span> <span class="n">uadc_amplitudes</span><span class="o">.</span><span class="n">contract_ladder</span><span class="p">(</span><span class="n">adc</span><span class="p">,</span> <span class="n">r2_a</span><span class="p">,</span> <span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">),</span> <span class="n">pack</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span>
                    <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_aaaa</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r1_ab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nocc_b</span><span class="p">,</span>
                                                       <span class="n">nvir_a</span> <span class="o">*</span> <span class="n">nvir_b</span><span class="p">),</span> <span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">uadc_amplitudes</span><span class="o">.</span><span class="n">contract_ladder</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">uadc_amplitudes</span><span class="o">.</span><span class="n">contract_ladder</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">r1_ab</span><span class="p">,</span> <span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">VVVV_p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">interim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span>
                    <span class="n">r2_b</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">interim</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">VVVV_p</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)[</span>
                    <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_bbbb</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">interim</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">VVVV_p</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span> <span class="o">+=</span> <span class="n">uadc_amplitudes</span><span class="o">.</span><span class="n">contract_ladder_antisym</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">VVVV_p</span><span class="p">)[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_bbbb</span><span class="p">)</span>

            <span class="c1"># Save intermediate for DF-ADC(3)/ROHF</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span> <span class="ow">and</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">:</span>
                <span class="n">ladder_int_b</span> <span class="o">=</span> <span class="n">uadc_amplitudes</span><span class="o">.</span><span class="n">contract_ladder</span><span class="p">(</span>
                    <span class="n">adc</span><span class="p">,</span> <span class="n">r2_b</span><span class="p">,</span> <span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">),</span> <span class="n">pack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">pack</span> <span class="o">=</span> <span class="n">ladder_int_b</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">pack</span> <span class="o">=</span> <span class="n">pack</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_bbbb</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span> <span class="o">+=</span> <span class="n">pack</span>
                <span class="k">del</span> <span class="n">pack</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span> <span class="o">+=</span> <span class="n">uadc_amplitudes</span><span class="o">.</span><span class="n">contract_ladder</span><span class="p">(</span><span class="n">adc</span><span class="p">,</span> <span class="n">r2_b</span><span class="p">,</span> <span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">),</span> <span class="n">pack</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span>
                    <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_bbbb</span><span class="p">)</span>

            <span class="n">interim_a</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;imae,jbem-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,mjbe-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">oovv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,jbem-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">interim_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmae,ibem-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmae,mibe-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">oovv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmae,ibem-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">interim_a</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnab,minj-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">oooo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_a</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnab,mjni-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">oooo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">interim_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imbe,jaem-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imbe,jmea-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">oovv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imbe,jaem-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">interim_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmbe,iaem-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_a</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmbe,imea-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">oovv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_a</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmbe,iaem-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">interim_a</span> <span class="o">=</span> <span class="n">interim_a</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span> <span class="o">+=</span> <span class="n">interim_a</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                          <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_aaaa</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">interim_a</span>

            <span class="n">interim_b</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;imae,jbem-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,mjbe-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;miea,mebj-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">interim_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmae,ibem-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmae,mibe-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mjea,mebi-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">interim_b</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnab,minj-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_b</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnab,mjni-&gt;ijab&#39;</span><span class="p">,</span> <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">interim_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imbe,jaem-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imbe,jmea-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mieb,meaj-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">interim_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmbe,iaem-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_b</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmbe,imea-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">interim_b</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mjeb,meai-&gt;ijab&#39;</span><span class="p">,</span>
                                    <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">interim_b</span> <span class="o">=</span> <span class="n">interim_b</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span> <span class="o">+=</span> <span class="n">interim_b</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                          <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_bbbb</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">interim_b</span>

            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,jbem-&gt;ijab&#39;</span><span class="p">,</span>
                                         <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,mjbe-&gt;ijab&#39;</span><span class="p">,</span>
                                         <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imae,mebj-&gt;ijab&#39;</span><span class="p">,</span>
                                         <span class="n">r2_a</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mjae,mibe-&gt;ijab&#39;</span><span class="p">,</span>
                                         <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ooVV</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mnab,minj-&gt;ijab&#39;</span><span class="p">,</span>
                                         <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ooOO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;imeb,jmea-&gt;ijab&#39;</span><span class="p">,</span>
                                         <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOvv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mjeb,iaem-&gt;ijab&#39;</span><span class="p">,</span>
                                         <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;mjeb,imea-&gt;ijab&#39;</span><span class="p">,</span>
                                         <span class="n">r1_ab</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">oovv</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jmbe,iaem-&gt;ijab&#39;</span><span class="p">,</span>
                                         <span class="n">r2_b</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>
            <span class="c1"># M_Y120_aa</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t1</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t2</span>

            <span class="n">Y_aa</span> <span class="o">=</span> <span class="n">r1_a_ov</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">Y_bb</span> <span class="o">=</span> <span class="n">r1_b_ov</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="n">Y_aaaa</span> <span class="o">=</span> <span class="n">r2_a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">Y_bbbb</span> <span class="o">=</span> <span class="n">r2_b</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="n">Y_abab</span> <span class="o">=</span> <span class="n">r1_ab</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">h_ce_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                <span class="n">h_ce_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                <span class="n">t1_ce_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                <span class="n">t1_ce_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">h_ce_aa</span><span class="p">,</span> <span class="n">h_ce_bb</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span>
                <span class="n">t1_ce_aa</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
                <span class="n">t1_ce_bb</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>

            <span class="n">t2_ce_aa</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
            <span class="n">t2_ce_bb</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>

            <span class="n">t1_ccee_aaaa</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">t1_ccee_abab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">t1_ccee_bbbb</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>


            <span class="n">einsum_type</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">v_cccc_aaaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">oooo</span>
            <span class="n">v_cccc_bbbb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOOO</span>
            <span class="n">v_cccc_aabb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ooOO</span>

            <span class="n">v_ceec_aaaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovvo</span>
            <span class="n">v_ceec_bbbb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVVO</span>
            <span class="n">v_ceec_aabb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovVO</span>
            <span class="n">v_ceec_bbaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVvo</span>

            <span class="n">v_ccee_aaaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">oovv</span>
            <span class="n">v_ccee_bbbb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOVV</span>
            <span class="n">v_ccee_aabb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ooVV</span>
            <span class="n">v_ccee_bbaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OOvv</span>

            <span class="n">v_cecc_aaaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovoo</span>
            <span class="n">v_cecc_bbbb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVOO</span>
            <span class="n">v_cecc_aabb</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">ovOO</span>
            <span class="n">v_cecc_bbaa</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">OVoo</span>

            <span class="n">e_core_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">e_extern_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="n">e_core_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">e_extern_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1">######################more m_030 terms##########################</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s2">&quot;Iiac,Libc-&gt;ILab&quot;</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">temp_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                <span class="n">array_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nvir_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                    <span class="n">v_eeee_aaaa</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_vVvV_df</span><span class="p">(</span>
                        <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span>

                    <span class="n">temp_1</span><span class="p">[:,</span>
                           <span class="p">:,</span>
                           <span class="p">:,</span>
                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ILab-&gt;IDLA&#39;</span><span class="p">,</span>
                                                   <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                   <span class="n">int_1</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">temp_1</span><span class="p">[:,</span>
                           <span class="p">:,</span>
                           <span class="p">:,</span>
                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AabD,ILab-&gt;IDLA&#39;</span><span class="p">,</span>
                                                  <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                  <span class="n">int_1</span><span class="p">,</span>
                                                  <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>

                        <span class="n">array_1</span><span class="p">[:,</span>
                                <span class="p">:,</span>
                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Jb,CDab-&gt;IJCD&#39;</span><span class="p">,</span>
                                                 <span class="n">Y_aa</span><span class="p">,</span>
                                                 <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                 <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="n">array_1</span><span class="p">[:,</span>
                                <span class="p">:,</span>
                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,Ib,CDab-&gt;IJCD&#39;</span><span class="p">,</span>
                                                 <span class="n">Y_aa</span><span class="p">,</span>
                                                 <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                 <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                        <span class="n">array_1</span><span class="p">[:,</span>
                                <span class="p">:,</span>
                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Jb,CDba-&gt;IJCD&#39;</span><span class="p">,</span>
                                                 <span class="n">Y_aa</span><span class="p">,</span>
                                                 <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                 <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="n">array_1</span><span class="p">[:,</span>
                                <span class="p">:,</span>
                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,Ib,CDba-&gt;IJCD&#39;</span><span class="p">,</span>
                                                 <span class="n">Y_aa</span><span class="p">,</span>
                                                 <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                 <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                    <span class="k">del</span> <span class="n">v_eeee_aaaa</span>
                <span class="n">temp_1</span> <span class="o">=</span> <span class="n">temp_1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_singles_a</span><span class="p">,</span> <span class="n">n_singles_a</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,b-&gt;a&#39;</span><span class="p">,</span>
                                         <span class="n">temp_1</span><span class="p">,</span> <span class="n">r1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">temp_1</span>
                <span class="k">del</span> <span class="n">int_1</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">=</span> <span class="n">array_1</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;IiDc,ic-&gt;ID&#39;</span><span class="p">,</span> <span class="n">ladder_int_a</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="k">del</span> <span class="n">array_1</span>
                    <span class="k">del</span> <span class="n">ladder_int_a</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                <span class="n">temp_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s2">&quot;Iica,Licb-&gt;ILab&quot;</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nvir_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                    <span class="n">vVvV</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_vVvV_df</span><span class="p">(</span>
                        <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span>
                    <span class="n">v_eeee_abab</span> <span class="o">=</span> <span class="n">vVvV</span>

                    <span class="n">temp_a</span><span class="p">[:,</span>
                           <span class="p">:,</span>
                           <span class="p">:,</span>
                           <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;AaDb,ILab-&gt;IDLA&#39;</span><span class="p">,</span>
                                                   <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                   <span class="n">int_1</span><span class="p">,</span>
                                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                    <span class="k">del</span> <span class="n">v_eeee_abab</span>
                <span class="n">temp_a</span> <span class="o">=</span> <span class="n">temp_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_singles_a</span><span class="p">,</span> <span class="n">n_singles_a</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,b-&gt;a&#39;</span><span class="p">,</span>
                                         <span class="n">temp_a</span><span class="p">,</span> <span class="n">r1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">temp_a</span>
                <span class="k">del</span> <span class="n">int_1</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijAb,LA-&gt;ijLb&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">r1_a_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijDa,ijLb-&gt;LbDa&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILab,LbDa-&gt;ID&#39;</span><span class="p">,</span>
                                             <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                             <span class="n">int_2</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijAb,LA-&gt;ijLb&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">r1_a_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijDa,ijLb-&gt;LbDa&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ILab,LbDa-&gt;ID&#39;</span><span class="p">,</span>
                                     <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                     <span class="n">int_2</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijAa,LA-&gt;ijLa&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">r1_a_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijDb,ijLa-&gt;LaDb&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IabL,LaDb-&gt;ID&#39;</span><span class="p">,</span>
                                             <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                             <span class="n">int_2</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;jmba,la-&gt;jmlb&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">r1_b_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;kmbd,jmlb-&gt;djlk&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkil,djlk-&gt;id&#39;</span><span class="p">,</span>
                                     <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                     <span class="n">int_2</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;jkca,la-&gt;jklc&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">r1_b_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;jkbd,jklc-&gt;lcbd&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilbc,lcbd-&gt;id&#39;</span><span class="p">,</span>
                                     <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                     <span class="n">int_2</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;jkac,la-&gt;jklc&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">r1_b_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;jkdb,jklc-&gt;lcdb&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilbc,lcdb-&gt;id&#39;</span><span class="p">,</span>
                                             <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                             <span class="n">int_2</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;jkab,la-&gt;jklb&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">r1_b_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;jkdc,jklb-&gt;lbdc&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ibcl,lbdc-&gt;id&#39;</span><span class="p">,</span>
                                             <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                             <span class="n">int_2</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

<span class="c1">#########################################################M_030_aabb#######</span>
            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijca,la-&gt;ijlc&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">r1_b_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;Ijcb,ijlc-&gt;biIl&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDbl,biIl-&gt;ID&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                     <span class="n">int_2</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;Ijcb,ID-&gt;Djcb&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">r1_a_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijca,Djcb-&gt;iDab&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDbl,iDab-&gt;la&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                     <span class="n">int_2</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ilca,la-&gt;ic&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">r1_b_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;Ijcb,ic-&gt;biIj&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iDbj,biIj-&gt;ID&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                     <span class="n">int_2</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;iDbj,ID-&gt;Iibj&#39;</span><span class="p">,</span>
                <span class="n">v_ceec_aabb</span><span class="p">,</span>
                <span class="n">r1_a_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;Ijcb,Iibj-&gt;ic&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ilca,ic-&gt;la&#39;</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">int_2</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijDc,ID-&gt;ijIc&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">r1_a_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijba,ijIc-&gt;baIc&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ibcl,baIc-&gt;la&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                     <span class="n">int_2</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijba,la-&gt;ijlb&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">r1_b_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;ijDc,ijlb-&gt;Dclb&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ibcl,Dclb-&gt;ID&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                     <span class="n">int_2</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;jlba,la-&gt;jb&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">r1_b_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;jiDc,jb-&gt;ibDc&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ibci,ibDc-&gt;ID&#39;</span><span class="p">,</span>
                                     <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                     <span class="n">int_2</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

            <span class="n">int_1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;jiDc,ID-&gt;cIji&#39;</span><span class="p">,</span>
                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                <span class="n">r1_a_ov</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">int_2</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;Ibci,cIji-&gt;jb&#39;</span><span class="p">,</span>
                <span class="n">v_ceec_aabb</span><span class="p">,</span>
                <span class="n">int_1</span><span class="p">,</span>
                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jlba,jb-&gt;la&#39;</span><span class="p">,</span>
                                     <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                     <span class="n">int_2</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">int_1</span>
            <span class="k">del</span> <span class="n">int_2</span>

<span class="c1">##########################################################################</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">v_eeee_aaaa</span> <span class="o">=</span> <span class="n">radc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_2</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;Ia,Jb,CDab-&gt;IJCD&#39;</span><span class="p">,</span>
                        <span class="n">Y_aa</span><span class="p">,</span>
                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                        <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,Ib,CDab-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ce_aa</span><span class="p">,</span>
                                            <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                    <span class="n">M_02Y1_aa</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ic,Dcab-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">v_eeee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                    <span class="k">del</span> <span class="n">v_eeee_aaaa</span>

                    <span class="n">v_eeee_bbbb</span> <span class="o">=</span> <span class="n">radc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_2</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">VVVV_p</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

                    <span class="n">M_12Y0_bb</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;ia,jb,cdab-&gt;ijcd&#39;</span><span class="p">,</span>
                        <span class="n">Y_bb</span><span class="p">,</span>
                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                        <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ib,cdab-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ce_bb</span><span class="p">,</span>
                                            <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                    <span class="n">M_02Y1_bb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                        <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,jc,dcab-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">v_eeee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                    <span class="k">del</span> <span class="n">v_eeee_bbbb</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>

                    <span class="n">v_eeee_abab</span> <span class="o">=</span> <span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span>
                    <span class="n">v_eeee_abab</span> <span class="o">=</span> <span class="n">v_eeee_abab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                        <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

                    <span class="n">M_12Y0_ab</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;Ia,jb,Cdab-&gt;IjCd&#39;</span><span class="p">,</span>
                        <span class="n">Y_aa</span><span class="p">,</span>
                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                        <span class="n">v_eeee_abab</span><span class="p">,</span>
                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,Ib,Cdba-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ce_aa</span><span class="p">,</span>
                                            <span class="n">v_eeee_abab</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                    <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ic,Dcab-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ce_bb</span><span class="p">,</span>
                                            <span class="n">v_eeee_abab</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jc,cdab-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ce_aa</span><span class="p">,</span>
                                            <span class="n">v_eeee_abab</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                    <span class="k">del</span> <span class="n">v_eeee_abab</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>

                    <span class="n">temp_ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                    <span class="n">temp_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                    <span class="n">temp_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">eris</span><span class="o">.</span><span class="n">vVvV_p</span><span class="p">:</span>
                        <span class="n">k</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">v_eeee_abab</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                                         <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

                        <span class="n">temp_ab</span><span class="p">[:,</span>
                                <span class="p">:,</span>
                                <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                                <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jb,Cdab-&gt;IjCd&#39;</span><span class="p">,</span>
                                                 <span class="n">Y_aa</span><span class="p">,</span>
                                                 <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                 <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="n">temp_ab</span><span class="p">[:,</span>
                                <span class="p">:,</span>
                                <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                                <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,Ib,Cdba-&gt;IjCd&#39;</span><span class="p">,</span>
                                                 <span class="n">Y_bb</span><span class="p">,</span>
                                                 <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                 <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                        <span class="n">temp_aa</span><span class="p">[:,</span>
                                <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ic,Dcab-&gt;ID&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="n">temp_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jc,cdab-&gt;id&#39;</span><span class="p">,</span>
                                              <span class="n">Y_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">[:,</span>
                                                       <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">],</span>
                                              <span class="n">v_eeee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="k">del</span> <span class="n">v_eeee_abab</span>
                        <span class="n">a</span> <span class="o">+=</span> <span class="n">k</span>

                    <span class="n">M_02Y1_aa</span> <span class="o">=</span> <span class="n">temp_aa</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">=</span> <span class="n">temp_bb</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">=</span> <span class="n">temp_ab</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                    <span class="n">temp_ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                    <span class="n">temp_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                    <span class="n">temp_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                    <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nvir_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                        <span class="n">vVvV</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_vVvV_df</span><span class="p">(</span>
                            <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span>
                        <span class="n">v_eeee_abab</span> <span class="o">=</span> <span class="n">vVvV</span>

                        <span class="n">temp_ab</span><span class="p">[:,</span>
                                <span class="p">:,</span>
                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jb,Cdab-&gt;IjCd&#39;</span><span class="p">,</span>
                                                 <span class="n">Y_aa</span><span class="p">,</span>
                                                 <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                 <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="n">temp_ab</span><span class="p">[:,</span>
                                <span class="p">:,</span>
                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                                <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,Ib,Cdba-&gt;IjCd&#39;</span><span class="p">,</span>
                                                 <span class="n">Y_bb</span><span class="p">,</span>
                                                 <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                 <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                 <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                        <span class="n">temp_aa</span><span class="p">[:,</span>
                                <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ic,Dcab-&gt;ID&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">v_eeee_abab</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="n">temp_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jc,cdab-&gt;id&#39;</span><span class="p">,</span>
                                              <span class="n">Y_abab</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">[:,</span>
                                                       <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                              <span class="n">v_eeee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="k">del</span> <span class="n">v_eeee_abab</span>

                    <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">temp_aa</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">=</span> <span class="n">temp_bb</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">=</span> <span class="n">temp_ab</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">temp_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                    <span class="n">temp_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">:</span>
                        <span class="n">k</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">vvvv</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:]</span>
                        <span class="n">v_eeee_aaaa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                        <span class="n">v_eeee_aaaa</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">vvvv</span>
                        <span class="n">v_eeee_aaaa</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">vvvv</span>

                        <span class="n">temp_1</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Jb,CDab-&gt;IJCD&#39;</span><span class="p">,</span>
                                                <span class="n">Y_aa</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="n">temp_1</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,Ib,CDab-&gt;IJCD&#39;</span><span class="p">,</span>
                                                <span class="n">Y_aa</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                        <span class="n">temp_2</span><span class="p">[:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ic,Dcab-&gt;ID&#39;</span><span class="p">,</span>
                                                              <span class="n">Y_aaaa</span><span class="p">,</span>
                                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                              <span class="n">v_eeee_aaaa</span><span class="p">,</span>
                                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                        <span class="k">del</span> <span class="n">v_eeee_aaaa</span>
                        <span class="n">a</span> <span class="o">+=</span> <span class="n">k</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">=</span> <span class="n">temp_1</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">temp_2</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">VVVV_p</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">temp_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                    <span class="n">temp_4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">eris</span><span class="o">.</span><span class="n">VVVV_p</span><span class="p">:</span>
                        <span class="n">k</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">VVVV</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:]</span>
                        <span class="n">v_eeee_bbbb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                        <span class="n">v_eeee_bbbb</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">VVVV</span>
                        <span class="n">v_eeee_bbbb</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">VVVV</span>

                        <span class="n">temp_3</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,cdab-&gt;ijcd&#39;</span><span class="p">,</span>
                                                <span class="n">Y_bb</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="n">temp_3</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ib,cdab-&gt;ijcd&#39;</span><span class="p">,</span>
                                                <span class="n">Y_bb</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                        <span class="n">temp_4</span><span class="p">[:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,jc,dcab-&gt;id&#39;</span><span class="p">,</span>
                                                              <span class="n">Y_bbbb</span><span class="p">,</span>
                                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                              <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                              <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                        <span class="k">del</span> <span class="n">v_eeee_bbbb</span>
                        <span class="n">a</span> <span class="o">+=</span> <span class="n">k</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">=</span> <span class="n">temp_3</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">temp_4</span>
                    <span class="k">del</span> <span class="n">temp_3</span>
                    <span class="k">del</span> <span class="n">temp_4</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">vvvv_p</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                    <span class="n">temp_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                    <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nvir_b</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                        <span class="n">v_eeee_bbbb</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_vVvV_df</span><span class="p">(</span>
                            <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span>

                        <span class="n">temp_3</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,cdab-&gt;ijcd&#39;</span><span class="p">,</span>
                                                <span class="n">Y_bb</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="n">temp_3</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ib,cdab-&gt;ijcd&#39;</span><span class="p">,</span>
                                                <span class="n">Y_bb</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                        <span class="n">temp_3</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,cdba-&gt;ijcd&#39;</span><span class="p">,</span>
                                                <span class="n">Y_bb</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="n">temp_3</span><span class="p">[:,</span>
                               <span class="p">:,</span>
                               <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">,</span>
                               <span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ib,cdba-&gt;ijcd&#39;</span><span class="p">,</span>
                                                <span class="n">Y_bb</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">v_eeee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                        <span class="k">del</span> <span class="n">v_eeee_bbbb</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">=</span> <span class="n">temp_3</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijdc,jc-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">ladder_int_b</span><span class="p">,</span>
                                            <span class="n">t1_ce_bb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="k">del</span> <span class="n">temp_3</span>
                    <span class="k">del</span> <span class="n">ladder_int_b</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                <span class="n">M_12Y0_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                <span class="n">M_12Y0_ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                <span class="n">M_02Y1_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                <span class="n">M_02Y1_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                <span class="n">M_12Y0_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovvv</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                    <span class="n">v_ceee_aaaa</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                        <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>

                    <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiCb,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                             <span class="n">Y_aa</span><span class="p">,</span>
                                             <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                             <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiCb,iaDb-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiDb,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiDb,iaCb-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiCb,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiCb,iaDb-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiDb,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiDb,iaCb-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,IJab,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,IJab,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJCb,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJCb,iaDb-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJDb,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJDb,iaCb-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijbd,ibCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijbd,iaCb-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Ijbd,ibCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Ijbd,iaCb-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,ijbc,jcab-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aaaa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijac,jcbD-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aaaa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijac,jDbc-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aaaa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jicb,jcaD-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jicb,jDac-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,jkbc,kcab-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;ijDa,ijbc,Ibac-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;ijab,ijac,IDbc-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;ijab,ijac,IcbD-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;ijab,ijcb,IDac-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;ijab,ijcb,IcaD-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="k">del</span> <span class="n">v_ceee_aaaa</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v_ceee_aaaa</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovvv</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiCb,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiCb,iaDb-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiDb,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiDb,iaCb-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiCb,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiCb,iaDb-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiDb,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiDb,iaCb-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,IJab,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,IJab,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJCb,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJCb,iaDb-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJDb,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJDb,iaCb-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijbd,ibCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijbd,iaCb-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Ijbd,ibCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Ijbd,iaCb-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,ijbc,jcab-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijac,jcbD-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijac,jDbc-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ijbc,Ibac-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ijac,IDbc-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ijac,IcbD-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_ceee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jicb,jcaD-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jicb,jDac-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ijcb,IDac-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ijcb,IcaD-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,jkbc,kcab-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">v_ceee_aaaa</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVVV</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_b</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                    <span class="n">v_ceee_bbbb</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                        <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LOV</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="o">-</span><span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkcb,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                             <span class="n">Y_bb</span><span class="p">,</span>
                                             <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                          <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                             <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkcb,kadb-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkdb,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkdb,kacb-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ikcb,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ikcb,kadb-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ikdb,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ikdb,kacb-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ijab,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ijab,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijcb,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijcb,kadb-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijdb,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijdb,kacb-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,IiCb,ibda-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,IiCb,iadb-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCb,ibda-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCb,iadb-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,jkbc,kcab-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bbbb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,jkac,kcbd-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bbbb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,jkac,kdbc-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bbbb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,ijbc,jcab-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jkac,kcbd-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jkac,kdbc-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;jkda,jkbc,ibac-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;jkab,jkac,idbc-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;jkab,jkac,icbd-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;jkab,jkac,idbc-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;jkab,jkac,icbd-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="k">del</span> <span class="n">v_ceee_bbbb</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">v_ceee_bbbb</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVVV</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkcb,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkcb,kadb-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkdb,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkdb,kacb-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ikcb,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ikcb,kadb-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ikdb,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ikdb,kacb-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ijab,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ijab,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijcb,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijcb,kadb-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijdb,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijdb,kacb-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,IiCb,ibda-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,IiCb,iadb-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCb,ibda-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCb,iadb-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,jkbc,kcab-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,jkac,kcbd-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,jkac,kdbc-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkda,jkbc,ibac-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkac,idbc-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkac,icbd-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_ceee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,ijbc,jcab-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jkac,kcbd-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jkac,kdbc-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkac,idbc-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkac,icbd-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">v_ceee_bbbb</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovVV</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_a</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                    <span class="n">v_ceee_aabb</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                        <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lov</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LVV</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,kjbc,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,kjbd,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kibc,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kibd,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijcb,kadb-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijdb,kacb-&gt;ijcd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijCb,iadb-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,Ijab,iadb-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCb,iadb-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,IiCb,ibda-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,kjbc,kbac-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bbbb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,kjca,kcbd-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bbbb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jibc,jbac-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jiac,jDbc-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jkac,kcbd-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;ijab,ijac,IDbc-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_ceee_aabb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;ijDa,ijbc,Ibac-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">v_ceee_aabb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;ijab,ijac,IDbc-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">v_ceee_aabb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="k">del</span> <span class="n">v_ceee_aabb</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v_ceee_aabb</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">ovVV</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,kjbc,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,kjbd,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kibc,kbda-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kibd,kbca-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijcb,kadb-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ijdb,kacb-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijCb,iadb-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,Ijab,iadb-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCb,iadb-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,IiCb,ibda-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,kjbc,kbac-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,kjca,kcbd-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ijac,IDbc-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_ceee_aabb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jibc,jbac-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jiac,jDbc-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ijbc,Ibac-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ijac,IDbc-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jkac,kcbd-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">del</span> <span class="n">v_ceee_aabb</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVvv</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
                <span class="n">chnk_size</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">calculate_chunk_size</span><span class="p">(</span><span class="n">adc</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">lib</span><span class="o">.</span><span class="n">prange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nocc_b</span><span class="p">,</span><span class="n">chnk_size</span><span class="p">):</span>
                    <span class="n">v_ceee_bbaa</span> <span class="o">=</span> <span class="n">dfadc</span><span class="o">.</span><span class="n">get_ovvv_spin_df</span><span class="p">(</span>
                        <span class="n">adc</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">LOV</span><span class="p">,</span> <span class="n">eris</span><span class="o">.</span><span class="n">Lvv</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">chnk_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiCb,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiDb,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiCb,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiDb,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJCb,iaDb-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJDb,iaCb-&gt;IJCD&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jidb,ibCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,Iibd,iaCb-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,Ijab,ibCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Ijbd,iaCb-&gt;IjCd&#39;</span><span class="p">,</span>
                                            <span class="n">Y_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,ijbc,jcab-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aaaa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijac,jcbD-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_aaaa</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijbc,jcaD-&gt;ID&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_bbbb</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,jkbc,kcab-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jkcb,kdac-&gt;id&#39;</span><span class="p">,</span>
                                            <span class="n">Y_abab</span><span class="p">,</span>
                                            <span class="n">t1_ccee_abab</span><span class="p">[:,</span>
                                                         <span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">],</span>
                                            <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;jkab,jkac,idbc-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_ceee_bbaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;jkad,jkbc,icab-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">v_ceee_bbaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="n">M_02Y1_bb</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                        <span class="s1">&#39;jkab,jkcb,idac-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">v_ceee_bbaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                    <span class="k">del</span> <span class="n">v_ceee_bbaa</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v_ceee_bbaa</span> <span class="o">=</span> <span class="n">uadc_ao2mo</span><span class="o">.</span><span class="n">unpack_eri_1</span><span class="p">(</span><span class="n">eris</span><span class="o">.</span><span class="n">OVvv</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>

                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiCb,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,JiDb,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiCb,ibDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,IiDb,ibCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJCb,iaDb-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IJDb,iaCb-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jidb,ibCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,Iibd,iaCb-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,Ijab,ibCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Ijbd,iaCb-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,ijbc,jcab-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijac,jcbD-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkac,idbc-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_ceee_bbaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ijbc,jcaD-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,jkbc,kcab-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jkcb,kdac-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,jkbc,icab-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkcb,idac-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">v_ceee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

                <span class="k">del</span> <span class="n">v_ceee_bbaa</span>

            <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijCD,jaiJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,ijCD,jaiI-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,IjDa,jaiJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,IjDa,iajJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,IjDa,jaiJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,JjDa,jaiI-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,JjDa,iajI-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,JjDa,jaiI-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,IjCa,jaiJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,IjCa,iajJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,IjCa,jaiJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,JjCa,jaiI-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,JjCa,iajI-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,JjCa,jaiI-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCD,jaiJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCD,iajJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,JjCD,jaiI-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,JjCD,iajI-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ia,JiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">h_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,ia,IiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">h_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ia,IJDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">h_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,ia,IJCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">h_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,iC,JDai-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,iC,iJDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,iD,JCai-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,iD,iJCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ia,JCDi-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ia,iCDJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,iC,IDai-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,iC,iIDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,iD,ICai-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,iD,iICa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,ia,ICDi-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,ia,iCDI-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,jD,IiJj-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,jD,IjJi-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,Ia,JDai-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,Ia,iJDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,Ja,IDai-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,Ja,iIDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ia,IDaJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ia,JDaI-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,jC,IiJj-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,jC,IjJi-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,Ia,JCai-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,Ia,iJCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,Ja,ICai-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,Ja,iICa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,ia,ICaJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,ia,JCaI-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ia,C,ia,JiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ia,D,ia,JiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ia,J,ia,JiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ia,a,ia,JiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,i,ia,JiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">e_core_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ja,C,ia,IiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ja,D,ia,IiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ja,I,ia,IiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ja,a,ia,IiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ja,i,ia,IiCD-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">e_core_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iC,D,ia,IJDa-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iC,I,ia,IJDa-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iC,J,ia,IJDa-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iC,i,ia,IJDa-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,a,ia,IJDa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">e_extern_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iD,C,ia,IJCa-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iD,I,ia,IJCa-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iD,J,ia,IJCa-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iD,i,ia,IJCa-&gt;IJCD&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iD,a,ia,IJCa-&gt;IJCD&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">e_extern_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,klcd,lakj-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,klcd,laki-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ilda,lakj-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ilda,kalj-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,jlda,laki-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,jlda,kali-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,liad,lakj-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ljad,laki-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ilca,lakj-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ilca,kalj-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,jlca,laki-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,jlca,kali-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,liac,lakj-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ljac,laki-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ilcd,lakj-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ilcd,kalj-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,jlcd,laki-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,jlcd,kali-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,ilcd,kalj-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ka,jlcd,kali-&gt;ijcd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ka,jkcd-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">h_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ka,ikcd-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">h_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ka,ijda-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">h_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ka,ijca-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">h_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,kc,jdak-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,kc,kjda-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,kd,jcak-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,kd,kjca-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ka,jcdk-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ka,kcdj-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kc,idak-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kc,kida-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kd,icak-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kd,kica-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ka,icdk-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ka,kcdi-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ld,ikjl-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ld,iljk-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ia,jdak-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ia,kjda-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ja,idak-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ja,kida-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ka,idaj-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,ka,jdai-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,lc,ikjl-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,lc,iljk-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ia,jcak-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ia,kjca-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ja,icak-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ja,kica-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ka,icaj-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,ka,jcai-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ia,c,ka,jkcd-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ia,d,ka,jkcd-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ia,j,ka,jkcd-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ia,a,ka,jkcd-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,k,ka,jkcd-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">e_core_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ja,c,ka,ikcd-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ja,d,ka,ikcd-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ja,i,ka,ikcd-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ja,a,ka,ikcd-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,k,ka,ikcd-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">e_core_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;kc,d,ka,ijda-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;kc,i,ka,ijda-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;kc,j,ka,ijda-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;kc,k,ka,ijda-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kc,a,ka,ijda-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">e_extern_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;kd,c,ka,ijca-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;kd,i,ka,ijca-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;kd,j,ka,ijca-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;kd,k,ka,ijca-&gt;ijcd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kd,a,ka,ijca-&gt;ijcd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">e_extern_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_12Y0_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCD,iajJ-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,JjCD,iajI-&gt;IJCD&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ikCd,iakj-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,Ikad,iakj-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,jkda,kaiI-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,kjad,kaiI-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,kjad,iakI-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IkCd,iakj-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,kjCd,kaiI-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,kjCd,iakI-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ia,IiCd-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">h_ce_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,ia,IjCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">h_ce_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ikCd,kaiI-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,IkCa,kaij-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,IkCa,kaij-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,IkCa,iakj-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,kjCa,iakI-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IkCd,kaij-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IkCd,iakj-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,kjCd,iakI-&gt;IjCd&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ia,ijCd-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">h_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ia,Ijad-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">h_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,iC,jdai-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,id,ijCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ia,iCdj-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,Ia,jdai-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,kd,Iijk-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ja,Iiad-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ia,Iadj-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ia,C,ia,ijCd-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ia,d,ia,ijCd-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ia,j,ia,ijCd-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Ia,a,ia,ijCd-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,i,ia,ijCd-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">e_core_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iC,I,ia,Ijad-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iC,d,ia,Ijad-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iC,j,ia,Ijad-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;iC,i,ia,Ijad-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_aa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,a,ia,Ijad-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aa</span><span class="p">,</span>
                                        <span class="n">e_extern_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,iC,Iiad-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,id,ICai-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ia,ICdi-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,kC,Ikji-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,Ia,ijCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,ja,ICai-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,ia,ICaj-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ja,C,ia,IiCd-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ja,I,ia,IiCd-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ja,d,ia,IiCd-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ja,a,ia,IiCd-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,i,ia,IiCd-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">e_core_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;id,C,ia,IjCa-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;id,I,ia,IjCa-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;id,j,ia,IjCa-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;id,i,ia,IjCa-&gt;IjCd&#39;</span><span class="p">,</span>
                    <span class="n">Y_bb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_12Y0_ab</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;id,a,ia,IjCa-&gt;IjCd&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bb</span><span class="p">,</span>
                                        <span class="n">e_extern_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,i,ia-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aaaa</span><span class="p">,</span>
                                    <span class="n">e_core_a</span><span class="p">,</span>
                                    <span class="n">t2_ce_aa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,a,ia-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aaaa</span><span class="p">,</span>
                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                    <span class="n">t2_ce_aa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jkab,kbji-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aaaa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jkab,kbji-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aaaa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jkab,jDki-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ikab,kbIj-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aaaa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ikab,Ibkj-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aaaa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ikab,kbIj-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_aaaa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ikab,IDkj-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ikab,kDIj-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_cecc_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,ijab-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">h_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,ijab-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">h_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jD,ijab-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">h_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,Ib,ijab-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">h_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,iabj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,ijba-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,iabj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,ibaj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,iabj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,iabj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jD,iabj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ja,ijDb-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ja,jDbi-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,Ib,iabj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ib,Ijab-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ib,Ibaj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ka,Iikj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_cccc_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;IiDa,i,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;IiDa,i,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;IiDa,a,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;IiDa,a,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,j,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">e_core_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,b,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">e_extern_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,j,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">e_core_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,b,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_aaaa</span><span class="p">,</span>
                                        <span class="n">e_extern_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Iiab,D,ijab,jD-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Iiab,i,ijab,jD-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Iiab,b,ijab,jD-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Iiab,j,ijab,jD-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijDa,I,ijab,Ib-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijDa,j,ijab,Ib-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijDa,a,ijab,Ib-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijDa,b,ijab,Ib-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_aaaa</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,j,ja-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bbbb</span><span class="p">,</span>
                                    <span class="n">e_core_b</span><span class="p">,</span>
                                    <span class="n">t2_ce_bb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,a,ja-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bbbb</span><span class="p">,</span>
                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                    <span class="n">t2_ce_bb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,klba,kblj-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bbbb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,klab,lbkj-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bbbb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,klab,kdlj-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkda,jlab,lbik-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bbbb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkda,jlab,iblk-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bbbb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkda,ljba,lbik-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_bbbb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jlab,idlk-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jlab,ldik-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_cecc_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jlab,idlk-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">v_cecc_bbaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,kb,kjba-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">h_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,kb,jkab-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">h_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,kd,jkab-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">h_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkda,ib,jkab-&gt;id&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">h_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,kb,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,kb,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,kb,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,kb,jkba-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,kb,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,kb,jbak-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,kd,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ka,jkdb-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ka,kdbj-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkda,ib,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkda,jb,ikab-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkda,jb,ibak-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkda,la,ijlk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_cccc_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijda,j,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijda,j,kjba,kb-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijda,a,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijda,a,kjba,kb-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,k,kjba,kb-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">e_core_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,b,kjba,kb-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">e_extern_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,k,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">e_core_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijda,b,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_bbbb</span><span class="p">,</span>
                                        <span class="n">e_extern_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijab,d,jkab,kd-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijab,j,jkab,kd-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijab,b,jkab,kd-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijab,k,jkab,kd-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jkda,i,jkab,ib-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jkda,k,jkab,ib-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jkda,a,jkab,ib-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jkda,b,jkab,ib-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_bbbb</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ikab,IDkj-&gt;ID&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">v_cecc_aabb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,i,ia-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">e_core_b</span><span class="p">,</span>
                                    <span class="n">t2_ce_bb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,a,ia-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">e_extern_b</span><span class="p">,</span>
                                    <span class="n">t2_ce_bb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,jiba-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">h_ce_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,ijab-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">h_ce_bb</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jD,jiab-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">h_ce_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,Ib,ijba-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">h_ce_aa</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jkba,jbki-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jkab,kbji-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jkab,jDki-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ikba,Ibkj-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,jkab,kbIi-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,kjba,kbIi-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,kjba,Ibki-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ikab,IDkj-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,kjab,IDki-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,kjab,kDIi-&gt;ID&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;IiDa,i,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;IiDa,i,jiba,jb-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;IiDa,a,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;IiDa,a,jiba,jb-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,j,jiba,jb-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_core_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,b,jiba,jb-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_extern_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,j,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_core_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,b,ijab,jb-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_extern_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Iiab,D,jiab,jD-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Iiab,i,jiab,jD-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Iiab,a,jiab,jD-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;Iiab,b,jiab,jD-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,j,jiab,jD-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_core_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijDa,I,ijba,Ib-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijDa,i,ijba,Ib-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijDa,j,ijba,Ib-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;ijDa,a,ijba,Ib-&gt;ID&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,b,ijba,Ib-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_extern_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,iabj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,iabj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,iabj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,ijba-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,iabj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IiDa,jb,ibaj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jD,ibaj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,ja,jDbi-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Iiab,jb,ijDa-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,Ib,ibaj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ib,Ibaj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,jb,Iiab-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_aa</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijDa,ka,Iikj-&gt;ID&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,j,ja-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">e_core_a</span><span class="p">,</span>
                                    <span class="n">t2_ce_aa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,a,ja-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">e_extern_a</span><span class="p">,</span>
                                    <span class="n">t2_ce_aa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,klab,lbkj-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aaaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,klab,lbkj-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,klab,ldkj-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,jlab,lbik-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                    <span class="n">v_cecc_aabb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,jlab,lbik-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,jlab,iblk-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,lkab,iblj-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jlab,idlk-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jlab,ldik-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbbb</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,lkab,idlj-&gt;id&#39;</span><span class="p">,</span>
                                    <span class="n">Y_abab</span><span class="p">,</span>
                                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                    <span class="n">v_cecc_bbaa</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">rohf</span><span class="o">.</span><span class="n">ROHF</span><span class="p">):</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,kb,jkab-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">h_ce_aa</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,kb,jkab-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">h_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,kd,jkab-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">h_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,ib,jkab-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">h_ce_bb</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,kb,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,kb,jkba-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,kb,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,kb,jbak-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ceec_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,kb,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,kb,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,kd,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,ka,jkdb-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,kb,kdaj-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,ib,jabk-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,jb,ikab-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_ccee_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,kb,ibaj-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">v_ceec_bbaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,la,ljik-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">v_cccc_aabb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jiad,j,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jiad,j,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jiad,a,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                    <span class="n">t1_ce_aa</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jiad,a,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,k,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_core_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,b,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_extern_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,k,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_core_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiad,b,jkab,kb-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_extern_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jiab,d,jkab,kd-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jiab,j,jkab,kd-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jiab,a,jkab,kd-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jiab,b,jkab,kd-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,k,jkab,kd-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_core_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jkad,i,jkab,ib-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jkad,j,jkab,ib-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jkad,k,jkab,ib-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_core_b</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                    <span class="s1">&#39;jkad,a,jkab,ib-&gt;id&#39;</span><span class="p">,</span>
                    <span class="n">Y_abab</span><span class="p">,</span>
                    <span class="n">e_extern_a</span><span class="p">,</span>
                    <span class="n">t1_ccee_abab</span><span class="p">,</span>
                    <span class="n">t1_ce_bb</span><span class="p">,</span>
                    <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
                <span class="n">M_02Y1_bb</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkad,b,jkab,ib-&gt;id&#39;</span><span class="p">,</span>
                                        <span class="n">Y_abab</span><span class="p">,</span>
                                        <span class="n">e_extern_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">s</span><span class="p">[</span><span class="n">s_a</span><span class="p">:</span><span class="n">f_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">M_02Y1_aa</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_b</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">M_02Y1_bb</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">s</span><span class="p">[</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span> <span class="o">+=</span> <span class="n">M_12Y0_ab</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">M_12Y0_aa</span> <span class="o">=</span> <span class="n">M_12Y0_aa</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span> <span class="o">+=</span> <span class="n">M_12Y0_aa</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                          <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_aaaa</span><span class="p">)</span>

            <span class="n">M_12Y0_bb</span> <span class="o">=</span> <span class="n">M_12Y0_bb</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">s</span><span class="p">[</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span> <span class="o">+=</span> <span class="n">M_12Y0_bb</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                          <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_doubles_bbbb</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">r1_ab</span>
            <span class="k">del</span> <span class="n">r2_a</span>
            <span class="k">del</span> <span class="n">r2_b</span>
            <span class="c1"># exit()</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">return</span> <span class="n">sigma_</span></div>



<div class="viewcode-block" id="make_rdm1">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.make_rdm1">[docs]</a>
<span class="k">def</span> <span class="nf">make_rdm1</span><span class="p">(</span><span class="n">adc</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;adc(2)&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(2)-x&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="n">adc</span><span class="p">,</span>
            <span class="s2">&quot;EE-ADC(3) RDMs include contributions up to ADC(2)-X only...&quot;</span><span class="p">)</span>

    <span class="n">method</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span>

    <span class="n">t1</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t1</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t2</span>
    <span class="n">nocc_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_a</span>
    <span class="n">nocc_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_b</span>
    <span class="n">nvir_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_a</span>
    <span class="n">nvir_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_b</span>

    <span class="n">occ_list_a</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">)</span>
    <span class="n">occ_list_b</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">f_ov_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">f_ov_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">t1_ce_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">t1_ce_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f_ov_a</span><span class="p">,</span> <span class="n">f_ov_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span>
        <span class="n">t1_ce_aa</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">t1_ce_bb</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>

    <span class="k">if</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t2_ce_aa</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">t2_ce_bb</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t2_ce_aa</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">t2_ce_bb</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">t1_ccee_aaaa</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
    <span class="n">t1_ccee_abab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
    <span class="n">t1_ccee_bbbb</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span>

    <span class="n">nmo_a</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">+</span> <span class="n">nvir_a</span>
    <span class="n">nmo_b</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">+</span> <span class="n">nvir_b</span>

    <span class="n">temp_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nmo_a</span><span class="p">,</span> <span class="n">nmo_a</span><span class="p">))</span>
    <span class="n">temp_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nmo_b</span><span class="p">,</span> <span class="n">nmo_b</span><span class="p">))</span>

    <span class="n">n_singles_a</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nvir_a</span>
    <span class="n">n_singles_b</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nvir_b</span>
    <span class="n">n_doubles_aaaa</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
    <span class="n">n_doubles_ab</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nvir_a</span> <span class="o">*</span> <span class="n">nvir_b</span>
    <span class="n">n_doubles_bbbb</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>

    <span class="n">ij_ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ij_ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ab_ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ab_ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_b</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">f_a</span> <span class="o">=</span> <span class="n">n_singles_a</span>
    <span class="n">s_b</span> <span class="o">=</span> <span class="n">f_a</span>
    <span class="n">f_b</span> <span class="o">=</span> <span class="n">s_b</span> <span class="o">+</span> <span class="n">n_singles_b</span>
    <span class="n">s_aaaa</span> <span class="o">=</span> <span class="n">f_b</span>
    <span class="n">f_aaaa</span> <span class="o">=</span> <span class="n">s_aaaa</span> <span class="o">+</span> <span class="n">n_doubles_aaaa</span>
    <span class="n">s_abab</span> <span class="o">=</span> <span class="n">f_aaaa</span>
    <span class="n">f_ab</span> <span class="o">=</span> <span class="n">s_abab</span> <span class="o">+</span> <span class="n">n_doubles_ab</span>
    <span class="n">s_bbbb</span> <span class="o">=</span> <span class="n">f_ab</span>
    <span class="n">f_bbbb</span> <span class="o">=</span> <span class="n">s_bbbb</span> <span class="o">+</span> <span class="n">n_doubles_bbbb</span>

    <span class="n">U</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span>
    <span class="n">nroots</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">opdm_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">opdm_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

        <span class="n">Y_aa</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][:</span><span class="n">f_a</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
        <span class="n">Y_bb</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">f_a</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

        <span class="n">Y_abab</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

        <span class="n">Y_vv_u_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">Y_vv_u_a</span><span class="p">[:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y_vv_u_a</span><span class="p">[:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y_aaaa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">Y_aaaa</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Y_vv_u_a</span>
        <span class="n">Y_aaaa</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y_vv_u_a</span>

        <span class="k">del</span> <span class="n">Y_vv_u_a</span>

        <span class="n">Y_vv_u_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">Y_vv_u_b</span><span class="p">[:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y_vv_u_b</span><span class="p">[:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y_bbbb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">Y_bbbb</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Y_vv_u_b</span>
        <span class="n">Y_bbbb</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y_vv_u_b</span>

        <span class="k">del</span> <span class="n">Y_vv_u_b</span>

<span class="c1"># OPDM ADC(2)</span>

        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ijab,Ljab-&gt;IL&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,La-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ijab,Ljab-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">temp_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="n">occ_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkab-&gt;&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
               <span class="n">occ_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja-&gt;&#39;</span><span class="p">,</span>
                                         <span class="n">Y_aa</span><span class="p">,</span>
                                         <span class="n">Y_aa</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
               <span class="n">occ_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkab-&gt;&#39;</span><span class="p">,</span>
                                         <span class="n">Y_abab</span><span class="p">,</span>
                                         <span class="n">Y_abab</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span> <span class="n">occ_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkab-&gt;&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">occ_list_a</span><span class="p">,</span>
               <span class="n">occ_list_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja-&gt;&#39;</span><span class="p">,</span>
                                         <span class="n">Y_bb</span><span class="p">,</span>
                                         <span class="n">Y_bb</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Ljab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">Y_aaaa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Ljab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,Ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">Y_aaaa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,Ijab,jb-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ja,jkbc,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ja,jb,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ja,jkbc,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jb,Lkac,jkbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jb,Lkac,jkbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jb,Lkac,kjcb-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jb,Lkac,jkbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,ja,jkbc,Ikbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,ja,jb,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,ja,jkbc,Ikbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,jb,Ikac,jkbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,jb,Ikac,jkbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,jb,Ikac,kjcb-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;La,jb,Ikac,jkbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,Ikbc,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,Ib,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,Ikbc,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,Ia,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,Ikac,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,Ikac,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ka,Ijbc,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kb,Ijac,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kb,Ijac,Lkcb-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,Ikbc,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,Ib,Lb-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,Ikbc,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,Ikca,Lkcb-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kb,Ijca,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ka,Ijbc,Lkbc-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kb,Ijca,Lkcb-&gt;IL&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;iA,iC-&gt;AC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAb,ijCb-&gt;AC&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijAb,ijCb-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,ijCb,jb-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">Y_aaaa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,ijCb,jb-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijAb,jb-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">Y_aaaa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijAb,jb-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,ib,jb,jC-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,ib,jkbd,jkCd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,ib,jkbd,jkCd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,jb,ikCd,jkbd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,jb,ikCd,jkbd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,jb,ikCd,kjdb-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iA,jb,ikCd,jkbd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ib,jb,jA-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">t1_ce_aa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ib,jkbd,jkAd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ib,jkbd,jkAd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,jb,ikAd,jkbd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,jb,ikAd,jkbd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,jb,ikAd,kjdb-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,jb,ikAd,jkbd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,jA,jC-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,jkAd,jkCd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,jkAd,jkCd-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,id,jkAb,jkCd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jb,iA,jC-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jb,ikAd,jkCd-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jb,ikAd,jkCd-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jd,ikAb,jkCd-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jd,ikAb,kjCd-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jd,ikCb,kjAd-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,jA,jC-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,jkAd,jkCd-&gt;AC&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,jkAd,jkCd-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,id,jkAb,jkCd-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jb,kiAd,kjCd-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
               <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jd,kiAb,kjCd-&gt;AC&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">temp_IC</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IjCa,ja-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IjCa,ja-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IC,ja,ja-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span>
                              <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IC,ja,ja-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span>
                              <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jC,ja,Ia-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span>
                              <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IjCa,jkab,kb-&gt;IC&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IjCa,jkab,kb-&gt;IC&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ijab,jkab,kC-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ja,jC-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span>
                              <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IjCa,jkab,kb-&gt;IC&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IjCa,kjba,kb-&gt;IC&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ijab,kjab,kC-&gt;IC&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkCa,jkab,Ib-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkCa,jkba,Ib-&gt;IC&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t2_ce_aa</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">temp_IC</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IC,ja,ja-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t2_ce_aa</span><span class="p">,</span>
                                  <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_IC</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IC,ja,ja-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t2_ce_aa</span><span class="p">,</span>
                                  <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_IC</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jC,ja,Ia-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t2_ce_aa</span><span class="p">,</span>
                                  <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_IC</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ja,jC-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t2_ce_aa</span><span class="p">,</span>
                                  <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ja,jkCb,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ja,jkCb,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jb,ka,jkCb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jb,ka,kjCb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jC,ja,Ikab,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jC,ja,Ikab,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jC,ka,jb,Ikab-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jC,ka,jb,Ikba-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,IkCb,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,IkCb,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,IkCa,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ka,IjCb,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,IkCb,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,IkCb,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,IkCa,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ka,IjCb,kb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ljab-&gt;il&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,la-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jlab-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">temp_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkab-&gt;&#39;</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
               <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja-&gt;&#39;</span><span class="p">,</span>
                                         <span class="n">Y_aa</span><span class="p">,</span>
                                         <span class="n">Y_aa</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
               <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkab-&gt;&#39;</span><span class="p">,</span>
                                         <span class="n">Y_abab</span><span class="p">,</span>
                                         <span class="n">Y_abab</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span> <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkab,jkab-&gt;&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">occ_list_b</span><span class="p">,</span>
               <span class="n">occ_list_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja-&gt;&#39;</span><span class="p">,</span>
                                         <span class="n">Y_bb</span><span class="p">,</span>
                                         <span class="n">Y_bb</span><span class="p">,</span>
                                         <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ljab,jb-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">Y_bbbb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jlba,jb-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;la,ijab,jb-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">Y_bbbb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;la,jiba,jb-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,lkac,jkbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,klca,jkbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,jkbc,lkbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,jb,lb-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,kjbc,klbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,lkac,jkbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,klca,kjcb-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;la,jb,ikac,jkbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;la,jb,kica,jkbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;la,ja,jkbc,ikbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;la,ja,jb,ib-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;la,ja,kjbc,kibc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;la,jb,ikac,jkbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;la,jb,kica,kjcb-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,ikbc,lkbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,ib,lb-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,kibc,klbc-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,kiac,klbc-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ka,jibc,klbc-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kb,jiac,klbc-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,ikbc,lkbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,ib,lb-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,kibc,klbc-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,ia,lb-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,ikac,lkbc-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,kica,klcb-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kb,ijac,klbc-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kb,ljac,kibc-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ka,ijbc,lkbc-&gt;il&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
               <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kb,ijac,lkbc-&gt;il&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;ijba,ijbc-&gt;ac&#39;</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ic-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,ijcb-&gt;ac&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijcb,jb-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">Y_bbbb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jibc,jb-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ijab,jb-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">Y_bbbb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jiba,jb-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">Y_abab</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,ja,jc-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,jkda,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,jkad,jkcd-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,id,jkba,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jb,ikda,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jd,ikba,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jb,jc-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jkdb,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jkbd,jkcd-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ikcd,jkbd-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,kidc,jkbd-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ikcd,jkbd-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,kidc,kjdb-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ib,jb,ja-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">t1_ce_bb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ib,jkdb,jkda-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ib,jkbd,jkad-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jb,ikad,jkbd-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jb,kida,jkbd-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_aa</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jb,ikad,jkbd-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jb,kida,kjdb-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,ja,jc-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,jkda,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ib,jkad,jkcd-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,id,jkab,jkcd-&gt;ac&#39;</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">Y_bb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jd,ikab,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jd,ikcb,jkda-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_aa</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jb,ia,jc-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jb,ikad,jkcd-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jb,kida,kjdc-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
               <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jd,ikab,jkcd-&gt;ac&#39;</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">Y_bb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                      <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">temp_ic</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijca,ja-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiac,ja-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ja,ja-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span>
                              <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ja,ja-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span>
                              <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,ja,ia-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span>
                              <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijca,jkab,kb-&gt;ic&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijca,kjba,kb-&gt;ic&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ijab,jkab,kc-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,jc-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span>
                              <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiac,jkab,kb-&gt;ic&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiac,jkab,kb-&gt;ic&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jiab,jkab,kc-&gt;ic&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkac,jkab,ib-&gt;ic&#39;</span><span class="p">,</span>
                              <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jkca,jkab,ib-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t2_ce_bb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">temp_ic</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ja,ja-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t2_ce_bb</span><span class="p">,</span>
                                  <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_ic</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ja,ja-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t2_ce_bb</span><span class="p">,</span>
                                  <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_ic</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,ja,ia-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t2_ce_bb</span><span class="p">,</span>
                                  <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_ic</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,jc-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t2_ce_bb</span><span class="p">,</span>
                                  <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ka,jkbc-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,jkcb,kb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,kjbc,kb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ka,jkcb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,ikcb,kb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,kibc,kb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,ka,kibc-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ka,jibc,kb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,ja,ikab,kb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,ja,kiba,kb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,ka,jb,kiab-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,ka,jb,ikab-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,ikcb,kb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ja,kibc,kb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,ikca,kb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ka,ijcb,kb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># OPDM ADC(2)-X</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(2)-x&quot;</span><span class="p">):</span>

            <span class="n">temp_IC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IC,jkab,jkab-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_IC</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IC,jkab,jkab-&gt;IC&#39;</span><span class="p">,</span>
                                  <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_IC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;IC,jkab,jkab-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jC,jkab,Ikab-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_IC</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jC,jkab,Ikab-&gt;IC&#39;</span><span class="p">,</span>
                                  <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_IC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jkab,jkCb-&gt;IC&#39;</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_IC</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,jkab,jkCb-&gt;IC&#39;</span><span class="p">,</span>
                                  <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">temp_ic</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jkab,jkab-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_ic</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jkab,jkab-&gt;ic&#39;</span><span class="p">,</span>
                                  <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_ic</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jkab,jkab-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,jkab,ikab-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_ic</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,kjab,kiab-&gt;ic&#39;</span><span class="p">,</span>
                                  <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_ic</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkba,jkbc-&gt;ic&#39;</span><span class="p">,</span>
                                  <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_ic</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkab,jkcb-&gt;ic&#39;</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">temp_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">=</span> <span class="n">temp_IC</span>
        <span class="n">temp_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_IC</span><span class="o">.</span><span class="n">T</span>

        <span class="n">temp_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">=</span> <span class="n">temp_ic</span>
        <span class="n">temp_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span> <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_ic</span><span class="o">.</span><span class="n">T</span>

        <span class="n">opdm_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opdm_a</span><span class="p">,</span> <span class="n">temp_a</span><span class="p">)</span>
        <span class="n">opdm_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opdm_b</span><span class="p">,</span> <span class="n">temp_b</span><span class="p">)</span>

    <span class="n">opdm_a</span> <span class="o">=</span> <span class="n">opdm_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nroots</span><span class="p">,</span> <span class="n">nmo_a</span><span class="p">,</span> <span class="n">nmo_a</span><span class="p">)</span>
    <span class="n">opdm_b</span> <span class="o">=</span> <span class="n">opdm_b</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nroots</span><span class="p">,</span> <span class="n">nmo_b</span><span class="p">,</span> <span class="n">nmo_b</span><span class="p">)</span>

    <span class="n">opdm</span> <span class="o">=</span> <span class="p">(</span><span class="n">opdm_a</span><span class="p">,</span> <span class="n">opdm_b</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">opdm</span></div>



<div class="viewcode-block" id="get_spin_square">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.get_spin_square">[docs]</a>
<span class="k">def</span> <span class="nf">get_spin_square</span><span class="p">(</span><span class="n">adc</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;adc(2)&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(2)-x&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>

    <span class="n">method</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span>
    <span class="n">dm_a</span><span class="p">,</span> <span class="n">dm_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="n">adc</span><span class="p">,</span>
            <span class="s2">&quot;EE-ADC(3) &lt;S^2&gt; includes contributions up to ADC(2)-X only...&quot;</span><span class="p">)</span>

    <span class="n">t1</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t1</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t2</span>
    <span class="n">nocc_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_a</span>
    <span class="n">nocc_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_b</span>
    <span class="n">nvir_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_a</span>
    <span class="n">nvir_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_b</span>

    <span class="n">ovlp</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="o">.</span><span class="n">get_ovlp</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">_scf</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ovlp</span><span class="p">,</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">f_ov_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">f_ov_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">t1_ce_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">t1_ce_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f_ov_a</span><span class="p">,</span> <span class="n">f_ov_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span>
        <span class="n">t1_ce_aa</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">t1_ce_bb</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>

    <span class="k">if</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t2_ce_aa</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">t2_ce_bb</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t2_ce_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">t2_ce_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>

    <span class="n">t1_ccee_aaaa</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
    <span class="n">t1_ccee_abab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
    <span class="n">t1_ccee_bbbb</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span>

    <span class="k">if</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t2_ccee_aaaa</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">t2_ccee_abab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
        <span class="n">t2_ccee_bbbb</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t2_ccee_aaaa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">t2_ccee_abab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">t2_ccee_bbbb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>

    <span class="n">n_singles_a</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nvir_a</span>
    <span class="n">n_singles_b</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nvir_b</span>
    <span class="n">n_doubles_aaaa</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
    <span class="n">n_doubles_ab</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nvir_a</span> <span class="o">*</span> <span class="n">nvir_b</span>
    <span class="n">n_doubles_bbbb</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>

    <span class="n">ij_ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ij_ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ab_ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ab_ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_b</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">f_a</span> <span class="o">=</span> <span class="n">n_singles_a</span>
    <span class="n">s_b</span> <span class="o">=</span> <span class="n">f_a</span>
    <span class="n">f_b</span> <span class="o">=</span> <span class="n">s_b</span> <span class="o">+</span> <span class="n">n_singles_b</span>
    <span class="n">s_aaaa</span> <span class="o">=</span> <span class="n">f_b</span>
    <span class="n">f_aaaa</span> <span class="o">=</span> <span class="n">s_aaaa</span> <span class="o">+</span> <span class="n">n_doubles_aaaa</span>
    <span class="n">s_abab</span> <span class="o">=</span> <span class="n">f_aaaa</span>
    <span class="n">f_ab</span> <span class="o">=</span> <span class="n">s_abab</span> <span class="o">+</span> <span class="n">n_doubles_ab</span>
    <span class="n">s_bbbb</span> <span class="o">=</span> <span class="n">f_ab</span>
    <span class="n">f_bbbb</span> <span class="o">=</span> <span class="n">s_bbbb</span> <span class="o">+</span> <span class="n">n_doubles_bbbb</span>

    <span class="n">U</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span>

    <span class="n">spin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">trace_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">trace_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">S_oc_ab</span> <span class="o">=</span> <span class="n">delta</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">S_oo_ab</span> <span class="o">=</span> <span class="n">delta</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">S_vir_ab</span> <span class="o">=</span> <span class="n">delta</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="n">nocc_b</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">S_vv_ab</span> <span class="o">=</span> <span class="n">delta</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="n">nocc_b</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">S_ov_ab</span> <span class="o">=</span> <span class="n">delta</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">S_vo_ab</span> <span class="o">=</span> <span class="n">delta</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

        <span class="n">Y_aa</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][:</span><span class="n">f_a</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
        <span class="n">Y_bb</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">f_a</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

        <span class="n">Y_abab</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

        <span class="n">Y_vv_u_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">Y_vv_u_a</span><span class="p">[:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y_vv_u_a</span><span class="p">[:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y_aaaa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">Y_aaaa</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Y_vv_u_a</span>
        <span class="n">Y_aaaa</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y_vv_u_a</span>

        <span class="k">del</span> <span class="n">Y_vv_u_a</span>

        <span class="n">Y_vv_u_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">Y_vv_u_b</span><span class="p">[:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y_vv_u_b</span><span class="p">[:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y_bbbb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">Y_bbbb</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Y_vv_u_b</span>
        <span class="n">Y_bbbb</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y_vv_u_b</span>

        <span class="k">del</span> <span class="n">Y_vv_u_b</span>

        <span class="c1"># 2-RDM contributions to the S^2 values</span>
        <span class="n">IjKl</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ij,klab,klab&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ij,ka,ka&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ij,klab,klab&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ij,klab,klab&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ij,ka,ka&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,jlab,klab&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,ja,ka&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,ljab,lkab&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,ilab,klab&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,ia,ka&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,ilab,klab&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ilab,kjab&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ij,kj,klab,lb&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ij,kj,klab,lb&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ij,kl,kjab,lb&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ji,jk,klab,lb&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ji,jk,lkba,lb&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ji,kl,jlba,kb&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,ja,lb,kmac,lmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,ja,lb,mkca,lmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,ja,la,kmbc,lmbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,ja,la,kb,lb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,ja,la,mkbc,mlbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,ja,lb,kmac,lmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,ja,lb,mkca,mlcb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,la,jmbc,kmbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,la,jb,kb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,la,mjbc,mkbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,lb,mjac,mkbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,ma,ljbc,mkbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,mb,ljac,mkbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,la,jmbc,kmbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,la,jb,kb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,la,mjbc,mkbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,lb,ja,kb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,lb,jmac,kmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,lb,mjca,mkcb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,mb,jlac,mkbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,ma,jlbc,kmbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ik,la,mb,jlac,kmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,ia,la,kmbc,lmbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,ia,la,kb,lb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,ia,la,kmbc,lmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,ia,lb,kmac,lmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,ia,lb,kmac,lmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,ia,lb,kmac,mlcb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,ia,lb,kmac,lmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,la,imbc,kmbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,la,ib,kb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,la,imbc,kmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,lb,ia,kb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,lb,imac,kmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,lb,imac,kmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,ma,ilbc,kmbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,mb,ilac,kmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,mb,ilac,kmcb&#39;</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,la,imbc,kmbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,la,ib,kb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,la,imbc,kmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,lb,imca,kmcb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,ma,ilbc,kmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj,la,mb,ilca,kmcb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ia,jb,ka,lb&#39;</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ia,jb,kmac,mlcb&#39;</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ia,jb,kmac,lmbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ia,ka,jmbc,lmbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ia,ka,jb,lb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ia,ka,mjbc,mlbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ia,kb,mjac,mlbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ia,ma,kjbc,mlbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ia,mb,kjac,mlbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ia,mb,kjac,lmbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ja,la,imbc,kmbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ja,la,ib,kb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ja,la,imbc,kmbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ja,lb,imca,kmcb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ja,mb,ilca,kmbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ja,ma,ilbc,kmbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ja,mb,ilca,kmcb&#39;</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">S_oc_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ma,ma,ilbc,kjbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ma,mb,ilac,kjbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ma,ma,ilbc,kjbc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjKl</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kl,ma,mb,ilca,kjcb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">AbCd</span> <span class="o">=</span> <span class="o">-</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ijad,ijcb&#39;</span><span class="p">,</span> <span class="n">S_vir_ab</span><span class="p">,</span>
                            <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ab,cd,ijcb,jd&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ba,cd,jibd,jc&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ia,ic,jb,jd&#39;</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ia,ic,jkeb,jked&#39;</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ia,ic,jkbe,jkde&#39;</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ia,ie,jkcb,jked&#39;</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ia,jc,ikeb,jked&#39;</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ia,je,ikcb,jked&#39;</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ia,jb,ic,jd&#39;</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ia,jb,ikce,kjed&#39;</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ia,jb,ikce,jkde&#39;</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ia,je,ikcb,jkde&#39;</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ie,ie,jkad,jkcb&#39;</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ie,je,ikad,jkcb&#39;</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ib,id,ja,jc&#39;</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ib,id,jkae,jkce&#39;</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ib,id,jkae,jkce&#39;</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ib,ie,jkad,jkce&#39;</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ib,je,kiad,jkce&#39;</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ib,jd,kiae,kjce&#39;</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ib,je,kiad,kjce&#39;</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">S_vir_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ie,ie,jkad,jkcb&#39;</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AbCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ab,cd,ie,je,kiad,kjcb&#39;</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">IjCd</span> <span class="o">=</span> <span class="o">-</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ib,jkac,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                            <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ib,kjca,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijba,kc,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijba,kc,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijbc,ka,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijca,kb,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikbc,ja,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ic,kjba,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikba,jc,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikbc,ja,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ja,ikbc,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ja,ikbc,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ka,ijbc,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kb,ijca,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,jkac,ib,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,jc,ikba,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kjba,ic,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kjca,ib,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijba,kc,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t2_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijba,kc,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t2_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijbc,ka,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t2_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijca,kb,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t2_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikbc,ja,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t2_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikba,jc,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t2_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikbc,ja,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t2_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,jkac,ib,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t2_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kjba,ic,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t2_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kjca,ib,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t2_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ib,kc,ka,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ic,kc,ja,kb&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ja,kc,ic,kb&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,jc,kc,ib,ka&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kb,kc,ic,ja&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kc,kc,ib,ja&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ka,kc,ib,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kc,kc,ib,ja&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">IaKd</span> <span class="o">=</span> <span class="o">-</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jkca,jkcb&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                            <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,ja,jb&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jkac,jkbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ikca,jkcb&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,jkac,kb&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,jb,ikbc,kc&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,jb,kicb,kc&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,kb,kicb,jc&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,jc,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,jc,klda,kldb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,jc,klad,klbd&#39;</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,jd,klca,kldb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,kc,jlda,kldb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,kd,jlca,kldb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,ja,jc,kb,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,ja,jc,kldb,kldc&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,ja,jc,klbd,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,ja,kc,jlbd,klcd&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,ja,kc,ljdb,klcd&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,ja,kc,jlbd,klcd&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,ja,kc,ljdb,lkdc&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,jc,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,jc,klda,kldb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,jc,klad,klbd&#39;</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,jd,klac,klbd&#39;</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,kd,jlac,kldb&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,kc,ja,kb&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,kc,jlad,klbd&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,kc,ljda,lkdb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jc,kd,jlac,klbd&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ic,jc,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ic,jc,klda,kldb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ic,jc,klad,klbd&#39;</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ic,jd,klda,klcb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ic,kc,klda,jldb&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ic,kd,klda,jlcb&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ic,kb,ka,jc&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ic,kb,klad,jlcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ic,kb,lkda,jlcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ic,kd,klad,jlcb&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,kc,kc,ilda,jldb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,kc,kd,ilca,jldb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ka,kb,ilcd,jlcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ka,kb,ic,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ka,kb,ilcd,jlcd&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ka,kc,ildc,jldb&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ka,lc,ilcd,jkdb&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ka,lb,ilcd,jkcd&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ka,lc,ildc,jkdb&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,kc,kc,ilda,jldb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaKd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,kc,lc,ikda,jldb&#39;</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">AiDk</span> <span class="o">=</span> <span class="o">-</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,ja,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                            <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jkac,jkbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jkac,jkbc&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,kiac,kjbc&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,aj,bj,ikbc,kc&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,aj,bj,ikbc,kc&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,aj,bk,ikbc,jc&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bi,cj,kjca,kb&#39;</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,ja,jc,kb,kc&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,ja,jc,klbd,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,ja,jc,klbd,klcd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,ja,kc,jlbd,klcd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,ja,kc,jlbd,klcd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,ja,kc,jlbd,lkdc&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,ja,kc,jlbd,klcd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,jc,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,jc,klad,klbd&#39;</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,jc,klad,klbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,jd,klac,klbd&#39;</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,kc,ja,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,kc,jlad,klbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,kc,jlad,klbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,kd,jlac,klbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,kd,jlac,lkbd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,jc,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,jc,klad,klbd&#39;</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,jc,klad,klbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,jd,klac,klbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,kc,ljad,lkbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bi,jc,kd,ljac,lkbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ic,jc,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ic,jc,klad,klbd&#39;</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ic,jc,klad,klbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ic,jd,klad,klbc&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ic,kb,ka,jc&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ic,kb,klad,ljdc&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ic,kb,klad,jlcd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ic,kd,klad,ljbc&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ic,kc,lkad,ljbd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ic,kd,lkad,ljbc&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ka,kb,ilcd,jlcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ka,kb,ic,jc&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ka,kb,licd,ljcd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ka,kc,licd,ljbd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ka,lb,licd,kjcd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ka,lc,licd,kjbd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,ka,lc,ilcd,kjbd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,kc,kc,liad,ljbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,kc,lc,kiad,ljbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,kc,kc,liad,ljbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">AiDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bj,kc,kd,liac,ljbd&#39;</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">IaDk</span> <span class="o">=</span> <span class="o">-</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,jb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                            <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ikac,kjcb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ikac,jkbc&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,jkbc,kc&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,kjcb,kc&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ic,kjcb,ka&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jb,ikac,kc&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jb,ikac,kc&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jc,ikac,kb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ka,ic,kjcb&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kb,ikac,jc&#39;</span><span class="p">,</span> <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,jc,kb,kc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,jc,kldb,kldc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,jc,klbd,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,kc,jlbd,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,kc,ljdb,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,kb,jlcd,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,kb,jc,kc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,kb,ljcd,lkcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,kc,jlbd,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ia,kc,ljdb,lkdc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ic,jb,ka,kc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ic,jb,klad,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ic,jb,klad,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ic,jd,klad,klcb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ic,kc,jb,ka&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ic,kc,jlbd,klad&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ic,kc,ljdb,klad&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ic,kd,ljcb,klad&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ic,kb,ljcd,lkad&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ic,kd,ljcb,lkad&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jb,ka,ilcd,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jb,ka,ic,kc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jb,ka,ilcd,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jb,kc,ilad,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jb,kc,ilad,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_aa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jb,kc,ilad,lkdc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jb,kc,ilad,klcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_oc_ab</span><span class="p">,</span>
                                   <span class="n">S_vir_ab</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">Y_bb</span><span class="p">,</span>
                                   <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                   <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jc,ka,ildc,kldb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jc,kd,ilac,kldb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jc,kc,ia,kb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jc,kc,ilad,lkdb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jc,kc,ilad,klbd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,jc,kd,ilac,klbd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ka,kc,ic,jb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ka,kc,ilcd,ljdb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ka,kc,ilcd,jlbd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ka,lc,ilcd,kjdb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ka,lb,ilcd,kjcd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,ka,lc,ildc,kjdb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,kc,ia,jb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,kc,ilad,ljdb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,kc,ilad,jlbd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,kd,ilac,ljdb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,lc,ikad,ljdb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,ld,ikac,ljdb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,ld,ikac,jlbd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kb,kc,ia,jc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kb,kc,ilad,ljdc&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kb,kc,ilad,jlcd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kb,lc,ikad,ljcd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kb,lc,ikad,jlcd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,kc,ia,jb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,kc,ilad,ljdb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,kc,ilad,jlbd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,kd,ilac,jlbd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,ld,ikac,ljdb&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_aa</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,lc,ikad,jlbd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">IaDk</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ab,kc,ld,ikac,jlbd&#39;</span><span class="p">,</span>
                           <span class="n">S_oc_ab</span><span class="p">,</span>
                           <span class="n">S_vir_ab</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">Y_bb</span><span class="p">,</span>
                           <span class="n">t1_ccee_abab</span><span class="p">,</span>
                           <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                           <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">einsum</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span>
        <span class="n">einsum_type</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">IjdL</span> <span class="o">=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jkab,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                        <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kjba,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,kjba&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jkab,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jkab,lkcb,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jkbc,la,klbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,jb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kjba,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kjba,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kjbc,la,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,klba,jc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,klab,jc,klbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,ib,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,jlab,ilcb,kc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kjba,ilbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kjba,ilbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kjbc,ilbc,la&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,klbc,ilbc,ja&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,ib,ja&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,klba,ilbc,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,klbc,ilbc,ja&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ljba,ilbc,kc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,jb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,ib,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,ib,ja&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,kc,klca,lb&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,kb,klac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,kb,lkca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,kc,klac,lb&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kb,jlac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kb,ljca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kc,ljba,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,lb,kjca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,kb,jlbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,kb,ljcb,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,lb,ljbc,kc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,lb,jlbc,kc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kb,jlac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kb,ljca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kc,jlab,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,lb,jkac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,ja,klbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,ja,klbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,jc,klba,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,kb,jlac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,kb,ljca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,kc,ljba,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,lb,kjca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,la,kjbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,lb,ic,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,lb,ic,klcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,jb,lb,ic,klca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,lb,ic,ljca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,lc,ib,ljca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,lc,ib,jlac&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,lb,lb,ic,kjca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,lb,lc,ib,kjca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,la,lb,ic,kjcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,lb,lb,ic,kjca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="n">IjlD</span> <span class="o">=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                        <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ikab,jb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikbc,la,klbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,lkcb,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikbc,la,lkbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,ib,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,klab,ic,klbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,klab,ic,klcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,jb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ikab,jlbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ikab,ljcb,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ikbc,ljbc,la&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ilab,ljbc,kc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ilab,jlbc,kc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,klbc,ia,jlbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,ia,jb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,lkab,ic,ljcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,lkbc,ia,ljbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,ib,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,jb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,ia,jb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,kb,klac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,kb,klac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,kc,klac,lb&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,kc,lkac,lb&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,kb,ilbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,kb,ilbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,lb,ilbc,kc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,lb,ilcb,kc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kc,ilab,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,lb,ikac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kc,ilab,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,lb,ikac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,jb,klbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,jb,lkcb,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,lb,jc,lkbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,lb,jc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ib,jc,lkac,lb&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ib,lb,jc,lkac&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,jb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,jb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,jb,kc,ilab,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,jb,la,ikcb,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,jb,lb,ikac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,lc,ilac,jb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,lb,ilac,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,lc,ilac,jb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,la,lb,ikbc,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,lb,lb,ikac,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,lb,lb,ikac,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,lb,lc,ikab,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="n">AbcL</span> <span class="o">=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijba,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                        <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,ja,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijbd,ka,jkdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijba,jkcd,kd&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijba,kjdc,kd&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijbd,ka,jkcd&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijda,kb,kjdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,ib,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jkba,id,jkdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jkda,ib,jkdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jkad,ib,jkcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,ja,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,ib,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jd,jkda,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jc,jkad,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jc,kjda,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jd,jkad,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,id,jd,jkba,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,id,jc,kjba,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jb,jd,ikda,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jb,kc,ikda,jd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jd,jd,ikba,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,jc,ikbd,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,jc,ikbd,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,jd,ikbd,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,kd,ikbd,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,kc,ikbd,jd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,kd,ikbd,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jc,jd,ikba,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jd,jd,ikba,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AbcL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jd,kd,ijba,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="n">AblC</span> <span class="o">=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jiac,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                        <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,ic,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,ja,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ijcd,ka,kjbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jiac,jkbd,kd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jiac,jkbd,kd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jiad,jkbd,kc&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jidc,ka,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jkad,ic,jkbd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jkac,id,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jkad,ic,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,ic,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,ja,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jb,jkad,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jb,jkad,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jd,jkad,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jd,kjad,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,id,jb,jkac,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,id,jd,kjac,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,jb,ikcd,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,jb,kidc,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,jd,kidc,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,kb,kidc,jd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,kd,kidc,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,kd,ikcd,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jb,jd,kiac,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jb,kc,jiad,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jd,jd,kiac,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jd,kd,jiac,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jc,jd,kiad,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jd,jd,kiac,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="n">AjdC</span> <span class="o">=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jiac,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                        <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,ic,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,ja,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ijcd,ka,kjbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jiac,jkbd,kd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jiac,jkbd,kd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jiad,jkbd,kc&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jidc,ka,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jkad,ic,jkbd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jkac,id,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jkad,ic,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,ic,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,ja,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jb,jkad,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jb,jkad,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jd,jkad,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jd,kjad,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,id,jb,jkac,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,id,jd,kjac,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,jb,ikcd,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,jb,kidc,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,jd,kidc,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,kb,kidc,jd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,kd,kidc,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,kd,ikcd,jb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jb,jd,kiac,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jb,kc,jiad,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jd,jd,kiac,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jd,kd,jiac,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jc,jd,kiad,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jd,jd,kiac,kb&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="n">AjlK</span> <span class="o">=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                        <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ikab,jb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikbc,la,klbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikab,lkcb,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ikbc,la,lkbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,ib,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,klab,ic,klbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,klab,ic,klcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,jb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ikab,jlbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ikab,ljcb,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ikbc,ljbc,la&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ilab,ljbc,kc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ilab,jlbc,kc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,klbc,ia,jlbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,ia,jb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,lkab,ic,ljcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,lkbc,ia,ljbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,ib,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,jb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,ia,jb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,kb,klac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,kb,klac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,kc,klac,lb&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,kc,lkac,lb&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,kb,ilbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,kb,ilbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,lb,ilbc,kc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,lb,ilcb,kc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kc,ilab,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,lb,ikac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,kc,ilab,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,kb,lb,ikac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,jb,klbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,jb,lkcb,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,lb,jc,lkbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,lb,jc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ib,jc,lkac,lb&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ib,lb,jc,lkac&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,jb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,jb,kb,ilac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,jb,kc,ilab,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,jb,la,ikcb,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,jb,lb,ikac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,lc,ilac,jb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,lb,ilac,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,lc,ilac,jb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,la,lb,ikbc,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,lb,lb,ikac,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,lb,lb,ikac,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,lb,lc,ikab,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="n">IbdC</span> <span class="o">=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijba,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                        <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,ja,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijbd,ka,jkdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijba,jkcd,kd&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijba,kjdc,kd&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijbd,ka,jkcd&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ijda,kb,kjdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,ib,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jkba,id,jkdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jkda,ib,jkdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jkad,ib,jkcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,ja,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,ib,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jd,jkda,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jc,jkad,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jc,kjda,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jd,jkad,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,id,jd,jkba,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,id,jc,kjba,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jb,jd,ikda,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jb,kc,ikda,jd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jd,jd,ikba,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,jc,ikbd,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,jc,ikbd,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,jd,ikbd,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,kd,ikbd,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,kc,ikbd,jd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,kd,ikbd,jc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jc,jd,ikba,kd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vv_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jd,jd,ikba,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IbdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jd,kd,ijba,kc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="n">IblK</span> <span class="o">=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jkab,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                        <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kjba,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,kjba&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jkab,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jkab,lkcb,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jkbc,la,klbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,jb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kjba,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kjba,klbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kjbc,la,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,klba,jc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,klab,jc,klbc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,ib,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,jlab,ilcb,kc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kjba,ilbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kjba,ilbc,lc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kjbc,ilbc,la&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,klbc,ilbc,ja&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,ib,ja&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,klba,ilbc,jc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,klbc,ilbc,ja&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ljba,ilbc,kc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,kb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,ka,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,jb,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,ib,kb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,ib,ja&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">t2_ce_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,kc,klca,lb&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,kb,klac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,kb,lkca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,kc,klac,lb&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kb,jlac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kb,ljca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kc,ljba,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,lb,kjca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,kb,jlbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,kb,ljcb,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,lb,ljbc,kc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,lb,jlbc,kc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kb,jlac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kb,ljca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,kc,jlab,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,kb,lb,jkac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,ja,klbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,ja,klbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,jc,klba,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,kb,jlac,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,kb,ljca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,kc,ljba,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,lb,kjca,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_aa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ib,la,kjbc,lc&#39;</span><span class="p">,</span>
                               <span class="n">S_oo_ab</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">Y_aa</span><span class="p">,</span>
                               <span class="n">Y_bb</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">t1_ce_bb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,lb,ic,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,lb,ic,klcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,jb,lb,ic,klca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,lb,ic,ljca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,lc,ib,ljca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,lc,ib,jlac&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,lb,lb,ic,kjca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,lb,lc,ib,kjca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_aa</span><span class="p">,</span> <span class="n">Y_aa</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,la,lb,ic,kjcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
        <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,lb,lb,ic,kjca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                       <span class="n">Y_bb</span><span class="p">,</span> <span class="n">Y_bb</span><span class="p">,</span> <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">t1_ccee_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(2)-x&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>

            <span class="n">IjCd</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijba,klcd,klcd&#39;</span><span class="p">,</span>
                                       <span class="n">S_ov_ab</span><span class="p">,</span>
                                       <span class="n">S_vo_ab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">Y_aaaa</span><span class="p">,</span>
                                       <span class="n">Y_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijba,klcd,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijba,klcd,klcd&#39;</span><span class="p">,</span>
                                       <span class="n">S_ov_ab</span><span class="p">,</span>
                                       <span class="n">S_vo_ab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">Y_bbbb</span><span class="p">,</span>
                                       <span class="n">Y_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijbc,klda,kldc&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijbc,klad,klcd&#39;</span><span class="p">,</span>
                                       <span class="n">S_ov_ab</span><span class="p">,</span>
                                       <span class="n">S_vo_ab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">Y_bbbb</span><span class="p">,</span>
                                       <span class="n">Y_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijca,klbd,klcd&#39;</span><span class="p">,</span>
                                       <span class="n">S_ov_ab</span><span class="p">,</span>
                                       <span class="n">S_vo_ab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">Y_aaaa</span><span class="p">,</span>
                                       <span class="n">Y_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijca,klbd,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ijcd,klba,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikbc,jlad,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikbc,ljda,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikcd,ljba,klcd&#39;</span><span class="p">,</span>
                                       <span class="n">S_ov_ab</span><span class="p">,</span>
                                       <span class="n">S_vo_ab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">Y_abab</span><span class="p">,</span>
                                       <span class="n">Y_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikba,jlcd,klcd&#39;</span><span class="p">,</span>
                                       <span class="n">S_ov_ab</span><span class="p">,</span>
                                       <span class="n">S_vo_ab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">Y_bbbb</span><span class="p">,</span>
                                       <span class="n">Y_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikba,ljcd,lkcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikbc,jlad,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikbc,ljda,lkdc&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikca,ljbd,lkcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,ikcd,ljba,lkcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,jkac,ilbd,lkdc&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,jkac,ilbd,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_bbbb</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,jkcd,ilba,klcd&#39;</span><span class="p">,</span>
                                       <span class="n">S_ov_ab</span><span class="p">,</span>
                                       <span class="n">S_vo_ab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">Y_abab</span><span class="p">,</span>
                                       <span class="n">Y_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kjba,ilcd,klcd&#39;</span><span class="p">,</span>
                                       <span class="n">S_ov_ab</span><span class="p">,</span>
                                       <span class="n">S_vo_ab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                       <span class="n">Y_aaaa</span><span class="p">,</span>
                                       <span class="n">Y_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kjba,ilcd,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kjbc,ilda,kldc&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kjca,ilbd,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">Y_aaaa</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kjca,ilbd,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,kjcd,ilba,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,klbc,ijda,klcd&#39;</span><span class="p">,</span>
                                       <span class="n">S_ov_ab</span><span class="p">,</span>
                                       <span class="n">S_vo_ab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                       <span class="n">Y_abab</span><span class="p">,</span>
                                       <span class="n">Y_aaaa</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,klba,ijcd,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,klbc,ijda,kldc&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,klca,ijbd,klcd&#39;</span><span class="p">,</span>
                               <span class="n">S_ov_ab</span><span class="p">,</span>
                               <span class="n">S_vo_ab</span><span class="p">,</span>
                               <span class="n">t1_ccee_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">Y_abab</span><span class="p">,</span>
                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">IjCd</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bj,klac,ijbd,klcd&#39;</span><span class="p">,</span>
                                       <span class="n">S_ov_ab</span><span class="p">,</span>
                                       <span class="n">S_vo_ab</span><span class="p">,</span>
                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                       <span class="n">Y_abab</span><span class="p">,</span>
                                       <span class="n">Y_bbbb</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">AbcL</span> <span class="o">+=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jkda,jkdc&#39;</span><span class="p">,</span>
                             <span class="n">S_ov_ab</span><span class="p">,</span>
                             <span class="n">S_vv_ab</span><span class="p">,</span>
                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                             <span class="n">Y_abab</span><span class="p">,</span>
                             <span class="n">Y_abab</span><span class="p">,</span>
                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AbcL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jkad,jkcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">S_vv_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AbcL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,id,jkba,jkdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,ikbd,kjdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AbcL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,ikbd,jkcd&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AbcL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jb,ikda,jkdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">AblC</span> <span class="o">+=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,ikcd,jkbd&#39;</span><span class="p">,</span>
                             <span class="n">S_vo_ab</span><span class="p">,</span>
                             <span class="n">S_vv_ab</span><span class="p">,</span>
                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                             <span class="n">Y_bbbb</span><span class="p">,</span>
                             <span class="n">Y_abab</span><span class="p">,</span>
                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,kidc,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AblC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jkad,jkbd&#39;</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">S_vv_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AblC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jkad,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AblC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,id,jkac,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AblC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jc,kiad,kjbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">AjdC</span> <span class="o">+=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,ikcd,jkbd&#39;</span><span class="p">,</span>
                             <span class="n">S_vo_ab</span><span class="p">,</span>
                             <span class="n">S_vv_ab</span><span class="p">,</span>
                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                             <span class="n">Y_bbbb</span><span class="p">,</span>
                             <span class="n">Y_abab</span><span class="p">,</span>
                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ja,kidc,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jkad,jkbd&#39;</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">S_vv_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,ic,jkad,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,id,jkac,jkbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ai,bc,jc,kiad,kjbd&#39;</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">AjlK</span> <span class="o">+=</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,klbc,klbc&#39;</span><span class="p">,</span>
                                     <span class="n">S_oo_ab</span><span class="p">,</span>
                                     <span class="n">S_vo_ab</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">Y_aaaa</span><span class="p">,</span>
                                     <span class="n">Y_aaaa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,klbc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,klbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,klac,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,klac,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,ilbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,ilbc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,jlbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,ljbc,lkbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ib,ljbc,lkac&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,la,ikbc,ljbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,ilac,ljcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">AjlK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,ilac,jlbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">IbdC</span> <span class="o">+=</span> <span class="o">-</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jkda,jkdc&#39;</span><span class="p">,</span>
                             <span class="n">S_ov_ab</span><span class="p">,</span>
                             <span class="n">S_vv_ab</span><span class="p">,</span>
                             <span class="n">t1_ce_aa</span><span class="p">,</span>
                             <span class="n">Y_abab</span><span class="p">,</span>
                             <span class="n">Y_abab</span><span class="p">,</span>
                             <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IbdC</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ib,jkad,jkcd&#39;</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">S_vv_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IbdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,id,jkba,jkdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,ikbd,kjdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IbdC</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,ja,ikbd,jkcd&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IbdC</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,bc,jb,ikda,jkdc&#39;</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span> <span class="n">S_vv_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">IblK</span> <span class="o">+=</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,klbc,klbc&#39;</span><span class="p">,</span>
                                     <span class="n">S_oo_ab</span><span class="p">,</span>
                                     <span class="n">S_ov_ab</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">Y_aaaa</span><span class="p">,</span>
                                     <span class="n">Y_aaaa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,klbc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,klbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,klca,klcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,klac,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,jlbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,ljbc,lkbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,ilbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,ilbc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,jb,ilcb,klca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,ilbc,ljca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,ilbc,jlac&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IblK</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,la,ilbc,kjbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">IjdL</span> <span class="o">+=</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,klbc,klbc&#39;</span><span class="p">,</span>
                                     <span class="n">S_oo_ab</span><span class="p">,</span>
                                     <span class="n">S_ov_ab</span><span class="p">,</span>
                                     <span class="n">t1_ce_bb</span><span class="p">,</span>
                                     <span class="n">Y_aaaa</span><span class="p">,</span>
                                     <span class="n">Y_aaaa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,klbc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ja,klbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,klca,klcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,jb,klac,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,jlbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ia,ka,ljbc,lkbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,ilbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_ov_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_bb</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,ja,ilbc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,jb,ilcb,klca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,ilbc,ljca&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,kb,ilbc,jlac&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjdL</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ka,la,ilbc,kjbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_ov_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">IjlD</span> <span class="o">+=</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,klbc,klbc&#39;</span><span class="p">,</span>
                                     <span class="n">S_oo_ab</span><span class="p">,</span>
                                     <span class="n">S_vo_ab</span><span class="p">,</span>
                                     <span class="n">t1_ce_aa</span><span class="p">,</span>
                                     <span class="n">Y_aaaa</span><span class="p">,</span>
                                     <span class="n">Y_aaaa</span><span class="p">,</span>
                                     <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,klbc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ia,klbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,klac,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ib,klac,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,ilbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">Y_aaaa</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,aj,ka,ilbc,klbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,jlbc,klbc&#39;</span><span class="p">,</span>
                                   <span class="n">S_oo_ab</span><span class="p">,</span>
                                   <span class="n">S_vo_ab</span><span class="p">,</span>
                                   <span class="n">t1_ce_aa</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">Y_bbbb</span><span class="p">,</span>
                                   <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ia,ljbc,lkbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,ib,ljbc,lkac&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">-=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,la,ikbc,ljbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_aa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,ilac,ljcb&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_aaaa</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">IjlD</span> <span class="o">+=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ak,kb,ilac,jlbc&#39;</span><span class="p">,</span> <span class="n">S_oo_ab</span><span class="p">,</span> <span class="n">S_vo_ab</span><span class="p">,</span>
                           <span class="n">t1_ce_bb</span><span class="p">,</span> <span class="n">Y_abab</span><span class="p">,</span> <span class="n">Y_bbbb</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="c1"># 1-RDM contributions to the S^2 values</span>
        <span class="n">na</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">dm_a</span><span class="p">[</span><span class="n">r</span><span class="p">])</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">dm_b</span><span class="p">[</span><span class="n">r</span><span class="p">])</span>

        <span class="n">spin_square</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">((</span><span class="n">na</span> <span class="o">-</span> <span class="n">nb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">na</span> <span class="o">+</span> <span class="n">nb</span><span class="p">)</span> <span class="o">+</span> <span class="n">IjKl</span> <span class="o">+</span> <span class="n">AbCd</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">IjCd</span> <span class="o">+</span> \
            <span class="n">IaKd</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">IaDk</span> <span class="o">+</span> <span class="n">AiDk</span> <span class="o">+</span> <span class="n">IjdL</span> <span class="o">+</span> <span class="n">IjlD</span> <span class="o">+</span> <span class="n">AbcL</span> <span class="o">+</span> <span class="n">AjdC</span> <span class="o">+</span> <span class="n">AblC</span> <span class="o">+</span> <span class="n">AjlK</span> <span class="o">+</span> <span class="n">IbdC</span> <span class="o">+</span> <span class="n">IblK</span>

        <span class="n">spin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spin</span><span class="p">,</span> <span class="n">spin_square</span><span class="p">)</span>

        <span class="n">trace_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace_a</span><span class="p">,</span> <span class="n">na</span><span class="p">)</span>
        <span class="n">trace_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace_b</span><span class="p">,</span> <span class="n">nb</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">spin</span><span class="p">,</span> <span class="p">(</span><span class="n">trace_a</span><span class="p">,</span> <span class="n">trace_b</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_trans_moments">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.get_trans_moments">[docs]</a>
<span class="k">def</span> <span class="nf">get_trans_moments</span><span class="p">(</span><span class="n">adc</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;adc(2)&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(2)-x&quot;</span><span class="p">,</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(3)&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">adc</span><span class="o">.</span><span class="n">approx_trans_moments</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="n">adc</span><span class="p">,</span>
            <span class="s2">&quot;EE-ADC(3) oscillator strengths do not include&quot;</span>
            <span class="o">+</span> <span class="s2">&quot; contributions from third-order amplitudes...&quot;</span><span class="p">)</span>

    <span class="n">method</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span>

    <span class="n">t1</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t1</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t2</span>

    <span class="n">nocc_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_a</span>
    <span class="n">nocc_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_b</span>
    <span class="n">nvir_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_a</span>
    <span class="n">nvir_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_b</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">f_ov_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">f_ov_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">t1_1_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">t1_1_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f_ov_a</span><span class="p">,</span> <span class="n">f_ov_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span>
        <span class="n">t1_1_a</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">t1_1_b</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>

    <span class="n">nmo_a</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">+</span> <span class="n">nvir_a</span>
    <span class="n">nmo_b</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">+</span> <span class="n">nvir_b</span>

    <span class="n">n_singles_a</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nvir_a</span>
    <span class="n">n_singles_b</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nvir_b</span>
    <span class="n">n_doubles_aaaa</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
    <span class="n">n_doubles_ab</span> <span class="o">=</span> <span class="n">nocc_a</span> <span class="o">*</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="n">nvir_a</span> <span class="o">*</span> <span class="n">nvir_b</span>
    <span class="n">n_doubles_bbbb</span> <span class="o">=</span> <span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>

    <span class="n">ij_ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ij_ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ab_ind_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_a</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ab_ind_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">nvir_b</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">f_a</span> <span class="o">=</span> <span class="n">n_singles_a</span>
    <span class="n">s_b</span> <span class="o">=</span> <span class="n">f_a</span>
    <span class="n">f_b</span> <span class="o">=</span> <span class="n">s_b</span> <span class="o">+</span> <span class="n">n_singles_b</span>
    <span class="n">s_aaaa</span> <span class="o">=</span> <span class="n">f_b</span>
    <span class="n">f_aaaa</span> <span class="o">=</span> <span class="n">s_aaaa</span> <span class="o">+</span> <span class="n">n_doubles_aaaa</span>
    <span class="n">s_abab</span> <span class="o">=</span> <span class="n">f_aaaa</span>
    <span class="n">f_ab</span> <span class="o">=</span> <span class="n">s_abab</span> <span class="o">+</span> <span class="n">n_doubles_ab</span>
    <span class="n">s_bbbb</span> <span class="o">=</span> <span class="n">f_ab</span>
    <span class="n">f_bbbb</span> <span class="o">=</span> <span class="n">s_bbbb</span> <span class="o">+</span> <span class="n">n_doubles_bbbb</span>

    <span class="n">U</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span>
    <span class="n">nroots</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">TY_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nroots</span><span class="p">,</span> <span class="n">nmo_a</span><span class="p">,</span> <span class="n">nmo_a</span><span class="p">))</span>
    <span class="n">TY_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nroots</span><span class="p">,</span> <span class="n">nmo_b</span><span class="p">,</span> <span class="n">nmo_b</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

        <span class="n">TY_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nmo_a</span><span class="p">,</span> <span class="n">nmo_a</span><span class="p">))</span>
        <span class="n">TY_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nmo_b</span><span class="p">,</span> <span class="n">nmo_b</span><span class="p">))</span>

        <span class="n">Y_a</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][:</span><span class="n">f_a</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">)</span>
        <span class="n">Y_b</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">f_a</span><span class="p">:</span><span class="n">f_b</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

        <span class="n">Y1_abab</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_abab</span><span class="p">:</span><span class="n">f_ab</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">)</span>

        <span class="n">Y_vv_u_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">Y_vv_u_a</span><span class="p">[:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y_vv_u_a</span><span class="p">[:,</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_aaaa</span><span class="p">:</span><span class="n">f_aaaa</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y1_oovv_u_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
        <span class="n">Y1_oovv_u_a</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Y_vv_u_a</span>
        <span class="n">Y1_oovv_u_a</span><span class="p">[</span><span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ij_ind_a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y_vv_u_a</span>

        <span class="k">del</span> <span class="n">Y_vv_u_a</span>

        <span class="n">Y_vv_u_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">Y_vv_u_b</span><span class="p">[:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y_vv_u_b</span><span class="p">[:,</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ab_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">U</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">s_bbbb</span><span class="p">:</span><span class="n">f_bbbb</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">((</span><span class="n">nocc_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nocc_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">nvir_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">nvir_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">Y1_oovv_u_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
        <span class="n">Y1_oovv_u_b</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Y_vv_u_b</span>
        <span class="n">Y1_oovv_u_b</span><span class="p">[</span><span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ij_ind_b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y_vv_u_b</span>

        <span class="k">del</span> <span class="n">Y_vv_u_b</span>

        <span class="c1"># T_U2_Y0 qp block</span>
        <span class="k">if</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t1_2_a</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,qg-&gt;pq&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t1_2_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;xr,xv-&gt;vr&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t1_2_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">t1_2_a</span>

        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">=</span> <span class="n">Y_a</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">=</span> <span class="n">Y_b</span>

        <span class="k">if</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t1_2_b</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> \
                <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,qg-&gt;pq&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t1_2_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
                <span class="s1">&#39;xr,xv-&gt;vr&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t1_2_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">t1_2_b</span>

        <span class="n">t2_1_a</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
        <span class="n">t2_1_ab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
             <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,ph,qxgh-&gt;pq&#39;</span><span class="p">,</span>
                                    <span class="n">Y_a</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span>
                                    <span class="n">t2_1_a</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,xh,qxgh-&gt;pq&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pxgh,qxgh-&gt;pq&#39;</span><span class="p">,</span> <span class="n">Y1_oovv_u_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xyrg,xyvg-&gt;vr&#39;</span><span class="p">,</span> <span class="n">Y1_oovv_u_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
             <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,yr,xyvg-&gt;vr&#39;</span><span class="p">,</span>
                                    <span class="n">Y_a</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span>
                                    <span class="n">t2_1_a</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xr,yg,xyvg-&gt;vr&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,xygh,pyvh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,xygh,xyvh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;xg,pxvg-&gt;vp&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,xygh,yphv-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,yxhg,pyvh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xv,xygh,pygh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">t2_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">t2_1_a</span>
        <span class="k">del</span> <span class="n">t2_1_ab</span>

        <span class="n">t2_1_b</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span>
        <span class="n">t2_1_ab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
             <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,ph,qxgh-&gt;pq&#39;</span><span class="p">,</span>
                                    <span class="n">Y_b</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span>
                                    <span class="n">t2_1_b</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,xh,qxgh-&gt;pq&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pxgh,qxgh-&gt;pq&#39;</span><span class="p">,</span> <span class="n">Y1_oovv_u_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xyrg,xyvg-&gt;vr&#39;</span><span class="p">,</span> <span class="n">Y1_oovv_u_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
             <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,yr,xyvg-&gt;vr&#39;</span><span class="p">,</span>
                                    <span class="n">Y_b</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span>
                                    <span class="n">t2_1_b</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xr,yg,xyvg-&gt;vr&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,xygh,pyvh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xv,xygh,pygh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span> <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s1">&#39;xg,pxvg-&gt;vp&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,xygh,pyvh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.25</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,xygh,xyvh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,xygh,pyvh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">t2_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">t2_1_b</span>
        <span class="k">del</span> <span class="n">t2_1_ab</span>

        <span class="n">t2_1_ab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
             <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,ph,qxhg-&gt;pq&#39;</span><span class="p">,</span>
                                    <span class="n">Y_b</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span>
                                    <span class="n">t2_1_ab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
             <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,ph,xqgh-&gt;pq&#39;</span><span class="p">,</span>
                                    <span class="n">Y_a</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span>
                                    <span class="n">t2_1_ab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,xh,qxgh-&gt;pq&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,xh,xqhg-&gt;pq&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
             <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pxgh,qxgh-&gt;pq&#39;</span><span class="p">,</span>
                                    <span class="n">Y1_abab</span><span class="p">,</span>
                                    <span class="n">t2_1_ab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
             <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xpgh,xqgh-&gt;pq&#39;</span><span class="p">,</span>
                                    <span class="n">Y1_abab</span><span class="p">,</span>
                                    <span class="n">t2_1_ab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
             <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xyrg,xyvg-&gt;vr&#39;</span><span class="p">,</span>
                                    <span class="n">Y1_abab</span><span class="p">,</span>
                                    <span class="n">t2_1_ab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
             <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xygr,xygv-&gt;vr&#39;</span><span class="p">,</span>
                                    <span class="n">Y1_abab</span><span class="p">,</span>
                                    <span class="n">t2_1_ab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
             <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,yr,yxvg-&gt;vr&#39;</span><span class="p">,</span>
                                    <span class="n">Y_b</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span>
                                    <span class="n">t2_1_ab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
             <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,yr,xygv-&gt;vr&#39;</span><span class="p">,</span>
                                    <span class="n">Y_a</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span>
                                    <span class="n">t2_1_ab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xr,yg,xyvg-&gt;vr&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xr,yg,yxgv-&gt;vr&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,xygh,pyvh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,yxhg,yphv-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,xygh,xyvh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,xyhg,xyhv-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xv,xygh,pygh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xv,yxgh,ypgh-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">t2_1_ab</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
             <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,pxvg-&gt;vp&#39;</span><span class="p">,</span>
                                    <span class="n">Y_b</span><span class="p">,</span>
                                    <span class="n">t2_1_ab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
             <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,xpgv-&gt;vp&#39;</span><span class="p">,</span>
                                    <span class="n">Y_a</span><span class="p">,</span>
                                    <span class="n">t2_1_ab</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">t2_1_ab</span>

    <span class="c1"># T_U1_Y0 qp block</span>
        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
             <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,qg-&gt;pq&#39;</span><span class="p">,</span>
                                    <span class="n">Y_a</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
             <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,qg-&gt;pq&#39;</span><span class="p">,</span>
                                    <span class="n">Y_b</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
             <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xr,xv-&gt;vr&#39;</span><span class="p">,</span>
                                    <span class="n">Y_a</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
             <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xr,xv-&gt;vr&#39;</span><span class="p">,</span>
                                    <span class="n">Y_b</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,xg,xv-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pg,xg,xv-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xv,xg,pg-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_a</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">t1_1_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xv,xg,pg-&gt;pv&#39;</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">t1_1_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
             <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,pg,xv-&gt;vp&#39;</span><span class="p">,</span>
                                    <span class="n">Y_a</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span>
                                    <span class="n">t1_1_a</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
             <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,pg,xv-&gt;vp&#39;</span><span class="p">,</span>
                                    <span class="n">Y_b</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span>
                                    <span class="n">t1_1_b</span><span class="p">,</span>
                                    <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t2_2_a</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,pxvg-&gt;vp&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t2_2_a</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">t2_2_a</span>

            <span class="n">t2_2_b</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,pxvg-&gt;vp&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t2_2_b</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">t2_2_b</span>

            <span class="n">t2_2_ab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,xpgv-&gt;vp&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t2_2_ab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xg,pxvg-&gt;vp&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t2_2_ab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">t2_2_ab</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(2)&quot;</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">Y1_abab</span>
            <span class="k">del</span> <span class="n">Y1_oovv_u_a</span>
            <span class="k">del</span> <span class="n">Y1_oovv_u_b</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(2)-x&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># T_U2_Y1 qp block</span>
                <span class="n">t2_2_a</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
                <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pxgh,qxgh-&gt;pq&#39;</span><span class="p">,</span> <span class="n">Y1_oovv_u_a</span><span class="p">,</span> <span class="n">t2_2_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span> <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xyrg,xyvg-&gt;vr&#39;</span><span class="p">,</span> <span class="n">Y1_oovv_u_a</span><span class="p">,</span> <span class="n">t2_2_a</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">t2_2_a</span>

                <span class="n">t2_2_b</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span>
                <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span> <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pxgh,qxgh-&gt;pq&#39;</span><span class="p">,</span> <span class="n">Y1_oovv_u_b</span><span class="p">,</span> <span class="n">t2_2_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span> <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                    <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xyrg,xyvg-&gt;vr&#39;</span><span class="p">,</span> <span class="n">Y1_oovv_u_b</span><span class="p">,</span> <span class="n">t2_2_b</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">t2_2_b</span>

                <span class="n">t2_2_ab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
                <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                     <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pxgh,qxgh-&gt;pq&#39;</span><span class="p">,</span>
                                            <span class="n">Y1_abab</span><span class="p">,</span>
                                            <span class="n">t2_2_ab</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                     <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xpgh,xqgh-&gt;pq&#39;</span><span class="p">,</span>
                                            <span class="n">Y1_abab</span><span class="p">,</span>
                                            <span class="n">t2_2_ab</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="c1"># T_U2_Y1 rv block</span>
                <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                     <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xyrg,xyvg-&gt;vr&#39;</span><span class="p">,</span>
                                            <span class="n">Y1_abab</span><span class="p">,</span>
                                            <span class="n">t2_2_ab</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                     <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xygr,xygv-&gt;vr&#39;</span><span class="p">,</span>
                                            <span class="n">Y1_abab</span><span class="p">,</span>
                                            <span class="n">t2_2_ab</span><span class="p">,</span>
                                            <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">t2_2_ab</span>

    <span class="c1">#           # T_U2_Y1 vp block</span>

            <span class="n">t2_1_a</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pxgh,yv,xygh-&gt;pv&#39;</span><span class="p">,</span>
                                               <span class="n">Y1_oovv_u_a</span><span class="p">,</span>
                                               <span class="n">t1_1_a</span><span class="p">,</span>
                                               <span class="n">t2_1_a</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xyvg,ph,xygh-&gt;pv&#39;</span><span class="p">,</span>
                                              <span class="n">Y1_oovv_u_a</span><span class="p">,</span>
                                              <span class="n">t1_1_a</span><span class="p">,</span>
                                              <span class="n">t2_1_a</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xygh,pg,xyvh-&gt;vp&#39;</span><span class="p">,</span>
                                             <span class="n">Y1_oovv_u_a</span><span class="p">,</span>
                                             <span class="n">t1_1_a</span><span class="p">,</span>
                                             <span class="n">t2_1_a</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xygh,yv,pxgh-&gt;vp&#39;</span><span class="p">,</span>
                                             <span class="n">Y1_oovv_u_a</span><span class="p">,</span>
                                             <span class="n">t1_1_a</span><span class="p">,</span>
                                             <span class="n">t2_1_a</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">t2_1_a</span>

            <span class="n">t2_1_ab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xyvg,ph,xyhg-&gt;pv&#39;</span><span class="p">,</span>
                                             <span class="n">Y1_abab</span><span class="p">,</span>
                                             <span class="n">t1_1_a</span><span class="p">,</span>
                                             <span class="n">t2_1_ab</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pxgh,yv,yxgh-&gt;pv&#39;</span><span class="p">,</span>
                                              <span class="n">Y1_abab</span><span class="p">,</span>
                                              <span class="n">t1_1_a</span><span class="p">,</span>
                                              <span class="n">t2_1_ab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xpgh,yv,xygh-&gt;pv&#39;</span><span class="p">,</span>
                                              <span class="n">Y1_abab</span><span class="p">,</span>
                                              <span class="n">t1_1_b</span><span class="p">,</span>
                                              <span class="n">t2_1_ab</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xygv,ph,xygh-&gt;pv&#39;</span><span class="p">,</span>
                                             <span class="n">Y1_abab</span><span class="p">,</span>
                                             <span class="n">t1_1_b</span><span class="p">,</span>
                                             <span class="n">t2_1_ab</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xygh,pg,xyvh-&gt;vp&#39;</span><span class="p">,</span>
                                       <span class="n">Y1_abab</span><span class="p">,</span>
                                       <span class="n">t1_1_a</span><span class="p">,</span>
                                       <span class="n">t2_1_ab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xyhg,pg,xyhv-&gt;vp&#39;</span><span class="p">,</span>
                                       <span class="n">Y1_abab</span><span class="p">,</span>
                                       <span class="n">t1_1_b</span><span class="p">,</span>
                                       <span class="n">t2_1_ab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;yxgh,yv,pxgh-&gt;vp&#39;</span><span class="p">,</span>
                                       <span class="n">Y1_abab</span><span class="p">,</span>
                                       <span class="n">t1_1_a</span><span class="p">,</span>
                                       <span class="n">t2_1_ab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xyhg,yv,xphg-&gt;vp&#39;</span><span class="p">,</span>
                                       <span class="n">Y1_abab</span><span class="p">,</span>
                                       <span class="n">t1_1_b</span><span class="p">,</span>
                                       <span class="n">t2_1_ab</span><span class="p">,</span>
                                       <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">t2_1_ab</span>

            <span class="n">t2_1_b</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pxgh,yv,xygh-&gt;pv&#39;</span><span class="p">,</span>
                                               <span class="n">Y1_oovv_u_b</span><span class="p">,</span>
                                               <span class="n">t1_1_b</span><span class="p">,</span>
                                               <span class="n">t2_1_b</span><span class="p">,</span>
                                               <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xyvg,ph,xygh-&gt;pv&#39;</span><span class="p">,</span>
                                              <span class="n">Y1_oovv_u_b</span><span class="p">,</span>
                                              <span class="n">t1_1_b</span><span class="p">,</span>
                                              <span class="n">t2_1_b</span><span class="p">,</span>
                                              <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xygh,pg,xyvh-&gt;vp&#39;</span><span class="p">,</span>
                                             <span class="n">Y1_oovv_u_b</span><span class="p">,</span>
                                             <span class="n">t1_1_b</span><span class="p">,</span>
                                             <span class="n">t2_1_b</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xygh,yv,pxgh-&gt;vp&#39;</span><span class="p">,</span>
                                             <span class="n">Y1_oovv_u_b</span><span class="p">,</span>
                                             <span class="n">t1_1_b</span><span class="p">,</span>
                                             <span class="n">t2_1_b</span><span class="p">,</span>
                                             <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">t2_1_b</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(2)-x&quot;</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">Y1_abab</span>
            <span class="k">del</span> <span class="n">Y1_oovv_u_a</span>
            <span class="k">del</span> <span class="n">Y1_oovv_u_b</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;adc(3)&quot;</span><span class="p">):</span>
            <span class="n">t2_ce_aa</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
            <span class="n">t2_ce_bb</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>
            <span class="n">einsum_type</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">t1_ccee_aaaa</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
            <span class="n">t1_ccee_bbbb</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span>
            <span class="n">t1_ccee_abab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>

            <span class="n">t2_ccee_aaaa</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
            <span class="n">t2_ccee_bbbb</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][:]</span>
            <span class="n">t2_ccee_abab</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>

            <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">f_ov_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                <span class="n">f_ov_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
                <span class="n">t1_ce_aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_a</span><span class="p">,</span> <span class="n">nvir_a</span><span class="p">))</span>
                <span class="n">t1_ce_bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc_b</span><span class="p">,</span> <span class="n">nvir_b</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">f_ov_a</span><span class="p">,</span> <span class="n">f_ov_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span>
                <span class="n">t1_ce_aa</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][:]</span>
                <span class="n">t1_ce_bb</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]</span>

            <span class="c1">#            TY_a[:nocc_a,:nocc_a] -= lib.einsum(&#39;Ia,La-&gt;IL&#39;, Y_a, t3_aa, optimize = einsum_type)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Liab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Liab,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ib,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ib,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Ib,Liab-&gt;IL&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liab,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">t2_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Liab,ijbc,jc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Liab,ijbc,jc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Liab,ijbc,jc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,Liab,jicb,jc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ia,Ljbc,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ia,Lb,ib-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ia,Ljbc,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijab,Lc,ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijab,Lc,ijcb-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liab,Ijbc,jc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liab,Ijbc,jc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.2500000005</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Libc,ja,Ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,Ijbc,Lc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.2500000005</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijbc,La,Ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,La,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,Ljac,Ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,Ljac,Ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,Ijcb,Lc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijbc,La,Ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Ib,Liba-&gt;IL&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liba,Ib-&gt;IL&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t2_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liba,Ijbc,jc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liba,Ijbc,jc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Libc,ja,Ijbc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,Ijcb,Lc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,Ljca,Ijcb-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiba,Ijbc,Lc-&gt;IL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

<span class="c1">#            TY_a[nocc_a:,nocc_a:] += lib.einsum(&#39;iC,iA-&gt;AC&#39;, Y_a, t3_aa, optimize = einsum_type)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijAa,ja-&gt;AC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijAa,ja-&gt;AC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ja,ijAa-&gt;AC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ja,ijAa-&gt;AC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jC,ijAa-&gt;AC&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAa,jC-&gt;AC&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                        <span class="n">t2_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijAa,jkab,kb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijAa,jkab,kb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijab,kA,jkab-&gt;AC&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ia,jA,ja-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ia,jkAb,jkab-&gt;AC&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ia,jkAb,jkab-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijAa,jkab,kb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijAa,kjba,kb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijab,kA,kjab-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iA,ja,jC-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.2500000005</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iA,jkab,jkCb-&gt;AC&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iA,jkab,jkCb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAa,jkCb,kb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAa,jkCb,kb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAb,ka,jkCb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,kA,jkCb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.2500000005</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jkAa,jkCb-&gt;AC&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAb,ka,kjCb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,kA,kjCb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jC,jiAa-&gt;AC&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiAa,jC-&gt;AC&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t2_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,kA,kjCb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,jkAa,jkCb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiAa,jkCb,kb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiAa,jkCb,kb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiAb,ka,jkCb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiba,kA,jkCb-&gt;AC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,iC,ia-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ia,iC-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijCb,ijab-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijab,ijCb-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijCb,ijab-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijab,ijCb-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,Ijab,ijab-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,Ia,ia-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,Ijab,ijab-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijab,Ijab-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ia,Ia-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijab,Ijab-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCb,ijab-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCb,ijab-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,IjCb-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,IjCb-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ia,ijCb,jb-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ia,ijCb,jb-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijab,iC,jb-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;Ia,ijab,iC,jb-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijab,Ia,jb-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ia,Ijab,jb-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ia,Ijab,jb-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;iC,ijab,Ia,jb-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,jC,Ib-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,ja,IjCb-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCb,jiba-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,IjCb,ijab-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,IjCb-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiba,IjCb-&gt;IC&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,ja,IjCb-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[:</span><span class="n">nocc_a</span><span class="p">,</span>
                 <span class="n">nocc_a</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiba,jC,Ib-&gt;IC&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>


<span class="c1">#            TY_a[nocc_a:,:nocc_a] += lib.einsum(&#39;ia,LiAa-&gt;AL&#39;, Y_a, t3_aaaa, optimize = einsum_type)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iA,La-&gt;AL&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t2_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,La,iA-&gt;AL&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_aa</span><span class="p">,</span>
                                        <span class="n">t2_ce_aa</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iA,Ljab,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,iA,Ljab,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,LiAb,ja,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,LiAb,jkac,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,LiAb,jkac,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liab,jA,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liab,jkAc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liab,jkAc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Libc,jkAa,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAa,Lkbc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAa,Lb,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAa,Lkbc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAb,La,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAb,Lkac,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAb,Lkac,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,LkAc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,LkAc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijbc,LkAa,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,LjAa,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAb,La,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAb,Lkac,kjcb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijAb,Lkac,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,LkAc,kjcb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,LkAc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijbc,LkAa,kjbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>


<span class="c1">#            TY_a[nocc_a:,:nocc_a] += lib.einsum(&#39;ia,LiAa-&gt;AL&#39;, Y_b, t3_abab, optimize = einsum_type)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,LiAb,ja,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,LiAb,jkca,jkcb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,LiAb,jkac,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liba,jA,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liba,jkAc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Liba,jkAc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,Libc,jkAa,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,LkAc,kjcb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijab,LkAc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ijbc,LkAa,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ib,LjAa,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiAa,Lkbc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiAa,Lb,jb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiAa,Lkbc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiAb,Lkca,jkcb-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiba,LkAc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jiba,LkAc,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_a</span><span class="p">[</span><span class="n">nocc_a</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_a</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jibc,LkAa,jkbc-&gt;AL&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ib,jlab-&gt;il&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jlab,ib-&gt;il&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t2_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jlab,ikbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jlab,kicb,kc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jlbc,ka,kibc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jkab,lc,kibc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,klac,kibc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jkab,ikbc,lc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

<span class="c1">#            TY_b[:nocc_b,:nocc_b] -= lib.einsum(&#39;ia,la-&gt;il&#39;, Y_b, t3_bb, optimize = einsum_type)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ljab,jb-&gt;il&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jlba,jb-&gt;il&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,jlba-&gt;il&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jb,ljab-&gt;il&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ib,ljab-&gt;il&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ljab,ib-&gt;il&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">t2_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ljab,jkbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ljab,kjcb,kc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,lkbc,jkbc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,lb,jb-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,klbc,kjbc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jlba,jkbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jlba,jkbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkba,lc,jkbc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkab,lc,jkbc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ljab,ikbc,kc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ljab,kicb,kc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.2500000005</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ljbc,ka,ikbc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jkab,ikbc,lc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.2500000005</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jkbc,la,ikbc-&gt;il&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,la,ib-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,lkac,ikbc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,klca,kicb-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kjba,lc,kibc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kjbc,la,kibc-&gt;il&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jc,ijba-&gt;ac&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijba,jc-&gt;ac&#39;</span><span class="p">,</span>
                                        <span class="n">Y_a</span><span class="p">,</span>
                                        <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                        <span class="n">t2_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijbd,ka,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,id,jkba,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijba,jkcd,kd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijba,kjdc,kd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijbd,ka,jkcd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijda,kb,kjdc-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

<span class="c1">#            TY_b[nocc_b:,nocc_b:] += lib.einsum(&#39;ic,ia-&gt;ac&#39;, Y_b, t3_bb, optimize = einsum_type)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ijab,jb-&gt;ac&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jiba,jb-&gt;ac&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ce_aa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jb,jiba-&gt;ac&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jb,ijab-&gt;ac&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jc,ijab-&gt;ac&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijab,jc-&gt;ac&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                        <span class="n">t2_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ijab,jkbd,kd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ijab,kjdb,kd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ijbd,ka,jkbd-&gt;ac&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ib,ja,jb-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ib,jkda,jkdb-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,ib,jkad,jkbd-&gt;ac&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jiba,jkbd,kd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jiba,jkbd,kd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ic,jibd,ka,jkbd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ia,jb,jc-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ia,jkdb,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.2500000005</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ia,jkbd,jkcd-&gt;ac&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijab,jkcd,kd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijab,kjdc,kd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijad,kb,jkcd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijbd,ka,jkcd-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.2500000005</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,id,jkab,jkcd-&gt;ac&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jida,kb,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jidb,ka,jkdc-&gt;ac&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ikcb,jkab-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jkab,kibc-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jkab,ikcb-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kibc,jkab-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_a</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_aaaa</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,ka,kibc-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jkab,kc,ib-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jc,ja-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,jc-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkbc,jkba-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkba,jkbc-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkcb,jkab-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkab,jkcb-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,ikab,jkab-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,ia,ja-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,jkab,ikab-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,ja,ia-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                <span class="n">t2_ce_bb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,kiab,kjab-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,kjab,kiab-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,ikcb,jkab-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jkab,ikcb-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">t2_ccee_bbbb</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kibc,kjba-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,kjba,kibc-&gt;ic&#39;</span><span class="p">,</span>
                                                <span class="n">Y_b</span><span class="p">,</span>
                                                <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                <span class="n">t2_ccee_abab</span><span class="p">,</span>
                                                <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,jkcb,kb-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,ja,kjbc,kb-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkba,kc,jb-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,jkab,jc,kb-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,jkab,ia,kb-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,ja,ikab,kb-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,ja,kiba,kb-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jc,kjab,ib,ka-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jkab,kc,ib-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[:</span><span class="n">nocc_b</span><span class="p">,</span>
                 <span class="n">nocc_b</span><span class="p">:]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ja,jb,ka,ikcb-&gt;ic&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>


<span class="c1">#            TY_b[nocc_b:,:nocc_b] += lib.einsum(&#39;ib,ilba-&gt;al&#39;, Y_a, t3_abab, optimize = einsum_type)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ilbc,ja,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ilbc,jkda,jkdc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ilbc,jkad,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ilca,jb,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ilca,jkbd,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ilca,jkbd,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ilcd,jkba,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijbc,lkad,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijbc,jkcd,klda-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijcd,klba,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_a</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ic,jlba,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijba,lkcd,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijba,lc,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijba,klcd,kjcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijbc,lkad,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijbc,klda,kjdc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijca,klbd,kjcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijcd,klba,kjcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_a</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

<span class="c1">#            TY_b[nocc_b:,:nocc_b] += lib.einsum(&#39;ib,liab-&gt;al&#39;, Y_b, t3_bbbb, optimize = einsum_type)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ia,lb-&gt;al&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t2_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,lb,ia-&gt;al&#39;</span><span class="p">,</span>
                                        <span class="n">Y_b</span><span class="p">,</span>
                                        <span class="n">t1_ce_bb</span><span class="p">,</span>
                                        <span class="n">t2_ce_bb</span><span class="p">,</span>
                                        <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ia,ljbc,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ia,jlcb,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,liac,jb,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,liac,jkdb,jkdc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,liac,jkbd,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,libc,ja,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,libc,jkda,jkdc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,libc,jkad,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,licd,jkab,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.333333334</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijab,lkcd,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijab,lc,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijab,klcd,kjcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijac,lb,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijac,lkbd,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijac,kldb,kjdc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijbc,lkad,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijbc,klda,kjdc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.0833333335</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ijcd,lkab,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                       <span class="n">Y_b</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                       <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,ic,ljab,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.500000001</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jica,lb,jc-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ce_bb</span><span class="p">,</span>
                                                      <span class="n">t1_ce_aa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jica,lkbd,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.666666668</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jica,kldb,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jicb,lkad,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jicb,jkcd,klda-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_aaaa</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>
            <span class="n">TY_b</span><span class="p">[</span><span class="n">nocc_b</span><span class="p">:,</span>
                 <span class="p">:</span><span class="n">nocc_b</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.166666667</span> <span class="o">*</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ib,jicd,lkab,jkcd-&gt;al&#39;</span><span class="p">,</span>
                                                      <span class="n">Y_b</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_bbbb</span><span class="p">,</span>
                                                      <span class="n">t1_ccee_abab</span><span class="p">,</span>
                                                      <span class="n">optimize</span><span class="o">=</span><span class="n">einsum_type</span><span class="p">)</span>

        <span class="n">TY_aa</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">TY_a</span>
        <span class="n">TY_bb</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">TY_b</span>

    <span class="n">TY</span> <span class="o">=</span> <span class="p">(</span><span class="n">TY_aa</span><span class="p">,</span> <span class="n">TY_bb</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">TY</span></div>



<div class="viewcode-block" id="analyze_spec_factor">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.analyze_spec_factor">[docs]</a>
<span class="k">def</span> <span class="nf">analyze_spec_factor</span><span class="p">(</span><span class="n">adc</span><span class="p">):</span>
    <span class="n">X_aa</span><span class="p">,</span> <span class="n">X_bb</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">X</span>

    <span class="n">nroots</span> <span class="o">=</span> <span class="n">X_aa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">X_aa</span> <span class="o">=</span> <span class="n">X_aa</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nroots</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">X_bb</span> <span class="o">=</span> <span class="n">X_bb</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nroots</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">energy</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">E</span> <span class="o">*</span> <span class="mf">27.2114</span>

    <span class="n">X_a</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_aa</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">X_b</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_bb</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">nmo_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_a</span> <span class="o">+</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_a</span>
    <span class="n">nmo_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">nocc_b</span> <span class="o">+</span> <span class="n">adc</span><span class="o">.</span><span class="n">nvir_b</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="n">adc</span><span class="p">,</span>
        <span class="s2">&quot;Print spectroscopic factors &gt; </span><span class="si">%E</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">adc</span><span class="o">.</span><span class="n">spec_factor_print_tol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">adc</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">symmetry</span><span class="p">:</span>
        <span class="n">sym_a</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">symm</span><span class="o">.</span><span class="n">irrep_id2name</span><span class="p">(</span>
                <span class="n">adc</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">groupname</span><span class="p">,</span>
                <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">hf_symm</span><span class="o">.</span><span class="n">get_orbsym</span><span class="p">(</span>
                <span class="n">adc</span><span class="o">.</span><span class="n">mol</span><span class="p">,</span>
                <span class="n">adc</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="n">sym_b</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">symm</span><span class="o">.</span><span class="n">irrep_id2name</span><span class="p">(</span>
                <span class="n">adc</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">groupname</span><span class="p">,</span>
                <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">hf_symm</span><span class="o">.</span><span class="n">get_orbsym</span><span class="p">(</span>
                <span class="n">adc</span><span class="o">.</span><span class="n">mol</span><span class="p">,</span>
                <span class="n">adc</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">sym_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">nmo_a</span><span class="p">)</span>
        <span class="n">sym_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">nmo_b</span><span class="p">)</span>

    <span class="n">sym_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sym_a</span><span class="p">)</span>
    <span class="n">sym_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sym_b</span><span class="p">)</span>

    <span class="n">spin_a</span> <span class="o">=</span> <span class="s2">&quot;Alpha&quot;</span>
    <span class="n">spin_b</span> <span class="o">=</span> <span class="s2">&quot;Beta&quot;</span>

    <span class="n">thresh</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">spec_factor_print_tol</span>

    <span class="k">for</span> <span class="n">root_a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

        <span class="n">X_a_root</span> <span class="o">=</span> <span class="n">X_a</span><span class="p">[</span><span class="n">root_a</span><span class="p">,</span> <span class="p">:]</span>

        <span class="n">sort_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">X_a_root</span><span class="p">)</span>

        <span class="n">X_a_root</span> <span class="o">=</span> <span class="n">X_a_root</span><span class="p">[</span><span class="n">sort_a</span><span class="p">]</span>

        <span class="n">X_a_root</span> <span class="o">=</span> <span class="n">X_a_root</span><span class="p">[</span><span class="n">X_a_root</span> <span class="o">&gt;</span> <span class="n">thresh</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X_a_root</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">adc</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> | root </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="n">root_a</span><span class="p">,</span> <span class="n">spin_a</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="n">adc</span><span class="p">,</span>
            <span class="s2">&quot;Hole_MO       Particle_MO        X_a^2       Orbital symmetry      excitation energy&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="n">adc</span><span class="p">,</span>
            <span class="s2">&quot;-------------------------------------------------------------------------------------&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">hp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_a_root</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">P</span> <span class="o">=</span> <span class="p">((</span><span class="n">sort_a</span><span class="p">[</span><span class="n">hp</span><span class="p">])</span> <span class="o">%</span> <span class="n">nmo_a</span><span class="p">)</span>
            <span class="n">H</span> <span class="o">=</span> <span class="p">((</span><span class="n">sort_a</span><span class="p">[</span><span class="n">hp</span><span class="p">])</span> <span class="o">//</span> <span class="n">nmo_a</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="n">adc</span><span class="p">,</span>
                <span class="s1">&#39;%4.d           %4.d            </span><span class="si">%10.8f</span><span class="s1">      </span><span class="si">%s</span><span class="s1"> -&gt; </span><span class="si">%s</span><span class="s1">           </span><span class="si">%12.8f</span><span class="s1"> &#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="n">P</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">X_a_root</span><span class="p">[</span><span class="n">hp</span><span class="p">],</span>
                <span class="n">sym_a</span><span class="p">[</span><span class="n">H</span><span class="p">],</span>
                <span class="n">sym_a</span><span class="p">[</span><span class="n">P</span><span class="p">],</span>
                <span class="n">energy</span><span class="p">[</span><span class="n">root_a</span><span class="p">])</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="n">adc</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Partial norm of X_a = </span><span class="si">%10.8f</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X_a_root</span><span class="p">)))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="n">adc</span><span class="p">,</span>
            <span class="s2">&quot;*************************************************************************************</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">root_b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

        <span class="n">X_b_root</span> <span class="o">=</span> <span class="n">X_b</span><span class="p">[</span><span class="n">root_b</span><span class="p">,</span> <span class="p">:]</span>

        <span class="n">sort_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">X_b_root</span><span class="p">)</span>

        <span class="n">X_b_root</span> <span class="o">=</span> <span class="n">X_b_root</span><span class="p">[</span><span class="n">sort_b</span><span class="p">]</span>

        <span class="n">X_b_root</span> <span class="o">=</span> <span class="n">X_b_root</span><span class="p">[</span><span class="n">X_b_root</span> <span class="o">&gt;</span> <span class="n">thresh</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X_b_root</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">adc</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> | root </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="n">root_b</span><span class="p">,</span> <span class="n">spin_b</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="n">adc</span><span class="p">,</span>
            <span class="s2">&quot;Hole_MO       Particle_MO        X_b^2       Orbital symmetry      excitation energy&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="n">adc</span><span class="p">,</span>
            <span class="s2">&quot;-------------------------------------------------------------------------------------&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">hp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_b_root</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">P</span> <span class="o">=</span> <span class="n">sort_b</span><span class="p">[</span><span class="n">hp</span><span class="p">]</span> <span class="o">%</span> <span class="n">nmo_b</span>
            <span class="n">H</span> <span class="o">=</span> <span class="n">sort_b</span><span class="p">[</span><span class="n">hp</span><span class="p">]</span> <span class="o">//</span> <span class="n">nmo_b</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="n">adc</span><span class="p">,</span>
                <span class="s1">&#39;%4.d           %4.d            </span><span class="si">%10.8f</span><span class="s1">      </span><span class="si">%s</span><span class="s1"> -&gt; </span><span class="si">%s</span><span class="s1">           </span><span class="si">%12.8f</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="n">P</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">X_b_root</span><span class="p">[</span><span class="n">hp</span><span class="p">],</span>
                <span class="n">sym_b</span><span class="p">[</span><span class="n">H</span><span class="p">],</span>
                <span class="n">sym_b</span><span class="p">[</span><span class="n">P</span><span class="p">],</span>
                <span class="n">energy</span><span class="p">[</span><span class="n">root_b</span><span class="p">])</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="n">adc</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Partial norm of X_b = </span><span class="si">%10.8f</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X_b_root</span><span class="p">)))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="n">adc</span><span class="p">,</span>
            <span class="s2">&quot;*************************************************************************************</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_properties">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.get_properties">[docs]</a>
<span class="k">def</span> <span class="nf">get_properties</span><span class="p">(</span><span class="n">adc</span><span class="p">,</span> <span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

    <span class="c1"># Transition moments</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">get_trans_moments</span><span class="p">()</span>

    <span class="n">dX</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;xqp,nqp-&gt;xn&quot;</span><span class="p">,</span> <span class="n">adc</span><span class="o">.</span><span class="n">dip_mom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dX</span> <span class="o">+=</span> <span class="n">lib</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;xqp,nqp-&gt;xn&quot;</span><span class="p">,</span> <span class="n">adc</span><span class="o">.</span><span class="n">dip_mom</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">spec_intensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">dX</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">dX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">spec_intensity</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">dX</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">dX</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">spec_intensity</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">dX</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">dX</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Oscillator strengths</span>
    <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">adc</span><span class="o">.</span><span class="n">E</span> <span class="o">*</span> <span class="n">spec_intensity</span>

    <span class="k">return</span> <span class="n">P</span><span class="p">,</span> <span class="n">X</span></div>



<div class="viewcode-block" id="analyze">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.analyze">[docs]</a>
<span class="k">def</span> <span class="nf">analyze</span><span class="p">(</span><span class="n">myadc</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">myadc</span><span class="o">.</span><span class="n">compute_properties</span><span class="p">:</span>

        <span class="n">header</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">*************************************************************&quot;</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">          Spectroscopic amplitude analysis summary&quot;</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">*************************************************************&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">myadc</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>

        <span class="n">myadc</span><span class="o">.</span><span class="n">analyze_spec_factor</span><span class="p">()</span></div>



<div class="viewcode-block" id="UADCEE">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.UADCEE">[docs]</a>
<span class="k">class</span> <span class="nc">UADCEE</span><span class="p">(</span><span class="n">uadc</span><span class="o">.</span><span class="n">UADC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;unrestricted ADC for EE energies and spectroscopic amplitudes</span>

<span class="sd">    Attributes:</span>
<span class="sd">        verbose : int</span>
<span class="sd">            Print level.  Default value equals to :class:`Mole.verbose`</span>
<span class="sd">        max_memory : float or int</span>
<span class="sd">            Allowed memory in MB.  Default value equals to :class:`Mole.max_memory`</span>
<span class="sd">        incore_complete : bool</span>
<span class="sd">            Avoid all I/O. Default is False.</span>
<span class="sd">        method : string</span>
<span class="sd">            nth-order ADC method. Options are : ADC(2), ADC(2)-X, ADC(3). Default is ADC(2).</span>
<span class="sd">        conv_tol : float</span>
<span class="sd">            Convergence threshold for Davidson iterations.  Default is 1e-8.</span>
<span class="sd">        max_cycle : int</span>
<span class="sd">            Number of Davidson iterations.  Default is 50.</span>
<span class="sd">        max_space : int</span>
<span class="sd">            Space size to hold trial vectors for Davidson iterative diagonalization.  Default is 12.</span>

<span class="sd">    Kwargs:</span>
<span class="sd">        nroots : int</span>
<span class="sd">            Number of roots (eigenvalues) requested. Default value is 1.</span>

<span class="sd">            &gt;&gt;&gt; myadc = adc.UADC(mf).run()</span>
<span class="sd">            &gt;&gt;&gt; myadcee = adc.UADCEE(myadc).run()</span>

<span class="sd">    Saved results</span>

<span class="sd">        e_ee : float or list of floats</span>
<span class="sd">            EE energy (eigenvalue). For nroots = 1, it is a single float</span>
<span class="sd">            number. If nroots &gt; 1, it is a list of floats for the lowest</span>
<span class="sd">            nroots eigenvalues.</span>
<span class="sd">        v_ee : array</span>
<span class="sd">            Eigenvectors for each EE transition.</span>
<span class="sd">        p_ee : array</span>
<span class="sd">            Oscillator strength for each EE transition.</span>
<span class="sd">        x_ee : array</span>
<span class="sd">            Spectroscopic amplitudes for each EE transition.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">_keys</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;tol_residual&#39;</span><span class="p">,</span> <span class="s1">&#39;conv_tol&#39;</span><span class="p">,</span> <span class="s1">&#39;e_corr&#39;</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">,</span>
        <span class="s1">&#39;method_type&#39;</span><span class="p">,</span> <span class="s1">&#39;mo_coeff&#39;</span><span class="p">,</span> <span class="s1">&#39;mo_energy_a&#39;</span><span class="p">,</span> <span class="s1">&#39;mo_energy_b&#39;</span><span class="p">,</span> <span class="s1">&#39;max_memory&#39;</span><span class="p">,</span>
        <span class="s1">&#39;t1&#39;</span><span class="p">,</span> <span class="s1">&#39;t2&#39;</span><span class="p">,</span> <span class="s1">&#39;max_space&#39;</span><span class="p">,</span> <span class="s1">&#39;max_cycle&#39;</span><span class="p">,</span>
        <span class="s1">&#39;nocc_a&#39;</span><span class="p">,</span> <span class="s1">&#39;nocc_b&#39;</span><span class="p">,</span> <span class="s1">&#39;nvir_a&#39;</span><span class="p">,</span> <span class="s1">&#39;nvir_b&#39;</span><span class="p">,</span> <span class="s1">&#39;mo_energy_a&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mo_energy_b&#39;</span><span class="p">,</span> <span class="s1">&#39;nmo_a&#39;</span><span class="p">,</span> <span class="s1">&#39;nmo_b&#39;</span><span class="p">,</span> <span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="s1">&#39;transform_integrals&#39;</span><span class="p">,</span>
        <span class="s1">&#39;with_df&#39;</span><span class="p">,</span> <span class="s1">&#39;spec_factor_print_tol&#39;</span><span class="p">,</span> <span class="s1">&#39;evec_print_tol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;compute_properties&#39;</span><span class="p">,</span> <span class="s1">&#39;approx_trans_moments&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">adc</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">stdout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_memory</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">max_memory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_space</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">max_space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_cycle</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">max_cycle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">conv_tol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tol_residual</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">tol_residual</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t2</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">t2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imds</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">imds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_corr</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">e_corr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">method_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scf</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">_scf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nocc</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">_nocc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nvir</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">_nvir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nocc_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">_nocc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nocc_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">_nocc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nvir_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">_nvir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nvir_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">_nvir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mo_coeff</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_coeff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mo_energy_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mo_energy_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">mo_energy_b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nmo_a</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">_nmo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nmo_b</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">_nmo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform_integrals</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">transform_integrals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">with_df</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">with_df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_properties</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">compute_properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">approx_trans_moments</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">approx_trans_moments</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spec_factor_print_tol</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">spec_factor_print_tol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evec_print_tol</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">evec_print_tol</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">E</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">U</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">X</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">f_ov</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">f_ov</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_spin_square</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">compute_spin_square</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dip_mom</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">dip_mom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dip_mom_nuc</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">dip_mom_nuc</span>

    <span class="n">kernel</span> <span class="o">=</span> <span class="n">uadc</span><span class="o">.</span><span class="n">kernel</span>
    <span class="n">get_imds</span> <span class="o">=</span> <span class="n">get_imds</span>
    <span class="n">get_diag</span> <span class="o">=</span> <span class="n">get_diag</span>
    <span class="n">matvec</span> <span class="o">=</span> <span class="n">matvec</span>
    <span class="n">get_trans_moments</span> <span class="o">=</span> <span class="n">get_trans_moments</span>
    <span class="n">get_spin_square</span> <span class="o">=</span> <span class="n">get_spin_square</span>
    <span class="n">make_rdm1</span> <span class="o">=</span> <span class="n">make_rdm1</span>
    <span class="n">get_properties</span> <span class="o">=</span> <span class="n">get_properties</span>

    <span class="n">analyze_spec_factor</span> <span class="o">=</span> <span class="n">analyze_spec_factor</span>
    <span class="n">analyze</span> <span class="o">=</span> <span class="n">analyze</span>

<div class="viewcode-block" id="UADCEE.get_init_guess">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.UADCEE.get_init_guess">[docs]</a>
    <span class="k">def</span> <span class="nf">get_init_guess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nroots</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">diag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">diag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">diag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_diag</span><span class="p">()</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">ascending</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">diag</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">diag</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nroots</span><span class="p">))</span>
        <span class="n">min_shape</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">diag</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nroots</span><span class="p">)</span>
        <span class="n">guess</span><span class="p">[:</span><span class="n">min_shape</span><span class="p">,</span> <span class="p">:</span><span class="n">min_shape</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">min_shape</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">diag</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nroots</span><span class="p">))</span>
        <span class="n">g</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">guess</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">guess</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">guess</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">[:,</span> <span class="n">p</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">guess</span></div>


<div class="viewcode-block" id="UADCEE.gen_matvec">
<a class="viewcode-back" href="../../../pyscf_api_docs/pyscf.adc.html#pyscf.adc.uadc_ee.UADCEE.gen_matvec">[docs]</a>
    <span class="k">def</span> <span class="nf">gen_matvec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eris</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">imds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">imds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_imds</span><span class="p">(</span><span class="n">eris</span><span class="p">)</span>
        <span class="n">diag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_diag</span><span class="p">(</span><span class="n">imds</span><span class="p">,</span> <span class="n">eris</span><span class="p">)</span>
        <span class="n">matvec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matvec</span><span class="p">(</span><span class="n">imds</span><span class="p">,</span> <span class="n">eris</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">matvec</span><span class="p">,</span> <span class="n">diag</span></div>
</div>


</pre></div>

                </article>
              
              
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, The PySCF Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>